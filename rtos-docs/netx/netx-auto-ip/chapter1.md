---
title: 'Capítulo 1: Introducción a AutoIP de Azure RTOS NetX'
description: El protocolo AutoIP de Azure RTOS NetX es un protocolo diseñado para configurar dinámicamente las direcciones IPv4 en una red local.
author: philmea
ms.author: philmea
ms.date: 06/04/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: c26b4112814bb586e056246d68c2597d56df6085
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 03/22/2021
ms.locfileid: "104815286"
---
# <a name="chapter-1---introduction-to-azure-rtos-netx-autoip"></a><span data-ttu-id="f9794-103">Capítulo 1: Introducción a AutoIP de Azure RTOS NetX</span><span class="sxs-lookup"><span data-stu-id="f9794-103">Chapter 1 - Introduction to Azure RTOS NetX AutoIP</span></span>
  
<span data-ttu-id="f9794-104">El protocolo AutoIP de Azure RTOS NetX es un protocolo diseñado para configurar dinámicamente las direcciones IPv4 en una red local.</span><span class="sxs-lookup"><span data-stu-id="f9794-104">The Azure RTOS NetX AutoIP Protocol is a protocol designed for dynamically configuring IPv4 addresses on a local network.</span></span> <span data-ttu-id="f9794-105">AutoIP es un protocolo simple que emplea las funciones ARP para realizar su función de asignación automática de direcciones IP.</span><span class="sxs-lookup"><span data-stu-id="f9794-105">AutoIP is a simple protocol that utilizes ARP capabilities to perform its automatic IP address assignment function.</span></span> <span data-ttu-id="f9794-106">AutoIP asigna direcciones en el intervalo de 169.254.1.0 a 169.254.254.255.</span><span class="sxs-lookup"><span data-stu-id="f9794-106">AutoIP allocates addresses in the range of 169.254.1.0 through 169.254.254.255.</span></span>

## <a name="autoip-requirements"></a><span data-ttu-id="f9794-107">Requisitos de AutoIP</span><span class="sxs-lookup"><span data-stu-id="f9794-107">AutoIP Requirements</span></span>

<span data-ttu-id="f9794-108">Para que funcione correctamente, el paquete AutoIP de NetX requiere que ya se haya creado una instancia de IP NetX.</span><span class="sxs-lookup"><span data-stu-id="f9794-108">In order to function properly, the NetX AutoIP package requires that a NetX IP instance has already been created.</span></span> <span data-ttu-id="f9794-109">Además, ARP debe estar habilitado en la misma instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="f9794-109">In addition, ARP must be enabled on that same IP instance.</span></span> <span data-ttu-id="f9794-110">El paquete AutoIP de NetX no tiene ningún requisito adicional.</span><span class="sxs-lookup"><span data-stu-id="f9794-110">The NetX AutoIP package has no further requirements.</span></span>

## <a name="autoip-constraints"></a><span data-ttu-id="f9794-111">Restricciones de AutoIP</span><span class="sxs-lookup"><span data-stu-id="f9794-111">AutoIP Constraints</span></span> 

<span data-ttu-id="f9794-112">El protocolo AutoIP de NetX implementa los requisitos del estándar RFC3927.</span><span class="sxs-lookup"><span data-stu-id="f9794-112">The NetX AutoIP protocol implements the requirements of the RFC3927 standard.</span></span> <span data-ttu-id="f9794-113">Sin embargo, se aplican las restricciones siguientes:</span><span class="sxs-lookup"><span data-stu-id="f9794-113">However, there are the following constraints:</span></span>

1. <span data-ttu-id="f9794-114">Si se usa DHCP de NetX, el subproceso DHCP debe crearse con una prioridad más alta que el subproceso de instancia de IP y el subproceso de AutoIP de NetX.</span><span class="sxs-lookup"><span data-stu-id="f9794-114">If NetX DHCP is used, the DHCP thread must be created with a higher priority than both the NetX IP instance thread and the AutoIP thread.</span></span>
1. <span data-ttu-id="f9794-115">AutoIP de NetX no proporciona un mecanismo para que las direcciones IP antiguas sigan utilizándose.</span><span class="sxs-lookup"><span data-stu-id="f9794-115">NetX AutoIP does not provide a mechanism for old IP addresses to continue being used.</span></span>
1. <span data-ttu-id="f9794-116">Cuando la dirección IP cambia, la aplicación es responsable de anular las conexiones TCP existentes y volver a establecerlas en la nueva dirección IP.</span><span class="sxs-lookup"><span data-stu-id="f9794-116">When the IP address changes, the application is responsible for tearing down any existing TCP connections and re-establishing them on the new IP address.</span></span>

## <a name="autoip-protocol-implementation"></a><span data-ttu-id="f9794-117">Implementación del protocolo AutoIP</span><span class="sxs-lookup"><span data-stu-id="f9794-117">AutoIP Protocol Implementation</span></span>

<span data-ttu-id="f9794-118">En primer lugar, el protocolo AutoIP de NetX selecciona una dirección aleatoria dentro del intervalo de direcciones IPv4 de AutoIP de 169.254.1.0 a 169.254.254.255.</span><span class="sxs-lookup"><span data-stu-id="f9794-118">The NetX AutoIP protocol first selects a random address within the AutoIP IPv4 address range of 169.254.1.0 through 169.254.254.255.</span></span> <span data-ttu-id="f9794-119">Como alternativa, la aplicación puede forzar una dirección IP de inicio proporcionándola en la función ***nx_auto_ip_start***.</span><span class="sxs-lookup"><span data-stu-id="f9794-119">Alternatively, the application may force a starting IP address by providing it to the ***nx_auto_ip_start*** function.</span></span> <span data-ttu-id="f9794-120">Esto resulta útil en situaciones en las que una dirección AutoIP se ha usado correctamente en una ejecución anterior.</span><span class="sxs-lookup"><span data-stu-id="f9794-120">This is useful in situations where an AutoIP address was successfully used in a prior run.</span></span>

<span data-ttu-id="f9794-121">Una vez que se selecciona una dirección AutoIP, AutoIP de NetX envía una serie de sondeos ARP para la dirección seleccionada.</span><span class="sxs-lookup"><span data-stu-id="f9794-121">Once an AutoIP address is selected, NetX AutoIP sends out a series of ARP probes for the selected address.</span></span> <span data-ttu-id="f9794-122">Un sondeo ARP consta de un mensaje de solicitud ARP con la dirección del remitente establecida en 0.0.0.0 y la dirección de destino establecida en la dirección AutoIP deseada.</span><span class="sxs-lookup"><span data-stu-id="f9794-122">An ARP probe consists of an ARP request message with the sender address set to 0.0.0.0 and the target address set to the desired AutoIP address.</span></span> <span data-ttu-id="f9794-123">Se envía una serie de estos sondeos ARP (el número real viene determinado por la definición NX_AUTO_IP_PROBE_NUM).</span><span class="sxs-lookup"><span data-stu-id="f9794-123">A series of these ARP probes are sent (the actual number is determined by the define NX_AUTO_IP_PROBE_NUM).</span></span> <span data-ttu-id="f9794-124">Si otro nodo de red responde a este sondeo o envía un sondeo idéntico para la misma dirección, se selecciona aleatoriamente una nueva dirección AutoIP en el intervalo de direcciones IPv4 de AutoIP y se repite el procesamiento del sondeo.</span><span class="sxs-lookup"><span data-stu-id="f9794-124">If another network node responds to this probe or sends an identical probe for the same address, a new AutoIP address is randomly selected within the AutoIP IPv4 address range and the probe processing repeats.</span></span>

<span data-ttu-id="f9794-125">Si se envían los sondeos NX_AUTO_IP_PROBE_NUM sin ninguna respuesta, AutoIP de NetX emite una serie de anuncios ARP para la dirección seleccionada.</span><span class="sxs-lookup"><span data-stu-id="f9794-125">If NX_AUTO_IP_PROBE_NUM probes are sent without any responses, NetX AutoIP issues a series of ARP announcements for the selected address.</span></span> <span data-ttu-id="f9794-126">Un anuncio ARP consta de un mensaje de solicitud ARP con el remitente y la dirección de destino del mensaje ARP establecidos en la dirección AutoIP seleccionada.</span><span class="sxs-lookup"><span data-stu-id="f9794-126">An ARP announcement consists of an ARP request message with both the sender and target address in the ARP message set to the selected AutoIP address.</span></span> <span data-ttu-id="f9794-127">Se envía una serie de mensajes de anuncio ARP, correspondientes a la definición NX_AUTO_IP_ANNOUNCE_NUM.</span><span class="sxs-lookup"><span data-stu-id="f9794-127">A series of ARP announcement messages are sent, corresponding to the define NX_AUTO_IP_ANNOUNCE_NUM.</span></span> <span data-ttu-id="f9794-128">Si otro nodo de red responde a un mensaje de anuncio o envía un anuncio idéntico para la misma dirección, se selecciona aleatoriamente una nueva dirección AutoIP en el intervalo de direcciones IPv4 de AutoIP y el procesamiento del sondeo empieza de nuevo.</span><span class="sxs-lookup"><span data-stu-id="f9794-128">If another network node responds to an announce message or sends an identical announcement for the same address, a new AutoIP address is randomly selected within the AutoIP IPv4 address range and the probe processing starts over.</span></span>

<span data-ttu-id="f9794-129">Cuando el sondeo y el anuncio se completan sin conflictos detectados, la dirección de AutoIP seleccionada se considera válida y la instancia de IP asociada se configura con esta dirección.</span><span class="sxs-lookup"><span data-stu-id="f9794-129">When the probe and announcement completes without any detected conflicts, the selected AutoIP address is considered valid and the associated IP instance is setup with this address.</span></span>

## <a name="autoip-address-change"></a><span data-ttu-id="f9794-130">Cambio de dirección en AutoIP</span><span class="sxs-lookup"><span data-stu-id="f9794-130">AutoIP Address Change</span></span>

<span data-ttu-id="f9794-131">Como se ha mencionado anteriormente, AutoIP de NetX cambia la dirección de la instancia de IP después del sondeo y el procesamiento del anuncio correctos.</span><span class="sxs-lookup"><span data-stu-id="f9794-131">As mentioned before, NetX AutoIP changes the IP instance address after successful probe and announcement processing.</span></span> <span data-ttu-id="f9794-132">La supervisión en este caso no tiene mucha importancia.</span><span class="sxs-lookup"><span data-stu-id="f9794-132">Monitoring for this case is not terribly important.</span></span> <span data-ttu-id="f9794-133">Sin embargo, es posible que la dirección de AutoIP cambie en el futuro.</span><span class="sxs-lookup"><span data-stu-id="f9794-133">However, it is possible to have the AutoIP address change in the future.</span></span> <span data-ttu-id="f9794-134">Entre las posibles causas se incluyen conflictos de direcciones de AutoIP en el futuro, así como la resolución de direcciones DHCP.</span><span class="sxs-lookup"><span data-stu-id="f9794-134">Potential causes include future AutoIP address conflicts as well as DHCP address resolution.</span></span> <span data-ttu-id="f9794-135">Con el fin de procesar estas posibles situaciones correctamente, la aplicación debe usar la siguiente API de NetX para alertar de cualquier cambio de dirección IP:</span><span class="sxs-lookup"><span data-stu-id="f9794-135">In order to process these potential situations properly, the application should use the following NetX API to alert it of any and all IP address changes:</span></span>

```c
nx_ip_address_change_notify(NX_IP *ip_ptr,
                            VOID (*ip_address_change_notify)(NX_IP *,VOID*),
                            VOID *additional_info);
```

<span data-ttu-id="f9794-136">El procesamiento de la función *ip_address_change_notify* proporcionada debe reiniciar el procesador de AutoIP de NetX o deshabilitarlo si DHCP ha resuelto posteriormente la dirección IP.</span><span class="sxs-lookup"><span data-stu-id="f9794-136">The processing in the supplied *ip_address_change_notify* function must either restart the NetX AutoIP processor or disable it if DHCP has subsequently resolved the IP address.</span></span> <span data-ttu-id="f9794-137">Consulte en la sección *Sistema de ejemplo pequeño* el procesamiento de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="f9794-137">Please refer to the *Small Example System* section for sample processing.</span></span>

## <a name="autoip-rfcs"></a><span data-ttu-id="f9794-138">RFC de AutoIP</span><span class="sxs-lookup"><span data-stu-id="f9794-138">AutoIP RFCs</span></span>

<span data-ttu-id="f9794-139">AutoIP de NetX es compatible con la RFC3927 y RFC relacionadas.</span><span class="sxs-lookup"><span data-stu-id="f9794-139">NetX AutoIP is compliant with RFC3927 and related RFCs.</span></span>