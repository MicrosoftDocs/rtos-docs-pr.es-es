---
title: 'Capítulo 3: Componentes funcionales de Azure RTOS NetX'
description: Este capítulo contiene una descripción de la pila TCP/IP de alto rendimiento de Azure RTOS NetX desde una perspectiva funcional.
author: philmea
ms.author: philmea
ms.date: 05/19/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: db23aa152b2765ac7cc9be098723fc5df0947484
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 03/22/2021
ms.locfileid: "104815310"
---
# <a name="chapter-3---functional-components-of-azure-rtos-netx"></a><span data-ttu-id="8016a-103">Capítulo 3: Componentes funcionales de Azure RTOS NetX</span><span class="sxs-lookup"><span data-stu-id="8016a-103">Chapter 3 - Functional Components of Azure RTOS NetX</span></span>

<span data-ttu-id="8016a-104">Este capítulo contiene una descripción de la pila TCP/IP de alto rendimiento de Azure RTOS NetX desde una perspectiva funcional.</span><span class="sxs-lookup"><span data-stu-id="8016a-104">This chapter contains a description of the high-performance Azure RTOS NetX TCP/IP stack from a functional perspective.</span></span> 

## <a name="execution-overview"></a><span data-ttu-id="8016a-105">Información general sobre la ejecución</span><span class="sxs-lookup"><span data-stu-id="8016a-105">Execution Overview</span></span>

<span data-ttu-id="8016a-106">Hay cinco tipos de ejecución de programa en una aplicación NetX: inicialización, llamadas a la interfaz de la aplicación, subproceso de IP interno, temporizadores periódicos de IP y el controlador de red.</span><span class="sxs-lookup"><span data-stu-id="8016a-106">There are five types of program execution within a NetX application: initialization, application interface calls, internal IP thread, IP periodic timers, and the network driver.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-107">NetX requiere la instalación de ThreadX y depende de la ejecución de subprocesos, la suspensión, los temporizadores periódicos y los recursos de exclusión mutua.</span><span class="sxs-lookup"><span data-stu-id="8016a-107">NetX requires the installation of ThreadX and depends on its thread execution, suspension, periodic timers, and mutual exclusion facilities.</span></span>

### <a name="initialization"></a><span data-ttu-id="8016a-108">Inicialización</span><span class="sxs-lookup"><span data-stu-id="8016a-108">Initialization</span></span>

<span data-ttu-id="8016a-109">Se debe llamar al servicio \***nx_system_initialize** _ antes de llamar a cualquier otro servicio de NetX.</span><span class="sxs-lookup"><span data-stu-id="8016a-109">The service \***nx_system_initialize** _ must be called before any other NetX service is called.</span></span> <span data-ttu-id="8016a-110">Se puede llamar a la inicialización del sistema desde la rutina _ *_tx_application_define_*\* de ThreadX o desde los subprocesos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-110">System initialization can be called either from the ThreadX _ *_tx_application_define_*\* routine or from application threads.</span></span>

<span data-ttu-id="8016a-111">Después de volver de \***nx_system_initialize** _, el sistema está listo para crear grupos de paquetes e instancias de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-111">After \***nx_system_initialize** _ returns, the system is ready to create packet pools and IP instances.</span></span> <span data-ttu-id="8016a-112">Dado que la creación de una instancia de IP requiere un grupo de paquetes predeterminado, debe existir al menos un grupo de paquetes de NetX antes de crear una instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-112">Because creating an IP instance requires a default packet pool, at least one NetX packet pool must exist prior to creating an IP instance.</span></span> <span data-ttu-id="8016a-113">Se permite crear grupos de paquetes e instancias de IP desde la función de inicialización de ThreadX _ *_tx_application_define_*\* y desde los subprocesos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-113">Creating packet pools and IP instances are allowed from the ThreadX initialization function _ *_tx_application_define_*\* and from application threads.</span></span>

<span data-ttu-id="8016a-114">Internamente, la creación de una instancia de IP se realiza en dos partes.</span><span class="sxs-lookup"><span data-stu-id="8016a-114">Internally, creating an IP instance is accomplished in two parts.</span></span> <span data-ttu-id="8016a-115">La primera parte se realiza en el contexto del autor de llamada, ya sea desde ***tx_application_define*** o desde el contexto de un subproceso de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-115">The first part is done within the context of the caller, either from ***tx_application_define*** or from an application thread's context.</span></span> <span data-ttu-id="8016a-116">Esto incluye la configuración de la estructura de datos de IP y la creación de varios recursos de IP, incluido el subproceso de IP interno.</span><span class="sxs-lookup"><span data-stu-id="8016a-116">This includes setting up the IP data structure and creating various IP resources, including the internal IP thread.</span></span> <span data-ttu-id="8016a-117">La segunda parte se realiza durante la ejecución inicial desde el subproceso de IP interno.</span><span class="sxs-lookup"><span data-stu-id="8016a-117">The second part is performed during the initial execution from the internal IP thread.</span></span> <span data-ttu-id="8016a-118">Aquí es donde se llama primero al controlador de red, proporcionado durante la primera parte de la creación de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-118">This is where the network driver, supplied during the first part of IP creation, is first called.</span></span> <span data-ttu-id="8016a-119">La llamada al controlador de red desde el subproceso de IP interno permite que el controlador realice la E/S y la suspensión durante su procesamiento de inicialización.</span><span class="sxs-lookup"><span data-stu-id="8016a-119">Calling the network driver from the internal IP thread enables the driver to perform I/O and suspend during its initialization processing.</span></span> <span data-ttu-id="8016a-120">Cuando el controlador de red vuelve de su procesamiento de inicialización, se completa la creación de la instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-120">When the network driver returns from its initialization processing, the IP creation is complete.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-121">El servicio **nx_ip_status_check** de NetX está disponible para obtener información sobre la instancia de IP y el estado de su interfaz principal.</span><span class="sxs-lookup"><span data-stu-id="8016a-121">The NetX service **nx_ip_status_check** is available to obtain information on the IP instance and its primary interface status.</span></span> <span data-ttu-id="8016a-122">Esta información de estado incluye si el vínculo está inicializado, habilitado y se ha resuelto la dirección IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-122">Such status information includes whether or not the link is initialized, enabled, and IP address is resolved.</span></span> <span data-ttu-id="8016a-123">Esta información se usa para sincronizar los subprocesos de la aplicación que necesitan usar una instancia de IP recién creada.</span><span class="sxs-lookup"><span data-stu-id="8016a-123">This information is used to synchronize application threads needing to use a newly created IP instance.</span></span> <span data-ttu-id="8016a-124">Para los sistemas de host múltiple, consulte "Compatibilidad con host múltiple" más adelante.</span><span class="sxs-lookup"><span data-stu-id="8016a-124">For multihome systems, see "Multihome Support" below.</span></span> <span data-ttu-id="8016a-125">**nx_ip_interface_status_check** está disponible para obtener información sobre la interfaz especificada.</span><span class="sxs-lookup"><span data-stu-id="8016a-125">**nx_ip_interface_status_check** is available to obtain information on the specified interface.</span></span>

### <a name="application-interface-calls"></a><span data-ttu-id="8016a-126">Llamadas a la interfaz de la aplicación</span><span class="sxs-lookup"><span data-stu-id="8016a-126">Application Interface Calls</span></span>

<span data-ttu-id="8016a-127">Las llamadas desde la aplicación se realizan en gran medida desde los subprocesos de la aplicación que se ejecutan en RTOS ThreadX.</span><span class="sxs-lookup"><span data-stu-id="8016a-127">Calls from the application are largely made from application threads running under the ThreadX RTOS.</span></span> <span data-ttu-id="8016a-128">Sin embargo, se puede llamar a algunos servicios de inicialización, creación y habilitación desde ***tx_application_define***.</span><span class="sxs-lookup"><span data-stu-id="8016a-128">However, some initialization, create, and enable services may be called from ***tx_application_define***.</span></span> <span data-ttu-id="8016a-129">Las secciones "Permitido desde" del capítulo 4 indican desde dónde se puede llamar a cada servicio de NetX.</span><span class="sxs-lookup"><span data-stu-id="8016a-129">The "Allowed From" sections in Chapter 4 indicate from which each NetX service can be called.</span></span>

<span data-ttu-id="8016a-130">En su mayor parte, el procesamiento de actividades intensivas como el cálculo de sumas de comprobación se realiza en el contexto del subproceso de llamada, sin bloquear el acceso de otros subprocesos a la instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-130">For the most part, processing intensive activities such as computing checksums is done within the calling thread's context—without blocking the access of other threads to the IP instance.</span></span> <span data-ttu-id="8016a-131">Por ejemplo, en la transmisión, el cálculo de la suma de comprobación de UDP se realiza en el servicio ***nx_udp_socket_send***, antes de llamar a la función de envío de IP subyacente.</span><span class="sxs-lookup"><span data-stu-id="8016a-131">For example, on transmission, the UDP checksum calculation is performed inside the ***nx_udp_socket_send*** service, prior to calling the underlying IP send function.</span></span> <span data-ttu-id="8016a-132">En un paquete recibido, la suma de comprobación de UDP se calcula en el servicio ***nx_udp_socket_receive***, que se ejecuta en el contexto del subproceso de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-132">On a received packet, the UDP checksum is calculated in the ***nx_udp_socket_receive*** service, executed in the context of the application thread.</span></span> <span data-ttu-id="8016a-133">Esto ayuda a evitar la detención de solicitudes de red de subprocesos de mayor prioridad debido al procesamiento intensivo de sumas de comprobación en subprocesos de menor prioridad.</span><span class="sxs-lookup"><span data-stu-id="8016a-133">This helps prevent stalling network requests of higher-priority threads because of processing intensive checksum computation in lower-priority threads.</span></span>

<span data-ttu-id="8016a-134">Los valores, como las direcciones IP y los números de puerto, se pasan a las funciones de API en el orden de bytes del host.</span><span class="sxs-lookup"><span data-stu-id="8016a-134">Values, such as IP addresses and port numbers, are passed to API functions in host byte order.</span></span> <span data-ttu-id="8016a-135">Internamente, estos valores también se almacenan en el orden de bytes del host.</span><span class="sxs-lookup"><span data-stu-id="8016a-135">Internally these values are stored in host byte order as well.</span></span> <span data-ttu-id="8016a-136">Esto permite a los desarrolladores ver fácilmente los valores mediante un depurador.</span><span class="sxs-lookup"><span data-stu-id="8016a-136">This enables developers to easily view the values via a debugger.</span></span> <span data-ttu-id="8016a-137">Cuando estos valores se programan en un marco para la transmisión, se convierten al orden de bytes de la red.</span><span class="sxs-lookup"><span data-stu-id="8016a-137">When these values are programmed into a frame for transmission, they are converted to network byte order.</span></span>

### <a name="internal-ip-thread"></a><span data-ttu-id="8016a-138">Subproceso de IP interno</span><span class="sxs-lookup"><span data-stu-id="8016a-138">Internal IP Thread</span></span>

<span data-ttu-id="8016a-139">Como se ha mencionado, cada instancia de IP en NetX tiene su propio subproceso.</span><span class="sxs-lookup"><span data-stu-id="8016a-139">As mentioned, each IP instance in NetX has its own thread.</span></span> <span data-ttu-id="8016a-140">La prioridad y el tamaño de la pila del subproceso de IP interno se define en el servicio ***nx_ip_create***.</span><span class="sxs-lookup"><span data-stu-id="8016a-140">The priority and stack size of the internal IP thread is defined in the ***nx_ip_create*** service.</span></span> <span data-ttu-id="8016a-141">El subproceso de IP interno se crea en un modo listo para ejecutarse.</span><span class="sxs-lookup"><span data-stu-id="8016a-141">The internal IP thread is created in a ready-to-execute mode.</span></span> <span data-ttu-id="8016a-142">Si el subproceso de IP tiene una prioridad más alta que el subproceso que realiza la llamada, se puede producir un adelantamiento dentro de la llamada de creación de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-142">If the IP thread has a higher priority than the calling thread, preemption may occur inside the IP create call.</span></span>

<span data-ttu-id="8016a-143">El punto de entrada del subproceso de IP interno está en la función interna ***_nx_ip_thread_entry***.</span><span class="sxs-lookup"><span data-stu-id="8016a-143">The entry point of the internal IP thread is at the internal function ***_nx_ip_thread_entry***.</span></span> <span data-ttu-id="8016a-144">Cuando se inicia, el subproceso de IP interno completa primero la inicialización del controlador de red, que consiste en realizar tres llamadas al controlador de red específico de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-144">When started, the internal IP thread first completes network driver initialization, which consists of making three calls to the application-specific network driver.</span></span> <span data-ttu-id="8016a-145">La primera llamada es para conectar el controlador de red a la instancia de IP, seguida de una llamada de inicialización, que permite al controlador de red pasar por el proceso de inicialización.</span><span class="sxs-lookup"><span data-stu-id="8016a-145">The first call is to attach the network driver to the IP instance, followed by an initialization call, which allows the network driver to go through the initialization process.</span></span> <span data-ttu-id="8016a-146">Después de que el controlador de red vuelve de la inicialización (se puede suspender mientras espera a que el hardware se configure correctamente), el subproceso de IP interno vuelve a llamar al controlador de red para habilitar el vínculo.</span><span class="sxs-lookup"><span data-stu-id="8016a-146">After the network driver returns from initialization (it may suspend while waiting for the hardware to be properly set up), the internal IP thread calls the network driver again to enable the link.</span></span> 

<span data-ttu-id="8016a-147">Después de que el controlador de red vuelva de la llamada para habilitar el vínculo, el subproceso de IP interno entra en una comprobación de bucle sin fin de varios eventos que necesitan procesamiento para esta instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-147">After the network driver returns from the link enable call, the internal IP thread enters an endless loop checking for various events that need processing for this IP instance.</span></span> <span data-ttu-id="8016a-148">Entre los eventos procesados en este bucle se incluyen la recepción de paquetes IP diferida, el ensamblado de fragmentos de paquetes IP, el procesamiento de ping de ICMP, el procesamiento de IGMP, el procesamiento de la cola de paquetes TCP, el procesamiento periódico de TCP, los tiempos de espera de ensamblado de fragmentos IP y el procesamiento periódico de IGMP.</span><span class="sxs-lookup"><span data-stu-id="8016a-148">Events processed in this loop include deferred IP packet reception, IP packet fragment assembly, ICMP ping processing, IGMP processing, TCP packet queue processing, TCP periodic processing, IP fragment assembly timeouts, and IGMP periodic processing.</span></span> <span data-ttu-id="8016a-149">Los eventos también incluyen actividades de resolución de direcciones: el procesamiento de paquetes ARP y el procesamiento periódico de ARP en la red IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-149">Events also include address resolution activities: ARP packet processing and ARP periodic processing in the IP network.</span></span>

> [!NOTE]
> <span data-ttu-id="8016a-150">*Las funciones de devolución de llamada de NetX, incluidas las devoluciones de llamada de escucha y desconexión, se llaman desde el subproceso de IP interno, no desde el subproceso de llamada original. La aplicación debe tener cuidado de no entrar en suspensión dentro de cualquier función de devolución de llamada de NetX.*</span><span class="sxs-lookup"><span data-stu-id="8016a-150">*The NetX callback functions, including listen and disconnect callbacks, are called from the internal IP thread—not the original calling thread. The application must take care not to suspend inside any NetX callback function.*</span></span>

### <a name="ip-periodic-timers"></a><span data-ttu-id="8016a-151">Temporizadores periódicos de IP</span><span class="sxs-lookup"><span data-stu-id="8016a-151">IP Periodic Timers</span></span>
<span data-ttu-id="8016a-152">Se utilizan dos temporizadores periódicos de ThreadX para cada instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-152">There are two ThreadX periodic timers used for each IP instance.</span></span> <span data-ttu-id="8016a-153">El primero es un temporizador de un segundo para ARP, IGMP, el tiempo de espera de TCP y también controla el procesamiento del reensamblado de fragmentos IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-153">The first one is a one-second timer for ARP, IGMP, TCP timeout, and it also drives IP fragment reassemble processing.</span></span> <span data-ttu-id="8016a-154">El segundo temporizador es un temporizador de 100 ms para controlar el tiempo de espera de la retransmisión TCP.</span><span class="sxs-lookup"><span data-stu-id="8016a-154">The second timer is a 100ms timer to drive the TCP retransmission timeout.</span></span>

### <a name="network-driver"></a><span data-ttu-id="8016a-155">Controlador de red</span><span class="sxs-lookup"><span data-stu-id="8016a-155">Network Driver</span></span>
<span data-ttu-id="8016a-156">Cada instancia de IP en NetX tiene una interfaz principal, que se identifica mediante el controlador de dispositivo especificado en el servicio ***nx_ip_create***.</span><span class="sxs-lookup"><span data-stu-id="8016a-156">Each IP instance in NetX has a primary interface, which is identified by its device driver specified in the ***nx_ip_create*** service.</span></span> <span data-ttu-id="8016a-157">El controlador de red es responsable de controlar varias solicitudes de NetX, como la transmisión de paquetes, la recepción de paquetes y las solicitudes de estado y control.</span><span class="sxs-lookup"><span data-stu-id="8016a-157">The network driver is responsible for handling various NetX requests, including packet transmission, packet reception, and requests for status and control.</span></span>

<span data-ttu-id="8016a-158">En el caso de un sistema de host múltiple, la instancia de IP tiene varias interfaces, cada una con un controlador de red asociado que realiza estas tareas para la interfaz correspondiente.</span><span class="sxs-lookup"><span data-stu-id="8016a-158">For a multi-home system, the IP instance has multiple interfaces, each with an associated network driver that performs these tasks for the respective interface.</span></span>

<span data-ttu-id="8016a-159">El controlador de red también debe controlar los eventos asincrónicos que se producen en el soporte físico.</span><span class="sxs-lookup"><span data-stu-id="8016a-159">The network driver must also handle asynchronous events occurring on the media.</span></span> <span data-ttu-id="8016a-160">Los eventos asincrónicos del soporte físico incluyen la recepción de paquetes, la finalización de la transmisión de paquetes y los cambios de estado.</span><span class="sxs-lookup"><span data-stu-id="8016a-160">Asynchronous events from the media include packet reception, packet transmission completion, and status changes.</span></span> <span data-ttu-id="8016a-161">NetX proporciona al controlador de red varias funciones de acceso para controlar varios eventos.</span><span class="sxs-lookup"><span data-stu-id="8016a-161">NetX provides the network driver with several access functions to handle various events.</span></span> <span data-ttu-id="8016a-162">Estas funciones están diseñadas para ser llamadas desde la parte de rutina del servicio de interrupciones del controlador de red.</span><span class="sxs-lookup"><span data-stu-id="8016a-162">These functions are designed to be called from the interrupt service routine portion of the network driver.</span></span> <span data-ttu-id="8016a-163">En el caso de las redes IP, el controlador de red debe reenviar todos los paquetes ARP recibidos a la función interna \* **_nx_arp_packet_deferred_receive** _.</span><span class="sxs-lookup"><span data-stu-id="8016a-163">For IP networks, the network driver should forward all ARP packets received to the \***_nx_arp_packet_deferred_receive** _ internal function.</span></span> <span data-ttu-id="8016a-164">Todos los paquetes RARP se deben reenviar a la función interna _ *_ _nx_rarp_packet_deferred_receive_* _.</span><span class="sxs-lookup"><span data-stu-id="8016a-164">All RARP packets should be forwarded to _ *_ _nx_rarp_packet_deferred_receive_* _ internal function.</span></span> <span data-ttu-id="8016a-165">Hay dos opciones para los paquetes IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-165">There are two options for IP packets.</span></span> <span data-ttu-id="8016a-166">Si se requiere el envío rápido de paquetes IP, los paquetes IP entrantes se deben reenviar a _ *_ _nx_ip_packet_receive_* _ para su procesamiento inmediato.</span><span class="sxs-lookup"><span data-stu-id="8016a-166">If fast dispatch of IP packets is required, incoming IP packets should be forwarded to _ *_ _nx_ip_packet_receive_* _ for immediate processing.</span></span> <span data-ttu-id="8016a-167">Esto mejora considerablemente el rendimiento de NetX en el control de paquetes IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-167">This greatly improves NetX performance in handling IP packets.</span></span> <span data-ttu-id="8016a-168">De lo contrario, el controlador de red debe reenviar los paquetes IP a _\*_ _nx_ip_packet_deferred_receive_\*\*.</span><span class="sxs-lookup"><span data-stu-id="8016a-168">Otherwise, the network driver should forward IP packets to _\*_ _nx_ip_packet_deferred_receive_\*\*.</span></span> <span data-ttu-id="8016a-169">Este servicio coloca el paquete IP en la cola de procesamiento diferido, donde se controla después mediante el subproceso de IP interno, lo que da como resultado la mínima cantidad de tiempo de procesamiento de ISR.</span><span class="sxs-lookup"><span data-stu-id="8016a-169">This service places the IP packet in the deferred processing queue where it is then handled by the internal IP thread, which results in the least amount of ISR processing time.</span></span>

<span data-ttu-id="8016a-170">El controlador de red también puede diferir el procesamiento de interrupciones para quedarse fuera del contexto del subproceso de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-170">The network driver can also defer interrupt processing to run out of the context of the IP thread.</span></span> <span data-ttu-id="8016a-171">En este modo, el ISR debe guardar la información necesaria, llamar a la función interna ***_nx_ip_driver_deferred_processing*** y confirmar el controlador de interrupciones.</span><span class="sxs-lookup"><span data-stu-id="8016a-171">In this mode, the ISR shall save the necessary information, call the internal function ***_nx_ip_driver_deferred_processing***, and acknowledge the interrupt controller.</span></span> <span data-ttu-id="8016a-172">Este servicio notifica al subproceso de IP que programe una devolución de llamada al controlador del dispositivo para completar el procesamiento del evento que provoca la interrupción.</span><span class="sxs-lookup"><span data-stu-id="8016a-172">This service notifies IP thread to schedule a callback to the device driver to complete the processing of the event that causes the interrupt.</span></span>

<span data-ttu-id="8016a-173">Algunos controladores de red pueden realizar el cálculo y la validación de la suma de comprobación de encabezados TCP/IP en hardware, sin ocupar recursos de CPU valiosos.</span><span class="sxs-lookup"><span data-stu-id="8016a-173">Some network controllers are capable of performing TCP/IP header checksum computation and validation in hardware, without taking up valuable CPU resources.</span></span> <span data-ttu-id="8016a-174">Para aprovechar las ventajas de la característica de funcionalidad por hardware, NetX proporciona opciones para habilitar o deshabilitar varios cálculos de suma de comprobación por software en tiempo de compilación, así como para activar o desactivar el cálculo de la suma de comprobación en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="8016a-174">To take advantage of the hardware capability feature, NetX provides options to enable or disable various software checksum computation at compilation time, as well as turning on or off checksum computation at run time.</span></span> <span data-ttu-id="8016a-175">Consulte "[Capítulo 5: Controladores de red de NetX](chapter5.md)" para obtener información detallada sobre la escritura de controladores de red de NetX.</span><span class="sxs-lookup"><span data-stu-id="8016a-175">See "[Chapter 5 NetX Network Drivers](chapter5.md)" for more detailed information on writing NetX network drivers.</span></span>

### <a name="multihome-support"></a><span data-ttu-id="8016a-176">Compatibilidad con host múltiple</span><span class="sxs-lookup"><span data-stu-id="8016a-176">Multihome Support</span></span>
<span data-ttu-id="8016a-177">NetX admite sistemas conectados a varios dispositivos físicos mediante una única instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-177">NetX supports systems connected to multiple physical devices using a single IP instance.</span></span> <span data-ttu-id="8016a-178">Cada interfaz física se asigna a un bloque de control de interfaz en la instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-178">Each physical interface is assigned to an interface control block in the IP instance.</span></span> <span data-ttu-id="8016a-179">Las aplicaciones que deseen usar un sistema de host múltiple deben definir el valor de **NX_MAX_PHSYCIAL_INTERFACES** en el número de dispositivos físicos conectados al sistema y volver a compilar la biblioteca de NetX.</span><span class="sxs-lookup"><span data-stu-id="8016a-179">Applications wishing to use a multihome system must define the value for **NX_MAX_PHSYCIAL_INTERFACES** to the number of physical devices attached to the system, and rebuild NetX library.</span></span> <span data-ttu-id="8016a-180">De manera predeterminada, **NX_MAX_PHYSICAL_INTERFACES** está establecido en uno, creando un bloque de control de interfaz en la instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-180">By default **NX_MAX_PHYSICAL_INTERFACES** is set to one, creating one interface control block in the IP instance.</span></span>

<span data-ttu-id="8016a-181">La aplicación NetX crea una única instancia de IP para el dispositivo primario mediante el servicio \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="8016a-181">The NetX application creates a single IP instance for the primary device using the \***nx_ip_create** _ service.</span></span> <span data-ttu-id="8016a-182">Para cada dispositivo de red adicional, la aplicación conecta el dispositivo a la instancia de IP mediante el servicio _ \*_nx_ip_interface_attach_\*\*.</span><span class="sxs-lookup"><span data-stu-id="8016a-182">For each additional network devices, the application attaches the device to the IP instance using the _ *_nx_ip_interface_attach_*\* service.</span></span>

<span data-ttu-id="8016a-183">Cada estructura de la interfaz de red contiene un subconjunto de información de red sobre la interfaz de red que se encuentra en el bloque de control IP, incluida la dirección IP de la interfaz, la máscara de subred, el tamaño de MTU de IP y la información de dirección de capa MAC.</span><span class="sxs-lookup"><span data-stu-id="8016a-183">Each network interface structure contains a subset of network information about the network interface that is contained in the IP control block, including interface IP address, subnet mask, IP MTU size, and MAC-layer address information.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-184">*NetX con compatibilidad con host múltiple es compatible con versiones anteriores de NetX. Los servicios que no toman información explícita de la interfaz tienen como valor predeterminado el dispositivo de red primario.*</span><span class="sxs-lookup"><span data-stu-id="8016a-184">*NetX with multihome support is backward compatible with earlier versions of NetX. Services that do not take explicit interface information default to the primary network device.*</span></span>

<span data-ttu-id="8016a-185">La interfaz principal tiene el índice cero en la lista de instancias de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-185">The primary interface has index zero in the IP instance list.</span></span> <span data-ttu-id="8016a-186">A cada dispositivo subsiguiente conectado a la instancia de IP se le asigna el siguiente índice.</span><span class="sxs-lookup"><span data-stu-id="8016a-186">Each subsequent device attached to the IP instance is assigned the next index.</span></span>

<span data-ttu-id="8016a-187">Todos los servicios de protocolo de capa superior para los que la instancia de IP está habilitada, incluidos TCP, UDP, ICMP e IGMP, están disponibles para todos los dispositivos conectados.</span><span class="sxs-lookup"><span data-stu-id="8016a-187">All upper layer protocol services for which the IP instance is enabled, including TCP, UDP, ICMP, and IGMP, are available to all the attached devices.</span></span>

<span data-ttu-id="8016a-188">En la mayoría de los casos, NetX puede determinar la mejor dirección de origen que se va a usar al transmitir un paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-188">In most cases, NetX can determine the best source address to use when transmitting a packet.</span></span> <span data-ttu-id="8016a-189">La selección de la dirección de origen se basa en la dirección de destino.</span><span class="sxs-lookup"><span data-stu-id="8016a-189">The source address selection is based on the destination address.</span></span> <span data-ttu-id="8016a-190">Se proporcionan servicios de NetX para permitir que las aplicaciones especifiquen utilizar una dirección de origen específica, en los casos en los que no se puede determinar la más adecuada en función de la dirección de destino.</span><span class="sxs-lookup"><span data-stu-id="8016a-190">NetX services are provided to allow applications to specify a specific source address to use, in cases where the most suitable one cannot be determined by the destination address.</span></span> <span data-ttu-id="8016a-191">Un ejemplo sería en un sistema de host múltiple, una aplicación debe enviar un paquete a una difusión IP o a direcciones de destino de multidifusión.</span><span class="sxs-lookup"><span data-stu-id="8016a-191">An example would be in a multihome system, an application needs to send a packet to an IP broadcast or multicast destination addresses.</span></span>

<span data-ttu-id="8016a-192">Entre los servicios específicos para desarrollar aplicaciones de host múltiple se incluyen los siguientes:</span><span class="sxs-lookup"><span data-stu-id="8016a-192">Services specifically for developing multihome applications include the following:</span></span>

<span data-ttu-id="8016a-193">*nx_igmp_multicast_interface_join, nx_ip_driver_interface_direct_command, nx_ip_interface_address_get, nx_ip_interface_address_set, nx_ip_interface_attach, nx_ip_interface_info_get, nx_ip_interface_status_check, nx_ip_raw_packet_interface_send y nx_udp_socket_interface_send*</span><span class="sxs-lookup"><span data-stu-id="8016a-193">*nx_igmp_multicast_interface_join nx_ip_driver_interface_direct_command nx_ip_interface_address_get nx_ip_interface_address_set nx_ip_interface_attach nx_ip_interface_info_get nx_ip_interface_status_check nx_ip_raw_packet_interface_send nx_udp_socket_interface_send*</span></span>

<span data-ttu-id="8016a-194">Estos servicios se explican con más detalle en el "[Capítulo 4: Descripción de los servicios de Azure RTOS NetX](chapter4.md)".</span><span class="sxs-lookup"><span data-stu-id="8016a-194">These services are explained in greater detail in "[Chapter 4 - Description of Azure RTOS NetX Services](chapter4.md)".</span></span>

### <a name="loopback-interface"></a><span data-ttu-id="8016a-195">Interfaz de bucle invertido</span><span class="sxs-lookup"><span data-stu-id="8016a-195">Loopback Interface</span></span>
<span data-ttu-id="8016a-196">La interfaz de bucle invertido es una interfaz de red especial sin un vínculo físico conectado a ella.</span><span class="sxs-lookup"><span data-stu-id="8016a-196">The loopback interface is a special network interface without an physical link attached to.</span></span> <span data-ttu-id="8016a-197">La interfaz de bucle invertido permite a las aplicaciones comunicarse mediante la dirección IP de bucle invertido 127.0.0.1.</span><span class="sxs-lookup"><span data-stu-id="8016a-197">The loopback interface allows applications to communicate using the IP loopback address 127.0.0.1</span></span>

<span data-ttu-id="8016a-198">Para utilizar una interfaz de bucle invertido lógica, asegúrese de que la opción configurable ***NX_DISABLE_LOOPBACK_INTERFACE*** no esté establecida.</span><span class="sxs-lookup"><span data-stu-id="8016a-198">To utilize a logical loopback interface, ensure the configurable option ***NX_DISABLE_LOOPBACK_INTERFACE*** is not set.</span></span>

### <a name="interface-control-blocks"></a><span data-ttu-id="8016a-199">Bloques de control de interfaz</span><span class="sxs-lookup"><span data-stu-id="8016a-199">Interface Control Blocks</span></span>
<span data-ttu-id="8016a-200">El número de bloques de control de interfaz de la instancia de IP es el número de interfaces físicas (definidas por \***NX_MAX_PHYSICAL_INTERFACES** _) más la interfaz de bucle invertido, si está habilitada.</span><span class="sxs-lookup"><span data-stu-id="8016a-200">The number of interface control blocks in the IP instance is the number of physical interfaces (defined by \***NX_MAX_PHYSICAL_INTERFACES** _) plus the loopback interface if it is enabled.</span></span> <span data-ttu-id="8016a-201">El número total de interfaces se define en _\*_NX_MAX_IP_INTERFACES_\*\*.</span><span class="sxs-lookup"><span data-stu-id="8016a-201">The total number of interfaces is defined in _\*_NX_MAX_IP_INTERFACES_\*\*.</span></span>

## <a name="protocol-layering"></a><span data-ttu-id="8016a-202">Capas de protocolos</span><span class="sxs-lookup"><span data-stu-id="8016a-202">Protocol Layering</span></span>

<span data-ttu-id="8016a-203">El protocolo TCP/IP implementado por NetX es un protocolo en capas, lo que significa que los protocolos más complejos se crean a partir de los protocolos subyacentes más simples.</span><span class="sxs-lookup"><span data-stu-id="8016a-203">The TCP/IP implemented by NetX is a layered protocol, which means more complex protocols are built on top of simpler underlying protocols.</span></span> <span data-ttu-id="8016a-204">En TCP/IP, el protocolo de la capa más baja está en la *nivel de vínculo* y lo controla el controlador de red.</span><span class="sxs-lookup"><span data-stu-id="8016a-204">In TCP/ IP, the lowest layer protocol is at the *link Layer* and is handled by the network driver.</span></span> <span data-ttu-id="8016a-205">Normalmente, este nivel se dirige hacia Ethernet, pero también podría ser fibra, serie o prácticamente cualquier medio físico.</span><span class="sxs-lookup"><span data-stu-id="8016a-205">This level is typically targeted towards Ethernet, but it could also be fiber, serial, or virtually any physical media.</span></span>

<span data-ttu-id="8016a-206">Sobre el nivel de vínculo está la *capa de red*.</span><span class="sxs-lookup"><span data-stu-id="8016a-206">On top of the link layer is the *Network layer*.</span></span> <span data-ttu-id="8016a-207">En TCP/IP se trata del protocolo IP, que básicamente es responsable de enviar y recibir paquetes simples de la mejor forma posible a través de la red.</span><span class="sxs-lookup"><span data-stu-id="8016a-207">In TCP/IP, this is the IP, which is basically responsible for sending and receiving simple packets, in a best-effort manner, across the network.</span></span> <span data-ttu-id="8016a-208">Los protocolos de tipo de administración como ICMP e IGMP normalmente también se clasifican como capas de red, aunque se basan en IP para el envío y la recepción.</span><span class="sxs-lookup"><span data-stu-id="8016a-208">Management type protocols like ICMP and IGMP are typically also categorized as network layers, even though they rely on IP for sending and receiving.</span></span>

<span data-ttu-id="8016a-209">La *capa de transporte* se sitúa sobre la capa de red.</span><span class="sxs-lookup"><span data-stu-id="8016a-209">The *Transport layer* rests on top of the network layer.</span></span> <span data-ttu-id="8016a-210">Esta capa es responsable de administrar el flujo de datos entre los hosts de la red.</span><span class="sxs-lookup"><span data-stu-id="8016a-210">This layer is responsible for managing the flow of data between hosts on the network.</span></span> <span data-ttu-id="8016a-211">Hay dos tipos de servicios de transporte admitidos por NetX: UDP y TCP.</span><span class="sxs-lookup"><span data-stu-id="8016a-211">There are two types of transport services supported by NetX: UDP and TCP.</span></span> <span data-ttu-id="8016a-212">Los servicios de UDP proporcionan la mejor opción para enviar y recibir datos entre dos hosts de una manera sin conexión, mientras que TCP proporciona un servicio orientado a la conexión confiable entre dos entidades host.</span><span class="sxs-lookup"><span data-stu-id="8016a-212">UDP services provide best-effort sending and receiving of data between two hosts in a connectionless manner, while TCP provides reliable connection-oriented service between two host entities.</span></span>

<span data-ttu-id="8016a-213">Esta estructura en capas se refleja en los paquetes de datos de red reales.</span><span class="sxs-lookup"><span data-stu-id="8016a-213">This layering is reflected in the actual network data packets.</span></span> <span data-ttu-id="8016a-214">Cada capa de TCP/IP contiene un bloque de información llamado encabezado.</span><span class="sxs-lookup"><span data-stu-id="8016a-214">Each layer in TCP/IP contains a block of information called a header.</span></span> <span data-ttu-id="8016a-215">Esta técnica de rodear los datos (y posiblemente la información de protocolo) con un encabezado se llama normalmente encapsulación de datos.</span><span class="sxs-lookup"><span data-stu-id="8016a-215">This technique of surrounding data (and possibly protocol information) with a header is typically called data encapsulation.</span></span> <span data-ttu-id="8016a-216">La figura 1 muestra un ejemplo de la disposición en capas de NetX y la figura 2 muestra la encapsulación de datos resultante para los datos de UDP que se envían.</span><span class="sxs-lookup"><span data-stu-id="8016a-216">Figure 1 shows an example of NetX layering and Figure 2 shows the resulting data encapsulation for UDP data being sent.</span></span>

![Capas de protocolos](./media/user-guide/protocol-layering.png)

<span data-ttu-id="8016a-218">**FIGURA 1. Capas de protocolos**</span><span class="sxs-lookup"><span data-stu-id="8016a-218">**FIGURE 1. Protocol Layering**</span></span>

![Encapsulación de datos de UDP](./media/user-guide/udp-data-encapsulation.png)

<span data-ttu-id="8016a-220">**FIGURA 2. Encapsulación de datos de UDP**</span><span class="sxs-lookup"><span data-stu-id="8016a-220">**FIGURE 2. UDP Data Encapsulation**</span></span>

## <a name="packet-pools"></a><span data-ttu-id="8016a-221">Grupos de paquetes</span><span class="sxs-lookup"><span data-stu-id="8016a-221">Packet Pools</span></span>

<span data-ttu-id="8016a-222">En las aplicaciones de redes en tiempo real, la asignación de paquetes de una manera rápida y determinista siempre es un desafío.</span><span class="sxs-lookup"><span data-stu-id="8016a-222">Allocating packets in a fast and deterministic manner is always a challenge in real-time networking applications.</span></span> <span data-ttu-id="8016a-223">Con esto en mente, NetX proporciona la capacidad de crear y administrar varios grupos de paquetes de red de tamaño fijo.</span><span class="sxs-lookup"><span data-stu-id="8016a-223">With this in mind, NetX provides the ability to create and manage multiple pools of fixed-size network packets.</span></span>

<span data-ttu-id="8016a-224">Dado que los grupos de paquetes de NetX se componen de bloques de memoria de tamaño fijo, nunca hay problemas de fragmentación interna.</span><span class="sxs-lookup"><span data-stu-id="8016a-224">Because NetX packet pools consist of fixed-size memory blocks, there are never any internal fragmentation problems.</span></span> <span data-ttu-id="8016a-225">Por supuesto, la fragmentación provoca un comportamiento que es inherentemente no determinista.</span><span class="sxs-lookup"><span data-stu-id="8016a-225">Of course, fragmentation causes behavior that is inherently nondeterministic.</span></span>

<span data-ttu-id="8016a-226">Además, el tiempo necesario para asignar y liberar un paquete de NetX equivale a la manipulación de una lista vinculada simple.</span><span class="sxs-lookup"><span data-stu-id="8016a-226">In addition, the time required to allocate and free a NetX packet amounts to simple linked-list manipulation.</span></span> <span data-ttu-id="8016a-227">Además, la asignación y desasignación de paquetes se realiza al inicio de la lista disponible.</span><span class="sxs-lookup"><span data-stu-id="8016a-227">Furthermore, packet allocation and deallocation is done at the head of the available list.</span></span> <span data-ttu-id="8016a-228">Esto proporciona el procesamiento de la lista vinculada más rápido posible.</span><span class="sxs-lookup"><span data-stu-id="8016a-228">This provides the fastest possible linked list processing.</span></span>

<span data-ttu-id="8016a-229">La falta de flexibilidad suele ser el principal inconveniente de los grupos de paquetes de tamaño fijo.</span><span class="sxs-lookup"><span data-stu-id="8016a-229">Lack of flexibility is typically the main drawback of fixed-size packet pools.</span></span> <span data-ttu-id="8016a-230">La determinación del tamaño óptimo de la carga del paquete, que también controla el paquete entrante en el peor de los casos, es una tarea difícil.</span><span class="sxs-lookup"><span data-stu-id="8016a-230">Determining the optimal packet payload size that also handles the worst-case incoming packet is a difficult task.</span></span> <span data-ttu-id="8016a-231">Los paquetes de NetX solucionan este problema con una característica opcional llamada *encadenamiento de paquetes*.</span><span class="sxs-lookup"><span data-stu-id="8016a-231">NetX packets address this problem with an optional feature called *packet chaining*.</span></span> <span data-ttu-id="8016a-232">Un paquete de red real puede constar de uno o varios paquetes de NetX vinculados entre sí.</span><span class="sxs-lookup"><span data-stu-id="8016a-232">An actual network packet can be made of one or more NetX packets linked together.</span></span> <span data-ttu-id="8016a-233">Además, el encabezado del paquete mantiene un puntero a la parte superior del paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-233">In addition, the packet header maintains a pointer to the top of the packet.</span></span> <span data-ttu-id="8016a-234">A medida que se agregan protocolos adicionales, este puntero simplemente se mueve hacia atrás y el nuevo encabezado se escribe directamente delante de los datos.</span><span class="sxs-lookup"><span data-stu-id="8016a-234">As additional protocols are added, this pointer is simply moved backwards and the new header is written directly in front of the data.</span></span> <span data-ttu-id="8016a-235">Sin una tecnología de paquetes flexible, la pila tendría que asignar otro búfer y copiar los datos en el nuevo búfer con el nuevo encabezado, lo que es intensivo en procesamiento.</span><span class="sxs-lookup"><span data-stu-id="8016a-235">Without the flexible packet technology, the stack would have to allocate another buffer and copy the data into a new buffer with the new header, which is processing intensive.</span></span>

<span data-ttu-id="8016a-236">Dado que el tamaño de la carga de cada paquete es fijo para un grupo de paquetes determinado, los datos de la aplicación mayores que el tamaño de la carga requieren varios paquetes encadenados juntos.</span><span class="sxs-lookup"><span data-stu-id="8016a-236">Since each packet payload size is fixed for a given packet pool, application data larger than the payload size  requires multiple packets chained together.</span></span> <span data-ttu-id="8016a-237">Al rellenar un paquete con datos del usuario, la aplicación debe usar el servicio ***nx_packet_data_append***.</span><span class="sxs-lookup"><span data-stu-id="8016a-237">When filling a packet with user data, the application must use the service ***nx_packet_data_append***.</span></span> <span data-ttu-id="8016a-238">Este servicio mueve los datos de la aplicación a un paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-238">This service moves application data into a packet.</span></span> <span data-ttu-id="8016a-239">En situaciones en las que un paquete no es suficiente para contener los datos del usuario, se asignan paquetes adicionales para almacenar los datos de usuario.</span><span class="sxs-lookup"><span data-stu-id="8016a-239">In situations where a packet is not enough to hold user data, additional packets are allocated to store user data.</span></span> <span data-ttu-id="8016a-240">Para usar el encadenamiento de paquetes, el controlador debe ser capaz de recibir o transmitir paquetes encadenados.</span><span class="sxs-lookup"><span data-stu-id="8016a-240">To use packet chaining, the driver must be able to receive into or transmit from chained packets.</span></span>

<span data-ttu-id="8016a-241">Cada grupo de memoria de paquetes de NetX es un recurso público.</span><span class="sxs-lookup"><span data-stu-id="8016a-241">Each NetX packet memory pool is a public resource.</span></span> <span data-ttu-id="8016a-242">NetX no aplica restricciones sobre cómo se usan los grupos.</span><span class="sxs-lookup"><span data-stu-id="8016a-242">NetX places no constraints on how packet pools are used.</span></span>

### <a name="packet-pool-memory-area"></a><span data-ttu-id="8016a-243">Área de memoria del grupo de paquetes</span><span class="sxs-lookup"><span data-stu-id="8016a-243">Packet Pool Memory Area</span></span>
<span data-ttu-id="8016a-244">El área de memoria del grupo de paquetes se especifica durante la creación.</span><span class="sxs-lookup"><span data-stu-id="8016a-244">The memory area for the packet pool is specified during creation.</span></span> <span data-ttu-id="8016a-245">Como sucede con otras áreas de memoria de objetos de ThreadX y NetX, se puede ubicar en cualquier parte del espacio de direcciones del destino.</span><span class="sxs-lookup"><span data-stu-id="8016a-245">Like other memory areas for ThreadX and NetX objects, it can be located anywhere in the target's address space.</span></span> <span data-ttu-id="8016a-246">Se trata de una característica importante porque ofrece a la aplicación una gran flexibilidad.</span><span class="sxs-lookup"><span data-stu-id="8016a-246">This is an important feature because of the considerable flexibility it gives the application.</span></span> <span data-ttu-id="8016a-247">Por ejemplo, imagine que un producto de comunicación tiene un área de memoria de alta velocidad para los búferes de red.</span><span class="sxs-lookup"><span data-stu-id="8016a-247">For example, suppose that a communication product has a high-speed memory area for network buffers.</span></span> <span data-ttu-id="8016a-248">Este área de memoria se emplea fácilmente convirtiéndola en un grupo de memoria de paquetes de NetX.</span><span class="sxs-lookup"><span data-stu-id="8016a-248">This memory area is easily utilized by making it into a NetX packet memory pool.</span></span>

### <a name="creating-packet-pools"></a><span data-ttu-id="8016a-249">Creación de grupos de paquetes</span><span class="sxs-lookup"><span data-stu-id="8016a-249">Creating Packet Pools</span></span>
<span data-ttu-id="8016a-250">Los grupos de paquetes se crean durante la inicialización o en tiempo de ejecución mediante subprocesos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-250">Packet pools are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="8016a-251">No hay ningún límite en el número de grupos de memoria de paquetes en una aplicación de NetX.</span><span class="sxs-lookup"><span data-stu-id="8016a-251">There are no limits on the number of packet memory pools in a NetX application.</span></span>

### <a name="packet-header-nx_packet"></a><span data-ttu-id="8016a-252">Encabezado de paquete NX_PACKET</span><span class="sxs-lookup"><span data-stu-id="8016a-252">Packet Header NX_PACKET</span></span>
<span data-ttu-id="8016a-253">De manera predeterminada, NetX coloca el encabezado del paquete inmediatamente antes del área de la carga del paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-253">By default, NetX places the packet header immediately before the packet payload area.</span></span> <span data-ttu-id="8016a-254">El bloque de memoria de paquetes es básicamente una serie de paquetes: encabezados seguidos inmediatamente por la carga del paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-254">The packet memory pool is basically a series of packets—headers followed immediately by the packet payload.</span></span> <span data-ttu-id="8016a-255">El encabezado del paquete (***NX_PACKET***) y el diseño del grupo de paquetes se muestran en la figura 3.</span><span class="sxs-lookup"><span data-stu-id="8016a-255">The packet header (***NX_PACKET***) and the layout of the packet pool are pictured in Figure 3.</span></span>

<span data-ttu-id="8016a-256">En el caso de los controladores de dispositivos de red que pueden realizar operaciones sin copia, normalmente la dirección inicial del área de la carga del paquete se programa en la lógica de DMA.</span><span class="sxs-lookup"><span data-stu-id="8016a-256">For network devices driver that are able to perform zero copy operations, typically the starting address of the packet payload area is programmed into the DMA logic.</span></span> <span data-ttu-id="8016a-257">Algunos motores de DMA tienen un requisito de alineación en el área de la carga.</span><span class="sxs-lookup"><span data-stu-id="8016a-257">Certain DMA engines have alignment requirement on the payload area.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-258">\*El controlador de red debe llamar a la función \***nx_packet_transmit_release** _ cuando se complete la transmisión de un paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-258">\*The network driver to must call the \***nx_packet_transmit_release** _ function when the transmission of a packet is complete.</span></span> <span data-ttu-id="8016a-259">Esta función realiza una comprobación para asegurarse de que el paquete no forma parte de una cola de salida de TCP antes de que se vuelva a colocar en el grupo disponible.</span><span class="sxs-lookup"><span data-stu-id="8016a-259">This function checks to make sure the packet is not part of a TCP output queue before it is actually placed back in the available pool.</span></span> <span data-ttu-id="8016a-260">Si no se llama a esta función, se puede producir un comportamiento imprevisible._</span><span class="sxs-lookup"><span data-stu-id="8016a-260">Failure to call this function can result in unpredictable behavior._</span></span>

![Diseño del encabezado del paquete y del grupo de paquetes](./media/user-guide/packet-header-packet-pool-layout.png)

<span data-ttu-id="8016a-262">**FIGURA 3. Diseño del encabezado del paquete y del grupo de paquetes**</span><span class="sxs-lookup"><span data-stu-id="8016a-262">**FIGURE 3. Packet Header and Packet Pool Layout**</span></span>

<span data-ttu-id="8016a-263">Los campos del encabezado del paquete se definen como se muestra en la tabla siguiente.</span><span class="sxs-lookup"><span data-stu-id="8016a-263">The fields of the packet header are defined as shown in the following table.</span></span> <span data-ttu-id="8016a-264">Tenga en cuenta que esta tabla no es una lista exhaustiva de todos los miembros de la estructura *NX_PACKET*.</span><span class="sxs-lookup"><span data-stu-id="8016a-264">Note that this table is not a comprehensive list of all the members in the *NX_PACKET* structure.</span></span>

| <span data-ttu-id="8016a-265">Encabezado de paquete</span><span class="sxs-lookup"><span data-stu-id="8016a-265">Packet header</span></span>          | <span data-ttu-id="8016a-266">Propósito</span><span class="sxs-lookup"><span data-stu-id="8016a-266">Purpose</span></span>                                                                                                                                                                                                                                                                                                                            |
|------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="8016a-267">*nx_packet_pool_owner*</span><span class="sxs-lookup"><span data-stu-id="8016a-267">*nx_packet_pool_owner*</span></span>   | <span data-ttu-id="8016a-268">Este campo apunta al grupo de paquetes que posee este paquete en particular.</span><span class="sxs-lookup"><span data-stu-id="8016a-268">This field points to the packet pool that owns this particular packet.</span></span> <span data-ttu-id="8016a-269">Cuando se libera el paquete, se libera a este grupo en particular.</span><span class="sxs-lookup"><span data-stu-id="8016a-269">When the packet is released, it is released to this particular pool.</span></span> <span data-ttu-id="8016a-270">Con la propiedad del grupo dentro de cada paquete, es posible que un datagrama abarque varios paquetes de varios grupos de paquetes.</span><span class="sxs-lookup"><span data-stu-id="8016a-270">With the pool ownership inside each packet, it is possible for a datagram to span multiple packets from multiple packet pools.</span></span>                                                         |
| <span data-ttu-id="8016a-271">*nx_packet_next*</span><span class="sxs-lookup"><span data-stu-id="8016a-271">*nx_packet_next*</span></span>         | <span data-ttu-id="8016a-272">Este campo apunta al siguiente paquete dentro del mismo marco.</span><span class="sxs-lookup"><span data-stu-id="8016a-272">This field points to the next packet within the same frame.</span></span> <span data-ttu-id="8016a-273">Si es NULL, no hay paquetes adicionales que formen parte del marco.</span><span class="sxs-lookup"><span data-stu-id="8016a-273">If NULL, there are no additional packets that are part of the frame.</span></span> |
| <span data-ttu-id="8016a-274">*nx_packet_last*</span><span class="sxs-lookup"><span data-stu-id="8016a-274">*nx_packet_last*</span></span>         | <span data-ttu-id="8016a-275">Este campo apunta al último paquete que se encuentra en el mismo paquete de red.</span><span class="sxs-lookup"><span data-stu-id="8016a-275">This field points to the last packet within the same network packet.</span></span> <span data-ttu-id="8016a-276">Si es NULL, este paquete representa todo el paquete de red.</span><span class="sxs-lookup"><span data-stu-id="8016a-276">If NULL, this packet represents the entire network packet.</span></span>  |
| <span data-ttu-id="8016a-277">*nx_packet_length*</span><span class="sxs-lookup"><span data-stu-id="8016a-277">*nx_packet_length*</span></span>       | <span data-ttu-id="8016a-278">Este campo contiene el número total de bytes de todo el paquete de red, incluido el total de todos los bytes de todos los paquetes encadenados mediante el miembro *nx_packet_next*.</span><span class="sxs-lookup"><span data-stu-id="8016a-278">This field contains the total number of bytes in the entire network packet, including the total of all bytes in all packets chained together by the *nx_packet_next* member.</span></span> |
| <span data-ttu-id="8016a-279">*nx_packet_ip_interface*</span><span class="sxs-lookup"><span data-stu-id="8016a-279">*nx_packet_ip_interface*</span></span> | <span data-ttu-id="8016a-280">Este campo es el bloque de control de la interfaz, que se asigna al paquete cuando lo recibe el controlador de interfaz y por NetX para los paquetes salientes.</span><span class="sxs-lookup"><span data-stu-id="8016a-280">This field is the interface control block which is assigned to the packet when it is received by the interface driver, and by NetX for outgoing packets.</span></span> <span data-ttu-id="8016a-281">Un bloque de control de interfaz describe la interfaz, por ejemplo, la dirección de red, la dirección MAC, la dirección IP y el estado de la interfaz, como el vínculo habilitado y la asignación física necesaria.</span><span class="sxs-lookup"><span data-stu-id="8016a-281">An interface control block describes the interface e.g. network address, MAC address, IP address and interface status such as link enabled and physical mapping required.</span></span> |
| <span data-ttu-id="8016a-282">*nx_packet_data_start*</span><span class="sxs-lookup"><span data-stu-id="8016a-282">*nx_packet_data_start*</span></span>   | <span data-ttu-id="8016a-283">Este campo apunta al inicio del área de la carga física de este paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-283">This field points to the start of the physical payload area of this packet.</span></span> <span data-ttu-id="8016a-284">No tiene que estar inmediatamente después del encabezado NX_PACKET, pero ese es el valor predeterminado para el servicio ***nx_packet_pool_create***.</span><span class="sxs-lookup"><span data-stu-id="8016a-284">It does not have to be immediately following the NX_PACKET header, but that is the default for the ***nx_packet_pool_create*** service.</span></span> |
| <span data-ttu-id="8016a-285">*nx_packet_data_end*</span><span class="sxs-lookup"><span data-stu-id="8016a-285">*nx_packet_data_end*</span></span>     | <span data-ttu-id="8016a-286">Este campo apunta al final del área de la carga física de este paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-286">This field points to the end of the physical payload area of this packet.</span></span> <span data-ttu-id="8016a-287">La diferencia entre este campo y el campo nx_packet_data_start representa el tamaño de la carga.</span><span class="sxs-lookup"><span data-stu-id="8016a-287">The difference between this field and the nx_packet_data_start field represents the payload size.</span></span> |
| <span data-ttu-id="8016a-288">*nx_packet_prepend_ptr*</span><span class="sxs-lookup"><span data-stu-id="8016a-288">*nx_packet_prepend_ptr*</span></span>  | <span data-ttu-id="8016a-289">Este campo apunta a la ubicación donde se agregan los datos de los paquetes, ya sea el encabezado de protocolo o los datos reales, delante de los datos de los paquetes existentes (si existen) en el área de carga de paquetes.</span><span class="sxs-lookup"><span data-stu-id="8016a-289">This field points to the location of where packet data, either protocol header or actual data, is added in front of the existing packet data (if any) in the packet payload area.</span></span> <span data-ttu-id="8016a-290">Debe ser mayor o igual que la posición del puntero *nx_packet_data_start* y menor o igual que el puntero *nx_packet_append_ptr*.</span><span class="sxs-lookup"><span data-stu-id="8016a-290">It must be greater than or equal to the *nx_packet_data_start* pointer location and less than or equal to the *nx_packet_append_ptr* pointer.</span></span>  <span data-ttu-id="8016a-291">*Por motivos de rendimiento, NetX supone que cuando el paquete se pasa a los servicios de NetX para su transmisión, el puntero antepuesto apunta a una dirección alineada para palabra larga.*</span><span class="sxs-lookup"><span data-stu-id="8016a-291">*For performance reasons, NetX assumes that when the packet is passed into NetX services for transmission, the prepend pointer points to long word aligned address.*</span></span> |
| <span data-ttu-id="8016a-292">*nx_packet_append_ptr*</span><span class="sxs-lookup"><span data-stu-id="8016a-292">*nx_packet_append_ptr*</span></span>    | <span data-ttu-id="8016a-293">Este campo apunta al final de los datos que se encuentran actualmente en el área de carga de paquetes.</span><span class="sxs-lookup"><span data-stu-id="8016a-293">This field points to the end of the data currently in the packet payload area.</span></span> <span data-ttu-id="8016a-294">Debe encontrarse entre la ubicación de memoria a la que apuntan *nx_packet_prepend_ptr* y *nx_packet_data_end*.</span><span class="sxs-lookup"><span data-stu-id="8016a-294">It must be in between the memory location pointed to by *nx_packet_prepend_ptr* and *nx_packet_data_end*.</span></span> <span data-ttu-id="8016a-295">La diferencia entre este campo y el campo *nx_packet_prepend_ptr* representa la cantidad de datos de este paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-295">The difference between this field and the *nx_packet_prepend_ptr* field represents the amount of data in this packet.</span></span> |
| <span data-ttu-id="8016a-296">*nx_packet_fragment_next*</span><span class="sxs-lookup"><span data-stu-id="8016a-296">*nx_packet_fragment_next*</span></span> | <span data-ttu-id="8016a-297">Este campo se usa para mantener los paquetes fragmentados hasta que se pueda volver a ensamblar todo el paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-297">This field is used to hold fragmented packets until the entire packet can be re-assembled.</span></span> |
| <span data-ttu-id="8016a-298">*nx_packet_pad*</span><span class="sxs-lookup"><span data-stu-id="8016a-298">*nx_packet_pad*</span></span>           | <span data-ttu-id="8016a-299">Este campo define la longitud del relleno en palabras de 4 bytes para lograr el requisito de alineación deseado.</span><span class="sxs-lookup"><span data-stu-id="8016a-299">This fields defines the length of padding in 4- byte words to achieve the desired alignment requirement.</span></span> <span data-ttu-id="8016a-300">Este campo se quita si no se define *NX_PACKET_HEADER_PAD*.</span><span class="sxs-lookup"><span data-stu-id="8016a-300">This field is removed if *NX_PACKET_HEADER_PAD* is not defined.</span></span> |
|  |  |

### <a name="packet-header-offsets"></a><span data-ttu-id="8016a-301">Desplazamientos de encabezados de paquetes</span><span class="sxs-lookup"><span data-stu-id="8016a-301">Packet Header Offsets</span></span>

<span data-ttu-id="8016a-302">El tamaño del encabezado del paquete se define para dejar espacio suficiente para acomodar el tamaño del encabezado.</span><span class="sxs-lookup"><span data-stu-id="8016a-302">Packet header size is defined to allow enough room to accommodate the size of the header.</span></span> <span data-ttu-id="8016a-303">El servicio *nx_packet_allocate* se utiliza para asignar un paquete y ajusta el puntero antepuesto del paquete según el tipo de paquete especificado.</span><span class="sxs-lookup"><span data-stu-id="8016a-303">The *nx_packet_allocate* service is used to allocate a packet and adjusts the prepend pointer in the packet according to the type of packet specified.</span></span> <span data-ttu-id="8016a-304">El tipo de paquete indica a NetX el desplazamiento necesario para insertar el encabezado de protocolo (por ejemplo, UDP, TCP o ICMP) delante de los datos del protocolo.</span><span class="sxs-lookup"><span data-stu-id="8016a-304">The packet type tells NetX the offset required for inserting the protocol header (such as UDP, TCP, or ICMP) in front of the protocol data.</span></span>

<span data-ttu-id="8016a-305">Los siguientes tipos se definen en NetX para tener en cuenta el encabezado IP y el encabezado de capa física (Ethernet) del paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-305">The following types are defined in NetX to take into account the IP header and physical layer (Ethernet) header in the packet.</span></span> <span data-ttu-id="8016a-306">En el último caso, se supone que tiene 16 bytes para tener en cuenta la alineación de 4 bytes necesaria.</span><span class="sxs-lookup"><span data-stu-id="8016a-306">In the latter case, it is assumed to be 16 bytes taking the required 4-byte alignment into consideration.</span></span> <span data-ttu-id="8016a-307">Los paquetes IP siguen definidos en NetX para que las aplicaciones asignen paquetes para redes IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-307">IP packets are still defined in NetX for applications to allocate packets for IP networks.</span></span> <span data-ttu-id="8016a-308">En la tabla siguiente se muestran los símbolos definidos:</span><span class="sxs-lookup"><span data-stu-id="8016a-308">The following table shows symbols defined:</span></span>

| <span data-ttu-id="8016a-309">Tipo de paquete</span><span class="sxs-lookup"><span data-stu-id="8016a-309">Packet Type</span></span>   | <span data-ttu-id="8016a-310">Value</span><span class="sxs-lookup"><span data-stu-id="8016a-310">Value</span></span> |
|---------------|-------|
| <span data-ttu-id="8016a-311">NX_IP_PACKET</span><span class="sxs-lookup"><span data-stu-id="8016a-311">NX_IP_PACKET</span></span>  | <span data-ttu-id="8016a-312">0x24</span><span class="sxs-lookup"><span data-stu-id="8016a-312">0x24</span></span>  |
| <span data-ttu-id="8016a-313">NX_UDP_PACKET</span><span class="sxs-lookup"><span data-stu-id="8016a-313">NX_UDP_PACKET</span></span> | <span data-ttu-id="8016a-314">0x2c</span><span class="sxs-lookup"><span data-stu-id="8016a-314">0x2c</span></span>  |
| <span data-ttu-id="8016a-315">NX_TCP_PACKET</span><span class="sxs-lookup"><span data-stu-id="8016a-315">NX_TCP_PACKET</span></span> | <span data-ttu-id="8016a-316">0x38</span><span class="sxs-lookup"><span data-stu-id="8016a-316">0x38</span></span>  |
|               |       |

### <a name="pool-capacity"></a><span data-ttu-id="8016a-317">Capacidad del grupo</span><span class="sxs-lookup"><span data-stu-id="8016a-317">Pool Capacity</span></span>
<span data-ttu-id="8016a-318">El número de paquetes de un grupo de paquetes es una función del tamaño de la carga y el número total de bytes del área de memoria proporcionado al servicio de creación del grupo de paquetes.</span><span class="sxs-lookup"><span data-stu-id="8016a-318">The number of packets in a packet pool is a function of the payload size and the total number of bytes in the memory area supplied to the packet pool create service.</span></span> <span data-ttu-id="8016a-319">La capacidad del grupo se calcula dividiendo el tamaño del paquete (incluido el tamaño del encabezado NX_PACKET, el tamaño de carga útil y la alineación adecuada) en el número total de bytes del área de memoria proporcionada.</span><span class="sxs-lookup"><span data-stu-id="8016a-319">The capacity of the pool is calculated by dividing the packet size (including the size of the NX_PACKET header, the payload size, and proper alignment) into the total number of bytes in the supplied memory area.</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="8016a-320">Suspensión de subprocesos</span><span class="sxs-lookup"><span data-stu-id="8016a-320">Thread Suspension</span></span>
<span data-ttu-id="8016a-321">Los subprocesos de la aplicación se pueden suspender mientras se espera un paquete de un grupo vacío.</span><span class="sxs-lookup"><span data-stu-id="8016a-321">Application threads can suspend while waiting for a packet from an empty pool.</span></span> <span data-ttu-id="8016a-322">Cuando se devuelve un paquete al grupo, el subproceso suspendido recibe este paquete y se reanuda.</span><span class="sxs-lookup"><span data-stu-id="8016a-322">When a packet is returned to the pool, the suspended thread is given this packet and resumed.</span></span>

<span data-ttu-id="8016a-323">Si se suspenden varios subprocesos en el mismo grupo de paquetes, se reanudan en el orden en el que se hayan suspendido (FIFO).</span><span class="sxs-lookup"><span data-stu-id="8016a-323">If multiple threads are suspended on the same packet pool, they are resumed in the order they were suspended (FIFO).</span></span>

### <a name="pool-statistics-and-errors"></a><span data-ttu-id="8016a-324">Estadísticas y errores del grupo</span><span class="sxs-lookup"><span data-stu-id="8016a-324">Pool Statistics and Errors</span></span>
<span data-ttu-id="8016a-325">Si está habilitado, el software de administración de paquetes de NetX **Errors** realiza el seguimiento de varias estadísticas y errores que pueden ser útiles para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-325">If enabled, the NetX packet management software **Errors** keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="8016a-326">Se mantienen las estadísticas y los informes de errores siguientes para los grupos de paquetes:</span><span class="sxs-lookup"><span data-stu-id="8016a-326">The following statistics and error reports are maintained for packet pools:</span></span>

* <span data-ttu-id="8016a-327">Número total de paquetes en el grupo</span><span class="sxs-lookup"><span data-stu-id="8016a-327">Total Packets in Pool</span></span>
* <span data-ttu-id="8016a-328">Paquetes libres en el grupo</span><span class="sxs-lookup"><span data-stu-id="8016a-328">Free Packets in Pool</span></span>
* <span data-ttu-id="8016a-329">Solicitudes de asignación de grupos vacíos</span><span class="sxs-lookup"><span data-stu-id="8016a-329">Pool Empty Allocation Requests</span></span>
* <span data-ttu-id="8016a-330">Suspensiones de asignación de grupos vacíos</span><span class="sxs-lookup"><span data-stu-id="8016a-330">Pool Empty Allocation Suspensions</span></span>
* <span data-ttu-id="8016a-331">Liberaciones de paquetes no válidas</span><span class="sxs-lookup"><span data-stu-id="8016a-331">Invalid Packet Releases</span></span>

<span data-ttu-id="8016a-332">Todas estas estadísticas e informes de errores, excepto el total y el número de paquetes libres del grupo, están integrados en la biblioteca de NetX a menos que se defina \***NX_DISABLE_PACKET_INFO** _.</span><span class="sxs-lookup"><span data-stu-id="8016a-332">All of these statistics and error reports, except for total and free packet count in pool, are built into NetX library unless \***NX_DISABLE_PACKET_INFO** _ is defined.</span></span> <span data-ttu-id="8016a-333">Estos datos están disponibles para la aplicación con el servicio _ \*_nx_packet_pool_info_get_\*\*.</span><span class="sxs-lookup"><span data-stu-id="8016a-333">This data is available to the application with the _ *_nx_packet_pool_info_get_*\* service.</span></span>

### <a name="packet-pool-control-block-nx_packet_pool"></a><span data-ttu-id="8016a-334">Bloque de control del grupo de paquetes NX_PACKET_POOL</span><span class="sxs-lookup"><span data-stu-id="8016a-334">Packet Pool Control Block NX_PACKET_POOL</span></span>

<span data-ttu-id="8016a-335">Las características de cada grupo de memoria de paquetes se encuentran en su bloque de control.</span><span class="sxs-lookup"><span data-stu-id="8016a-335">The characteristics of each packet memory pool are found in its control block.</span></span> <span data-ttu-id="8016a-336">Contiene información útil, como la lista vinculada de paquetes libres, el número de paquetes libres y el tamaño de la carga de los paquetes de este grupo.</span><span class="sxs-lookup"><span data-stu-id="8016a-336">It contains useful information such as the linked list of free packets, the number of free packets, and the payload size for packets in this pool.</span></span> <span data-ttu-id="8016a-337">Esta estructura se define en el archivo *tx_api.h*.</span><span class="sxs-lookup"><span data-stu-id="8016a-337">This structure is defined in the *nx_api.h* file.</span></span>

<span data-ttu-id="8016a-338">Los bloques de control del grupo de paquetes se pueden ubicar en cualquier parte de la memoria, pero es más común convertir el bloque de control en una estructura global mediante su definición fuera del ámbito de cualquier función.</span><span class="sxs-lookup"><span data-stu-id="8016a-338">Packet pool control blocks can be located anywhere in memory, but it is most common to make the control block a global structure by defining it outside the scope of any function.</span></span>

## <a name="ip-protocol"></a><span data-ttu-id="8016a-339">Protocolo IP</span><span class="sxs-lookup"><span data-stu-id="8016a-339">IP Protocol</span></span>

<span data-ttu-id="8016a-340">El componente del protocolo de Internet (IP) de NetX es responsable de enviar y recibir paquetes IP en Internet.</span><span class="sxs-lookup"><span data-stu-id="8016a-340">The Internet Protocol (IP) component of NetX is responsible for sending and receiving IP packets on the Internet.</span></span> <span data-ttu-id="8016a-341">En NetX, es el componente responsable en última instancia de enviar y recibir mensajes TCP, UDP, ICMP e IGMP, mediante el controlador de red subyacente.</span><span class="sxs-lookup"><span data-stu-id="8016a-341">In NetX, it is the component ultimately responsible for sending and receiving TCP, UDP, ICMP, and IGMP messages, utilizing the underlying network driver.</span></span>

<span data-ttu-id="8016a-342">NetX admite el protocolo IP (RFC 791)</span><span class="sxs-lookup"><span data-stu-id="8016a-342">NetX supports IP protocol (RFC 791)</span></span>

### <a name="ip-addresses"></a><span data-ttu-id="8016a-343">Direcciones IP</span><span class="sxs-lookup"><span data-stu-id="8016a-343">IP Addresses</span></span>

<span data-ttu-id="8016a-344">Cada host de Internet tiene un identificador único de 32 bits llamado dirección IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-344">Each host on the Internet has a unique 32-bit identifier called an IP address.</span></span> <span data-ttu-id="8016a-345">Hay cinco clases de direcciones IP, como se describe en la figura 4.</span><span class="sxs-lookup"><span data-stu-id="8016a-345">There are five classes of IP addresses as described in Figure 4.</span></span> <span data-ttu-id="8016a-346">Los intervalos de las cinco clases de direcciones IP son los siguientes:</span><span class="sxs-lookup"><span data-stu-id="8016a-346">The ranges of the five IP address classes are as follows:</span></span>

| <span data-ttu-id="8016a-347">Clase</span><span class="sxs-lookup"><span data-stu-id="8016a-347">Class</span></span> | <span data-ttu-id="8016a-348">Intervalo</span><span class="sxs-lookup"><span data-stu-id="8016a-348">Range</span></span>                        |
|-------|------------------------------|
| <span data-ttu-id="8016a-349">Un</span><span class="sxs-lookup"><span data-stu-id="8016a-349">A</span></span>     | <span data-ttu-id="8016a-350">De 0.0.0.0 a 127.255.255.255</span><span class="sxs-lookup"><span data-stu-id="8016a-350">0.0.0.0 to 127.255.255.255</span></span>   |
| <span data-ttu-id="8016a-351">B</span><span class="sxs-lookup"><span data-stu-id="8016a-351">B</span></span>     | <span data-ttu-id="8016a-352">De 128.0.0.0 a 191.255.255.255</span><span class="sxs-lookup"><span data-stu-id="8016a-352">128.0.0.0 to 191.255.255.255</span></span> |
| <span data-ttu-id="8016a-353">C</span><span class="sxs-lookup"><span data-stu-id="8016a-353">C</span></span>     | <span data-ttu-id="8016a-354">De 192.0.0.0 a 223.255.255.255</span><span class="sxs-lookup"><span data-stu-id="8016a-354">192.0.0.0 to 223.255.255.255</span></span> |
| <span data-ttu-id="8016a-355">D</span><span class="sxs-lookup"><span data-stu-id="8016a-355">D</span></span>     | <span data-ttu-id="8016a-356">De 224.0.0.0 a 239.255.255.255</span><span class="sxs-lookup"><span data-stu-id="8016a-356">224.0.0.0 to 239.255.255.255</span></span> |
| <span data-ttu-id="8016a-357">E</span><span class="sxs-lookup"><span data-stu-id="8016a-357">E</span></span>     | <span data-ttu-id="8016a-358">De 240.0.0.0 a 247.255.255.255</span><span class="sxs-lookup"><span data-stu-id="8016a-358">240.0.0.0 to 247.255.255.255</span></span> |

<span data-ttu-id="8016a-359">**7 bits 24 bits**</span><span class="sxs-lookup"><span data-stu-id="8016a-359">**7 bits 24 bits**</span></span>

![Estructura de una dirección IP](./media/user-guide/ip-address-structure.png)

<span data-ttu-id="8016a-361">**FIGURA 4. Estructura de una dirección IP**</span><span class="sxs-lookup"><span data-stu-id="8016a-361">**FIGURE 4. IP Address Structure**</span></span>

<span data-ttu-id="8016a-362">También hay tres tipos de especificaciones de dirección: *unidifusión*, *difusión* y *multidifusión*.</span><span class="sxs-lookup"><span data-stu-id="8016a-362">There are also three types of address specifications: *unicast*, *broadcast*, and *multicast*.</span></span> <span data-ttu-id="8016a-363">Las direcciones de unidifusión son aquellas direcciones IP que identifican un host específico en Internet.</span><span class="sxs-lookup"><span data-stu-id="8016a-363">Unicast addresses are those IP addresses that identify a specific host on the Internet.</span></span> <span data-ttu-id="8016a-364">Las direcciones de unidifusión pueden ser una dirección IP de origen o de destino.</span><span class="sxs-lookup"><span data-stu-id="8016a-364">Unicast addresses can be either a source or a destination IP address.</span></span> <span data-ttu-id="8016a-365">Una dirección de difusión identifica todos los hosts de una red o subred específicas y solo se puede usar como direcciones de destino.</span><span class="sxs-lookup"><span data-stu-id="8016a-365">A broadcast address identifies all hosts on a specific network or sub-network and can only be used as destination addresses.</span></span> <span data-ttu-id="8016a-366">Las direcciones de difusión se especifican con la parte del identificador de host de la dirección establecida en unos.</span><span class="sxs-lookup"><span data-stu-id="8016a-366">Broadcast addresses are specified by having the host ID portion of the address set to ones.</span></span> <span data-ttu-id="8016a-367">Las direcciones de multidifusión (clase D) especifican un grupo dinámico de hosts en Internet.</span><span class="sxs-lookup"><span data-stu-id="8016a-367">Multicast addresses (Class D) specify a dynamic group of hosts on the Internet.</span></span> <span data-ttu-id="8016a-368">Los miembros del grupo de multidifusión pueden unirse y dejar de participar siempre que lo deseen.</span><span class="sxs-lookup"><span data-stu-id="8016a-368">Members of the multicast group may join and leave whenever they wish.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-369">*Solo los protocolos sin conexión como UDP sobre IP pueden emplear la difusión y la funcionalidad de difusión limitada del grupo de multidifusión.*</span><span class="sxs-lookup"><span data-stu-id="8016a-369">*Only connectionless protocols like UDP over IP can utilize broadcast and the limited broadcast capability of the multicast group.*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-370">*La macro* IP_ADDRESS *se define en el archivo* \***nx_api.h** _.</span><span class="sxs-lookup"><span data-stu-id="8016a-370">*The macro* IP_ADDRESS *is defined in* \***nx_api.h** _.</span></span> <span data-ttu-id="8016a-371">Permite una especificación sencilla de direcciones IP mediante comas en lugar de puntos.</span><span class="sxs-lookup"><span data-stu-id="8016a-371">It allows easy specification of IP addresses using commas instead of a periods.</span></span> <span data-ttu-id="8016a-372">Por ejemplo, IP_ADDRESS(128, 0, 0, 0) _especifica la primera dirección de clase B que se muestra en la figura 4.\*</span><span class="sxs-lookup"><span data-stu-id="8016a-372">For example, IP_ADDRESS(128,0,0,0) _specifies the first class B address shown in Figure 4.\*</span></span>

### <a name="ip-gateway-address"></a><span data-ttu-id="8016a-373">Dirección de la puerta de enlace IP</span><span class="sxs-lookup"><span data-stu-id="8016a-373">IP Gateway Address</span></span>

<span data-ttu-id="8016a-374">Las puertas de enlace de red ayudan a los hosts de sus redes a retransmitir paquetes destinados a destinos fuera del dominio local.</span><span class="sxs-lookup"><span data-stu-id="8016a-374">Network gateways assist hosts on their networks to relay packets destined to destinations outside the local domain.</span></span> <span data-ttu-id="8016a-375">Cada nodo tiene cierto conocimiento del próximo salto al que se va hacer el envío, ya sea el destino de uno de sus vecinos o mediante una tabla de enrutamiento estático programada previamente.</span><span class="sxs-lookup"><span data-stu-id="8016a-375">Each node has some knowledge of which next hop to send to, either the destination one of its neighbors, or through a pre-programmed static routing table.</span></span> <span data-ttu-id="8016a-376">Sin embargo, si se produce un error en estos enfoques, el nodo debe reenviar el paquete a su puerta de enlace predeterminada, que tiene más información sobre cómo enrutar el paquete a su destino.</span><span class="sxs-lookup"><span data-stu-id="8016a-376">However if these approaches fail, the node should forward the packet to its default gateway which has more information on how to route the packet to its destination.</span></span> <span data-ttu-id="8016a-377">Tenga en cuenta que la puerta de enlace predeterminada debe ser accesible directamente mediante una de las interfaces físicas asociadas a la instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-377">Note that the default gateway must be directly accessible through one of the physical interfaces attached to the IP instance.</span></span> <span data-ttu-id="8016a-378">La aplicación llama a ***nx_ip_gateway_address_set*** para configurar la dirección de la puerta de enlace predeterminada de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-378">The application calls ***nx_ip_gateway_address_set*** to configure IP default gateway address.</span></span>

### <a name="ip-header"></a><span data-ttu-id="8016a-379">Encabezado IP</span><span class="sxs-lookup"><span data-stu-id="8016a-379">IP Header</span></span>

<span data-ttu-id="8016a-380">Para que cualquier paquete IP se envíe a Internet, debe tener un encabezado IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-380">For any IP packet to be sent on the Internet, it must have an IP header.</span></span> <span data-ttu-id="8016a-381">Cuando los protocolos de nivel superior (UDP, TCP, ICMP o IGMP) llaman al componente IP para enviar un paquete, el módulo de transmisión IP coloca un encabezado IP delante de los datos.</span><span class="sxs-lookup"><span data-stu-id="8016a-381">When higher-level protocols (UDP, TCP, ICMP, or IGMP) call the IP component to send a packet, the IP transmit module places an IP header in front of the data.</span></span> <span data-ttu-id="8016a-382">Por el contrario, cuando se reciben paquetes IP de la red, el componente IP quita el encabezado IP del paquete antes de entregarlo a los protocolos de nivel superior.</span><span class="sxs-lookup"><span data-stu-id="8016a-382">Conversely, when IP packets are received from the network, the IP component removes the IP header from the packet before delivery to the higher-level protocols.</span></span> <span data-ttu-id="8016a-383">En la figura 5 se muestra el formato del encabezado IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-383">Figure 5 shows the format of the IP header.</span></span>

![Formato del encabezado IP](./media/user-guide/ip-header-format.png)

<span data-ttu-id="8016a-385">**FIGURA 5. Formato del encabezado IP**</span><span class="sxs-lookup"><span data-stu-id="8016a-385">**FIGURE 5. IP Header Format**</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-386">*Se espera que todos los encabezados de la implementación de TCP/IP estén en formato big endian. En este formato, el byte más significativo de la palabra reside en la dirección de bytes más baja. Por ejemplo, la versión de 4 bits y la longitud del encabezado de 4 bits del encabezado IP deben estar ubicadas en el primer byte del encabezado.*</span><span class="sxs-lookup"><span data-stu-id="8016a-386">*All headers in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address. For example, the 4-bit version and the 4-bit header length of the IP header must be located on the first byte of the header.*</span></span>

<span data-ttu-id="8016a-387">Los campos del encabezado IP se definen de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="8016a-387">The fields of the IP header are defined as follows:</span></span>

<span data-ttu-id="8016a-388">**Propósito del campo del encabezado IP**</span><span class="sxs-lookup"><span data-stu-id="8016a-388">**IP Header Field Purpose**</span></span>

<span data-ttu-id="8016a-389">***Versión de 4 bits*** Este campo contiene la versión de IP que representa este encabezado.</span><span class="sxs-lookup"><span data-stu-id="8016a-389">***4-bit version*** This field contains the version of IP this header represents.</span></span> <span data-ttu-id="8016a-390">En el caso de IP versión 4, que es lo que admite NetX, el valor de este campo es 4.</span><span class="sxs-lookup"><span data-stu-id="8016a-390">For IP version 4, which is what NetX supports, the value of this field is 4.</span></span>

<span data-ttu-id="8016a-391">***Longitud del encabezado de 4 bits*** Este campo especifica el número de palabras de 32 bits del encabezado IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-391">***4-bit header length*** This field specifies the number of 32-bit words in the IP header.</span></span> <span data-ttu-id="8016a-392">Si no hay palabras de opción presentes, el valor de este campo es 5.</span><span class="sxs-lookup"><span data-stu-id="8016a-392">If no option words are present, the value for this field is 5.</span></span>

<span data-ttu-id="8016a-393">***Tipo de servicio (TOS) de 8 bits*** Este campo especifica el tipo de servicio solicitado para este paquete IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-393">***8-bit type of service (TOS)*** This field specifies the type of service requested for this IP packet.</span></span> <span data-ttu-id="8016a-394">Las solicitudes válidas son las siguientes:</span><span class="sxs-lookup"><span data-stu-id="8016a-394">Valid requests are as follows:</span></span>

| <span data-ttu-id="8016a-395">**Solicitud TOS**</span><span class="sxs-lookup"><span data-stu-id="8016a-395">**TOS Request**</span></span>     | <span data-ttu-id="8016a-396">**Valor**</span><span class="sxs-lookup"><span data-stu-id="8016a-396">**Value**</span></span> |
| ------------------- | --------- |
| <span data-ttu-id="8016a-397">Normal</span><span class="sxs-lookup"><span data-stu-id="8016a-397">Normal</span></span>              | <span data-ttu-id="8016a-398">0x00</span><span class="sxs-lookup"><span data-stu-id="8016a-398">0x00</span></span>      |
| <span data-ttu-id="8016a-399">Retraso mínimo</span><span class="sxs-lookup"><span data-stu-id="8016a-399">Minimum Delay</span></span>       | <span data-ttu-id="8016a-400">0x10</span><span class="sxs-lookup"><span data-stu-id="8016a-400">0x10</span></span>      |
| <span data-ttu-id="8016a-401">Datos máximos</span><span class="sxs-lookup"><span data-stu-id="8016a-401">Maximum Data</span></span>        | <span data-ttu-id="8016a-402">0x08</span><span class="sxs-lookup"><span data-stu-id="8016a-402">0x08</span></span>      |
| <span data-ttu-id="8016a-403">Confiabilidad máxima</span><span class="sxs-lookup"><span data-stu-id="8016a-403">Maximum Reliability</span></span> | <span data-ttu-id="8016a-404">0x04</span><span class="sxs-lookup"><span data-stu-id="8016a-404">0x04</span></span>      |
| <span data-ttu-id="8016a-405">Costo mínimo</span><span class="sxs-lookup"><span data-stu-id="8016a-405">Minimum Cost</span></span>        | <span data-ttu-id="8016a-406">0x02</span><span class="sxs-lookup"><span data-stu-id="8016a-406">0x02</span></span>      |

<span data-ttu-id="8016a-407">***Longitud total de 16 bits*** Este campo contiene la longitud total del datagrama IP en bytes, incluido el encabezado IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-407">***16-bit total length*** This field contains the total length of the IP datagram in bytes, including the IP header.</span></span> <span data-ttu-id="8016a-408">Un datagrama IP es la unidad básica de información que se encuentra en una red de Internet con TCP/IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-408">An IP datagram is the basic unit of information found on a TCP/IP Internet.</span></span> <span data-ttu-id="8016a-409">Contiene una dirección de origen y de destino, además de los datos.</span><span class="sxs-lookup"><span data-stu-id="8016a-409">It contains a destination and source address in addition to data.</span></span> <span data-ttu-id="8016a-410">Dado que es un campo de 16 bits, el tamaño máximo de un datagrama IP es de 65 535 bytes.</span><span class="sxs-lookup"><span data-stu-id="8016a-410">Because it is a 16-bit field, the maximum size of an IP datagram is 65,535 bytes.</span></span>

<span data-ttu-id="8016a-411">***identificación de 16 bits*** El campo es un número que se usa para identificar de forma única cada datagrama IP enviado desde un host.</span><span class="sxs-lookup"><span data-stu-id="8016a-411">***16-bit identification*** The field is a number used to uniquely identify each IP datagram sent from a host.</span></span> <span data-ttu-id="8016a-412">Normalmente, este número se incrementa después de enviar un datagrama IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-412">This number is typically incremented after an IP datagram is sent.</span></span> <span data-ttu-id="8016a-413">Es especialmente útil para ensamblar fragmentos de paquetes IP recibidos.</span><span class="sxs-lookup"><span data-stu-id="8016a-413">It is especially useful in assembling received IP packet fragments.</span></span>

<span data-ttu-id="8016a-414">***Marcas de 3 bits*** Este campo contiene información de fragmentación de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-414">***3-bit flags*** This field contains IP fragmentation information.</span></span> <span data-ttu-id="8016a-415">El bit 14 es el bit "no fragmentar".</span><span class="sxs-lookup"><span data-stu-id="8016a-415">Bit 14 is the "don't fragment" bit.</span></span> <span data-ttu-id="8016a-416">Si se establece este bit, el datagrama IP saliente no se fragmentará.</span><span class="sxs-lookup"><span data-stu-id="8016a-416">If this bit is set, the outgoing IP datagram will not be fragmented.</span></span> <span data-ttu-id="8016a-417">El bit 13 es el bit "más fragmentos".</span><span class="sxs-lookup"><span data-stu-id="8016a-417">Bit 13 is the "more fragments" bit.</span></span> <span data-ttu-id="8016a-418">Si se establece este bit, hay más fragmentos.</span><span class="sxs-lookup"><span data-stu-id="8016a-418">If this bit is set, there are more fragments.</span></span> <span data-ttu-id="8016a-419">Si este bit está a cero, se trata del último fragmento del paquete IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-419">If this bit is clear, this is the last fragment of the IP packet.</span></span>

<span data-ttu-id="8016a-420">**Propósito del campo del encabezado IP**</span><span class="sxs-lookup"><span data-stu-id="8016a-420">**IP Header Field Purpose**</span></span>

<span data-ttu-id="8016a-421">***Desplazamiento del fragmento de 13 bits*** Este campo contiene los 13 bits superiores del desplazamiento del fragmento.</span><span class="sxs-lookup"><span data-stu-id="8016a-421">***13-bit fragment offset*** This field contains the upper 13-bits of the fragment offset.</span></span> <span data-ttu-id="8016a-422">Por este motivo, los desplazamientos de fragmentos solo se permiten en límites de 8 bytes.</span><span class="sxs-lookup"><span data-stu-id="8016a-422">Because of this, fragment offsets are only allowed on 8-byte boundaries.</span></span> <span data-ttu-id="8016a-423">El primer fragmento de un datagrama IP fragmentado tendrá el bit "más fragmentos" establecido y tendrá un desplazamiento de 0.</span><span class="sxs-lookup"><span data-stu-id="8016a-423">The first fragment of a fragmented IP datagram will have the “more fragments” bit set and have an offset of 0.</span></span>

<span data-ttu-id="8016a-424">***Período de vida (TTL) de 8 bits*** Este campo contiene el número de enrutadores que puede pasar este datagrama, lo que limita la vigencia del datagrama.</span><span class="sxs-lookup"><span data-stu-id="8016a-424">***8-bit time to live (TTL)*** This field contains the number of routers this datagram can pass, which limits the lifetime of the datagram.</span></span>

<span data-ttu-id="8016a-425">***Protocolo de 8 bits*** Este campo especifica el protocolo que usa el datagrama IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-425">***8-bit protocol*** This field specifies which protocol is using the IP datagram.</span></span> <span data-ttu-id="8016a-426">A continuación se muestra una lista de protocolos válidos y sus valores:</span><span class="sxs-lookup"><span data-stu-id="8016a-426">The following is a list of valid protocols and their values:</span></span>

| <span data-ttu-id="8016a-427">Protocolo</span><span class="sxs-lookup"><span data-stu-id="8016a-427">Protocol</span></span> | <span data-ttu-id="8016a-428">Value</span><span class="sxs-lookup"><span data-stu-id="8016a-428">Value</span></span> |
|----------|-------|
| <span data-ttu-id="8016a-429">ICMP</span><span class="sxs-lookup"><span data-stu-id="8016a-429">ICMP</span></span>     | <span data-ttu-id="8016a-430">0x01</span><span class="sxs-lookup"><span data-stu-id="8016a-430">0x01</span></span>  |
| <span data-ttu-id="8016a-431">IGMP</span><span class="sxs-lookup"><span data-stu-id="8016a-431">IGMP</span></span>     | <span data-ttu-id="8016a-432">0x02</span><span class="sxs-lookup"><span data-stu-id="8016a-432">0x02</span></span>  |
| <span data-ttu-id="8016a-433">TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-433">TCP</span></span>      | <span data-ttu-id="8016a-434">0X06</span><span class="sxs-lookup"><span data-stu-id="8016a-434">0X06</span></span>  |
| <span data-ttu-id="8016a-435">UDP</span><span class="sxs-lookup"><span data-stu-id="8016a-435">UDP</span></span>      | <span data-ttu-id="8016a-436">0X11</span><span class="sxs-lookup"><span data-stu-id="8016a-436">0X11</span></span>  |
|          |       |


<span data-ttu-id="8016a-437">***Suma de comprobación de 16 bits*** Este campo contiene la suma de comprobación de 16 bits solo para el encabezado IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-437">***16-bit checksum*** This field contains the 16-bit checksum that covers the IP header only.</span></span> <span data-ttu-id="8016a-438">Hay sumas de comprobación adicionales en los protocolos de nivel superior para la carga de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-438">There are additional checksums in the higher level protocols that cover the IP payload.</span></span>

<span data-ttu-id="8016a-439">***Dirección IP de origen de 32 bits*** Este campo contiene la dirección IP del remitente y siempre es una dirección de host.</span><span class="sxs-lookup"><span data-stu-id="8016a-439">***32-bit source IP address*** This field contains the IP address of the sender and is always a host address.</span></span>

<span data-ttu-id="8016a-440">***Dirección IP de destino de 32 bits*** Este campo contiene la dirección IP del receptor o receptores, si la dirección es una dirección de difusión o multidifusión.</span><span class="sxs-lookup"><span data-stu-id="8016a-440">***32-bit destination IP address*** This field contains the IP address of the receiver or receivers if the address is a broadcast or multicast address.</span></span>

### <a name="creating-ip-instances"></a><span data-ttu-id="8016a-441">Creación de instancias de IP</span><span class="sxs-lookup"><span data-stu-id="8016a-441">Creating IP Instances</span></span>

<span data-ttu-id="8016a-442">Las instancias de IP se crean durante la inicialización o en tiempo de ejecución mediante subprocesos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-442">IP instances are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="8016a-443">El servicio *nx_ip_create* define la dirección IP inicial, la máscara de red, el grupo de paquetes predeterminado, el controlador del soporte físico y la memoria y la prioridad del subproceso de IP interno.</span><span class="sxs-lookup"><span data-stu-id="8016a-443">The initial IP address, network mask, default packet pool, media driver, and memory and priority of the internal IP thread are defined by the *nx_ip_create* service.</span></span> <span data-ttu-id="8016a-444">Si la aplicación inicializa la instancia de IP con su dirección IP establecida en una dirección no válida (0.0.0.0), se supone que la dirección de la interfaz va a ser resuelta con una configuración manual más adelante, mediante RARP, DHCP o protocolos similares.</span><span class="sxs-lookup"><span data-stu-id="8016a-444">If the application initializes the IP instance with its IP address set to an invalid address(0.0.0.0), it is assumed that the interface address is going to resolved by manual configuration later, via RARP, or through DHCP or similar protocols.</span></span>

<span data-ttu-id="8016a-445">En sistemas con varias interfaces de red, la interfaz principal se designa al llamar a *nx_ip_create*.</span><span class="sxs-lookup"><span data-stu-id="8016a-445">For systems with multiple network interfaces, the primary interface is designated when calling *nx_ip_create*.</span></span> <span data-ttu-id="8016a-446">Cada interfaz adicional se puede conectar a la misma instancia de IP mediante una llamada a *nx_ip_interface_attach*.</span><span class="sxs-lookup"><span data-stu-id="8016a-446">Each additional interface can be attached to the same IP instance by calling *nx_ip_interface_attach*.</span></span> <span data-ttu-id="8016a-447">Este servicio almacena información sobre la interfaz de red (como la dirección IP o la máscara de red) en el bloque de control de la interfaz y asocia la instancia del controlador con el bloque de control de la interfaz en la instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-447">This service stores information about the network interface (such as IP address, network mask) in the interface control block, and associates the driver instance with the interface control block in the IP instance.</span></span> <span data-ttu-id="8016a-448">Cuando el controlador recibe un paquete de datos, debe almacenar la información de la interfaz en la estructura NX_PACKET antes de reenviarlo a la lógica de recepción de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-448">As the driver receives a data packet, it needs to store the interface information in the NX_PACKET structure before forwarding it to the IP receive logic.</span></span> <span data-ttu-id="8016a-449">Tenga en cuenta que se debe haber creado una instancia de IP antes de conectar cualquier interfaz.</span><span class="sxs-lookup"><span data-stu-id="8016a-449">Note an IP instance must already be created before attaching any interfaces.</span></span>

 ### <a name="ip-send"></a><span data-ttu-id="8016a-450">Envío de IP</span><span class="sxs-lookup"><span data-stu-id="8016a-450">IP Send</span></span>
 <span data-ttu-id="8016a-451">El procesamiento del envío de IP en NetX está muy optimizado.</span><span class="sxs-lookup"><span data-stu-id="8016a-451">The IP send processing in NetX is very streamlined.</span></span>

<span data-ttu-id="8016a-452">El puntero antepuesto del paquete se mueve hacia atrás para acomodar el encabezado IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-452">The prepend pointer in the packet is moved backwards to accommodate the IP header.</span></span> <span data-ttu-id="8016a-453">Se completa el encabezado IP (con todas las opciones especificadas por la capa de protocolo que realiza la llamada), se calcula en línea la suma de comprobación de IP y se envía el paquete al controlador de red asociado.</span><span class="sxs-lookup"><span data-stu-id="8016a-453">The IP header is completed (with all the options specified by the calling protocol layer), the IP checksum is computed in-line, and the packet is dispatched to the associated network driver.</span></span> <span data-ttu-id="8016a-454">Además, la fragmentación de salida también se coordina desde el procesamiento de envío de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-454">In addition, outgoing fragmentation is also coordinated from within the IP send processing.</span></span>

<span data-ttu-id="8016a-455">En el caso de IP, NetX inicia solicitudes ARP si se necesita asignación física para la dirección IP de destino.</span><span class="sxs-lookup"><span data-stu-id="8016a-455">For IP, NetX initiates ARP requests if physical mapping is needed for the destination IP address.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-456">*En cuanto a la conectividad IP, los paquetes que requieren la resolución de direcciones IP (por ejemplo, la asignación física) se ponen en la cola de ARP hasta que el número de paquetes de la cola supera la profundidad de la cola de ARP (definida por el* *símbolo **NX_ARP_MAX_QUEUE_DEPTH**). Si se alcanza la profundidad de la* *cola, NetX quitará el paquete más antiguo de la cola y seguirá esperando a la resolución de direcciones para el resto de paquetes en cola. Por otro lado, si no se resuelve una entrada de ARP, los paquetes pendientes en la entrada de ARP se liberan tras el tiempo de espera de entrada de ARP.*</span><span class="sxs-lookup"><span data-stu-id="8016a-456">*For IP connectivity, packets that require IP address resolution (i.e., physical mapping) are enqueued on the ARP queue until the number of packets queued exceeds the ARP queue depth (defined by the* *symbol **NX_ARP_MAX_QUEUE_DEPTH**). If the* *queue depth is reached, NetX will remove the oldest packet on the queue and continue waiting for address resolution for the remaining packets enqueued. On the other hand, if an ARP entry is not resolved, the pending packets on the ARP entry are released upon ARP entry timeout.*</span></span>

<span data-ttu-id="8016a-457">En el caso de sistemas con varias interfaces de red, NetX elige una interfaz en función de la dirección IP de destino.</span><span class="sxs-lookup"><span data-stu-id="8016a-457">For systems with multiple network interfaces, NetX chooses an interface based on the destination IP address.</span></span> <span data-ttu-id="8016a-458">El siguiente procedimiento se aplica al proceso de selección:</span><span class="sxs-lookup"><span data-stu-id="8016a-458">The following procedure applies to the selection process:</span></span>

1. <span data-ttu-id="8016a-459">Si una dirección de destino es de difusión o multidifusión IP y se especifica una interfaz de salida válida, se usa esa interfaz.</span><span class="sxs-lookup"><span data-stu-id="8016a-459">If a destination address is IP broadcast or multicast, and if a valid outgoing interface is specified, use that interface.</span></span> <span data-ttu-id="8016a-460">De lo contrario, se usa la primera interfaz física.</span><span class="sxs-lookup"><span data-stu-id="8016a-460">Otherwise, the first physical interface is used.</span></span>

2. <span data-ttu-id="8016a-461">Si la dirección de destino se encuentra en la tabla de enrutamiento estático, se usa la interfaz asociada a la puerta de enlace.</span><span class="sxs-lookup"><span data-stu-id="8016a-461">If the destination address is found in the static routing table, the interface associated with the gateway is used.</span></span>

3. <span data-ttu-id="8016a-462">Si el destino es en vínculo, se usa la interfaz en vínculo.</span><span class="sxs-lookup"><span data-stu-id="8016a-462">If the destination is on-link, the on-link interface is used.</span></span>

4. <span data-ttu-id="8016a-463">Si la dirección de destino es una dirección de bucle invertido 127.0.0.1, se usa la interfaz de bucle invertido.</span><span class="sxs-lookup"><span data-stu-id="8016a-463">If the destination address is a loopback address 127.0.0.1, the loopback interface is used.</span></span>

5. <span data-ttu-id="8016a-464">Si la puerta de enlace predeterminada está configurada correctamente, se usa la interfaz asociada a la puerta de enlace predeterminada para transmitir el paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-464">If the default gateway is properly configured, use the interface associated with the default gateway to transmit the packet.</span></span>

6. <span data-ttu-id="8016a-465">El paquete de salida se elimina si se produce un error en todo lo anterior.</span><span class="sxs-lookup"><span data-stu-id="8016a-465">The output packet is dropped if all the above fails.</span></span>

### <a name="ip-receive"></a><span data-ttu-id="8016a-466">Recepción de IP</span><span class="sxs-lookup"><span data-stu-id="8016a-466">IP Receive</span></span>

<span data-ttu-id="8016a-467">El procesamiento de recepción de IP se llama desde el controlador de red o desde el subproceso de IP interno (para procesar los paquetes de la cola de paquetes recibidos diferida).</span><span class="sxs-lookup"><span data-stu-id="8016a-467">The IP receive processing is either called from the network driver or the internal IP thread (for processing packets on the deferred received packet queue).</span></span> <span data-ttu-id="8016a-468">El procesamiento de recepción de IP examina el campo de protocolo e intenta enviar el paquete al componente de protocolo adecuado.</span><span class="sxs-lookup"><span data-stu-id="8016a-468">The IP receive processing examines the protocol field and attempts to dispatch the packet to the proper protocol component.</span></span> <span data-ttu-id="8016a-469">Antes de que el paquete se envíe realmente, el encabezado IP se quita adelantando el puntero antepuesto después del encabezado IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-469">Before the packet is actually dispatched, the IP header is removed by advancing the prepend pointer past the IP header.</span></span>

<span data-ttu-id="8016a-470">El procesamiento de recepción de IP también detecta paquetes IP fragmentados y realiza los pasos necesarios para volver a ensamblarlos si está habilitada la fragmentación.</span><span class="sxs-lookup"><span data-stu-id="8016a-470">IP receive processing also detects fragmented IP packets and performs the necessary steps to reassemble them if fragmentation is enabled.</span></span> <span data-ttu-id="8016a-471">Si la fragmentación es necesaria pero no está habilitada, se elimina el paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-471">If fragmentation is needed but not enabled, the packet is dropped.</span></span>

<span data-ttu-id="8016a-472">NetX determina la interfaz de red adecuada en función de la interfaz especificada en el paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-472">NetX determines the appropriate network interface based on the interface specified in the packet.</span></span> <span data-ttu-id="8016a-473">Si la interfaz del paquete es NULL, el valor predeterminado de NetX es la interfaz principal.</span><span class="sxs-lookup"><span data-stu-id="8016a-473">If the packet interface is NULL, NetX defaults to the primary interface.</span></span> <span data-ttu-id="8016a-474">Esto se hace para garantizar la compatibilidad con controladores Ethernet de NetX heredados.</span><span class="sxs-lookup"><span data-stu-id="8016a-474">This is done to guarantee compatibility with legacy NetX Ethernet drivers.</span></span>

### <a name="raw-ip-send"></a><span data-ttu-id="8016a-475">Envío de IP sin formato</span><span class="sxs-lookup"><span data-stu-id="8016a-475">Raw IP Send</span></span>

<span data-ttu-id="8016a-476">Un paquete IP sin formato es un marco IP que contiene una carga de protocolo de nivel superior no admitida directamente (ni procesada) por NetX.</span><span class="sxs-lookup"><span data-stu-id="8016a-476">A raw IP packet is an IP frame that contains upper layer protocol payload not directly supported (and processed) by NetX.</span></span> <span data-ttu-id="8016a-477">Un paquete sin formato permite a los desarrolladores definir sus propias aplicaciones basadas en IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-477">A raw packet allows developers to define their own IP-based applications.</span></span> <span data-ttu-id="8016a-478">Una aplicación puede enviar paquetes IP sin formato directamente mediante el servicio ***nx_ip_raw_packet_send** _ si se ha habilitado el procesamiento de paquetes IP sin formato con el servicio _*_nx_ip_raw_packet_enabled_\*_.</span><span class="sxs-lookup"><span data-stu-id="8016a-478">An application may send raw IP packets directly using the ***nx_ip_raw_packet_send** _ service if raw IP packet processing has been enabled with the _*_nx_ip_raw_packet_enabled_\*_ service.</span></span> <span data-ttu-id="8016a-479">Sin embargo, si la dirección de destino es una dirección de multidifusión o de difusión, el valor predeterminado de NetX es la primera interfaz (principal).</span><span class="sxs-lookup"><span data-stu-id="8016a-479">If the destination address is a multicast or broadcast address, however, NetX defaults to the first (primary) interface.</span></span> <span data-ttu-id="8016a-480">Por lo tanto, para enviar estos paquetes mediante las interfaces secundarias, la aplicación debe usar el servicio _ *_nx_ip_raw_packet_interface_send_*\* para especificar la dirección de origen que se va a utilizar para el paquete saliente.</span><span class="sxs-lookup"><span data-stu-id="8016a-480">Therefore, to send such packets out on secondary interfaces, the application must use the _ *_nx_ip_raw_packet_interface_send_*\* service to specify the source address to use for the outgoing packet.</span></span>

### <a name="raw-ip-receive"></a><span data-ttu-id="8016a-481">Recepción de IP sin formato</span><span class="sxs-lookup"><span data-stu-id="8016a-481">Raw IP Receive</span></span>

<span data-ttu-id="8016a-482">Si está habilitado el procesamiento de paquetes IP sin formato, la aplicación puede recibir paquetes IP sin formato mediante el servicio \***nx_ip_raw_packet_receive** _.</span><span class="sxs-lookup"><span data-stu-id="8016a-482">If raw IP packet processing is enabled, the application may receive raw IP packets through the \***nx_ip_raw_packet_receive** _ service.</span></span> <span data-ttu-id="8016a-483">Todos los paquetes entrantes se procesan según el protocolo especificado en el encabezado IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-483">All incoming packets are processed according to the protocol specified in the IP header.</span></span> <span data-ttu-id="8016a-484">Si el protocolo especifica UDP, TCP, IGMP o ICMP, NetX procesará el paquete con el controlador adecuado para el tipo de protocolo del paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-484">If the protocol specifies UDP, TCP, IGMP or ICMP, NetX will process the packet using the appropriate handler for the packet protocol type.</span></span> <span data-ttu-id="8016a-485">Si el protocolo no es uno de estos protocolos y está habilitada la recepción de IP sin formato, el paquete entrante se colocará en la cola de paquetes sin formato en espera de que la aplicación la reciba mediante el servicio _ \*_nx_ip_raw_packet_receive_\*\*.</span><span class="sxs-lookup"><span data-stu-id="8016a-485">If the protocol is not one of these protocols, and raw IP receive is enabled, the incoming packet will be put into the raw packet queue waiting for the application to receive it via the _ *_nx_ip_raw_packet_receive_*\* service.</span></span> <span data-ttu-id="8016a-486">Además, los subprocesos de la aplicación se pueden suspender con un tiempo de espera opcional mientras esperan un paquete IP sin formato.</span><span class="sxs-lookup"><span data-stu-id="8016a-486">In addition, application threads may suspend with an optional timeout while waiting for a raw IP packet.</span></span>

### <a name="default-packet-pool"></a><span data-ttu-id="8016a-487">Grupo de paquetes predeterminado</span><span class="sxs-lookup"><span data-stu-id="8016a-487">Default Packet Pool</span></span>

<span data-ttu-id="8016a-488">A cada instancia de IP se le asigna un grupo de paquetes predeterminado durante la creación.</span><span class="sxs-lookup"><span data-stu-id="8016a-488">Each IP instance is given a default packet pool during creation.</span></span> <span data-ttu-id="8016a-489">Este grupo de paquetes se usa para asignar paquetes para ARP, RARP, ICMP, IGMP y varios paquetes de control de TCP (como SYN o ACK).</span><span class="sxs-lookup"><span data-stu-id="8016a-489">This packet pool is used to allocate packets for ARP, RARP, ICMP, IGMP, various TCP control packets (such as SYN, ACK).</span></span> <span data-ttu-id="8016a-490">Si el grupo de paquetes predeterminado está vacío cuando NetX necesita asignar un paquete, NetX puede tener que cancelar esa operación específica y devolverá un mensaje de error si es posible.</span><span class="sxs-lookup"><span data-stu-id="8016a-490">If the default packet pool is empty when NetX needs to allocate a packet, NetX may have to abort the particular operation, and will return an error message if possible.</span></span>

### <a name="ip-helper-thread"></a><span data-ttu-id="8016a-491">Subproceso auxiliar de IP</span><span class="sxs-lookup"><span data-stu-id="8016a-491">IP Helper Thread</span></span>

<span data-ttu-id="8016a-492">Cada instancia de IP tiene un subproceso auxiliar.</span><span class="sxs-lookup"><span data-stu-id="8016a-492">Each IP instance has a helper thread.</span></span> <span data-ttu-id="8016a-493">Este subproceso es responsable de controlar todo el procesamiento de paquetes diferido y todo el procesamiento periódico.</span><span class="sxs-lookup"><span data-stu-id="8016a-493">This thread is responsible for handling all deferred packet processing and all periodic processing.</span></span> <span data-ttu-id="8016a-494">El subproceso auxiliar de IP se crea en ***nx_ip_create***.</span><span class="sxs-lookup"><span data-stu-id="8016a-494">The IP helper thread is created in ***nx_ip_create.***</span></span> <span data-ttu-id="8016a-495">Aquí es donde se asigna su pila y la prioridad al subproceso.</span><span class="sxs-lookup"><span data-stu-id="8016a-495">This is where the thread is given its stack and priority.</span></span> <span data-ttu-id="8016a-496">Tenga en cuenta que el primer procesamiento del subproceso auxiliar de IP es finalizar la inicialización del controlador de red asociado con el servicio de creación de IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-496">Note that the first processing in the IP helper thread is to finish the network driver initialization associated with the IP create service.</span></span> <span data-ttu-id="8016a-497">Una vez completada la inicialización del controlador de red, el subproceso auxiliar inicia un bucle sin fin para procesar paquetes y solicitudes periódicas.</span><span class="sxs-lookup"><span data-stu-id="8016a-497">After the network driver initialization is complete, the helper thread starts an endless loop to process packet and periodic requests.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-498">*Si se observa un comportamiento no explicado en el subproceso auxiliar de IP, el primer paso de depuración es el aumento del tamaño de la pila durante el servicio de creación de IP. Si la pila es demasiado pequeña, es posible que el subproceso auxiliar de IP sobrescriba la memoria, lo que puede causar problemas inusuales.*</span><span class="sxs-lookup"><span data-stu-id="8016a-498">*If unexplained behavior is seen within the IP helper thread, increasing its stack size during the IP create service is the first debugging step. If the stack is too small, the IP helper thread could possibly be overwriting memory, which may cause unusual problems.*</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="8016a-499">Suspensión de subprocesos</span><span class="sxs-lookup"><span data-stu-id="8016a-499">Thread Suspension</span></span>

<span data-ttu-id="8016a-500">Los subprocesos de la aplicación se pueden suspender al intentar recibir paquetes IP sin formato.</span><span class="sxs-lookup"><span data-stu-id="8016a-500">Application threads can suspend while attempting to receive raw IP packets.</span></span> <span data-ttu-id="8016a-501">Después de recibir un paquete sin formato, se asigna el nuevo paquete al primer subproceso suspendido y se reanuda dicho subproceso.</span><span class="sxs-lookup"><span data-stu-id="8016a-501">After a raw packet is received, the new packet is given to the first thread suspended and that thread is resumed.</span></span> <span data-ttu-id="8016a-502">Todos los servicios de NetX para la recepción de paquetes tienen un tiempo de espera de suspensión opcional.</span><span class="sxs-lookup"><span data-stu-id="8016a-502">NetX services for receiving packets all have an optional suspension timeout.</span></span> <span data-ttu-id="8016a-503">Cuando se recibe un paquete o se agota el tiempo de espera, el subproceso de la aplicación se reanuda con el estado de finalización adecuado.</span><span class="sxs-lookup"><span data-stu-id="8016a-503">When a packet is received or the timeout expires, the application thread is resumed with the appropriate completion status.</span></span>

### <a name="ip-statistics-and-errors"></a><span data-ttu-id="8016a-504">Estadísticas y errores de IP</span><span class="sxs-lookup"><span data-stu-id="8016a-504">IP Statistics and Errors</span></span>

<span data-ttu-id="8016a-505">Si se habilita, NetX realiza un seguimiento de varias estadísticas y errores que pueden ser útiles para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-505">If enabled, the NetX keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="8016a-506">Se mantienen las estadísticas y los informes de errores siguientes para cada instancia de IP:</span><span class="sxs-lookup"><span data-stu-id="8016a-506">The following statistics and error reports are maintained for each IP instance:</span></span>

- <span data-ttu-id="8016a-507">Número total de paquetes IP enviados</span><span class="sxs-lookup"><span data-stu-id="8016a-507">Total IP Packets Sent</span></span>
- <span data-ttu-id="8016a-508">Número total de bytes IP enviados</span><span class="sxs-lookup"><span data-stu-id="8016a-508">Total IP Bytes Sent</span></span>
- <span data-ttu-id="8016a-509">Número total de paquetes IP recibidos</span><span class="sxs-lookup"><span data-stu-id="8016a-509">Total IP Packets Received</span></span>
- <span data-ttu-id="8016a-510">Número total de bytes IP recibidos</span><span class="sxs-lookup"><span data-stu-id="8016a-510">Total IP Bytes Received</span></span>
- <span data-ttu-id="8016a-511">Número total de paquetes IP no válidos</span><span class="sxs-lookup"><span data-stu-id="8016a-511">Total IP Invalid Packets</span></span>
- <span data-ttu-id="8016a-512">Número total de paquetes de recepción de IP eliminados</span><span class="sxs-lookup"><span data-stu-id="8016a-512">Total IP Receive Packets Dropped</span></span>
- <span data-ttu-id="8016a-513">Número total de errores de suma de comprobación de recepción de IP</span><span class="sxs-lookup"><span data-stu-id="8016a-513">Total IP Receive Checksum Errors</span></span>
- <span data-ttu-id="8016a-514">Número total de paquetes de envío de IP eliminados</span><span class="sxs-lookup"><span data-stu-id="8016a-514">Total IP Send Packets Dropped</span></span>
- <span data-ttu-id="8016a-515">Número total de fragmentos IP enviados</span><span class="sxs-lookup"><span data-stu-id="8016a-515">Total IP Fragments Sent</span></span>
- <span data-ttu-id="8016a-516">Número total de fragmentos IP recibidos</span><span class="sxs-lookup"><span data-stu-id="8016a-516">Total IP Fragments Received</span></span>

<span data-ttu-id="8016a-517">Todas estas estadísticas e informes de errores están disponibles para la aplicación con el servicio ***nx_ip_info_get***.</span><span class="sxs-lookup"><span data-stu-id="8016a-517">All of these statistics and error reports are available to the application with the ***nx_ip_info_get*** service.</span></span>

### <a name="ip-control-block-nx_ip"></a><span data-ttu-id="8016a-518">Bloque de control de IP NX_IP</span><span class="sxs-lookup"><span data-stu-id="8016a-518">IP Control Block NX_IP</span></span>

<span data-ttu-id="8016a-519">Las características de cada instancia de IP se encuentran en su bloque de control.</span><span class="sxs-lookup"><span data-stu-id="8016a-519">The characteristics of each IP instance are found in its control block.</span></span> <span data-ttu-id="8016a-520">Contiene información útil, como las direcciones IP y las máscaras de red de cada dispositivo de red, y una tabla de asignación de direcciones IP vecinas y hardware físico.</span><span class="sxs-lookup"><span data-stu-id="8016a-520">It contains useful information such as the IP addresses and network masks of each network device, and a table of neighbor IP and physical hardware address mapping.</span></span> <span data-ttu-id="8016a-521">Esta estructura se define en el archivo ***nx_api.h***. Los bloques de control de la instancia de IP se pueden ubicar en cualquier parte de la memoria, pero es más común convertir el bloque de control en una estructura global mediante su definición fuera del ámbito de cualquier función.</span><span class="sxs-lookup"><span data-stu-id="8016a-521">This structure is defined in the ***nx_api.h*** IP instance control blocks can be located anywhere in memory, but it is most common to make the control block a global structure by defining it outside the scope of any function.</span></span>

### <a name="static-ip-routing"></a><span data-ttu-id="8016a-522">Enrutamiento IP estático</span><span class="sxs-lookup"><span data-stu-id="8016a-522">Static IP Routing</span></span>

<span data-ttu-id="8016a-523">La característica de enrutamiento estático permite que una aplicación especifique una red IP y una dirección de próximo salto para direcciones IP de destino específicas fuera de la red.</span><span class="sxs-lookup"><span data-stu-id="8016a-523">The static routing feature allows an application to specify an IP network and next hop address for specific out of network destination IP addresses.</span></span> <span data-ttu-id="8016a-524">Si está habilitado el enrutamiento estático, NetX busca en la tabla de enrutamiento estática una entrada que coincida con la dirección de destino del paquete que se va a enviar.</span><span class="sxs-lookup"><span data-stu-id="8016a-524">If static routing is enabled, NetX searches through the static routing table for an entry matching the destination address of the packet to send.</span></span> <span data-ttu-id="8016a-525">Si no se encuentra ninguna coincidencia, NetX busca en la lista de interfaces físicas y elige una dirección IP de origen y una dirección del próximo salto en función de la dirección IP de destino y la máscara de red.</span><span class="sxs-lookup"><span data-stu-id="8016a-525">If no match is found, NetX searches through the list of physical interfaces and chooses a source IP address and next hop address based on the destination IP address and the network mask.</span></span> <span data-ttu-id="8016a-526">Si el destino no coincide con ninguna de las direcciones IP de los controladores de red conectados a la instancia de IP, NetX elige una interfaz que esté conectada directamente a la puerta de enlace predeterminada y usa la dirección IP de la interfaz como dirección de origen y la puerta de enlace predeterminada como el próximo salto.</span><span class="sxs-lookup"><span data-stu-id="8016a-526">If the destination does not match any of the IP addresses of the network drivers attached to the IP instance, NetX chooses an interface that is directly connected to the default gateway, and uses the IP address of the interface as source address, and the default gateway as the next hop.</span></span>

<span data-ttu-id="8016a-527">Se pueden agregar y quitar entradas de la tabla de enrutamiento estático mediante los servicios ***nx_ip_static_route_add*** y \***nx_ip_static_route_delete** _, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="8016a-527">Entries can be added and removed from the static routing table using the ***nx_ip_static_route_add*** and \***nx_ip_static_route_delete** _ services, respectively.</span></span> <span data-ttu-id="8016a-528">Para usar el enrutamiento estático, la aplicación host debe habilitar esta característica mediante la definición de _ *_NX_ENABLE_IP_STATIC_ROUTING_*.\*</span><span class="sxs-lookup"><span data-stu-id="8016a-528">To use static routing, the host application must enable this feature by defining _ *_NX_ENABLE_IP_STATIC_ROUTING_*.\*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-529">*Cuando se agrega una entrada a la tabla de enrutamiento estático, NetX comprueba si ya hay una entrada coincidente para la dirección de destino especificada en la tabla. Si existe una, da preferencia a la entrada con la red más pequeña (prefijo más largo) de la máscara de red.*</span><span class="sxs-lookup"><span data-stu-id="8016a-529">*When adding an entry to the static routing table, NetX checks for a matching entry for the specified destination address already in the table. If one exists, it gives preference to the entry with the smaller network (longer prefix) in the network mask.*</span></span>

### <a name="ip-fragmentation"></a><span data-ttu-id="8016a-530">Fragmentación de IP</span><span class="sxs-lookup"><span data-stu-id="8016a-530">IP Fragmentation</span></span>

<span data-ttu-id="8016a-531">El dispositivo de red puede tener límites en cuanto al tamaño de los paquetes salientes.</span><span class="sxs-lookup"><span data-stu-id="8016a-531">The network device may have limits on the size of outgoing packets.</span></span> <span data-ttu-id="8016a-532">Este límite se llama unidad de transmisión máxima (MTU).</span><span class="sxs-lookup"><span data-stu-id="8016a-532">This limit is called the maximum transmission unit (MTU).</span></span> <span data-ttu-id="8016a-533">La MTU de IP es el tamaño del marco IP más grande que un controlador de capa de vínculo puede transmitir sin fragmentar el paquete IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-533">IP MTU is the largest IP frame size a link layer driver is able to transmit without fragmenting the IP packet.</span></span> <span data-ttu-id="8016a-534">Durante la fase de inicialización de un controlador de dispositivo, el módulo del controlador debe configurar su tamaño de MTU de IP mediante el servicio \***nx_ip_interface_mtu_set**.\*</span><span class="sxs-lookup"><span data-stu-id="8016a-534">During a device driver initialization phase, the driver module must configure its IP MTU size via the service \***nx_ip_interface_mtu_set**.\*</span></span>

<span data-ttu-id="8016a-535">Aunque no se recomienda, la aplicación puede generar datagramas mayores que la MTU de IP subyacente admitida por el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="8016a-535">Although not recommended, the application may generate datagrams larger than the underlying IP MTU supported by the device.</span></span> <span data-ttu-id="8016a-536">Antes de transmitir este tipo de datagrama IP, la capa de IP debe fragmentar estos paquetes.</span><span class="sxs-lookup"><span data-stu-id="8016a-536">Before transmitting such IP datagram, the IP layer must fragment these packets.</span></span> <span data-ttu-id="8016a-537">Al recibir marcos IP fragmentados, el extremo receptor debe almacenar todos los marcos IP fragmentados con el mismo identificador de fragmentación y volver a ensamblarlos en orden.</span><span class="sxs-lookup"><span data-stu-id="8016a-537">On receiving fragmented IP frames, the receiving end must store all fragmented IP frames with the same fragmentation ID, and reassemble them in order.</span></span> <span data-ttu-id="8016a-538">Si la lógica de recepción de IP no puede recopilar todos los fragmentos para restaurar el marco de IP original a tiempo, se liberan todos los fragmentos.</span><span class="sxs-lookup"><span data-stu-id="8016a-538">If the IP receive logic is unable to collect all the fragments to restore the original IP frame in time, all the fragments are released.</span></span> <span data-ttu-id="8016a-539">Es el protocolo de la capa superior el que detecta esta pérdida de paquetes y se recupera de ella.</span><span class="sxs-lookup"><span data-stu-id="8016a-539">It is up to the upper layer protocol to detect such packet loss and recover from it.</span></span>

<span data-ttu-id="8016a-540">Con el fin de admitir la fragmentación de IP y la operación de reensamblado, el diseñador del sistema debe habilitar la característica de fragmentación de IP en NetX mediante el servicio ***nx_ip_fragment_enable***.</span><span class="sxs-lookup"><span data-stu-id="8016a-540">In order to support IP fragmentation and reassembly operation, the system designer must enable the IP fragmentation feature in NetX using the ***nx_ip_fragment_enable*** service.</span></span> <span data-ttu-id="8016a-541">Si esta característica no está habilitada, se descartan los paquetes IP fragmentados entrantes, así como los paquetes que superan la MTU del controlador de red.</span><span class="sxs-lookup"><span data-stu-id="8016a-541">If this feature is not enabled, incoming fragmented IP packets are discarded, as well as packets that exceed the network driver's MTU.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-542">*La lógica de fragmentación de IP se puede quitar por completo mediante la definición de*  \***NX_DISABLE_FRAGMENTATION** _ _al compilar la biblioteca de NetX.</span><span class="sxs-lookup"><span data-stu-id="8016a-542">*The IP Fragmentation logic can be removed completely by defining* \***NX_DISABLE_FRAGMENTATION** _ _when building theNetX library.</span></span> <span data-ttu-id="8016a-543">Esto ayuda a reducir el tamaño del código de NetX.\*</span><span class="sxs-lookup"><span data-stu-id="8016a-543">Doing so helps reduce the code size of NetX.\*</span></span>

## <a name="address-resolution-protocol-arp-in-ip"></a><span data-ttu-id="8016a-544">Protocolo de resolución de direcciones (ARP) en IP</span><span class="sxs-lookup"><span data-stu-id="8016a-544">Address Resolution Protocol (ARP) in IP</span></span>

<span data-ttu-id="8016a-545">El protocolo de resolución de direcciones (ARP) es responsable de asignar dinámicamente las direcciones IP de 32 bits a las de los soportes físicos subyacentes (RFC 826).</span><span class="sxs-lookup"><span data-stu-id="8016a-545">The Address Resolution Protocol (ARP) is responsible for dynamically mapping 32-bit IP addresses to those of the underlying physical media (RFC 826).</span></span> <span data-ttu-id="8016a-546">Ethernet es el soporte físico más típico y admite direcciones de 48 bits.</span><span class="sxs-lookup"><span data-stu-id="8016a-546">Ethernet is the most typical physical media, and it supports 48-bit addresses.</span></span> <span data-ttu-id="8016a-547">La necesidad de ARP viene determinada por el controlador de red proporcionado al servicio ***nx_ip_create***.</span><span class="sxs-lookup"><span data-stu-id="8016a-547">The need for ARP is determined by the network driver supplied to the ***nx_ip_create*** service.</span></span> <span data-ttu-id="8016a-548">Si se requiere asignación física, el controlador de red debe establecer la marca ***nx_interface_address_mapping_needed*** en la estructura de la interfaz.</span><span class="sxs-lookup"><span data-stu-id="8016a-548">If physical mapping is required, the network driver must set the flag ***nx_interface_address_mapping_needed*** in the interface strcuture.</span></span>

### <a name="arp-enable"></a><span data-ttu-id="8016a-549">Habilitación de ARP</span><span class="sxs-lookup"><span data-stu-id="8016a-549">ARP Enable</span></span>
<span data-ttu-id="8016a-550">Para que ARP funcione correctamente, primero se debe habilitar desde la aplicación con el servicio ***nx_arp_enable***.</span><span class="sxs-lookup"><span data-stu-id="8016a-550">For ARP to function properly, it must first be enabled by the application with the ***nx_arp_enable*** service.</span></span> <span data-ttu-id="8016a-551">Este servicio configura varias estructuras de datos para el procesamiento de ARP, incluida la creación de un área de memoria caché de ARP desde la memoria suministrada al servicio de habilitación de ARP.</span><span class="sxs-lookup"><span data-stu-id="8016a-551">This service sets up various data structures for ARP processing, including the creation of an ARP cache area from the memory supplied to the ARP enable service.</span></span>

### <a name="arp-cache"></a><span data-ttu-id="8016a-552">Memoria caché de ARP</span><span class="sxs-lookup"><span data-stu-id="8016a-552">ARP Cache</span></span>
<span data-ttu-id="8016a-553">La memoria caché de ARP se puede ver como una matriz de estructuras de datos de asignaciones de ARP internas.</span><span class="sxs-lookup"><span data-stu-id="8016a-553">The ARP cache can be viewed as an array of internal ARP mapping data structures.</span></span> <span data-ttu-id="8016a-554">Cada estructura interna es capaz de mantener la relación entre una dirección IP y una dirección de hardware físico.</span><span class="sxs-lookup"><span data-stu-id="8016a-554">Each internal structure is capable of maintaining the relationship between an IP address and a physical hardware address.</span></span> <span data-ttu-id="8016a-555">Además, cada estructura de datos tiene punteros de vínculo para que pueda formar parte de varias listas vinculadas.</span><span class="sxs-lookup"><span data-stu-id="8016a-555">In addition, each data structure has link pointers so it can be part of multiple linked lists.</span></span>

<span data-ttu-id="8016a-556">La aplicación puede buscar una dirección IP desde la memoria caché de ARP proporcionando una dirección MAC de hardware mediante el servicio \***nx_arp_ip_address_find** _ si la asignación existe en la tabla de ARP.</span><span class="sxs-lookup"><span data-stu-id="8016a-556">Application can look up an IP address from the ARP cache by supplying hardware MAC address using the service \***nx_arp_ip_address_find** _ if the mapping exists in the ARP table.</span></span> <span data-ttu-id="8016a-557">De forma similar, el servicio _ *_nx_arp_hardware_address_find_*\* devuelve la dirección MAC correspondiente a una dirección IP determinada.</span><span class="sxs-lookup"><span data-stu-id="8016a-557">Similarly, the service _ *_nx_arp_hardware_address_find_*\* returns the MAC address for a given IP address.</span></span>


### <a name="arp-dynamic-entries"></a><span data-ttu-id="8016a-558">Entradas dinámicas de ARP</span><span class="sxs-lookup"><span data-stu-id="8016a-558">ARP Dynamic Entries</span></span>

<span data-ttu-id="8016a-559">De manera predeterminada, el servicio de habilitación de ARP coloca todas las entradas de la memoria caché de ARP en la lista de entradas de ARP dinámicas disponibles.</span><span class="sxs-lookup"><span data-stu-id="8016a-559">By default, the ARP enable service places all entries in the ARP cache on the list of available dynamic ARP entries.</span></span> <span data-ttu-id="8016a-560">NetX asigna una entrada de ARP dinámica de esta lista cuando se detecta una solicitud de envío a una dirección IP no asignada.</span><span class="sxs-lookup"><span data-stu-id="8016a-560">A dynamic ARP entry is allocated from this list by NetX when a send request to an unmapped IP address is detected.</span></span> <span data-ttu-id="8016a-561">Después de la asignación, se configura la entrada de ARP y se envía una solicitud ARP al soporte físico.</span><span class="sxs-lookup"><span data-stu-id="8016a-561">After allocation, the ARP entry is set up and an ARP request is sent to the physical media.</span></span>

<span data-ttu-id="8016a-562">También se puede crear una entrada dinámica mediante el servicio ***nx_arp_dynamic_entry_set***.</span><span class="sxs-lookup"><span data-stu-id="8016a-562">A dynamic entry can also be created by the service ***nx_arp_dynamic_entry_set***.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-563">*Si todas las entradas de ARP dinámicas están en uso, la entrada de ARP usada menos recientemente se reemplaza por una nueva asignación.*</span><span class="sxs-lookup"><span data-stu-id="8016a-563">*If all dynamic ARP entries are in use, the least recently used ARP entry is replaced with a new mapping.*</span></span>

### <a name="arp-static-entries"></a><span data-ttu-id="8016a-564">Entradas estáticas de ARP</span><span class="sxs-lookup"><span data-stu-id="8016a-564">ARP Static Entries</span></span>
<span data-ttu-id="8016a-565">La aplicación también puede configurar una asignación de ARP estática mediante el servicio ***nx_arp_static_entry_create***.</span><span class="sxs-lookup"><span data-stu-id="8016a-565">The application can also set up static ARP mapping by using the ***nx_arp_static_entry_create*** service.</span></span> <span data-ttu-id="8016a-566">Este servicio asigna una entrada de ARP de la lista de entradas de ARP dinámicas y la coloca en la lista estática con la información de asignación proporcionada por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-566">This service allocates an ARP entry from the dynamic ARP entry list and places it on the static list with the mapping information supplied by the application.</span></span> <span data-ttu-id="8016a-567">Las entradas de ARP estáticas no están sujetas a reutilización o caducidad.</span><span class="sxs-lookup"><span data-stu-id="8016a-567">Static ARP entries are not subject to reuse or aging.</span></span> <span data-ttu-id="8016a-568">La aplicación puede eliminar una entrada estática mediante el servicio ***nx_arp_static_entry_delete***.</span><span class="sxs-lookup"><span data-stu-id="8016a-568">The application can delete a static entry by using the service ***nx_arp_static_entry_delete***.</span></span>
<span data-ttu-id="8016a-569">Para quitar todas las entradas estáticas de la tabla de ARP, la aplicación puede utilizar el servicio ***nx_arp_static_entries_delete***.</span><span class="sxs-lookup"><span data-stu-id="8016a-569">To remove all static entries in the ARP table, the application may use the service ***nx_arp_static_entries_delete***.</span></span>

### <a name="automatic-arp-entry"></a><span data-ttu-id="8016a-570">Entrada de ARP automática</span><span class="sxs-lookup"><span data-stu-id="8016a-570">Automatic ARP Entry</span></span>
<span data-ttu-id="8016a-571">NetX registra la asignación entre IP y MAC del nodo del mismo nivel después de las respuestas del nodo del mismo nivel a la solicitud ARP.</span><span class="sxs-lookup"><span data-stu-id="8016a-571">NetX records the peer's IP/MAC mapping after the peer responses to the ARP request.</span></span> <span data-ttu-id="8016a-572">NetX también implementa la característica de entrada de ARP automática, con la que se registra la asignación de direcciones IP y MAC del nodo del mismo nivel en función de solicitudes ARP no solicitadas desde la red.</span><span class="sxs-lookup"><span data-stu-id="8016a-572">NetX also implements the automatic ARP entry feature where it records peer IP/MAC address mapping based on unsolicited ARP requests from the network.</span></span> <span data-ttu-id="8016a-573">Esta característica permite que la tabla de ARP se rellene con información de los nodos del mismo nivel, lo que reduce el retraso necesario para pasar por el ciclo de solicitud y respuesta de ARP.</span><span class="sxs-lookup"><span data-stu-id="8016a-573">This feature allows the ARP table to be populated with peer information, reducing the delay needed to go through the ARP request/response cycle.</span></span> <span data-ttu-id="8016a-574">Sin embargo, el inconveniente de habilitar ARP automático es que la tabla de ARP tiende a llenarse rápidamente en una red ocupada con muchos nodos en el vínculo local, lo que finalmente provocaría el reemplazo de las entradas de ARP.</span><span class="sxs-lookup"><span data-stu-id="8016a-574">However the downside with enabling automatic ARP is that the ARP table tend to fill up quickly on a busy network with many nodes on the local link, which would eventually lead to ARP entry replacement.</span></span>

<span data-ttu-id="8016a-575">Esta característica está habilitada de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="8016a-575">This feature is enabled by default.</span></span> <span data-ttu-id="8016a-576">Para deshabilitarla, se debe compilar la biblioteca de NetX con el símbolo ***NX_DISABLE_ARP_AUTO_ENTRY*** definido.</span><span class="sxs-lookup"><span data-stu-id="8016a-576">To disable it, the NetX library must be compiled with the symbol ***NX_DISABLE_ARP_AUTO_ENTRY*** defined.</span></span>

### <a name="arp-messages"></a><span data-ttu-id="8016a-577">Mensajes de ARP</span><span class="sxs-lookup"><span data-stu-id="8016a-577">ARP Messages</span></span>

<span data-ttu-id="8016a-578">Como se ha mencionado anteriormente, se envía un mensaje de solicitud ARP cuando la tarea de IP detecta que es necesaria una asignación para una dirección IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-578">As mentioned previously, an ARP request message is sent when the IP task detects that mapping is needed for an IP address.</span></span> <span data-ttu-id="8016a-579">Las solicitudes ARP se envían periódicamente (cada \***NX_ARP_UPDATE_RATE** _ segundos) hasta que se recibe una respuesta de ARP correspondiente.</span><span class="sxs-lookup"><span data-stu-id="8016a-579">ARP requests are sent periodically (every \***NX_ARP_UPDATE_RATE** _ seconds) until a corresponding ARP response is received.</span></span> <span data-ttu-id="8016a-580">Se realiza un total de _ *_NX_ARP_MAXIMUM_RETRIES_*\* solicitudes ARP antes de que se abandone el intento de ARP.</span><span class="sxs-lookup"><span data-stu-id="8016a-580">A total of _ *_NX_ARP_MAXIMUM_RETRIES_*\* ARP requests are made before the ARP attempt is abandoned.</span></span> <span data-ttu-id="8016a-581">Cuando se recibe una respuesta de ARP, la información de la dirección física asociada se almacena en la entrada de ARP que se encuentra en la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="8016a-581">When an ARP response is received, the associated physical address information is stored in the ARP entry that is in the cache.</span></span>

<span data-ttu-id="8016a-582">En el caso de los sistemas de host múltiple, NetX determina la interfaz que va a enviar las solicitudes y respuestas de ARP en función de la dirección de destino especificada.</span><span class="sxs-lookup"><span data-stu-id="8016a-582">For multihome systems, NetX determines which interface to send the ARP requests and responses based on destination address specified.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-583">*Los paquetes IP salientes se ponen en cola mientras que NetX espera la respuesta de ARP. El número de paquetes* *IP salientes en cola se define mediante la constante* \***NX_ARP_MAX_QUEUE_DEPTH**.\*</span><span class="sxs-lookup"><span data-stu-id="8016a-583">*Outgoing IP packets are queued while NetX waits for the ARP response. The number of outgoing IP* *packets queued is defined by the constant* \***NX_ARP_MAX_QUEUE_DEPTH**.\*</span></span>

<span data-ttu-id="8016a-584">NetX también responde a las solicitudes ARP de otros nodos de la red IP local.</span><span class="sxs-lookup"><span data-stu-id="8016a-584">NetX also responds to ARP requests from other nodes on the local IP network.</span></span> <span data-ttu-id="8016a-585">Cuando se realiza una solicitud ARP externa que coincide con la dirección IP actual de la interfaz que recibe la solicitud ARP, NetX crea un mensaje de respuesta de ARP que contiene la dirección física actual.</span><span class="sxs-lookup"><span data-stu-id="8016a-585">When an external ARP request is made that matches the current IP address of the interface that receives the ARP request, NetX builds an ARP response message that contains the current physical address.</span></span>

<span data-ttu-id="8016a-586">Los formatos de solicitudes y respuestas de ARP para Ethernet se muestran en la figura 6 y se describen a continuación:</span><span class="sxs-lookup"><span data-stu-id="8016a-586">The formats of Ethernet ARP requests and responses are shown in Figure 6 and are described below:</span></span>

| <span data-ttu-id="8016a-587">Campo de la solicitud o respuesta</span><span class="sxs-lookup"><span data-stu-id="8016a-587">Request/Response Field</span></span>       | <span data-ttu-id="8016a-588">Propósito</span><span class="sxs-lookup"><span data-stu-id="8016a-588">Purpose</span></span>    |
|------------------------------|-----------------|
| <span data-ttu-id="8016a-589">Dirección Ethernet de destino</span><span class="sxs-lookup"><span data-stu-id="8016a-589">Ethernet Destination Address</span></span> | <span data-ttu-id="8016a-590">Este campo de 6 bytes contiene la dirección de destino de la respuesta de ARP y es de tipo difusión (todo unos) para las solicitudes ARP.</span><span class="sxs-lookup"><span data-stu-id="8016a-590">This 6-byte field contains the destination address for the ARP response and is a broadcast (all ones) for ARP requests.</span></span> <span data-ttu-id="8016a-591">Este campo lo configura el controlador de red.</span><span class="sxs-lookup"><span data-stu-id="8016a-591">This field is setup by the network driver.</span></span> |
| <span data-ttu-id="8016a-592">Dirección Ethernet de origen</span><span class="sxs-lookup"><span data-stu-id="8016a-592">Ethernet Source Address</span></span>      | <span data-ttu-id="8016a-593">Este campo de 6 bytes contiene la dirección del remitente de la solicitud o respuesta de ARP y lo configura el controlador de red.</span><span class="sxs-lookup"><span data-stu-id="8016a-593">This 6-byte field contains the address of the sender of the ARP request or response and is set up by the network driver.</span></span> |
| <span data-ttu-id="8016a-594">Tipo de marco</span><span class="sxs-lookup"><span data-stu-id="8016a-594">Frame Type</span></span>                   | <span data-ttu-id="8016a-595">Este campo de 2 bytes contiene el tipo de marco Ethernet presente y, para las solicitudes y respuestas de ARP, es igual a 0x0806.</span><span class="sxs-lookup"><span data-stu-id="8016a-595">This 2-byte field contains the type of Ethernet frame present and, for ARP requests and responses, this is equal to 0x0806.</span></span> <span data-ttu-id="8016a-596">Este es el último campo que el controlador de red es responsable de configurar.</span><span class="sxs-lookup"><span data-stu-id="8016a-596">This is the last field the network driver is responsible for setting up.</span></span> |
| <span data-ttu-id="8016a-597">Tipo de hardware</span><span class="sxs-lookup"><span data-stu-id="8016a-597">Hardware Type</span></span>                | <span data-ttu-id="8016a-598">Este campo de 2 bytes contiene el tipo de hardware, que es 0x0001 para Ethernet.</span><span class="sxs-lookup"><span data-stu-id="8016a-598">This 2-byte field contains the hardware type, which is 0x0001 for Ethernet.</span></span> |
| <span data-ttu-id="8016a-599">Tipo de protocolo</span><span class="sxs-lookup"><span data-stu-id="8016a-599">Protocol Type</span></span>                | <span data-ttu-id="8016a-600">Este campo de 2 bytes contiene el tipo de protocolo, que es 0x0800 para direcciones IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-600">This 2-byte field contains the protocol type, which is 0x0800 for IP addresses.</span></span> |
| <span data-ttu-id="8016a-601">Tamaño de hardware</span><span class="sxs-lookup"><span data-stu-id="8016a-601">Hardware Size</span></span>                | <span data-ttu-id="8016a-602">Este campo de 1 byte contiene el tamaño de la dirección de hardware, que es 6 para las direcciones Ethernet.</span><span class="sxs-lookup"><span data-stu-id="8016a-602">This 1-byte field contains the hardware address size, which is 6 for Ethernet addresses.</span></span> |


![Formato de paquetes de ARP](./media/user-guide/arp-packet-format.png)

<span data-ttu-id="8016a-604">**FIGURA 6. Formato de paquetes de ARP**</span><span class="sxs-lookup"><span data-stu-id="8016a-604">**FIGURE 6. ARP Packet Format**</span></span>

| <span data-ttu-id="8016a-605">Campo de la solicitud o respuesta</span><span class="sxs-lookup"><span data-stu-id="8016a-605">Request/Response Field</span></span> | <span data-ttu-id="8016a-606">Propósito</span><span class="sxs-lookup"><span data-stu-id="8016a-606">Purpose</span></span>  |
|---|---|
| <span data-ttu-id="8016a-607">Tamaño de protocolo</span><span class="sxs-lookup"><span data-stu-id="8016a-607">Protocol Size</span></span> | <span data-ttu-id="8016a-608">Este campo de 1 byte contiene el tamaño de la dirección IP, que es 4 para las direcciones IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-608">This 1-byte field contains the IP address size, which is 4 for IP addresses.</span></span>  |
| <span data-ttu-id="8016a-609">Código de operación</span><span class="sxs-lookup"><span data-stu-id="8016a-609">Operation Code</span></span> | <span data-ttu-id="8016a-610">Este campo de 2 bytes contiene la operación para este paquete ARP.</span><span class="sxs-lookup"><span data-stu-id="8016a-610">This 2-byte field contains the operation for this ARP packet.</span></span> <span data-ttu-id="8016a-611">Una solicitud ARP se especifica con el valor 0x0001, mientras que una respuesta de ARP se representa con el valor 0x0002.</span><span class="sxs-lookup"><span data-stu-id="8016a-611">An ARP request is specified with the value of 0x0001, while an ARP response is represented by a value of 0x0002.</span></span>  |
| <span data-ttu-id="8016a-612">Dirección Ethernet del remitente</span><span class="sxs-lookup"><span data-stu-id="8016a-612">Sender Ethernet Address</span></span> | <span data-ttu-id="8016a-613">Este campo de 6 bytes contiene la dirección Ethernet del remitente.</span><span class="sxs-lookup"><span data-stu-id="8016a-613">This 6-byte field contains the sender's Ethernet address.</span></span> |
| <span data-ttu-id="8016a-614">Dirección IP del remitente</span><span class="sxs-lookup"><span data-stu-id="8016a-614">Sender IP Address</span></span> | <span data-ttu-id="8016a-615">Este campo de 4 bytes contiene la dirección IP del remitente.</span><span class="sxs-lookup"><span data-stu-id="8016a-615">This 4-byte field contains the sender's IP address.</span></span> |
| <span data-ttu-id="8016a-616">Dirección Ethernet de destino</span><span class="sxs-lookup"><span data-stu-id="8016a-616">Target Ethernet Address</span></span> | <span data-ttu-id="8016a-617">Este campo de 6 bytes contiene la dirección Ethernet de destino.</span><span class="sxs-lookup"><span data-stu-id="8016a-617">This 6-byte field contains the target's Ethernet address.</span></span> |
| <span data-ttu-id="8016a-618">Dirección IP de destino</span><span class="sxs-lookup"><span data-stu-id="8016a-618">Target IP Address</span></span> | <span data-ttu-id="8016a-619">Este campo de 4 bytes contiene la dirección IP de destino.</span><span class="sxs-lookup"><span data-stu-id="8016a-619">This 4-byte field contains the target's IP address.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="8016a-620">*Las solicitudes y respuestas de ARP son paquetes de nivel Ethernet. Todos los demás paquetes TCP/IP se encapsulan con un encabezado de paquete IP.*</span><span class="sxs-lookup"><span data-stu-id="8016a-620">*ARP requests and responses are Ethernet-level packets. All other TCP/IP packets are encapsulated by an IP packet header.*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-621">*Se espera que todos los mensajes de ARP de la implementación de TCP/IP estén en formato big endian. En este formato, el byte más significativo de la palabra reside en la dirección de bytes más baja.*</span><span class="sxs-lookup"><span data-stu-id="8016a-621">*All ARP messages in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="arp-aging"></a><span data-ttu-id="8016a-622">Caducidad de ARP</span><span class="sxs-lookup"><span data-stu-id="8016a-622">ARP Aging</span></span>

<span data-ttu-id="8016a-623">NetX admite la invalidación automática de las entradas de ARP dinámicas.</span><span class="sxs-lookup"><span data-stu-id="8016a-623">NetX supports automatic dynamic ARP entry invalidation.</span></span><span data-ttu-id="8016a-624">\ ***NX_ARP_EXPIRATION_RATE** _ especifica el número de segundos que una dirección IP establecida en una asignación física sigue siendo válida.</span><span class="sxs-lookup"><span data-stu-id="8016a-624">\ ***NX_ARP_EXPIRATION_RATE** _specifies the number of seconds an established IP address to physical mapping stays valid.</span></span> <span data-ttu-id="8016a-625">Después de la expiración, la entrada de ARP se quita de la memoria caché de ARP.</span><span class="sxs-lookup"><span data-stu-id="8016a-625">After expiration, the ARP entry is removed from the ARP cache.</span></span> <span data-ttu-id="8016a-626">El siguiente intento de envío a la dirección IP correspondiente dará como resultado una nueva solicitud ARP.</span><span class="sxs-lookup"><span data-stu-id="8016a-626">The next attempt to send to the corresponding IP address will result in a new ARP request.</span></span> <span data-ttu-id="8016a-627">Si se establece _ *_NX_ARP_EXPIRATION_RATE_*\* en cero, se deshabilita la caducidad de ARP, que es la configuración predeterminada.</span><span class="sxs-lookup"><span data-stu-id="8016a-627">Setting _ *_NX_ARP_EXPIRATION_RATE_*\* to zero disables ARP aging, which is the default configuration.</span></span>

### <a name="arp-defend"></a><span data-ttu-id="8016a-628">Protección de ARP</span><span class="sxs-lookup"><span data-stu-id="8016a-628">ARP Defend</span></span>

<span data-ttu-id="8016a-629">Cuando se recibe una solicitud ARP o un paquete de respuesta de ARP y el remitente tiene la misma dirección IP, que entra en conflicto con la dirección IP de este nodo, NetX envía una solicitud ARP para esa dirección como protección.</span><span class="sxs-lookup"><span data-stu-id="8016a-629">When an ARP request or ARP response packet is received and the sender has the same IP address, which conflicts with the IP address of this node, NetX sends an ARP request for that address as a defense.</span></span> <span data-ttu-id="8016a-630">Si el paquete ARP en conflicto se recibe más de una vez en 10 segundos, NetX no envía más paquetes de protección.</span><span class="sxs-lookup"><span data-stu-id="8016a-630">If the conflict ARP packet is received more than once in 10 seconds, NetX does not send more defend packets.</span></span> <span data-ttu-id="8016a-631">El intervalo predeterminado de 10 segundos se puede redefinir mediante \***NX_ARP_DEFEND_INTERVAL** _.</span><span class="sxs-lookup"><span data-stu-id="8016a-631">The default interval 10 seconds can be redefined by \***NX_ARP_DEFEND_INTERVAL** _.</span></span> <span data-ttu-id="8016a-632">Este comportamiento sigue la directiva especificada en el punto 2.4(c) de RFC5227.</span><span class="sxs-lookup"><span data-stu-id="8016a-632">This behavior follows the policy specified in 2.4(c) of RFC5227.</span></span> <span data-ttu-id="8016a-633">Dado que Windows XP omite el anuncio de ARP como respuesta para su sondeo de ARP, el usuario puede definir _*_NX_ARP_DEFEND_BY_REPLY_*\* para enviar la respuesta de ARP como protección adicional.</span><span class="sxs-lookup"><span data-stu-id="8016a-633">Since Windows XP ignores ARP announcement as a response for its ARP probe, user can define _\*_NX_ARP_DEFEND_BY_REPLY_\*\*to send ARP response as additional defence.</span></span>

### <a name="arp-statistics-and-errors"></a><span data-ttu-id="8016a-634">Estadísticas y errores de ARP</span><span class="sxs-lookup"><span data-stu-id="8016a-634">ARP Statistics and Errors</span></span>

<span data-ttu-id="8016a-635">Si se habilita, el software de ARP de NetX realiza un seguimiento de varias estadísticas y errores que pueden ser útiles para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-635">If enabled, the NetX ARP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="8016a-636">Se mantienen las estadísticas y los informes de errores siguientes para cada procesamiento de ARP de IP:</span><span class="sxs-lookup"><span data-stu-id="8016a-636">The following statistics and error reports are maintained for each IP's ARP processing:</span></span>

- <span data-ttu-id="8016a-637">Número total de solicitudes ARP enviadas</span><span class="sxs-lookup"><span data-stu-id="8016a-637">Total ARP Requests Sent</span></span>
- <span data-ttu-id="8016a-638">Número total de solicitudes ARP recibidas</span><span class="sxs-lookup"><span data-stu-id="8016a-638">Total ARP Requests Received</span></span>
- <span data-ttu-id="8016a-639">Número total de respuestas de ARP enviadas</span><span class="sxs-lookup"><span data-stu-id="8016a-639">Total ARP Responses Sent</span></span>
- <span data-ttu-id="8016a-640">Número total de respuestas de ARP recibidas</span><span class="sxs-lookup"><span data-stu-id="8016a-640">Total ARP Responses Received</span></span>
- <span data-ttu-id="8016a-641">Número total de entradas dinámicas de ARP</span><span class="sxs-lookup"><span data-stu-id="8016a-641">Total ARP Dynamic Entries</span></span>
- <span data-ttu-id="8016a-642">Número total de entradas estáticas de ARP</span><span class="sxs-lookup"><span data-stu-id="8016a-642">Total ARP Static Entries</span></span>
- <span data-ttu-id="8016a-643">Número total de entradas caducadas de ARP</span><span class="sxs-lookup"><span data-stu-id="8016a-643">Total ARP Aged Entries</span></span>
- <span data-ttu-id="8016a-644">Número total de mensajes no válidos de ARP</span><span class="sxs-lookup"><span data-stu-id="8016a-644">Total ARP Invalid Messages</span></span>

<span data-ttu-id="8016a-645">Todas estas estadísticas e informes de errores están disponibles para la aplicación con el servicio ***nx_arp_info_get***.</span><span class="sxs-lookup"><span data-stu-id="8016a-645">All these statistics and error reports are available to the application with the ***nx_arp_info_get*** service.</span></span>

## <a name="reverse-address-resolution-protocol-rarp-in-ip"></a><span data-ttu-id="8016a-646">Protocolo de resolución inversa de direcciones (RARP) en IP</span><span class="sxs-lookup"><span data-stu-id="8016a-646">Reverse Address Resolution Protocol (RARP) in IP</span></span>

<span data-ttu-id="8016a-647">El protocolo de resolución inversa de direcciones (RARP) es el protocolo para solicitar la asignación de red de las direcciones IP de 32 bits del host (RFC 903).</span><span class="sxs-lookup"><span data-stu-id="8016a-647">The Reverse Address Resolution Protocol (RARP) is the protocol for requesting network assignment of the host's 32-bit IP addresses (RFC 903).</span></span> <span data-ttu-id="8016a-648">Esto se realiza mediante una solicitud RARP y continúa periódicamente hasta que un miembro de la red asigna una dirección IP a la interfaz de red del host en una respuesta de RARP.</span><span class="sxs-lookup"><span data-stu-id="8016a-648">This is done through an RARP request and continues periodically until a network member assigns an IP address to the host network interface in an RARP response.</span></span> <span data-ttu-id="8016a-649">La aplicación crea una instancia de IP mediante el servicio ***nx_ip_create*** con una dirección IP establecida en cero.</span><span class="sxs-lookup"><span data-stu-id="8016a-649">The application creates an IP instance by the service ***nx_ip_create*** with a zero IP address.</span></span> <span data-ttu-id="8016a-650">Si la aplicación habilita RARP, puede usar el protocolo RARP para solicitar una dirección IP del servidor de red accesible mediante la interfaz que tiene una dirección IP establecida en cero.</span><span class="sxs-lookup"><span data-stu-id="8016a-650">If RARP is enabled by the application, it can use the RARP protocol to request an IP address from the network server accessible through the interface that has a zero IP address.</span></span>

### <a name="rarp-enable"></a><span data-ttu-id="8016a-651">Habilitación de RARP</span><span class="sxs-lookup"><span data-stu-id="8016a-651">RARP Enable</span></span>

<span data-ttu-id="8016a-652">Para usar RARP, la aplicación debe crear la instancia de IP con una dirección IP establecida en cero y, a continuación, habilitar RARP con el servicio ***nx_rarp_enable***.</span><span class="sxs-lookup"><span data-stu-id="8016a-652">To use RARP, the application must create the IP instance with an IP address of zero, then enable RARP using the service ***nx_rarp_enable***.</span></span> <span data-ttu-id="8016a-653">En el caso de los sistemas de host múltiple, al menos un dispositivo de red asociado a la instancia de IP debe tener una dirección IP establecida en cero.</span><span class="sxs-lookup"><span data-stu-id="8016a-653">For multihome systems, at least one network device associated with the IP instance must have an IP address of zero.</span></span> <span data-ttu-id="8016a-654">El procesamiento de RARP envía periódicamente mensajes de solicitud RARP al sistema de NetX en el que requiere una dirección IP hasta que se recibe una respuesta de RARP válida con la dirección IP designada por la red.</span><span class="sxs-lookup"><span data-stu-id="8016a-654">The RARP processing periodically sends RARP request messages for the NetX system requiring an IP address until a valid RARP reply with the network designated IP address is received.</span></span> <span data-ttu-id="8016a-655">En este momento, se ha completado el procesamiento de RARP.</span><span class="sxs-lookup"><span data-stu-id="8016a-655">At this point, RARP processing is complete.</span></span>

<span data-ttu-id="8016a-656">Una vez habilitado RARP, se deshabilitará automáticamente una vez que se resuelvan todas las direcciones de las interfaces.</span><span class="sxs-lookup"><span data-stu-id="8016a-656">After RARP has been enabled, it is disabled automatically after all interface addresses are resolved.</span></span> <span data-ttu-id="8016a-657">La aplicación puede forzar la finalización de RARP con el servicio ***nx_rarp_disable***.</span><span class="sxs-lookup"><span data-stu-id="8016a-657">The application may force RARP to terminate by using the service ***nx_rarp_disable***.</span></span>

###  <a name="rarp-request"></a><span data-ttu-id="8016a-658">Solicitud RARP</span><span class="sxs-lookup"><span data-stu-id="8016a-658">RARP Request</span></span>

<span data-ttu-id="8016a-659">El formato de un paquete de solicitud RARP es casi idéntico al paquete ARP que se muestra en la figura 6 del tema [Mensajes de ARP](#arp-messages). La única diferencia es que el campo de tipo de marco es 0x8035 y el campo del *código de operación* es 3, lo que designa una solicitud RARP.</span><span class="sxs-lookup"><span data-stu-id="8016a-659">The format of an RARP request packet is almost identical to the ARP packet shown in Figure 6 in the topic [ARP Messages](#arp-messages).The only difference is the frame type field is 0x8035 and the *Operation Code* field is 3, designating an RARP request.</span></span> <span data-ttu-id="8016a-660">Como se ha mencionado anteriormente, las solicitudes RARP se enviarán periódicamente (cada ***NX_RARP_UPDATE_RATE*** segundos) hasta que se reciba una respuesta de RARP con la dirección IP asignada por la red.</span><span class="sxs-lookup"><span data-stu-id="8016a-660">As mentioned previously, RARP requests will be sent periodically (every ***NX_RARP_UPDATE_RATE*** seconds) until a RARP reply with the network assigned IP address is received.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-661">*Se espera que todos los mensajes de RARP de la implementación de TCP/IP estén en formato big endian. En este formato, el byte más significativo de la palabra reside en la dirección de bytes más baja.*</span><span class="sxs-lookup"><span data-stu-id="8016a-661">*All RARP messages in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="rarp-reply"></a><span data-ttu-id="8016a-662">Respuesta de RARP</span><span class="sxs-lookup"><span data-stu-id="8016a-662">RARP Reply</span></span>

<span data-ttu-id="8016a-663">Los mensajes de respuesta de RARP se reciben desde la red y contienen la dirección IP asignada por la red para este host.</span><span class="sxs-lookup"><span data-stu-id="8016a-663">RARP reply messages are received from the network and contain the network assigned IP address for this host.</span></span> <span data-ttu-id="8016a-664">El formato de un paquete de respuesta de RARP es casi idéntico al paquete ARP que se muestra en la figura 6.</span><span class="sxs-lookup"><span data-stu-id="8016a-664">The format of an RARP reply packet is almost identical to the ARP packet shown in Figure 6.</span></span> <span data-ttu-id="8016a-665">La única diferencia es que el campo de tipo de marco es 0x8035 y el campo del *código de operación* es 4, lo que designa una respuesta de RARP.</span><span class="sxs-lookup"><span data-stu-id="8016a-665">The only difference is the frame type field is 0x8035 and the *Operation Code* field is 4, which designates an RARP reply.</span></span> <span data-ttu-id="8016a-666">Después de la recepción, se configura la dirección IP en la instancia de IP, se deshabilita la solicitud RARP periódica y la instancia de IP ahora está lista para la operación de red normal.</span><span class="sxs-lookup"><span data-stu-id="8016a-666">After received, the IP address is setup in the IP instance, the periodic RARP request is disabled, and the IP instance is now ready for normal network operation.</span></span>

<span data-ttu-id="8016a-667">En el caso de hosts múltiples, la dirección IP se aplica a la interfaz de red que lo solicita.</span><span class="sxs-lookup"><span data-stu-id="8016a-667">For multihome hosts, the IP address is applied to the requesting network interface.</span></span> <span data-ttu-id="8016a-668">Si hay otras interfaces de red que aún solicitan una asignación de dirección IP, el servicio RARP periódico continúa hasta que se resuelven todas las solicitudes de direcciones IP de las interfaces.</span><span class="sxs-lookup"><span data-stu-id="8016a-668">If there are other network interfaces still requesting an IP address assignment, the periodic RARP service continues until all interface IP address requests are resolved.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-669">*La aplicación no debe utilizar la instancia de IP hasta que se complete el procesamiento de RARP. Las aplicaciones pueden usar **nx_ip_status_check** para esperar la finalización de RARP. En el caso de sistemas de host múltiple, la aplicación no debe usar la interfaz de la solicitud hasta que se complete el procesamiento de RARP en esa interfaz. El estado de la dirección IP del dispositivo secundario se puede comprobar con el servicio **nx_ip_interface_status_check**.*</span><span class="sxs-lookup"><span data-stu-id="8016a-669">*The application should not use the IP instance until the RARP processing is complete. The **nx_ip_status_check** may be used by applications to wait for the RARP completion. For multihome systems, the application should not use the requesting interface until the RARP processing is complete on that interface. Status of the IP address on the secondary device can be checked with the **nx_ip_interface_status_check** service.*</span></span>

### <a name="rarp-statistics-and-errors"></a><span data-ttu-id="8016a-670">Estadísticas y errores de RARP</span><span class="sxs-lookup"><span data-stu-id="8016a-670">RARP Statistics and Errors</span></span>

<span data-ttu-id="8016a-671">Si se habilita, el software de RARP de NetX realiza un seguimiento de varias estadísticas y errores que pueden ser útiles para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-671">If enabled, the NetX RARP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="8016a-672">Se mantienen las estadísticas y los informes de errores siguientes para cada procesamiento de RARP de IP:</span><span class="sxs-lookup"><span data-stu-id="8016a-672">The following statistics and error reports are maintained for each IP's RARP processing:</span></span>

- <span data-ttu-id="8016a-673">Número total de solicitudes RARP enviadas</span><span class="sxs-lookup"><span data-stu-id="8016a-673">Total RARP Requests Sent</span></span>
- <span data-ttu-id="8016a-674">Número total de respuestas de RARP recibidas</span><span class="sxs-lookup"><span data-stu-id="8016a-674">Total RARP Responses Received</span></span>
- <span data-ttu-id="8016a-675">Número total de mensajes no válidos de RARP</span><span class="sxs-lookup"><span data-stu-id="8016a-675">Total RARP Invalid Messages</span></span>

<span data-ttu-id="8016a-676">Todas estas estadísticas e informes de errores están disponibles para la aplicación con el servicio ***nx_rarp_info_get***.</span><span class="sxs-lookup"><span data-stu-id="8016a-676">All these statistics and error reports are available to the application with the ***nx_rarp_info_get*** service.</span></span>

## <a name="internet-control-message-protocol-icmp"></a><span data-ttu-id="8016a-677">Protocolo de mensajes de control de Internet (ICMP)</span><span class="sxs-lookup"><span data-stu-id="8016a-677">Internet Control Message Protocol (ICMP)</span></span>

<span data-ttu-id="8016a-678">El protocolo de mensajes de control de Internet (ICMP) para IP se limita a pasar información de errores y de control entre los miembros de la red IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-678">Internet Control Message Protocol for IP (ICMP) is limited to passing error and control information between IP network members.</span></span>

<span data-ttu-id="8016a-679">Como la mayoría de los mensajes de la capa de aplicación (por ejemplo, TCP/IP), los mensajes de ICMP se encapsulan con un encabezado IP con la designación del protocolo ICMP.</span><span class="sxs-lookup"><span data-stu-id="8016a-679">Like most other application layer (e.g., TCP/IP) messages, ICMP messages are encapsulated by an IP header with the ICMP protocol designation.</span></span>

### <a name="icmp-statistics-and-errors"></a><span data-ttu-id="8016a-680">Estadísticas y errores de ICMP</span><span class="sxs-lookup"><span data-stu-id="8016a-680">ICMP Statistics and Errors</span></span>

<span data-ttu-id="8016a-681">Si se habilita, NetX realiza un seguimiento de varias estadísticas y errores de ICMP que pueden ser útiles para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-681">If enabled, NetX keeps track of several ICMP statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="8016a-682">Se mantienen las estadísticas y los informes de errores siguientes para cada procesamiento de ICMP de IP:</span><span class="sxs-lookup"><span data-stu-id="8016a-682">The following statistics and error reports are maintained for each IP's ICMP processing:</span></span>

- <span data-ttu-id="8016a-683">Número total de pings de ICMP enviados</span><span class="sxs-lookup"><span data-stu-id="8016a-683">Total ICMP Pings Sent</span></span>
- <span data-ttu-id="8016a-684">Número total de tiempos de expiración de pings de ICMP</span><span class="sxs-lookup"><span data-stu-id="8016a-684">Total ICMP Ping Timeouts</span></span>
- <span data-ttu-id="8016a-685">Número total de subprocesos de ping de ICMP suspendidos</span><span class="sxs-lookup"><span data-stu-id="8016a-685">Total ICMP Ping Threads Suspended</span></span>
- <span data-ttu-id="8016a-686">Número total de respuestas de ping de ICMP recibidas</span><span class="sxs-lookup"><span data-stu-id="8016a-686">Total ICMP Ping Responses Received</span></span>
- <span data-ttu-id="8016a-687">Número total de errores de suma de comprobación de ICMP</span><span class="sxs-lookup"><span data-stu-id="8016a-687">Total ICMP Checksum Errors</span></span>
- <span data-ttu-id="8016a-688">Número total de mensajes de ICMP no controlados</span><span class="sxs-lookup"><span data-stu-id="8016a-688">Total ICMP Unhandled Messages</span></span>

<span data-ttu-id="8016a-689">Todas estas estadísticas e informes de errores están disponibles para la aplicación con el servicio ***nx_icmp_info_get***.</span><span class="sxs-lookup"><span data-stu-id="8016a-689">All these statistics and error reports are available to the application with the ***nx_icmp_info_get*** service.</span></span>

### <a name="icmp-enable"></a><span data-ttu-id="8016a-690">Habilitación de ICMP</span><span class="sxs-lookup"><span data-stu-id="8016a-690">ICMP Enable</span></span>
<span data-ttu-id="8016a-691">Antes de que los mensajes de ICMP puedan ser procesados por NetX, la aplicación debe llamar al servicio ***nx_icmp_enable*** para habilitar el procesamiento de ICMP.</span><span class="sxs-lookup"><span data-stu-id="8016a-691">Before ICMP messages can be processed by NetX, the application must call the ***nx_icmp_enable*** service to enable ICMP processing.</span></span> <span data-ttu-id="8016a-692">Una vez hecho esto, la aplicación puede emitir solicitudes de ping y paquetes de ping entrantes de campo.</span><span class="sxs-lookup"><span data-stu-id="8016a-692">After this is done, the application can issue ping requests and field incoming ping packets.</span></span>

### <a name="icmp-echo-request"></a><span data-ttu-id="8016a-693">Solicitud de eco de ICMP</span><span class="sxs-lookup"><span data-stu-id="8016a-693">ICMP Echo Request</span></span>
<span data-ttu-id="8016a-694">Una solicitud de eco es un tipo de mensaje de ICMP que se suele usar para comprobar la existencia de un nodo específico en la red, como se identifica por su dirección IP del host.</span><span class="sxs-lookup"><span data-stu-id="8016a-694">An echo request is one type of ICMP message that is typically used to check for the existence of a specific node on the network, as identified by its host IP address.</span></span> <span data-ttu-id="8016a-695">El popular comando ping se implementa mediante mensajes de solicitud y respuesta de eco de ICMP.</span><span class="sxs-lookup"><span data-stu-id="8016a-695">The popular ping command is implemented using ICMP echo request/echo reply messages.</span></span> <span data-ttu-id="8016a-696">Si el host específico está presente, su pila de red procesa la solicitud de ping y responde con una respuesta de ping.</span><span class="sxs-lookup"><span data-stu-id="8016a-696">If the specific host is present, its network stack processes the ping request and responses with a ping response.</span></span> <span data-ttu-id="8016a-697">En la figura 7 se detalla el formato del mensaje de ping de ICMP.</span><span class="sxs-lookup"><span data-stu-id="8016a-697">Figure 7 details the ICMP ping message format.</span></span>

![Mensaje de ping de ICMP](./media/user-guide/icmp-ping-message.png)

<span data-ttu-id="8016a-699">**FIGURA 7. Mensaje de ping de ICMP**</span><span class="sxs-lookup"><span data-stu-id="8016a-699">**FIGURE 7. ICMP Ping Message**</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-700">*Se espera que todos los mensajes de ICMP de la implementación de TCP/IP estén en formato big endian. En este formato, el byte más significativo de la palabra reside en la dirección de bytes más baja.*</span><span class="sxs-lookup"><span data-stu-id="8016a-700">*All ICMP messages in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

<span data-ttu-id="8016a-701">En la tabla siguiente se describe el formato de encabezado ICMP:</span><span class="sxs-lookup"><span data-stu-id="8016a-701">The following table describes the ICMP header format:</span></span>

| <span data-ttu-id="8016a-702">Campo del encabezado</span><span class="sxs-lookup"><span data-stu-id="8016a-702">Header Field</span></span>    | <span data-ttu-id="8016a-703">Propósito</span><span class="sxs-lookup"><span data-stu-id="8016a-703">Purpose</span></span> |
|-----------------|---------------------------------------------------|
| <span data-ttu-id="8016a-704">Tipo</span><span class="sxs-lookup"><span data-stu-id="8016a-704">Type</span></span>            | <span data-ttu-id="8016a-705">Este campo especifica el mensaje de ICMP (bits del 31 al 24).</span><span class="sxs-lookup"><span data-stu-id="8016a-705">This field specifies the ICMP message (bits 31- 24).</span></span> <span data-ttu-id="8016a-706">Las más comunes son: 0 para respuesta de eco y 8 para solicitud de eco</span><span class="sxs-lookup"><span data-stu-id="8016a-706">The most common are:   0 Echo Reply   8 Echo Request</span></span> |
| <span data-ttu-id="8016a-707">Código</span><span class="sxs-lookup"><span data-stu-id="8016a-707">Code</span></span>            | <span data-ttu-id="8016a-708">Este campo es específico del contexto del campo de tipo (bits del 23 a 16).</span><span class="sxs-lookup"><span data-stu-id="8016a-708">This field is context specific on the type field (bits 23-16).</span></span> <span data-ttu-id="8016a-709">En el caso de una solicitud o respuesta de eco, el código se establece en cero.</span><span class="sxs-lookup"><span data-stu-id="8016a-709">For an echo request or reply the code is set to zero.</span></span> |
| <span data-ttu-id="8016a-710">Suma de comprobación</span><span class="sxs-lookup"><span data-stu-id="8016a-710">Checksum</span></span>        | <span data-ttu-id="8016a-711">Este campo contiene la suma de comprobación de 16 bits de la suma del complemento a uno del mensaje de ICMP, incluido el encabezado ICMP completo a partir del campo de tipo.</span><span class="sxs-lookup"><span data-stu-id="8016a-711">This field contains the 16-bit checksum of the one's complement sum of the ICMP message including the entire the ICMP header starting with the Type field.</span></span> <span data-ttu-id="8016a-712">Antes de generar la suma de comprobación, se borra el campo de la suma de comprobación.</span><span class="sxs-lookup"><span data-stu-id="8016a-712">Before generating the checksum, the checksum field is cleared.</span></span>                 |
| <span data-ttu-id="8016a-713">Identificación</span><span class="sxs-lookup"><span data-stu-id="8016a-713">Identification</span></span>  | <span data-ttu-id="8016a-714">Este campo contiene un valor de identificador que identifica al host; el host debe utilizar el identificador extraído de una solicitud de eco en la respuesta de eco (bits del 31 al 16).</span><span class="sxs-lookup"><span data-stu-id="8016a-714">This field contains an ID value identifying the host; a host should use the ID extracted from an ECHO request in the ECHO REPLY (bits 31-16).</span></span> |
| <span data-ttu-id="8016a-715">Número de secuencia</span><span class="sxs-lookup"><span data-stu-id="8016a-715">Sequence number</span></span> | <span data-ttu-id="8016a-716">Este campo contiene un valor de identificador; el host debe utilizar el identificador extraído de una solicitud de eco en la respuesta de eco (bits del 31 al 16).</span><span class="sxs-lookup"><span data-stu-id="8016a-716">This field contains an ID value; a host should use the ID extracted from an ECHO request in the ECHO REPLY (bits 31-16).</span></span> <span data-ttu-id="8016a-717">A diferencia del campo de identificador, este valor cambiará en una solicitud de eco subsiguiente del mismo host (bits del 15 al 0).</span><span class="sxs-lookup"><span data-stu-id="8016a-717">Unlike the identifier field, this value will change in a subsequent Echo request from the same host (bits 15-0).</span></span> |


### <a name="icmp-echo-response"></a><span data-ttu-id="8016a-718">Respuesta de eco de ICMP</span><span class="sxs-lookup"><span data-stu-id="8016a-718">ICMP Echo Response</span></span>
<span data-ttu-id="8016a-719">Una respuesta de ping es otro tipo de mensaje de ICMP que el componente de ICMP genera internamente en respuesta a una solicitud de ping externa.</span><span class="sxs-lookup"><span data-stu-id="8016a-719">A ping response is another type of ICMP message that is generated internally by the ICMP component in response to an external ping request.</span></span> <span data-ttu-id="8016a-720">Además de la confirmación, la respuesta de ping también contiene una copia de los datos de usuario proporcionados en la solicitud de ping.</span><span class="sxs-lookup"><span data-stu-id="8016a-720">In addition to acknowledgement, the ping response also contains a copy of the user data supplied in the ping request.</span></span>

## <a name="internet-group-management-protocol-igmp"></a><span data-ttu-id="8016a-721">Protocolo de administración de grupos de Internet (IGMP)</span><span class="sxs-lookup"><span data-stu-id="8016a-721">Internet Group Management Protocol (IGMP)</span></span>

<span data-ttu-id="8016a-722">El protocolo de administración de grupos de Internet (IGMP) proporciona un dispositivo para comunicarse con sus vecinos y sus enrutadores que pretenden recibir, o unirse, a un grupo de multidifusión IP (RFC 1112 y RFC 2236).</span><span class="sxs-lookup"><span data-stu-id="8016a-722">The Internet Group Management Protocol (IGMP) provides a device to communicate with its neighbors and its routers that it intends to receive, or join, an IP multicast group (RFC 1112 and RFC 2236).</span></span> <span data-ttu-id="8016a-723">Un grupo de multidifusión es básicamente una colección dinámica de miembros de la red y se representa mediante una dirección IP de clase D.</span><span class="sxs-lookup"><span data-stu-id="8016a-723">A multicast group is basically a dynamic collection of network members and is represented by a Class D IP address.</span></span> <span data-ttu-id="8016a-724">Los miembros del grupo de multidifusión pueden salir en cualquier momento y los nuevos miembros pueden unirse en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="8016a-724">Members of the multicast group may leave at any time, and new members may join at any time.</span></span> <span data-ttu-id="8016a-725">La coordinación implicada en la unión y la salida del grupo es responsabilidad de IGMP.</span><span class="sxs-lookup"><span data-stu-id="8016a-725">The coordination involved in joining and leaving the group is the responsibility of IGMP.</span></span>

### <a name="igmp-enable"></a><span data-ttu-id="8016a-726">Habilitación de IGMP</span><span class="sxs-lookup"><span data-stu-id="8016a-726">IGMP Enable</span></span>

<span data-ttu-id="8016a-727">Antes de que pueda tener lugar cualquier actividad de multidifusión en NetX, la aplicación debe llamar al servicio ***nx_igmp_enable***.</span><span class="sxs-lookup"><span data-stu-id="8016a-727">Before any multicasting activity can take place in NetX, the application must call the ***nx_igmp_enable*** service.</span></span> <span data-ttu-id="8016a-728">Este servicio realiza la inicialización básica de IGMP como preparación para las solicitudes de multidifusión.</span><span class="sxs-lookup"><span data-stu-id="8016a-728">This service performs basic IGMP initialization in preparation for multicast requests.</span></span>

### <a name="multicast-ip-addressing"></a><span data-ttu-id="8016a-729">Direccionamiento IP de multidifusión</span><span class="sxs-lookup"><span data-stu-id="8016a-729">Multicast IP Addressing</span></span>

<span data-ttu-id="8016a-730">Como se ha mencionado anteriormente, las direcciones de multidifusión son realmente direcciones IP de clase D, tal como se muestra en la figura 4 en la página 58.</span><span class="sxs-lookup"><span data-stu-id="8016a-730">As mentioned previously, multicast addresses are actually Class D IP addresses as shown in Figure 4 on page 58.</span></span> <span data-ttu-id="8016a-731">Los 28 bits inferiores de la dirección de clase D se corresponden con el identificador del grupo de multidifusión.</span><span class="sxs-lookup"><span data-stu-id="8016a-731">The lower 28-bits of the Class D address correspond to the multicast group ID.</span></span> <span data-ttu-id="8016a-732">Hay una serie de direcciones de multidifusión predefinidas.</span><span class="sxs-lookup"><span data-stu-id="8016a-732">There are a series of pre-defined multicast addresses.</span></span> <span data-ttu-id="8016a-733">Sin embargo, la *dirección de todos los hosts* (244.0.0.1) es especialmente importante para el procesamiento de IGMP.</span><span class="sxs-lookup"><span data-stu-id="8016a-733">However, the *all hosts address* (244.0.0.1) is particularly important to IGMP processing.</span></span> <span data-ttu-id="8016a-734">Los enrutadores usan la *dirección de todos los hosts* para consultar a todos los miembros de multidifusión para informar sobre a qué grupos de multidifusión pertenecen.</span><span class="sxs-lookup"><span data-stu-id="8016a-734">The *all hosts address* is used by routers to query all multicast members to report on which multicast groups they belong to.</span></span>

### <a name="physical-address-mapping-in-ip"></a><span data-ttu-id="8016a-735">Asignación de dirección física en IP</span><span class="sxs-lookup"><span data-stu-id="8016a-735">Physical Address Mapping in IP</span></span>

<span data-ttu-id="8016a-736">Las direcciones de multidifusión de clase D se asignan directamente a direcciones Ethernet físicas que van desde la 01.00.5e.00.00.00 a la 01.00.5e.7f.ff.ff.</span><span class="sxs-lookup"><span data-stu-id="8016a-736">Class D multicast addresses map directly to physical Ethernet addresses ranging from 01.00.5e.00.00.00 through 01.00.5e.7f.ff.ff.</span></span> <span data-ttu-id="8016a-737">Los 23 bits inferiores de la dirección de multidifusión IP se asignan directamente a los 23 bits inferiores de la dirección Ethernet.</span><span class="sxs-lookup"><span data-stu-id="8016a-737">The lower 23 bits of the IP multicast address map directly to the lower 23 bits of the Ethernet address.</span></span>

### <a name="multicast-group-join"></a><span data-ttu-id="8016a-738">Unión a un grupo de multidifusión</span><span class="sxs-lookup"><span data-stu-id="8016a-738">Multicast Group Join</span></span>

<span data-ttu-id="8016a-739">Las aplicaciones que necesiten unirse a un grupo de multidifusión determinado pueden hacerlo mediante una llamada al servicio ***nx_igmp_multicast_join***.</span><span class="sxs-lookup"><span data-stu-id="8016a-739">Applications that need to join a particular multicast group may do so by calling the ***nx_igmp_multicast_join*** service.</span></span> <span data-ttu-id="8016a-740">Este servicio realiza un seguimiento del número de solicitudes para unirse a este grupo de multidifusión.</span><span class="sxs-lookup"><span data-stu-id="8016a-740">This service keeps track of the number of requests to join this multicast group.</span></span> <span data-ttu-id="8016a-741">Si esta es la primera solicitud de la aplicación para unirse al grupo de multidifusión, se envía un informe de IGMP a la red principal que indica la intención de este host de unirse al grupo.</span><span class="sxs-lookup"><span data-stu-id="8016a-741">If this is the first application request to join the multicast group, an IGMP report is sent out on the primary network indicating this host's intention to join the group.</span></span> <span data-ttu-id="8016a-742">A continuación, se llama al controlador de red para realizar escuchas de paquetes con la dirección Ethernet de este grupo de multidifusión.</span><span class="sxs-lookup"><span data-stu-id="8016a-742">Next, the network driver is called to set up for listening for packets with the Ethernet address for this multicast group.</span></span>

<span data-ttu-id="8016a-743">En un sistema de host múltiple, si el grupo de multidifusión es accesible mediante una interfaz específica, la aplicación debe usar el servicio ***nx_igmp_multicast_interface_join*** en lugar de \***nx_igmp_multicast_join**,\* que está limitado a los grupos de multidifusión de la red principal.</span><span class="sxs-lookup"><span data-stu-id="8016a-743">In a multihome system, if the multicast group is accessible via a specific interface, application shall use the service ***nx_igmp_multicast_interface_join*** instead of \***nx_igmp_multicast_join**,\* which is limited to multicast groups on the primary network.</span></span>

### <a name="multicast-group-leave"></a><span data-ttu-id="8016a-744">Salida de un grupo de multidifusión</span><span class="sxs-lookup"><span data-stu-id="8016a-744">Multicast Group Leave</span></span>

<span data-ttu-id="8016a-745">Las aplicaciones que necesiten salir de un grupo de multidifusión al que se han unido anteriormente pueden hacerlo llamando al servicio ***nx_igmp_multicast_leave***.</span><span class="sxs-lookup"><span data-stu-id="8016a-745">Applications that need to leave a previously joined multicast group may do so by calling the ***nx_igmp_multicast_leave*** service.</span></span> <span data-ttu-id="8016a-746">Este servicio reduce el recuento interno asociado con el número de veces que se han realizado uniones al grupo.</span><span class="sxs-lookup"><span data-stu-id="8016a-746">This service reduces the internal count associated with how many times the group was joined.</span></span> <span data-ttu-id="8016a-747">Si no hay ninguna solicitud de unión pendiente para un grupo, se llama al controlador de red para deshabilitar la escucha de paquetes con la dirección Ethernet de este grupo de multidifusión.</span><span class="sxs-lookup"><span data-stu-id="8016a-747">If there are no outstanding join requests for a group, the network driver is called to disable listening for packets with this multicast group's Ethernet address</span></span>

### <a name="multicast-loopback"></a><span data-ttu-id="8016a-748">Bucle invertido de multidifusión</span><span class="sxs-lookup"><span data-stu-id="8016a-748">Multicast Loopback</span></span>

<span data-ttu-id="8016a-749">Es posible que una aplicación desee recibir tráfico de multidifusión originado en uno de los orígenes del mismo nodo.</span><span class="sxs-lookup"><span data-stu-id="8016a-749">An application may wish to receive multicast traffic originated from one of the sources on the same node.</span></span> <span data-ttu-id="8016a-750">Esto requiere que el componente de multidifusión de IP tenga habilitado el bucle invertido mediante el servicio ***nx_igmp_loopback_enable***.</span><span class="sxs-lookup"><span data-stu-id="8016a-750">This requires the IP multicast component to have loopback enabled by using the service ***nx_igmp_loopback_enable***.</span></span>

### <a name="igmp-report-message"></a><span data-ttu-id="8016a-751">Mensaje de informe de IGMP</span><span class="sxs-lookup"><span data-stu-id="8016a-751">IGMP Report Message</span></span>

<span data-ttu-id="8016a-752">Cuando la aplicación se une a un grupo de multidifusión, se envía un mensaje de informe de IGMP mediante la red para indicar la intención del host de unirse a un grupo de multidifusión determinado.</span><span class="sxs-lookup"><span data-stu-id="8016a-752">When the application joins a multicast group, an IGMP report message is sent via the network to indicate the host's intention to join a particular multicast group.</span></span> <span data-ttu-id="8016a-753">En la figura 8 se muestra el formato del mensaje de informe de IGMP.</span><span class="sxs-lookup"><span data-stu-id="8016a-753">The format of the IGMP report message is shown in Figure 8.</span></span> <span data-ttu-id="8016a-754">La dirección del grupo de multidifusión se usa para el mensaje de grupo en el mensaje de informe de IGMP y para la dirección IP de destino.</span><span class="sxs-lookup"><span data-stu-id="8016a-754">The multicast group address is used for both the group message in the IGMP report message and the destination IP address.</span></span>

![Mensaje de informe de IGMP](./media/user-guide/igmp-report-message.png)

<span data-ttu-id="8016a-756">**FIGURA 8. Mensaje de informe de IGMP**</span><span class="sxs-lookup"><span data-stu-id="8016a-756">**FIGURE 8. IGMP Report Message**</span></span>

<span data-ttu-id="8016a-757">En la ilustración anterior (Figura 8), el encabezado IGMP contiene un campo de versión y tipo, un tiempo de respuesta máximo, un campo de suma de comprobación y un campo de dirección del grupo de multidifusión.</span><span class="sxs-lookup"><span data-stu-id="8016a-757">In the figure above (Figure 8), the IGMP header contains a version/type field, maximum response time, a checksum field, and a multicast group address field.</span></span> <span data-ttu-id="8016a-758">En el caso de los mensajes de IGMPv1, el campo de tiempo de respuesta máximo siempre se establece en cero, ya que no forma parte del protocolo IGMPv1.</span><span class="sxs-lookup"><span data-stu-id="8016a-758">For IGMPv1 messages, the Maximum Response Time field is always set to zero, as this is not part of the IGMPv1 protocol.</span></span> <span data-ttu-id="8016a-759">El campo de tiempo de respuesta máximo se establece cuando el host recibe un mensaje de IGMP de tipo consulta y se borra cuando un host recibe el mensaje de tipo informe de otro host, tal como se define en el protocolo IGMPv2.</span><span class="sxs-lookup"><span data-stu-id="8016a-759">The Maximum Response Time field is set when the host receives a Query type IGMP message and cleared when a host receives another host's Report type message as defined by the IGMPv2 protocol.</span></span>

<span data-ttu-id="8016a-760">A continuación se describe el formato de encabezado IGMP:</span><span class="sxs-lookup"><span data-stu-id="8016a-760">The following describes the IGMP header format:</span></span>

| <span data-ttu-id="8016a-761">**Campo del encabezado**</span><span class="sxs-lookup"><span data-stu-id="8016a-761">**Header Field**</span></span>          | <span data-ttu-id="8016a-762">**Propósito**</span><span class="sxs-lookup"><span data-stu-id="8016a-762">**Purpose**</span></span> |
|-----------------------|--------------------------------------------------------------------|
| <span data-ttu-id="8016a-763">Versión</span><span class="sxs-lookup"><span data-stu-id="8016a-763">Version</span></span>               | <span data-ttu-id="8016a-764">Este campo especifica la versión de IGMP (bits del 31 al 28).</span><span class="sxs-lookup"><span data-stu-id="8016a-764">This field specifies the IGMP version (bits 31- 28).</span></span>                                                                               |
| <span data-ttu-id="8016a-765">Tipo</span><span class="sxs-lookup"><span data-stu-id="8016a-765">Type</span></span>                  | <span data-ttu-id="8016a-766">Este campo especifica el tipo de mensaje de IGMP (bits del 27 al 24).</span><span class="sxs-lookup"><span data-stu-id="8016a-766">This field specifies the type of IGMP message (bits 27 -24).</span></span>                                                                       |
| <span data-ttu-id="8016a-767">Tiempo de respuesta máximo</span><span class="sxs-lookup"><span data-stu-id="8016a-767">Maximum Response Time</span></span> | <span data-ttu-id="8016a-768">No se utiliza en IGMPv1.</span><span class="sxs-lookup"><span data-stu-id="8016a-768">Not used in IGMPv1.</span></span> <span data-ttu-id="8016a-769">En IGMPv2, este campo actúa como el tiempo de respuesta máximo.</span><span class="sxs-lookup"><span data-stu-id="8016a-769">In IGMPv2 this field serves as the maximum response time.</span></span>                                                      |
| <span data-ttu-id="8016a-770">Suma de comprobación</span><span class="sxs-lookup"><span data-stu-id="8016a-770">Checksum</span></span>              | <span data-ttu-id="8016a-771">Este campo contiene la suma de comprobación de 16 bits de la suma del complemento a uno del mensaje de IGMP a partir de la versión de IGMP (bits del 0 al 15).</span><span class="sxs-lookup"><span data-stu-id="8016a-771">This field contains the 16-bit checksum of the one's complement sum of the IGMP message starting with the IGMP version (bits 0-15)</span></span> |
| <span data-ttu-id="8016a-772">Dirección del grupo</span><span class="sxs-lookup"><span data-stu-id="8016a-772">Group Address</span></span>         | <span data-ttu-id="8016a-773">Dirección IP del grupo de clase D de 32 bits</span><span class="sxs-lookup"><span data-stu-id="8016a-773">32-bit class D group IP address</span></span> |


<span data-ttu-id="8016a-774">Los mensajes de informe de IGMP también se envían en respuesta a los mensajes de consulta de IGMP enviados por un enrutador de multidifusión.</span><span class="sxs-lookup"><span data-stu-id="8016a-774">IGMP report messages are also sent in response to IGMP query messages sent by a multicast router.</span></span> <span data-ttu-id="8016a-775">Los enrutadores de multidifusión envían periódicamente mensajes de consulta para ver qué hosts siguen requiriendo pertenencia a grupos.</span><span class="sxs-lookup"><span data-stu-id="8016a-775">Multicast routers periodically send query messages out to see which hosts still require group membership.</span></span> <span data-ttu-id="8016a-776">Los mensajes de consulta tienen el mismo formato que el mensaje de informe de IGMP que se muestra en la figura 8.</span><span class="sxs-lookup"><span data-stu-id="8016a-776">Query messages have the same format as the IGMP Report message shown in Figure 8.</span></span> <span data-ttu-id="8016a-777">Las únicas diferencias son que el tipo de IGMP es igual a 1 y que el campo de dirección del grupo se establece en 0.</span><span class="sxs-lookup"><span data-stu-id="8016a-777">The only differences are the IGMP type is equal to 1 and the group address field is set to 0.</span></span> <span data-ttu-id="8016a-778">El enrutador de multidifusión envía los mensajes de consulta de IGMP a la dirección IP de *todos los hosts*.</span><span class="sxs-lookup"><span data-stu-id="8016a-778">IGMP Query messages are sent to the *all hosts* IP address by the multicast router.</span></span> <span data-ttu-id="8016a-779">Un host que aún desea mantener la pertenencia a grupos responde mediante el envío de otro mensaje de informe de IGMP.</span><span class="sxs-lookup"><span data-stu-id="8016a-779">A host that still wishes to maintain group membership responds by sending another IGMP Report message.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-780">*Se espera que todos los mensajes de la implementación de TCP/IP estén en formato **big endian**. En este formato, el byte más significativo de la palabra reside en la dirección de bytes más baja.*</span><span class="sxs-lookup"><span data-stu-id="8016a-780">*All messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="igmp-statistics-and-errors"></a><span data-ttu-id="8016a-781">Estadísticas y errores de IGMP</span><span class="sxs-lookup"><span data-stu-id="8016a-781">IGMP Statistics and Errors</span></span>

<span data-ttu-id="8016a-782">Si se habilita, el software de IGMP de NetX realiza un seguimiento de varias estadísticas y errores que pueden ser útiles para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-782">If enabled, the NetX IGMP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="8016a-783">Se mantienen las estadísticas y los informes de errores siguientes para cada procesamiento de IGMP de IP:</span><span class="sxs-lookup"><span data-stu-id="8016a-783">The following statistics and error reports are maintained for each IP's IGMP processing:</span></span>

- <span data-ttu-id="8016a-784">Número total de informes de IGMP enviados</span><span class="sxs-lookup"><span data-stu-id="8016a-784">Total IGMP Reports Sent</span></span>
- <span data-ttu-id="8016a-785">Número total de consultas de IGMP recibidas</span><span class="sxs-lookup"><span data-stu-id="8016a-785">Total IGMP Queries Received</span></span>
- <span data-ttu-id="8016a-786">Número total de errores de suma de comprobación de IGMP</span><span class="sxs-lookup"><span data-stu-id="8016a-786">Total IGMP Checksum Errors</span></span>
- <span data-ttu-id="8016a-787">Número total de grupos unidos actualmente a IGMP</span><span class="sxs-lookup"><span data-stu-id="8016a-787">Total IGMP Current Groups Joined</span></span>

<span data-ttu-id="8016a-788">Todas estas estadísticas e informes de errores están disponibles para la aplicación con el servicio ***nx_igmp_info_get***.</span><span class="sxs-lookup"><span data-stu-id="8016a-788">All these statistics and error reports are available to the application with the ***nx_igmp_info_get*** service.</span></span>

## <a name="user-datagram-protocol-udp"></a><span data-ttu-id="8016a-789">Protocolo de datagramas de usuario (UDP)</span><span class="sxs-lookup"><span data-stu-id="8016a-789">User Datagram Protocol (UDP)</span></span>

<span data-ttu-id="8016a-790">El protocolo de datagramas de usuario (UDP) proporciona la forma más sencilla de transferencia de datos entre los miembros de la red (RFC 768).</span><span class="sxs-lookup"><span data-stu-id="8016a-790">The User Datagram Protocol (UDP) provides the simplest form of data transfer between network members (RFC 768).</span></span> <span data-ttu-id="8016a-791">Los paquetes de datos de UDP se envían de un miembro de red a otro de la mejor forma posible; es decir, no hay ningún mecanismo integrado para la confirmación por parte del destinatario del paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-791">UDP data packets are sent from one network member to another in a best effort fashion; i.e., there is no built-in mechanism for acknowledgement by the packet recipient.</span></span> <span data-ttu-id="8016a-792">Además, el envío de un paquete UDP no requiere que se establezca una conexión de antemano.</span><span class="sxs-lookup"><span data-stu-id="8016a-792">In addition, sending a UDP packet does not require any connection to be established in advance.</span></span> <span data-ttu-id="8016a-793">Debido a esto, la transmisión de paquetes UDP es muy eficaz.</span><span class="sxs-lookup"><span data-stu-id="8016a-793">Because of this, UDP packet transmission is very efficient.</span></span>

### <a name="udp-header"></a><span data-ttu-id="8016a-794">Encabezado UDP</span><span class="sxs-lookup"><span data-stu-id="8016a-794">UDP Header</span></span>
<span data-ttu-id="8016a-795">UDP coloca un encabezado de paquete simple delante de los datos de la aplicación en la transmisión y quita un encabezado UDP similar del paquete en la recepción antes de entregar un paquete UDP recibido a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-795">UDP places a simple packet header in front of the application's data on transmission, and removes a similar UDP header from the packet on reception before delivering a received UDP packet to the application.</span></span> <span data-ttu-id="8016a-796">UDP emplea el protocolo IP para enviar y recibir paquetes, lo que significa que hay un encabezado IP delante del encabezado UDP cuando el paquete está en la red.</span><span class="sxs-lookup"><span data-stu-id="8016a-796">UDP utilizes the IP protocol for sending and receiving packets, which means there is an IP header in front of the UDP header when the packet is on the network.</span></span> <span data-ttu-id="8016a-797">En la figura 9 se muestra el formato del encabezado UDP.</span><span class="sxs-lookup"><span data-stu-id="8016a-797">Figure 9 shows the format of the UDP header.</span></span>

![Encabezado UDP](./media/user-guide/udp-header.png)

<span data-ttu-id="8016a-799">**FIGURA 9. Encabezado UDP**</span><span class="sxs-lookup"><span data-stu-id="8016a-799">**FIGURE 9. UDP Header**</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-800">*Se espera que todos los encabezados de la implementación de UDP/IP estén en formato big endian. En este formato, el byte más significativo de la palabra reside en la dirección de bytes más baja.*</span><span class="sxs-lookup"><span data-stu-id="8016a-800">*All headers in the UDP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

<span data-ttu-id="8016a-801">A continuación se describe el formato de encabezado UDP:</span><span class="sxs-lookup"><span data-stu-id="8016a-801">The following describes the UDP header format:</span></span>

| <span data-ttu-id="8016a-802">Campo del encabezado</span><span class="sxs-lookup"><span data-stu-id="8016a-802">Header Field</span></span>                   | <span data-ttu-id="8016a-803">Propósito</span><span class="sxs-lookup"><span data-stu-id="8016a-803">Purpose</span></span> |
|--------------------------------|---------------------------------------------|
| <span data-ttu-id="8016a-804">Número de puerto de origen de 16 bits</span><span class="sxs-lookup"><span data-stu-id="8016a-804">16-bit source port number</span></span>      | <span data-ttu-id="8016a-805">Este campo contiene el puerto desde el que se envía el paquete UDP.</span><span class="sxs-lookup"><span data-stu-id="8016a-805">This field contains the port on which the UDP packet is being sent from.</span></span> <span data-ttu-id="8016a-806">El intervalo de puertos UDP válidos va del 1 al 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="8016a-806">Valid UDP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="8016a-807">Número de puerto de destino de 16 bits</span><span class="sxs-lookup"><span data-stu-id="8016a-807">16-bit destination port number</span></span> | <span data-ttu-id="8016a-808">Este campo contiene el puerto UDP al que se envía el paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-808">This field contains the UDP port to which the packet is being sent to.</span></span> <span data-ttu-id="8016a-809">El intervalo de puertos UDP válidos va del 1 al 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="8016a-809">Valid UDP ports range from 1 through 0xFFFF.</span></span>   |
| <span data-ttu-id="8016a-810">Longitud de UDP de 16 bits</span><span class="sxs-lookup"><span data-stu-id="8016a-810">16-bit UDP length</span></span>   | <span data-ttu-id="8016a-811">Este campo contiene el número de bytes del paquete UDP, incluido el tamaño del encabezado UDP.</span><span class="sxs-lookup"><span data-stu-id="8016a-811">This field contains the number of bytes in the UDP packet, including the size of the UDP header.</span></span>                                  |
| <span data-ttu-id="8016a-812">Suma de comprobación de UDP de 16 bits</span><span class="sxs-lookup"><span data-stu-id="8016a-812">16-bit UDP checksum</span></span> | <span data-ttu-id="8016a-813">Este campo contiene la suma de comprobación de 16 bits del paquete, incluidos el encabezado UDP, el área de datos del paquete y el encabezado pseudo IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-813">This field contains the 16-bit checksum for the packet, including the UDP header, the packet data area, and the pseudo IP header.</span></span> |

### <a name="udp-enable"></a><span data-ttu-id="8016a-814">Habilitación de UDP</span><span class="sxs-lookup"><span data-stu-id="8016a-814">UDP Enable</span></span>

<span data-ttu-id="8016a-815">Antes de que sea posible la transmisión de paquetes UDP, la aplicación debe habilitar primero UDP mediante una llamada al servicio ***nx_udp_enable***.</span><span class="sxs-lookup"><span data-stu-id="8016a-815">Before UDP packet transmission is possible, the application must first enable UDP by calling the ***nx_udp_enable*** service.</span></span> <span data-ttu-id="8016a-816">Una vez habilitado, la aplicación puede enviar y recibir paquetes UDP.</span><span class="sxs-lookup"><span data-stu-id="8016a-816">After enabled, the application is free to send and receive UDP packets.</span></span>

### <a name="udp-socket-create"></a><span data-ttu-id="8016a-817">Creación de sockets UDP</span><span class="sxs-lookup"><span data-stu-id="8016a-817">UDP Socket Create</span></span>

<span data-ttu-id="8016a-818">Los sockets UDP se crean durante la inicialización o en tiempo de ejecución mediante subprocesos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-818">UDP sockets are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="8016a-819">En el servicio ***nx_udp_socket_create*** se definen el tipo inicial de servicio, el período de vida y la profundidad de la cola de recepción.</span><span class="sxs-lookup"><span data-stu-id="8016a-819">The initial type of service, time to live, and receive queue depth are defined by the ***nx_udp_socket_create*** service.</span></span> <span data-ttu-id="8016a-820">No hay ningún límite en el número de sockets UDP de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-820">There are no limits on the number of UDP sockets in an application.</span></span>

### <a name="udp-checksum"></a><span data-ttu-id="8016a-821">Suma de comprobación de UDP</span><span class="sxs-lookup"><span data-stu-id="8016a-821">UDP Checksum</span></span>

<span data-ttu-id="8016a-822">UDP especifica una suma de comprobación de 16 bits del complemento a uno que incluye el encabezado pseudo IP (que consta de la dirección IP de origen, la dirección IP de destino, el protocolo y la longitud de palabra de IP), el encabezado UDP y los datos del paquete UDP.</span><span class="sxs-lookup"><span data-stu-id="8016a-822">UDP specifies a one's complement 16-bit checksum that covers the IP pseudo header (consisting of the source IP address, destination IP address, and the protocol/length IP word), the UDP header, and the UDP packet data.</span></span> <span data-ttu-id="8016a-823">Si la suma de comprobación de UDP calculada es 0, se almacena como todo unos (0xFFFF).</span><span class="sxs-lookup"><span data-stu-id="8016a-823">If the calculated UDP checksum is 0, it is stored as all ones (0xFFFF).</span></span> <span data-ttu-id="8016a-824">Si el socket de envío tiene deshabilitada la lógica de la suma de comprobación de UDP, se coloca un cero en el campo de suma de comprobación de UDP para indicar que no se ha calculado la suma de comprobación.</span><span class="sxs-lookup"><span data-stu-id="8016a-824">If the sending socket has the UDP checksum logic disabled, a zero is placed in the UDP checksum field to indicate the checksum was not calculated.</span></span> <span data-ttu-id="8016a-825">Si la suma de comprobación de UDP no coincide con la suma de comprobación calculada por el receptor, simplemente se descarta el paquete UDP.</span><span class="sxs-lookup"><span data-stu-id="8016a-825">If the UDP checksum does not match the computed checksum by the receiver, the UDP packet is simply discarded.</span></span>

<span data-ttu-id="8016a-826">En la red IP, la suma de comprobación de UDP es opcional.</span><span class="sxs-lookup"><span data-stu-id="8016a-826">On the IP network, UDP checksum is optional.</span></span> <span data-ttu-id="8016a-827">NetX permite a una aplicación habilitar o deshabilitar el cálculo de la suma de comprobación de UDP por cada socket.</span><span class="sxs-lookup"><span data-stu-id="8016a-827">NetX allows an application to enable or disable UDP checksum calculation on a per-socket basis.</span></span> <span data-ttu-id="8016a-828">De manera predeterminada, la lógica de la suma de comprobación del socket UDP está habilitada.</span><span class="sxs-lookup"><span data-stu-id="8016a-828">By default, the UDP socket checksum logic is enabled.</span></span> <span data-ttu-id="8016a-829">La aplicación puede deshabilitar la lógica de la suma de comprobación para un socket UDP determinado mediante una llamada al servicio ***nx_udp_socket_checksum_disable***.</span><span class="sxs-lookup"><span data-stu-id="8016a-829">The application can disable checksum logic for a particular UDP socket by calling the ***nx_udp_socket_checksum_disable*** service.</span></span>

<span data-ttu-id="8016a-830">Algunos controladores Ethernet pueden generar la suma de comprobación de UDP sobre la marcha.</span><span class="sxs-lookup"><span data-stu-id="8016a-830">Certain Ethernet controllers are able to generate the UDP checksum on the fly.</span></span> <span data-ttu-id="8016a-831">Si el sistema puede usar la característica de cálculo de la suma de comprobación por hardware, la biblioteca de NetX se puede compilar sin la lógica de la suma de comprobación.</span><span class="sxs-lookup"><span data-stu-id="8016a-831">If the system is able to use hardware checksum computation feature, the NetX library can be built without the checksum logic.</span></span> <span data-ttu-id="8016a-832">Para deshabilitar la suma de comprobación por software de UDP, la biblioteca de NetX se debe compilar con los siguientes símbolos definidos: ***NX_DISABLE_UDP_TX_CHECKSUM*** y ***NX_DISABLE_UDP_RX_CHECKSUM* *_ (tal como se describe en el [Capítulo 2](chapter2.md)). Las opciones de configuración quitan completamente la lógica de la suma de comprobación de UDP de NetX, mientras que la llamada al servicio _* nx_udp_socket_checksum_disable**\* permite que la aplicación deshabilite el procesamiento de la suma de comprobación de UDP de IP por cada socket.</span><span class="sxs-lookup"><span data-stu-id="8016a-832">To disable UDP software checksum, the NetX library must be built with the following symbols defined: ***NX_DISABLE_UDP_TX_CHECKSUM*** and ***NX_DISABLE_UDP_RX_CHECKSUM\*\*_ (described in [Chapter 2](chapter2.md)). The configuration options remove UDP checksum logic from NetX entirely, while calling the _* nx_udp_socket_checksum_disable**\* service allows the application to disable IP UDP checksum processing on a per socket basis.</span></span>

### <a name="udp-ports-and-binding"></a><span data-ttu-id="8016a-833">Enlaces y puertos UDP</span><span class="sxs-lookup"><span data-stu-id="8016a-833">UDP Ports and Binding</span></span>

<span data-ttu-id="8016a-834">Un puerto UDP es un punto de conexión lógico en el protocolo UDP.</span><span class="sxs-lookup"><span data-stu-id="8016a-834">A UDP port is a logical end point in the UDP protocol.</span></span> <span data-ttu-id="8016a-835">Hay 65 535 puertos válidos en el componente de UDP de NetX, que van del 1 al 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="8016a-835">There are 65,535 valid ports in the UDP component of NetX, ranging from 1 through 0xFFFF.</span></span> <span data-ttu-id="8016a-836">Para enviar o recibir datos UDP, la aplicación debe crear primero un socket UDP y, a continuación, enlazarlo al puerto deseado.</span><span class="sxs-lookup"><span data-stu-id="8016a-836">To send or receive UDP data, the application must first create a UDP socket, then bind it to a desired port.</span></span> <span data-ttu-id="8016a-837">Después de enlazar un socket UDP a un puerto, la aplicación puede enviar y recibir datos en ese socket.</span><span class="sxs-lookup"><span data-stu-id="8016a-837">After binding a UDP socket to a port, the application may send and receive data on that socket.</span></span>

### <a name="udp-fast-pathtrade"></a><span data-ttu-id="8016a-838">UDP Fast Path&trade;</span><span class="sxs-lookup"><span data-stu-id="8016a-838">UDP Fast Path&trade;</span></span>

<span data-ttu-id="8016a-839">UDP Fast Path&trade; es el nombre de una ruta de baja sobrecarga de paquetes mediante la implementación de UDP de NetX.</span><span class="sxs-lookup"><span data-stu-id="8016a-839">The UDP Fast Path&trade; is the name for a low packet overhead path through the NetX UDP implementation.</span></span> <span data-ttu-id="8016a-840">El envío de un paquete UDP requiere solo algunas llamadas de función: ***nx_udp_socket_send** _, _*_nx_ip_packet_send_\*_ y la llamada eventual al controlador de red.</span><span class="sxs-lookup"><span data-stu-id="8016a-840">Sending a UDP packet requires just a few function calls: ***nx_udp_socket_send** _, _*_nx_ip_packet_send_\*_, and the eventual call to the network driver.</span></span> <span data-ttu-id="8016a-841">_*_nx_udp_socket_send_*_ está disponible en NetX para las aplicaciones de NETX existentes y solo es aplicable a los paquetes IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-841">_*_nx_udp_socket_send_*_ is available in NetX for existing NetX applications and is only applicable for IP packets.</span></span> <span data-ttu-id="8016a-842">Sin embargo, el método preferido es usar el servicio _ *_nx_udp_socket_send_*\* que se describe a continuación.</span><span class="sxs-lookup"><span data-stu-id="8016a-842">The preferred method, however, is to use _ *_nx_udp_socket_send_*\* service discussed below.</span></span> <span data-ttu-id="8016a-843">En la recepción de paquetes UDP, el paquete UDP se coloca en la cola de recepción del socket UDP adecuado o se entrega a un subproceso de la aplicación en suspensión en una única llamada de función desde el procesamiento de interrupciones de recepción del controlador de red.</span><span class="sxs-lookup"><span data-stu-id="8016a-843">On UDP packet reception, the UDP packet is either placed on the appropriate UDP socket receive queue or delivered to a suspended application thread in a single function call from the network driver's receive interrupt processing.</span></span> <span data-ttu-id="8016a-844">Esta lógica altamente optimizada para enviar y recibir paquetes UDP es la esencia de la tecnología UDP Fast Path.</span><span class="sxs-lookup"><span data-stu-id="8016a-844">This highly optimized logic for sending and receiving UDP packets is the essence of UDP Fast Path technology.</span></span>

### <a name="udp-packet-send"></a><span data-ttu-id="8016a-845">Envío de paquetes UDP</span><span class="sxs-lookup"><span data-stu-id="8016a-845">UDP Packet Send</span></span>

<span data-ttu-id="8016a-846">El envío de datos UDP mediante redes IP se realiza fácilmente mediante una llamada a la función \***nx_udp_socket_send** _.</span><span class="sxs-lookup"><span data-stu-id="8016a-846">Sending UDP data over IP networks is easily accomplished by calling the \***nx_udp_socket_send** _ function.</span></span> <span data-ttu-id="8016a-847">El autor de llamada debe establecer la versión de IP en el campo de _dirección IP\*.</span><span class="sxs-lookup"><span data-stu-id="8016a-847">The caller must set the IP version in the _IP address\* field.</span></span> <span data-ttu-id="8016a-848">NetX determinará la mejor dirección de origen para los paquetes UDP transmitidos en función de la dirección IP de destino.</span><span class="sxs-lookup"><span data-stu-id="8016a-848">NetX will determine the best source address for transmitted UDP packets based on the destination IP address.</span></span> <span data-ttu-id="8016a-849">Este servicio coloca un encabezado UDP delante de los datos del paquete y lo envía a la red mediante una rutina interna de envío IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-849">This service places a UDP header in front of the packet data and sends it out onto the network using an internal IP send routine.</span></span> <span data-ttu-id="8016a-850">No hay ninguna suspensión de subprocesos en el envío de paquetes UDP porque todas las transmisiones de paquetes UDP se procesan inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="8016a-850">There is no thread suspension on sending UDP packets because all UDP packet transmissions are processed immediately.</span></span>

<span data-ttu-id="8016a-851">En el caso de los destinos de multidifusión o de difusión, la aplicación debe especificar la dirección IP de origen que se usará si el dispositivo con NetX tiene varias direcciones IP entre las que elegir.</span><span class="sxs-lookup"><span data-stu-id="8016a-851">For multicast or broadcast destinations, the application should specify the source IP address to use if the NetX device has multiple IP addresses to choose from.</span></span> <span data-ttu-id="8016a-852">Esto se puede realizar con el servicio ***nx_udp_socket_interface_send***.</span><span class="sxs-lookup"><span data-stu-id="8016a-852">This can be done with the services ***nx_udp_socket_interface_send.***</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-853">*Si se usa **nx_udp_socket_send** para transmitir paquetes de multidifusión o de difusión, se utiliza la dirección IP de la primera interfaz como dirección de origen.*</span><span class="sxs-lookup"><span data-stu-id="8016a-853">*If **nx_udp_socket_send** is used for transmitting multicast or broadcast packets, the IP address of the first interface is used as source address.*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-854">*Si la lógica de la suma de comprobación de UDP está habilitada para este socket, la operación de suma de comprobación se realiza en el contexto del subproceso que realiza la llamada, sin bloquear el acceso a las estructuras de datos de UDP o IP.*</span><span class="sxs-lookup"><span data-stu-id="8016a-854">*If UDP checksum logic is enabled for this socket, the checksum operation is performed in the context of the calling thread, without blocking access to the UDP or IP data structures.*</span></span>

> [!NOTE]
> <span data-ttu-id="8016a-855">*Los datos de la carga UDP que residen en la estructura **NX_PACKET** deben residir en un límite de palabra larga. La aplicación debe dejar espacio suficiente entre el puntero antepuesto y el puntero de inicio de datos de NetX para colocar los encabezados del soporte físico, IP y UDP.*</span><span class="sxs-lookup"><span data-stu-id="8016a-855">*The UDP payload data residing in the **NX_PACKET** structure should reside on a long-word boundary. The application needs to leave sufficient space between the prepend pointer and the data start pointer for NetX to place the UDP, IP, and physical media headers.*</span></span>

### <a name="udp-packet-receive"></a><span data-ttu-id="8016a-856">Recepción de paquetes UDP</span><span class="sxs-lookup"><span data-stu-id="8016a-856">UDP Packet Receive</span></span>

<span data-ttu-id="8016a-857">Los subprocesos de la aplicación pueden recibir paquetes UDP desde un socket determinado mediante una llamada a ***nx_udp_socket_receive***.</span><span class="sxs-lookup"><span data-stu-id="8016a-857">Application threads may receive UDP packets from a particular socket by calling ***nx_udp_socket_receive***.</span></span> <span data-ttu-id="8016a-858">La función de recepción del socket entrega el paquete más antiguo de la cola de recepción del socket.</span><span class="sxs-lookup"><span data-stu-id="8016a-858">The socket receive function delivers the oldest packet on the socket's receive queue.</span></span> <span data-ttu-id="8016a-859">Si no hay paquetes en la cola de recepción, el subproceso que realiza la llamada se puede suspender (con un tiempo de espera opcional) hasta que llegue un paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-859">If there are no packets on the receive queue, the calling thread can suspend (with an optional timeout) until a packet arrives.</span></span>

<span data-ttu-id="8016a-860">El procesamiento de paquetes de recepción de UDP (normalmente llamado desde el controlador de interrupciones de recepción del controlador de red) es responsable de colocar el paquete en la cola de recepción del socket UDP o de entregarlo al primer subproceso suspendido en espera de un paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-860">The UDP receive packet processing (usually called from the network driver's receive interrupt handler) is responsible for either placing the packet on the UDP socket's receive queue or delivering it to the first suspended thread waiting for a packet.</span></span> <span data-ttu-id="8016a-861">Si el paquete está en cola, el procesamiento de recepción también comprueba la profundidad máxima de la cola de recepción asociada al socket.</span><span class="sxs-lookup"><span data-stu-id="8016a-861">If the packet is queued, the receive processing also checks the maximum receive queue depth associated with the socket.</span></span> <span data-ttu-id="8016a-862">Si este paquete recién puesto en cola supera la profundidad de la cola, se descarta el paquete más antiguo de la cola.</span><span class="sxs-lookup"><span data-stu-id="8016a-862">If this newly queued packet exceeds the queue depth, the oldest packet in the queue is discarded.</span></span>

### <a name="udp-receive-notify"></a><span data-ttu-id="8016a-863">Notificación de recepción de UDP</span><span class="sxs-lookup"><span data-stu-id="8016a-863">UDP Receive Notify</span></span>

<span data-ttu-id="8016a-864">Si el subproceso de la aplicación debe procesar los datos recibidos desde más de un socket, se debe usar la función ***nx_udp_socket_receive_notify***.</span><span class="sxs-lookup"><span data-stu-id="8016a-864">If the application thread needs to process received data from more than one socket, the ***nx_udp_socket_receive_notify*** function should be used.</span></span> <span data-ttu-id="8016a-865">Esta función registra una función de devolución de llamada de paquetes de recepción para el socket.</span><span class="sxs-lookup"><span data-stu-id="8016a-865">This function registers a receive packet callback function for the socket.</span></span> <span data-ttu-id="8016a-866">Cada vez que se recibe un paquete en el socket, se ejecuta la función de devolución de llamada.</span><span class="sxs-lookup"><span data-stu-id="8016a-866">Whenever a packet is received on the socket, the callback function is executed.</span></span>

<span data-ttu-id="8016a-867">El contenido de la función de devolución de llamada es específico de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-867">The contents of the callback function is application-specific.</span></span> <span data-ttu-id="8016a-868">Sin embargo, lo más probable es que contenga la lógica para informar al subproceso de procesamiento de que un paquete ahora está disponible en el socket correspondiente.</span><span class="sxs-lookup"><span data-stu-id="8016a-868">However, it would most likely contain logic to inform the processing thread that a packet is now available on the corresponding socket.</span></span>

### <a name="peer-address-and-port"></a><span data-ttu-id="8016a-869">Dirección y puerto del nodo del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="8016a-869">Peer Address and Port</span></span>

<span data-ttu-id="8016a-870">Al recibir un paquete UDP, la aplicación puede encontrar el número de puerto y la dirección IP del remitente mediante el servicio ***nx_udp_packet_info_extract***.</span><span class="sxs-lookup"><span data-stu-id="8016a-870">On receiving a UDP packet, application may find the sender's IP address and port number by using the service ***nx_udp_packet_info_extract***.</span></span> <span data-ttu-id="8016a-871">Si la devolución es correcta, este servicio proporciona información sobre la dirección IP del remitente, el número de puerto del remitente y la interfaz local a través de la cual se recibió el paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-871">On successful return, this service provides information on the sender's IP address, sender's port number, and the local interface through which the packet was received.</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="8016a-872">Suspensión de subprocesos</span><span class="sxs-lookup"><span data-stu-id="8016a-872">Thread Suspension</span></span>

<span data-ttu-id="8016a-873">Como se ha mencionado anteriormente, los subprocesos de la aplicación se pueden suspender al intentar recibir un paquete UDP en un puerto UDP determinado.</span><span class="sxs-lookup"><span data-stu-id="8016a-873">As mentioned previously, application threads can suspend while attempting to receive a UDP packet on a particular UDP port.</span></span> <span data-ttu-id="8016a-874">Una vez que se recibe un paquete en ese puerto, se asigna al primer subproceso suspendido y, a continuación, se reanuda el subproceso.</span><span class="sxs-lookup"><span data-stu-id="8016a-874">After a packet is received on that port, it is given to the first thread suspended and that thread is then resumed.</span></span> <span data-ttu-id="8016a-875">Está disponible un tiempo de espera opcional cuando hay una suspensión en la recepción de un paquete UDP, una característica disponible para la mayoría de los servicios de NetX.</span><span class="sxs-lookup"><span data-stu-id="8016a-875">An optional timeout is available when suspending on a UDP receive packet, a feature available for most NetX services.</span></span>

### <a name="udp-socket-statistics-and-errors"></a><span data-ttu-id="8016a-876">Estadísticas y errores del socket UDP</span><span class="sxs-lookup"><span data-stu-id="8016a-876">UDP Socket Statistics and Errors</span></span>

<span data-ttu-id="8016a-877">Si se habilita, el software de socket UDP de NetX realiza un seguimiento de varias estadísticas y errores que pueden ser útiles para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-877">If enabled, the NetX UDP socket software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="8016a-878">Se mantienen las estadísticas y los informes de errores siguientes para cada instancia de IP/UDP:</span><span class="sxs-lookup"><span data-stu-id="8016a-878">The following statistics and error reports are maintained for each IP/UDP instance:</span></span>

- <span data-ttu-id="8016a-879">Número total de paquetes UDP enviados</span><span class="sxs-lookup"><span data-stu-id="8016a-879">Total UDP Packets Sent</span></span>
- <span data-ttu-id="8016a-880">Número total de bytes UDP enviados</span><span class="sxs-lookup"><span data-stu-id="8016a-880">Total UDP Bytes Sent</span></span>
- <span data-ttu-id="8016a-881">Número total de paquetes UDP recibidos</span><span class="sxs-lookup"><span data-stu-id="8016a-881">Total UDP Packets Received</span></span>
- <span data-ttu-id="8016a-882">Número total de bytes UDP recibidos</span><span class="sxs-lookup"><span data-stu-id="8016a-882">Total UDP Bytes Received</span></span>
- <span data-ttu-id="8016a-883">Número total de paquetes UDP no válidos</span><span class="sxs-lookup"><span data-stu-id="8016a-883">Total UDP Invalid Packets</span></span>
- <span data-ttu-id="8016a-884">Número total de paquetes UDP recibidos eliminados</span><span class="sxs-lookup"><span data-stu-id="8016a-884">Total UDP Receive Packets Dropped</span></span>
- <span data-ttu-id="8016a-885">Número total de errores de suma de comprobación de recepción de UDP</span><span class="sxs-lookup"><span data-stu-id="8016a-885">Total UDP Receive Checksum Errors</span></span>
- <span data-ttu-id="8016a-886">Paquetes de socket UDP enviados</span><span class="sxs-lookup"><span data-stu-id="8016a-886">UDP Socket Packets Sent</span></span>
- <span data-ttu-id="8016a-887">Bytes de socket UDP enviados</span><span class="sxs-lookup"><span data-stu-id="8016a-887">UDP Socket Bytes Sent</span></span>
- <span data-ttu-id="8016a-888">Paquetes de socket UDP recibidos</span><span class="sxs-lookup"><span data-stu-id="8016a-888">UDP Socket Packets Received</span></span>
- <span data-ttu-id="8016a-889">Bytes de socket UDP recibidos</span><span class="sxs-lookup"><span data-stu-id="8016a-889">UDP Socket Bytes Received</span></span>
- <span data-ttu-id="8016a-890">Paquetes de socket UDP puestos en cola</span><span class="sxs-lookup"><span data-stu-id="8016a-890">UDP Socket Packets Queued</span></span>
- <span data-ttu-id="8016a-891">Paquetes de socket UDP recibidos eliminados</span><span class="sxs-lookup"><span data-stu-id="8016a-891">UDP Socket Receive Packets Dropped</span></span>
- <span data-ttu-id="8016a-892">Errores de suma de comprobación de socket UDP</span><span class="sxs-lookup"><span data-stu-id="8016a-892">UDP Socket Checksum Errors</span></span>

<span data-ttu-id="8016a-893">Todas estas estadísticas e informes de errores están disponibles para la aplicación con el servicio ***nx_udp_info_get*** para las estadísticas acumuladas de UDP en todos los sockets UDP y el servicio ***nx_udp_socket_info_get*** para las estadísticas de UDP en el socket UDP especificado.</span><span class="sxs-lookup"><span data-stu-id="8016a-893">All these statistics and error reports are available to the application with the ***nx_udp_info_get*** service for UDP statistics amassed over all UDP sockets, and the ***nx_udp_socket_info_get*** service for UDP statistics on the specified UDP socket.</span></span>

### <a name="udp-socket-control-block-nx_udp_socket"></a><span data-ttu-id="8016a-894">Bloque de control de socket UDP NX_UDP_SOCKET</span><span class="sxs-lookup"><span data-stu-id="8016a-894">UDP Socket Control Block NX_UDP_SOCKET</span></span>

<span data-ttu-id="8016a-895">Las características de cada socket UDP se encuentran en el bloque de control **NX_UDP_SOCKET** asociado.</span><span class="sxs-lookup"><span data-stu-id="8016a-895">The characteristics of each UDP socket are found in the associated **NX_UDP_SOCKET** control block.</span></span> <span data-ttu-id="8016a-896">Contiene información útil, como el vínculo a la estructura de datos IP, la interfaz de red para las rutas de acceso de envío y recepción, el puerto enlazado y la cola de paquetes de recepción.</span><span class="sxs-lookup"><span data-stu-id="8016a-896">It contains useful information such as the link to the IP data structure, the network interface for the sending and receiving paths, the bound port, and the receive packet queue.</span></span> <span data-ttu-id="8016a-897">Esta estructura se define en el archivo **_tx_api.h_**.</span><span class="sxs-lookup"><span data-stu-id="8016a-897">This structure is defined in the **_nx_api.h_** file.</span></span>

## <a name="transmission-control-protocol-tcp"></a><span data-ttu-id="8016a-898">Protocolo de control de transmisión (TCP)</span><span class="sxs-lookup"><span data-stu-id="8016a-898">Transmission Control Protocol (TCP)</span></span>

<span data-ttu-id="8016a-899">El protocolo de control de transmisión (TCP) proporciona transferencia de datos de secuencia confiable entre dos miembros de la red (RFC 793).</span><span class="sxs-lookup"><span data-stu-id="8016a-899">The Transmission Control Protocol (TCP) provides reliable stream data transfer between two network members (RFC 793).</span></span> <span data-ttu-id="8016a-900">El miembro receptor comprueba y confirma todos los datos enviados desde un miembro de la red.</span><span class="sxs-lookup"><span data-stu-id="8016a-900">All data sent from one network member are verified and acknowledged by the receiving member.</span></span> <span data-ttu-id="8016a-901">Además, los dos miembros deben haber establecido una conexión antes de cualquier transferencia de datos.</span><span class="sxs-lookup"><span data-stu-id="8016a-901">In addition, the two members must have established a connection prior to any data transfer.</span></span> <span data-ttu-id="8016a-902">Todo esto produce una transferencia de datos confiable; sin embargo, requiere bastante más sobrecarga que la transferencia de datos UDP descrita previamente.</span><span class="sxs-lookup"><span data-stu-id="8016a-902">All this results in reliable data transfer; however, it does require substantially more overhead than the previously described UDP data transfer.</span></span>

### <a name="tcp-header"></a><span data-ttu-id="8016a-903">Encabezado TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-903">TCP Header</span></span>

<span data-ttu-id="8016a-904">En la transmisión, el encabezado TCP se coloca delante de los datos del usuario.</span><span class="sxs-lookup"><span data-stu-id="8016a-904">On transmission, TCP header is placed in front of the data from the user.</span></span> <span data-ttu-id="8016a-905">En la recepción, el encabezado TCP se quita del paquete entrante y solo están disponibles para la aplicación los datos del usuario.</span><span class="sxs-lookup"><span data-stu-id="8016a-905">On reception, TCP header is removed from the incoming packet, leaving only the user data available to the application.</span></span> <span data-ttu-id="8016a-906">TCP emplea el protocolo IP para enviar y recibir paquetes, lo que significa que hay un encabezado IP delante del encabezado TCP cuando el paquete está en la red.</span><span class="sxs-lookup"><span data-stu-id="8016a-906">TCP utilizes the IP protocol to send and receive packets, which means there is an IP header in front of the TCP header when the packet is on the network.</span></span> <span data-ttu-id="8016a-907">En la figura 10 se muestra el formato del encabezado TCP.</span><span class="sxs-lookup"><span data-stu-id="8016a-907">Figure 10 shows the format of the TCP header.</span></span>

![Encabezado TCP](./media/user-guide/tcp-header.png)

<span data-ttu-id="8016a-909">**FIGURA 10. Encabezado TCP**</span><span class="sxs-lookup"><span data-stu-id="8016a-909">**FIGURE 10. TCP Header**</span></span>

<span data-ttu-id="8016a-910">A continuación se describe el formato de encabezado TCP:</span><span class="sxs-lookup"><span data-stu-id="8016a-910">The following describes the TCP header format:</span></span>

| <span data-ttu-id="8016a-911">Campo del encabezado</span><span class="sxs-lookup"><span data-stu-id="8016a-911">Header Field</span></span> | <span data-ttu-id="8016a-912">Propósito</span><span class="sxs-lookup"><span data-stu-id="8016a-912">Purpose</span></span> |
|---|---|
| <span data-ttu-id="8016a-913">Número de puerto de origen de 16 bits</span><span class="sxs-lookup"><span data-stu-id="8016a-913">16-bit source port number</span></span> | <span data-ttu-id="8016a-914">Este campo contiene el puerto por el que se envía el paquete TCP.</span><span class="sxs-lookup"><span data-stu-id="8016a-914">This field contains the port the TCP packet is being sent out on.</span></span> <span data-ttu-id="8016a-915">El intervalo de puertos TCP válidos va del 1 al 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="8016a-915">Valid TCP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="8016a-916">Número de puerto de destino de 16 bits</span><span class="sxs-lookup"><span data-stu-id="8016a-916">16-bit destination port number</span></span> | <span data-ttu-id="8016a-917">Este campo contiene el puerto al que se envía el paquete TCP.</span><span class="sxs-lookup"><span data-stu-id="8016a-917">This field contains the TCP port the packet is being sent to.</span></span> <span data-ttu-id="8016a-918">El intervalo de puertos TCP válidos va del 1 al 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="8016a-918">Valid TCP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="8016a-919">Número de secuencia de 32 bits</span><span class="sxs-lookup"><span data-stu-id="8016a-919">32-bit sequence number</span></span> | <span data-ttu-id="8016a-920">Este campo contiene el número de secuencia de los datos enviados desde este extremo de la conexión.</span><span class="sxs-lookup"><span data-stu-id="8016a-920">This field contains the sequence number for data sent from this end of the connection.</span></span> <span data-ttu-id="8016a-921">La secuencia original se establece durante la secuencia de conexión inicial entre dos nodos TCP.</span><span class="sxs-lookup"><span data-stu-id="8016a-921">The original sequence is established during the initial connection sequence between two TCP nodes.</span></span> <span data-ttu-id="8016a-922">Cada transferencia de datos desde ese punto da lugar a un incremento del número de secuencia en la cantidad de bytes enviados.</span><span class="sxs-lookup"><span data-stu-id="8016a-922">Every data transfer from that point results in an increment of the sequence number by the amount bytes sent.</span></span> |
| <span data-ttu-id="8016a-923">Número de confirmación de 32 bits</span><span class="sxs-lookup"><span data-stu-id="8016a-923">32-bit acknowledgement number</span></span> | <span data-ttu-id="8016a-924">Este campo contiene el número de secuencia correspondiente al último byte recibido por este lado de la conexión.</span><span class="sxs-lookup"><span data-stu-id="8016a-924">This field contains the sequence number corresponding to the last byte received by this side of the connection.</span></span> <span data-ttu-id="8016a-925">Se utiliza para determinar si el otro extremo de la conexión ha recibido correctamente o no los datos que se han enviado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="8016a-925">This is used to determine whether or not data previously sent has successfully been received by the other end of the connection.</span></span> |
| <span data-ttu-id="8016a-926">Longitud del encabezado de 4 bits</span><span class="sxs-lookup"><span data-stu-id="8016a-926">4-bit header length</span></span>           | <span data-ttu-id="8016a-927">Este campo contiene el número de palabras de 32 bits que hay en el encabezado TCP.</span><span class="sxs-lookup"><span data-stu-id="8016a-927">This field contains the number of 32-bit words in the TCP header.</span></span> <span data-ttu-id="8016a-928">Si no hay opciones en el encabezado TCP, el valor de este campo es 5.</span><span class="sxs-lookup"><span data-stu-id="8016a-928">If no options are present in the TCP header, this field is 5.</span></span> |
| <span data-ttu-id="8016a-929">Bits de código de 6 bits</span><span class="sxs-lookup"><span data-stu-id="8016a-929">6-bit code bits</span></span>               | <span data-ttu-id="8016a-930">Este campo contiene los seis bits de código diferentes que se usan para indicar diversa información de control asociada a la conexión.</span><span class="sxs-lookup"><span data-stu-id="8016a-930">This field contains the six different code bits used to indicate various control information associated with the connection.</span></span> <span data-ttu-id="8016a-931">Las bits de control se definen de la siguiente forma:</span><span class="sxs-lookup"><span data-stu-id="8016a-931">The control bits are defined as follows:</span></span> |



| <span data-ttu-id="8016a-932">Nombre</span><span class="sxs-lookup"><span data-stu-id="8016a-932">Name</span></span> | <span data-ttu-id="8016a-933">bit</span><span class="sxs-lookup"><span data-stu-id="8016a-933">Bit</span></span> | <span data-ttu-id="8016a-934">Significado</span><span class="sxs-lookup"><span data-stu-id="8016a-934">Meaning</span></span>                                                     |
|------|-----|-------------------------------------------------------------|
| <span data-ttu-id="8016a-935">URG</span><span class="sxs-lookup"><span data-stu-id="8016a-935">URG</span></span>  | <span data-ttu-id="8016a-936">21</span><span class="sxs-lookup"><span data-stu-id="8016a-936">21</span></span>  | <span data-ttu-id="8016a-937">Hay presentes datos urgentes</span><span class="sxs-lookup"><span data-stu-id="8016a-937">Urgent data present</span></span>                                         |
| <span data-ttu-id="8016a-938">ACK</span><span class="sxs-lookup"><span data-stu-id="8016a-938">ACK</span></span>  | <span data-ttu-id="8016a-939">20</span><span class="sxs-lookup"><span data-stu-id="8016a-939">20</span></span>  | <span data-ttu-id="8016a-940">El número de confirmación es válido</span><span class="sxs-lookup"><span data-stu-id="8016a-940">Acknowledgement number is valid</span></span>                             |
| <span data-ttu-id="8016a-941">PSH</span><span class="sxs-lookup"><span data-stu-id="8016a-941">PSH</span></span>  | <span data-ttu-id="8016a-942">19</span><span class="sxs-lookup"><span data-stu-id="8016a-942">19</span></span>  | <span data-ttu-id="8016a-943">Controlar estos datos inmediatamente</span><span class="sxs-lookup"><span data-stu-id="8016a-943">Handle this data immediately</span></span>                                |
| <span data-ttu-id="8016a-944">RST</span><span class="sxs-lookup"><span data-stu-id="8016a-944">RST</span></span>  | <span data-ttu-id="8016a-945">18</span><span class="sxs-lookup"><span data-stu-id="8016a-945">18</span></span>  | <span data-ttu-id="8016a-946">Restablecer la conexión</span><span class="sxs-lookup"><span data-stu-id="8016a-946">Reset the connection</span></span>                                        |
| <span data-ttu-id="8016a-947">SYN</span><span class="sxs-lookup"><span data-stu-id="8016a-947">SYN</span></span>  | <span data-ttu-id="8016a-948">17</span><span class="sxs-lookup"><span data-stu-id="8016a-948">17</span></span>  | <span data-ttu-id="8016a-949">Sincronizar los números de secuencia (se utiliza para establecer la conexión)</span><span class="sxs-lookup"><span data-stu-id="8016a-949">Synchronize sequence numbers (used to establish connection)</span></span> |
| <span data-ttu-id="8016a-950">FIN</span><span class="sxs-lookup"><span data-stu-id="8016a-950">FIN</span></span>  | <span data-ttu-id="8016a-951">16</span><span class="sxs-lookup"><span data-stu-id="8016a-951">16</span></span>  | <span data-ttu-id="8016a-952">El remitente ha finalizado la transmisión (se usa para cerrar la conexión)</span><span class="sxs-lookup"><span data-stu-id="8016a-952">Sender is finished with transmit (used to close connection)</span></span> |

<span data-ttu-id="8016a-953">**Ventana de 16 bits**</span><span class="sxs-lookup"><span data-stu-id="8016a-953">**16-bit window**</span></span>

<span data-ttu-id="8016a-954">Este campo se usa para el control de flujo.</span><span class="sxs-lookup"><span data-stu-id="8016a-954">This field is used for flow control.</span></span> <span data-ttu-id="8016a-955">Contiene la cantidad de bytes que el socket puede recibir actualmente.</span><span class="sxs-lookup"><span data-stu-id="8016a-955">It contains the amount of bytes the socket can currently receive.</span></span> <span data-ttu-id="8016a-956">Básicamente se usa para el control de flujo.</span><span class="sxs-lookup"><span data-stu-id="8016a-956">This basically is used for flow control.</span></span> <span data-ttu-id="8016a-957">El remitente es responsable de asegurarse de que los datos que se van a enviar se ajusten a la ventana anunciada del receptor.</span><span class="sxs-lookup"><span data-stu-id="8016a-957">The sender is responsible for making sure the data to send will fit into the receiver’s advertised window.</span></span>

| <span data-ttu-id="8016a-958">**Campo del encabezado**</span><span class="sxs-lookup"><span data-stu-id="8016a-958">**Header Field**</span></span>          | <span data-ttu-id="8016a-959">**Propósito**</span><span class="sxs-lookup"><span data-stu-id="8016a-959">**Purpose**</span></span> |
| ------------------------- | --- |
| <span data-ttu-id="8016a-960">**Suma de comprobación de TCP de 16 bits**</span><span class="sxs-lookup"><span data-stu-id="8016a-960">**16-bit TCP checksum**</span></span>   | <span data-ttu-id="8016a-961">Este campo contiene la suma de comprobación de 16 bits del paquete, incluidos el encabezado TCP, el área de datos del paquete y el encabezado pseudo IP.</span><span class="sxs-lookup"><span data-stu-id="8016a-961">This field contains the 16-bit checksum for the packet including the TCP header, the packet data area, and the pseudo IP header.</span></span>                |
| <span data-ttu-id="8016a-962">**Puntero urgente de 16 bits**</span><span class="sxs-lookup"><span data-stu-id="8016a-962">**16-bit urgent pointer**</span></span> | <span data-ttu-id="8016a-963">Este campo contiene el desplazamiento positivo del último byte de los datos urgentes.</span><span class="sxs-lookup"><span data-stu-id="8016a-963">This field contains the positive offset of the last byte of the urgent data.</span></span> <span data-ttu-id="8016a-964">Este campo solo es válido si se establece en el encabezado el bit de código URG.</span><span class="sxs-lookup"><span data-stu-id="8016a-964">This field is only valid if the URG code bit is set in the header.</span></span> |

> [!IMPORTANT]
> <span data-ttu-id="8016a-965">*Se espera que todos los encabezados de la implementación de TCP/IP estén en formato big endian. En este formato, el byte más significativo de la palabra reside en la dirección de bytes más baja.*</span><span class="sxs-lookup"><span data-stu-id="8016a-965">*All headers in the TCP/IP implementation are expected to be in big endian format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="tcp-enable"></a><span data-ttu-id="8016a-966">Habilitación de TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-966">TCP Enable</span></span>

<span data-ttu-id="8016a-967">Antes de que las conexiones TCP y las transmisiones de paquetes sean posibles, la aplicación debe habilitar primero TCP mediante una llamada al servicio nx_tcp_enable.</span><span class="sxs-lookup"><span data-stu-id="8016a-967">Before TCP connections and packet transmissions are possible, the application must first enable TCP by calling the nx_tcp_enable service.</span></span> <span data-ttu-id="8016a-968">Una vez habilitada, la aplicación puede acceder a todos los servicios de TCP.</span><span class="sxs-lookup"><span data-stu-id="8016a-968">After enabled, the application is free to access all TCP services.</span></span>

### <a name="tcp-socket-create"></a><span data-ttu-id="8016a-969">Creación de sockets TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-969">TCP Socket Create</span></span>

<span data-ttu-id="8016a-970">Los sockets TCP se crean durante la inicialización o en tiempo de ejecución mediante subprocesos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-970">TCP sockets are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="8016a-971">En el servicio ***nx_tcp_socket_create*** se definen el tipo inicial de servicio, el período de vida y el tamaño de la ventana.</span><span class="sxs-lookup"><span data-stu-id="8016a-971">The initial type of service, time to live, and window size are defined by the ***nx_tcp_socket_create*** service.</span></span> <span data-ttu-id="8016a-972">No hay ningún límite en el número de sockets TCP de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-972">There are no limits on the number of TCP sockets in an application.</span></span>

### <a name="tcp-checksum"></a><span data-ttu-id="8016a-973">Suma de comprobación de TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-973">TCP Checksum</span></span>

<span data-ttu-id="8016a-974">TCP especifica una suma de comprobación de 16 bits del complemento a uno que incluye el encabezado pseudo IP (que consta de la dirección IP de origen, la dirección IP de destino, el protocolo y la longitud de palabra de IP), el encabezado TCP y los datos del paquete TCP.</span><span class="sxs-lookup"><span data-stu-id="8016a-974">TCP specifies a one’s complement 16-bit checksum that covers the IP pseudo header, (consisting of the source IP address, destination IP address, and the protocol/length IP word), the TCP header, and the TCP packet data.</span></span>

<span data-ttu-id="8016a-975">Algunos controladores de red pueden realizar el cálculo y la validación de la suma de comprobación de TCP por hardware.</span><span class="sxs-lookup"><span data-stu-id="8016a-975">Certain network controllers are able to perform TCP checksum computation and validation in hardware.</span></span> <span data-ttu-id="8016a-976">En estos sistemas, es posible que las aplicaciones deseen usar la lógica de la suma de comprobación por hardware tanto como sea posible para reducir la sobrecarga en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="8016a-976">For such systems, applications may want to use hardware checksum logic as much as possible to reduce runtime overhead.</span></span> <span data-ttu-id="8016a-977">Las aplicaciones pueden deshabilitar por completo la lógica del cálculo de la suma de comprobación de TCP de la biblioteca de NetX en tiempo de compilación mediante la definición de **NX_DISABLE_TCP_TX_CHECKSUM** y **NX_DISABLE_TCP_RX_CHECKSUM**.</span><span class="sxs-lookup"><span data-stu-id="8016a-977">Applications may disable TCP checksum computation logic from the NetX library altogether at build time by defining **NX_DISABLE_TCP_TX_CHECKSUM** and **NX_DISABLE_TCP_RX_CHECKSUM**.</span></span> <span data-ttu-id="8016a-978">De esta manera, el código de la suma de comprobación de TCP no se compila.</span><span class="sxs-lookup"><span data-stu-id="8016a-978">This way, the TCP checksum code is not compiled in.</span></span>

### <a name="tcp-port"></a><span data-ttu-id="8016a-979">Puerto TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-979">TCP Port</span></span>

<span data-ttu-id="8016a-980">Un puerto TCP es un punto de conexión lógico en el protocolo TCP.</span><span class="sxs-lookup"><span data-stu-id="8016a-980">A TCP port is a logical connection point in the TCP protocol.</span></span> <span data-ttu-id="8016a-981">Hay 65 535 puertos válidos en el componente de TCP de NetX, que van del 1 al 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="8016a-981">There are 65,535 valid ports in the TCP component of NetX, ranging from 1 through 0xFFFF.</span></span> <span data-ttu-id="8016a-982">A diferencia de UDP, en el que los datos de un puerto se pueden enviar a cualquier otro puerto de destino, un puerto TCP se conecta a otro puerto TCP específico y solo cuando se establece esta conexión se puede realizar cualquier transferencia de datos, y solo entre los dos puertos que conforman la conexión.</span><span class="sxs-lookup"><span data-stu-id="8016a-982">Unlike UDP in which data from one port can be sent to any other destination port, a TCP port is connected to another specific TCP port, and only when this connection is established can any data transfer take place—and only between the two ports making up the connection.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-983">*Los puertos TCP son completamente independientes de los puertos UDP; es decir, el puerto UDP número 1 no tiene relación con el puerto TCP número 1.*</span><span class="sxs-lookup"><span data-stu-id="8016a-983">*TCP ports are completely separate from UDP ports; e.g., UDP port number 1 has no relation to TCP port number 1.*</span></span>

## <a name="client-server-model"></a><span data-ttu-id="8016a-984">Modelo cliente-servidor</span><span class="sxs-lookup"><span data-stu-id="8016a-984">Client-Server Model</span></span>

<span data-ttu-id="8016a-985">Para usar TCP para la transferencia de datos, primero se debe establecer una conexión entre los dos sockets TCP.</span><span class="sxs-lookup"><span data-stu-id="8016a-985">To use TCP for data transfer, a connection must first be established between the two TCP sockets.</span></span> <span data-ttu-id="8016a-986">El establecimiento de la conexión se realiza en modo cliente-servidor.</span><span class="sxs-lookup"><span data-stu-id="8016a-986">The establishment of the connection is done in a client-server fashion.</span></span> <span data-ttu-id="8016a-987">El lado cliente de la conexión es el lado que inicia la conexión, mientras que el lado servidor simplemente espera las solicitudes de conexión de cliente antes de que se realice cualquier procesamiento.</span><span class="sxs-lookup"><span data-stu-id="8016a-987">The client side of the connection is the side that initiates the connection, while the server side simply waits for client connection requests before any processing is done.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-988">*En el caso de los dispositivos de host múltiple, NetX determina automáticamente la dirección de origen que se usará para la conexión y la dirección del próximo salto en función de la dirección IP de destino de la conexión.*</span><span class="sxs-lookup"><span data-stu-id="8016a-988">*For multihome devices, NetX automatically determines the source address to use for the connection, and the next hop address based on the destination IP address of the connection.*</span></span>

### <a name="tcp-socket-state-machine"></a><span data-ttu-id="8016a-989">Máquina de estados del socket TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-989">TCP Socket State Machine</span></span>

<span data-ttu-id="8016a-990">La conexión entre dos sockets TCP (un cliente y un servidor) es compleja y se administra en modo de máquina de estados.</span><span class="sxs-lookup"><span data-stu-id="8016a-990">The connection between two TCP sockets (one client and one server) is complex and is managed in a state machine manner.</span></span> <span data-ttu-id="8016a-991">Cada socket TCP se inicia en estado CLOSED.</span><span class="sxs-lookup"><span data-stu-id="8016a-991">Each TCP socket starts in a CLOSED state.</span></span> <span data-ttu-id="8016a-992">Mediante los eventos de conexión, la máquina de estados de cada socket cambia al estado ESTABLISHED, que es donde tiene lugar la mayor parte de la transferencia de datos en TCP.</span><span class="sxs-lookup"><span data-stu-id="8016a-992">Through connection events each socket's state machine migrates into the ESTABLISHED state, which is where the bulk of the data transfer in TCP takes place.</span></span> <span data-ttu-id="8016a-993">Cuando un lado de la conexión ya no quiere enviar más datos, se desconecta.</span><span class="sxs-lookup"><span data-stu-id="8016a-993">When one side of the connection no longer wishes to send data, it disconnects.</span></span> <span data-ttu-id="8016a-994">Una vez que el otro lado se desconecta, el socket TCP vuelve al estado CLOSED.</span><span class="sxs-lookup"><span data-stu-id="8016a-994">After the other side disconnects, eventually the TCP socket returns to the CLOSED state.</span></span> <span data-ttu-id="8016a-995">Este proceso se repite cada vez que un cliente y un servidor TCP establecen y cierran una conexión.</span><span class="sxs-lookup"><span data-stu-id="8016a-995">This process repeats each time a TCP client and server establish and close a connection.</span></span> <span data-ttu-id="8016a-996">En la figura 11 se muestran los distintos estados de la máquina de estados de TCP.</span><span class="sxs-lookup"><span data-stu-id="8016a-996">Figure 11 shows the various states of the TCP state machine.</span></span>

![Estados de la máquina de estados de TCP](./media/user-guide/states-tcp-state-machine.png)

### <a name="figure-11-states-of-the-tcp-state-machine"></a><span data-ttu-id="8016a-998">FIGURA 11.</span><span class="sxs-lookup"><span data-stu-id="8016a-998">FIGURE 11.</span></span> <span data-ttu-id="8016a-999">Estados de la máquina de estados de TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-999">States of the TCP State Machine</span></span>

### <a name="tcp-client-connection"></a><span data-ttu-id="8016a-1000">Conexión del cliente TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1000">TCP Client Connection</span></span>

<span data-ttu-id="8016a-1001">Como se mencionó anteriormente, el lado cliente de la conexión TCP inicia una solicitud de conexión a un servidor TCP.</span><span class="sxs-lookup"><span data-stu-id="8016a-1001">As mentioned previously, the client side of the TCP connection initiates a connection request to a TCP server.</span></span> <span data-ttu-id="8016a-1002">Antes de que se pueda realizar una solicitud de conexión, TCP debe estar habilitado en la instancia de IP del cliente.</span><span class="sxs-lookup"><span data-stu-id="8016a-1002">Before a connection request can be made, TCP must be enabled on the client IP instance.</span></span> <span data-ttu-id="8016a-1003">Además, el socket TCP del cliente debe crearse con el servicio ***nx_tcp_socket_create** _ y enlazarse a un puerto mediante el servicio _*_nx_tcp_client_socket_bind_\*_.</span><span class="sxs-lookup"><span data-stu-id="8016a-1003">In addition, the client TCP socket must next be created with the ***nx_tcp_socket_create** _ service and bound to a port via the _*_nx_tcp_client_socket_bind_\*_ service.</span></span> <span data-ttu-id="8016a-1004">Una vez enlazado el socket de cliente, se utiliza el servicio _ *_nx_tcp_client_socket_connect_*\* se usa para establecer una conexión con un servidor TCP.</span><span class="sxs-lookup"><span data-stu-id="8016a-1004">After the client socket is bound, the _ *_nx_tcp_client_socket_connect_*\* service is used to establish a connection with a TCP server.</span></span> <span data-ttu-id="8016a-1005">Tenga en cuenta que el socket debe estar en estado CLOSED para iniciar un intento de conexión.</span><span class="sxs-lookup"><span data-stu-id="8016a-1005">Note the socket must be in a CLOSED state to initiate a connection attempt.</span></span> <span data-ttu-id="8016a-1006">El establecimiento de la conexión empieza por la emisión de un paquete SYN y, a continuación, se espera a que vuelva un paquete SYN ACK desde el servidor, lo que significa que se acepta la solicitud de conexión.</span><span class="sxs-lookup"><span data-stu-id="8016a-1006">Establishing the connection starts with NetX issuing a SYN packet and then waiting for a SYN ACK packet back from the server, which signifies acceptance of the connection request.</span></span> <span data-ttu-id="8016a-1007">Una vez recibido el paquete SYN ACK, NetX responde con un paquete ACK y promueve el socket de cliente al estado ESTABLISHED.</span><span class="sxs-lookup"><span data-stu-id="8016a-1007">After the SYN ACK is received, NetX responds with an ACK packet and promotes the client socket to the ESTABLISHED state.</span></span>

### <a name="tcp-client-disconnection"></a><span data-ttu-id="8016a-1008">Desconexión del cliente TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1008">TCP Client Disconnection</span></span>

<span data-ttu-id="8016a-1009">El cierre de la conexión se realiza mediante una llamada a ***nx_tcp_socket_disconnect***.</span><span class="sxs-lookup"><span data-stu-id="8016a-1009">Closing the connection is accomplished by calling ***nx_tcp_socket_disconnect***.</span></span> <span data-ttu-id="8016a-1010">Si no se especifica ninguna suspensión, el socket de cliente envía un paquete RST al socket de servidor y coloca el socket en estado CLOSED.</span><span class="sxs-lookup"><span data-stu-id="8016a-1010">If no suspension is specified, the client socket sends a RST packet to the server socket and places the socket in the CLOSED state.</span></span> <span data-ttu-id="8016a-1011">De lo contrario, si se solicita una suspensión, se realiza el protocolo de desconexión TCP completo, como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="8016a-1011">Otherwise, if a suspension is requested, the full TCP disconnect protocol is performed, as follows:</span></span>

- <span data-ttu-id="8016a-1012">Si el servidor ha iniciado previamente una solicitud de desconexión (el socket de cliente ya ha recibido un paquete FIN, ha respondido con un paquete ACK y está en estado CLOSE WAIT), NetX promueve el estado del socket TCP de cliente al estado LAST ACK y envía un paquete FIN.</span><span class="sxs-lookup"><span data-stu-id="8016a-1012">If the server previously initiated a disconnect request (the client socket has already received a FIN packet, responded with an ACK, and is in the CLOSE WAIT state), NetX promotes the client TCP socket state to the LAST ACK state and sends a FIN packet.</span></span> <span data-ttu-id="8016a-1013">Después, espera un paquete ACK del servidor antes de completar la desconexión y de entrar en estado CLOSED.</span><span class="sxs-lookup"><span data-stu-id="8016a-1013">It then waits for an ACK from the server before completing the disconnect and entering the CLOSED state.</span></span>

- <span data-ttu-id="8016a-1014">Por otro lado, si el cliente es el primero en iniciar una solicitud de desconexión (el servidor no se ha desconectado y el socket todavía está en estado ESTABLISHED), NetX envía un paquete FIN para iniciar la desconexión y espera a recibir un paquete FIN y un paquete ACK del servidor antes de completar la desconexión y colocar el socket en estado CLOSED.</span><span class="sxs-lookup"><span data-stu-id="8016a-1014">If on the other hand, the client is the first to initiate a disconnect request (the server has not disconnected and the socket is still in the ESTABLISHED state), NetX sends a FIN packet to initiate the disconnect and waits to receive a FIN and an ACK from the server before completing the disconnect and placing the socket in a CLOSED state.</span></span>

<span data-ttu-id="8016a-1015">Si todavía hay paquetes en la cola de transmisión del socket, NetX hace una suspensión durante el tiempo de espera especificado para permitir que se confirmen los paquetes.</span><span class="sxs-lookup"><span data-stu-id="8016a-1015">If there are still packets on the socket transmit queue, NetX suspends for the specified timeout to allow the packets to be acknowledged.</span></span> <span data-ttu-id="8016a-1016">Si se agota el tiempo de espera, NetX vacía la cola de transmisión del socket de cliente.</span><span class="sxs-lookup"><span data-stu-id="8016a-1016">If the timeout expires, NetX empties the transmit queue of the client socket.</span></span>

<span data-ttu-id="8016a-1017">Para desenlazar el puerto del socket de cliente, la aplicación llama a ***nx_tcp_client_socket_unbind***.</span><span class="sxs-lookup"><span data-stu-id="8016a-1017">To unbind the port from the client socket, the application calls ***nx_tcp_client_socket_unbind***.</span></span> <span data-ttu-id="8016a-1018">El socket se debe encontrar en estado CLOSED o en el proceso de desconexión (por ejemplo, TIMED WAIT) antes de que se libere el puerto; de lo contrario, se devuelve un error.</span><span class="sxs-lookup"><span data-stu-id="8016a-1018">The socket must be in a CLOSED state or in the process of disconnecting (i.e., TIMED WAIT state) before the port is released; otherwise, an error is returned.</span></span>

<span data-ttu-id="8016a-1019">Por último, si la aplicación ya no necesita el socket de cliente, llama a ***nx_tcp_socket_delete*** para eliminar el socket.</span><span class="sxs-lookup"><span data-stu-id="8016a-1019">Finally, if the application no longer needs the client socket, it calls ***nx_tcp_socket_delete*** to delete the socket.</span></span>

### <a name="tcp-server-connection"></a><span data-ttu-id="8016a-1020">Conexión del servidor TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1020">TCP Server Connection</span></span>

<span data-ttu-id="8016a-1021">El lado servidor de una conexión TCP es pasivo; es decir, el servidor espera a que un cliente inicie la solicitud de conexión.</span><span class="sxs-lookup"><span data-stu-id="8016a-1021">The server side of a TCP connection is passive; i.e., the server waits for a client to initiate connection request.</span></span> <span data-ttu-id="8016a-1022">Para aceptar una conexión de cliente, TCP debe estar habilitado antes en la instancia de IP mediante una llamada al servicio \***nx_tcp_enable** _.</span><span class="sxs-lookup"><span data-stu-id="8016a-1022">To accept a client connection, TCP must first be enabled on the IP instance by calling the service \***nx_tcp_enable** _.</span></span> <span data-ttu-id="8016a-1023">A continuación, la aplicación debe crear un socket TCP mediante el servicio _ \*_nx_tcp_socket_create_\*\*.</span><span class="sxs-lookup"><span data-stu-id="8016a-1023">Next, the application must create a TCP socket using the _ *_nx_tcp_socket_create_*\* service.</span></span>

<span data-ttu-id="8016a-1024">También se debe configurar el socket de servidor para la escucha de solicitudes de conexión.</span><span class="sxs-lookup"><span data-stu-id="8016a-1024">The server socket must also be set up for listening for connection requests.</span></span> <span data-ttu-id="8016a-1025">Esto se realiza mediante el servicio ***nx_tcp_server_socket_listen***.</span><span class="sxs-lookup"><span data-stu-id="8016a-1025">This is achieved by using the ***nx_tcp_server_socket_listen*** service.</span></span> <span data-ttu-id="8016a-1026">Este servicio coloca el socket de servidor en estado LISTEN y enlaza el puerto especificado del servidor al socket.</span><span class="sxs-lookup"><span data-stu-id="8016a-1026">This service places the server socket in the LISTEN state and binds the specified server port to the socket.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-1027">*Para establecer una rutina de devolución de llamada de escucha de sockets, la aplicación especifica la función de devolución de llamada adecuada para el argumento tcp_listen_callback del servicio **nx_tcp_server_socket_listen**. En este momento, NetX ejecutará la función de devolución de llamada de la aplicación siempre que se solicite una nueva conexión en este puerto del servidor. El procesamiento de la devolución de llamada está bajo el control de la aplicación.*</span><span class="sxs-lookup"><span data-stu-id="8016a-1027">*To set a socket listen callback routine the application specifies the appropriate callback function for the tcp_listen_callback argument of the **nx_tcp_server_socket_listen** service. This application callback function is then executed by NetX whenever a new connection is requested on this server port. The processing in the callback is under application control.*</span></span>

<span data-ttu-id="8016a-1028">Para aceptar solicitudes de conexión de cliente, la aplicación llama al servicio \***nx_tcp_server_socket_accept** _.</span><span class="sxs-lookup"><span data-stu-id="8016a-1028">To accept client connection requests, the application calls the \***nx_tcp_server_socket_accept** _ service.</span></span> <span data-ttu-id="8016a-1029">El socket de servidor debe estar en estado LISTEN o en estado SYN RECEIVED (es decir, el servidor está en estado LISTEN y ha recibido un paquete SYN de un cliente que solicita una conexión) para llamar al servicio de aceptación.</span><span class="sxs-lookup"><span data-stu-id="8016a-1029">The server socket must either be in a LISTEN state or a SYN RECEIVED state (i.e., the server is in the LISTEN state and has received a SYN packet from a client requesting a connection) to call the accept service.</span></span> <span data-ttu-id="8016a-1030">Un estado de devolución correcto desde _ *_nx_tcp_server_socket_accept_*\* indica que se ha configurado la conexión y el socket de servidor está en estado ESTABLISHED.</span><span class="sxs-lookup"><span data-stu-id="8016a-1030">A successful return status from _ *_nx_tcp_server_socket_accept_*\* indicates the connection has been set up and the server socket is in the ESTABLISHED state.</span></span>

<span data-ttu-id="8016a-1031">Una vez que el socket de servidor tenga una conexión válida, las solicitudes de conexión de cliente adicionales se ponen en cola hasta la profundidad especificada por el parámetro *listen_queue_size*, que se pasa al servicio \***nx_tcp_server_socket_listen** _.</span><span class="sxs-lookup"><span data-stu-id="8016a-1031">After the server socket has a valid connection, additional client connection requests are queued up to the depth specified by the *listen_queue_size*, passed into the \***nx_tcp_server_socket_listen** _ service.</span></span> <span data-ttu-id="8016a-1032">Para procesar las conexiones posteriores en un puerto del servidor, la aplicación debe llamar a _ *_nx_tcp_server_socket_relisten_*\* con un socket disponible (es decir, un socket en estado CLOSED).</span><span class="sxs-lookup"><span data-stu-id="8016a-1032">In order to process subsequent connections on a server port, the application must call _ *_nx_tcp_server_socket_relisten_*\* with an available socket (i.e., a socket in a CLOSED state).</span></span> <span data-ttu-id="8016a-1033">Tenga en cuenta que se puede usar el mismo socket de servidor si ya ha finalizado la conexión anterior asociada con el socket y el socket está en estado CLOSED.</span><span class="sxs-lookup"><span data-stu-id="8016a-1033">Note that the same server socket could be used if the previous connection associated with the socket is now finished and the socket is in the CLOSED state.</span></span>

### <a name="tcp-server-disconnection"></a><span data-ttu-id="8016a-1034">Desconexión del servidor TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1034">TCP Server Disconnection</span></span>

<span data-ttu-id="8016a-1035">El cierre de la conexión se realiza mediante una llamada a ***nx_tcp_socket_disconnect***.</span><span class="sxs-lookup"><span data-stu-id="8016a-1035">Closing the connection is accomplished by calling ***nx_tcp_socket_disconnect***.</span></span> <span data-ttu-id="8016a-1036">Si no se especifica ninguna suspensión, el socket de servidor envía un paquete RST al socket de cliente y coloca el socket en estado CLOSED.</span><span class="sxs-lookup"><span data-stu-id="8016a-1036">If no suspension is specified, the server socket sends a RST packet to the client socket and places the socket in the CLOSED state.</span></span> <span data-ttu-id="8016a-1037">De lo contrario, si se solicita una suspensión, se realiza el protocolo de desconexión TCP completo, como se indica a continuación: |</span><span class="sxs-lookup"><span data-stu-id="8016a-1037">Otherwise, if a suspension is requested, the full TCP disconnect protocol is performed, as follows: |</span></span>

- <span data-ttu-id="8016a-1038">Si el cliente ha iniciado previamente una solicitud de desconexión (el socket de servidor ya ha recibido un paquete FIN, ha respondido con un paquete ACK y está en estado CLOSE WAIT), NetX promueve el estado del socket TCP al estado LAST ACK y envía un paquete FIN.</span><span class="sxs-lookup"><span data-stu-id="8016a-1038">If the client previously initiated a disconnect request (the server socket has already received a FIN packet, responded with an ACK, and is in the CLOSE WAIT state), NetX promotes the TCP socket state to the LAST ACK state and sends a FIN packet.</span></span> <span data-ttu-id="8016a-1039">Después, espera un paquete ACK del cliente antes de completar la desconexión y de entrar en estado CLOSED.</span><span class="sxs-lookup"><span data-stu-id="8016a-1039">It then waits for an ACK from the client before completing the disconnect and entering the CLOSED state.</span></span>

- <span data-ttu-id="8016a-1040">Por otro lado, si el servidor es el primero en iniciar una solicitud de desconexión (el cliente no se ha desconectado y el socket todavía está en estado ESTABLISHED), NetX envía un paquete FIN para iniciar la desconexión y espera a recibir un paquete FIN y un paquete ACK del cliente antes de completar la desconexión y colocar el socket en estado CLOSED.</span><span class="sxs-lookup"><span data-stu-id="8016a-1040">If on the other hand, the server is the first to initiate a disconnect request (the client has not disconnected and the socket is still in the ESTABLISHED state), NetX sends a FIN packet to initiate the disconnect and waits to receive a FIN and an ACK from the client before completing the disconnect and placing the socket in a CLOSED state.</span></span>

<span data-ttu-id="8016a-1041">Si todavía hay paquetes en la cola de transmisión del socket, NetX hace una suspensión durante el tiempo de espera especificado para permitir que se confirmen esos paquetes.</span><span class="sxs-lookup"><span data-stu-id="8016a-1041">If there are still packets on the socket transmit queue, NetX suspends for the specified timeout to allow those packets to be acknowledged.</span></span> <span data-ttu-id="8016a-1042">Si se agota el tiempo de espera, NetX vacía la cola de transmisión del socket de servidor.</span><span class="sxs-lookup"><span data-stu-id="8016a-1042">If the timeout expires, NetX flushes the transmit queue of the server socket.</span></span>

<span data-ttu-id="8016a-1043">Una vez completado el procesamiento de la desconexión y que el socket de servidor se encuentre en estado CLOSED, la aplicación debe llamar al servicio ***nx_tcp_server_socket_unaccept*** para finalizar la asociación de este socket con el puerto del servidor.</span><span class="sxs-lookup"><span data-stu-id="8016a-1043">After the disconnect processing is complete and the server socket is in the CLOSED state, the application must call the ***nx_tcp_server_socket_unaccept*** service to end the association of this socket with the server port.</span></span> <span data-ttu-id="8016a-1044">Tenga en cuenta que la aplicación debe llamar a este servicio aunque ***nx_tcp_socket_disconnect*** o \***nx_tcp_server_socket_accept** _ devuelvan un estado de error.</span><span class="sxs-lookup"><span data-stu-id="8016a-1044">Note this service must be called by the application even if ***nx_tcp_socket_disconnect*** or \***nx_tcp_server_socket_accept** _ return an error status.</span></span> <span data-ttu-id="8016a-1045">Después de la devolución de _ \*_nx_tcp_server_socket_unaccept_\*\*, el socket se puede usar como un socket de cliente o de servidor, o incluso eliminarse si ya no se necesita.</span><span class="sxs-lookup"><span data-stu-id="8016a-1045">After the _ *_nx_tcp_server_socket_unaccept_*\* returns, the socket can be used as a client or server socket, or even deleted if it is no longer needed.</span></span> <span data-ttu-id="8016a-1046">Si se desea aceptar otra conexión de cliente en el mismo puerto de servidor, se debe llamar al servicio ***nx_tcp_server_socket_relisten*** en este socket.</span><span class="sxs-lookup"><span data-stu-id="8016a-1046">If accepting another client connection on the same server port is desired, the ***nx_tcp_server_socket_relisten*** service should be called on this socket.</span></span>

<span data-ttu-id="8016a-1047">En el segmento de código siguiente se muestra la secuencia de llamadas que usa un servidor TCP típico:</span><span class="sxs-lookup"><span data-stu-id="8016a-1047">The following code segment illustrates the sequence of calls a typical TCP server uses:</span></span>

```c
/* Set up a previously created TCP socket to listen on port 12 */

nx_tcp_server_socket_listen()

/* Loop to make a (another) connection. */
while(1) {

    /* Wait for a client socket connection request for 100 ticks. */
    nx_tcp_server_socket_accept();

    /* (Send and receive TCP messages with the TCP client) */

    /* Disconnect the server socket. */
    nx_tcp_socket_disconnect();

    /* Remove this server socket from listening on the port. */

    nx_tcp_server_socket_unaccept(&server_socket);

    /* Set up server socket to relisten on the same port for the next
    client. */
    nx_tcp_server_socket_relisten();
}
```

### <a name="mss-validation"></a><span data-ttu-id="8016a-1048">Validación de MSS</span><span class="sxs-lookup"><span data-stu-id="8016a-1048">MSS Validation</span></span>

<span data-ttu-id="8016a-1049">El tamaño máximo de segmento (MSS) es la cantidad máxima de bytes que puede recibir un host TCP sin que la capa IP subyacente los fragmente.</span><span class="sxs-lookup"><span data-stu-id="8016a-1049">The Maximum Segment Size (MSS) is the maximum amount of bytes a TCP host can receive without being fragmented by the underlying IP layer.</span></span> <span data-ttu-id="8016a-1050">Durante la fase de establecimiento de la conexión TCP, ambos extremos intercambian su propio valor de MSS de TCP, por lo que el remitente no envía un segmento de datos TCP mayor que el valor de MSS del receptor.</span><span class="sxs-lookup"><span data-stu-id="8016a-1050">During TCP connection establishment phase, both ends exchanges its own TCP MSS value, so that the sender does not send a TCP data segment that is larger than the receiver's MSS.</span></span> <span data-ttu-id="8016a-1051">El módulo TCP de NetX validará opcionalmente el valor de MSS anunciado de su nodo del mismo nivel antes de establecer una conexión.</span><span class="sxs-lookup"><span data-stu-id="8016a-1051">NetX TCP module will optionally validate its peer's advertised MSS value before establishing a connection.</span></span> <span data-ttu-id="8016a-1052">De forma predeterminada, NetX no habilita este tipo de comprobación.</span><span class="sxs-lookup"><span data-stu-id="8016a-1052">By default NetX does not enable such a check.</span></span> <span data-ttu-id="8016a-1053">Las aplicaciones que deseen realizar la validación de MSS definirán ***NX_ENABLE_TCP_MSS_CHECKING** _ al compilar la biblioteca de NetX y el valor mínimo se definirá en _*_NX_TCP_MSS_MINIMUM_\*_.</span><span class="sxs-lookup"><span data-stu-id="8016a-1053">Applications wishing to perform MSS validation shall define ***NX_ENABLE_TCP_MSS_CHECKING** _ when building the NetX library, and the minimum value shall be defined in _*_NX_TCP_MSS_MINIMUM_\*_.</span></span> <span data-ttu-id="8016a-1054">Se anulan las conexiones TCP entrantes con valores de MSS inferiores a _ \*_NX_TCP_MSS_MINIMUM_\*\*.</span><span class="sxs-lookup"><span data-stu-id="8016a-1054">Incoming TCP connections with MSS values below _ *_NX_TCP_MSS_MINIMUM_*\* are dropped.</span></span>

### <a name="stop-listening-on-a-server-port"></a><span data-ttu-id="8016a-1055">Detención de la escucha en un puerto del servidor</span><span class="sxs-lookup"><span data-stu-id="8016a-1055">Stop Listening on a Server Port</span></span>

<span data-ttu-id="8016a-1056">Si la aplicación ya no desea escuchar las solicitudes de conexión de cliente en un puerto del servidor que se especificó anteriormente mediante una llamada al servicio \***nx_tcp_server_socket_listen** _, la aplicación simplemente llamará al servicio _ \*_nx_tcp_server_socket_unlisten_\*\*.</span><span class="sxs-lookup"><span data-stu-id="8016a-1056">If the application no longer wishes to listen for client connection requests on a server port that was previously specified by a call to the ***nx_tcp_server_socket_listen** _ service, the application simply calls the _ *_nx_tcp_server_socket_unlisten_** service.</span></span> <span data-ttu-id="8016a-1057">Este servicio coloca cualquier socket en espera de una conexión en estado CLOSED y libera los paquetes de solicitud de conexión de cliente en cola.</span><span class="sxs-lookup"><span data-stu-id="8016a-1057">This service places any socket waiting for a connection back in the CLOSED state and releases any queued client connection request packets.</span></span>

### <a name="tcp-window-size"></a><span data-ttu-id="8016a-1058">Tamaño de la ventana de TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1058">TCP Window Size</span></span>

<span data-ttu-id="8016a-1059">Durante las fases de configuración y transferencia de datos de la conexión, cada puerto informa de la cantidad de datos que puede controlar, llamada tamaño de la ventana.</span><span class="sxs-lookup"><span data-stu-id="8016a-1059">During both the setup and data transfer phases of the connection, each port reports the amount of data it can handle, which is called its window size.</span></span> <span data-ttu-id="8016a-1060">A medida que se reciben y procesan los datos, el tamaño de esta ventana se ajusta dinámicamente.</span><span class="sxs-lookup"><span data-stu-id="8016a-1060">As data are received and processed, this window size is adjusted dynamically.</span></span> <span data-ttu-id="8016a-1061">En TCP, un remitente solo puede enviar una cantidad de datos que quepan en la ventana del receptor.</span><span class="sxs-lookup"><span data-stu-id="8016a-1061">In TCP, a sender can only send an amount of data that fits into the receiver's window.</span></span> <span data-ttu-id="8016a-1062">En esencia, el tamaño de la ventana proporciona el control de flujo para la transferencia de datos en cada dirección de la conexión.</span><span class="sxs-lookup"><span data-stu-id="8016a-1062">In essence, the window size provides flow control for data transfer in each direction of the connection.</span></span>

### <a name="tcp-packet-send"></a><span data-ttu-id="8016a-1063">Envío de paquetes TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1063">TCP Packet Send</span></span>

<span data-ttu-id="8016a-1064">El envío de datos TCP se realiza fácilmente mediante una llamada a la función ***nx_tcp_socket_send***.</span><span class="sxs-lookup"><span data-stu-id="8016a-1064">Sending TCP data is easily accomplished by calling the ***nx_tcp_socket_send*** function.</span></span> <span data-ttu-id="8016a-1065">Si el tamaño de los datos que se van a transmitir es mayor que el valor de MSS del socket o que el tamaño actual de la ventana de recepción del nodo del mismo nivel, lo que sea menor, la lógica interna de TCP divide los datos que caben en min(MSS, ventana de recepción del nodo del mismo nivel) para la transmisión.</span><span class="sxs-lookup"><span data-stu-id="8016a-1065">If the size of the data being transmitted is larger than the MSS value of the socket or the current peer receive window size, whichever is smaller, TCP internal logic carves off the data that fits into min (MSS, peer receive Window) for transmission.</span></span> <span data-ttu-id="8016a-1066">A continuación, este servicio crea un encabezado TCP delante del paquete (incluido el cálculo de la suma de comprobación).</span><span class="sxs-lookup"><span data-stu-id="8016a-1066">This service then builds a TCP header in front of the packet (including the checksum calculation).</span></span> <span data-ttu-id="8016a-1067">Si el tamaño de la ventana del receptor no es cero, el autor de llamada enviará tantos datos como pueda para llenar el tamaño de la ventana del receptor.</span><span class="sxs-lookup"><span data-stu-id="8016a-1067">If the receiver's window size is not zero, the caller will send as much data as it can to fill up the receiver window size.</span></span> <span data-ttu-id="8016a-1068">Si el tamaño de la ventana de recepción se convierte en cero, el autor de llamada puede suspender y esperar a que el tamaño de la ventana del receptor aumente lo suficiente para que se envíe este paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-1068">If the receive window becomes zero, the caller may suspend and wait for the receiver's window size to increase enough for this packet to be sent.</span></span> <span data-ttu-id="8016a-1069">En un momento dado, se pueden suspender varios subprocesos mientras intentan enviar datos mediante el mismo socket.</span><span class="sxs-lookup"><span data-stu-id="8016a-1069">At any given time, multiple threads may suspend while trying to send data through the same socket.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-1070">*Los datos TCP que residen en la estructura NX_PACKET deben residir en un límite de palabra larga. Además, debe haber espacio suficiente entre el puntero antepuesto y el puntero de inicio de datos para colocar los encabezados del soporte físico, IP y TCP.*</span><span class="sxs-lookup"><span data-stu-id="8016a-1070">*The TCP data residing in the NX_PACKET structure should reside on a long-word boundary. In addition, there needs to be sufficient space between the prepend pointer and the data start pointer to place the TCP, IP, and physical media headers.*</span></span>

### <a name="tcp-packet-retransmit"></a><span data-ttu-id="8016a-1071">Retransmisión de paquetes TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1071">TCP Packet Retransmit</span></span>

<span data-ttu-id="8016a-1072">Los paquetes TCP transmitidos previamente enviados realmente se almacenan internamente hasta que se devuelva un mensaje ACK desde el otro lado de la conexión.</span><span class="sxs-lookup"><span data-stu-id="8016a-1072">Previously transmitted TCP packets sent actually stored internally until an ACK is returned from the other side of the connection.</span></span> <span data-ttu-id="8016a-1073">Si los datos transmitidos no se confirman dentro del período de tiempo de espera, el paquete almacenado se vuelve a enviar y se establece el período de tiempo de espera siguiente.</span><span class="sxs-lookup"><span data-stu-id="8016a-1073">If transmitted data is not acknowledged within the timeout period, the stored packet is re-sent and the next timeout period is set.</span></span> <span data-ttu-id="8016a-1074">Cuando se recibe un mensaje ACK, finalmente se liberan todos los paquetes que están incluidos en el número de confirmación de la cola de transmisión interna.</span><span class="sxs-lookup"><span data-stu-id="8016a-1074">When an ACK is received, all packets covered by the acknowledgement number in the internal transmit queue are finally released.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8016a-1075">\*La aplicación no debe reutilizar el paquete ni modificar el contenido del paquete después de la devolución de la función \***nx_tcp_socket_send** _ con NX_SUCCESS.</span><span class="sxs-lookup"><span data-stu-id="8016a-1075">\*Application shall not reuse the packet or alter the contents of the packet after the \***nx_tcp_socket_send** _ function returns with NX_SUCCESS.</span></span> <span data-ttu-id="8016a-1076">Finalmente, el procesamiento interno de NetX libera el paquete transmitido una vez que los datos se han confirmado por el otro extremo._</span><span class="sxs-lookup"><span data-stu-id="8016a-1076">The transmitted packet is eventually released by NetX internal processing after the data is acknowledged by the other end._</span></span>

### <a name="tcp-keepalive"></a><span data-ttu-id="8016a-1077">KeepAlive de TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1077">TCP Keepalive</span></span>

<span data-ttu-id="8016a-1078">La característica KeepAlive de TCP permite a un socket detectar si su nodo del mismo nivel se desconecta sin la terminación adecuada (por ejemplo, un nodo bloqueado) o impedir que determinadas funciones de supervisión de red finalicen una conexión durante períodos prolongados de inactividad.</span><span class="sxs-lookup"><span data-stu-id="8016a-1078">TCP Keepalive feature allows a socket to detect whether or not its peer disconnects without proper termination (for example, the peer crashed), or to prevent certain network monitoring facilities to terminate a connection for long periods of idle.</span></span> <span data-ttu-id="8016a-1079">KeepAlive de TCP funciona enviando periódicamente un marco TCP sin datos y con el número de secuencia establecido en uno menos que el número de secuencia actual.</span><span class="sxs-lookup"><span data-stu-id="8016a-1079">TCP Keepalive works by periodically sending a TCP frame with no data, and the sequence number set to one less than the current sequence number.</span></span> <span data-ttu-id="8016a-1080">Al recibir este marco de KeepAlive de TCP, el destinatario, si sigue activo, responde con un mensaje ACK para su número de secuencia actual.</span><span class="sxs-lookup"><span data-stu-id="8016a-1080">On receiving such TCP Keepalive frame, the recipient, if still alive, responses with an ACK for its current sequence number.</span></span> <span data-ttu-id="8016a-1081">Esto completa la transacción de KeepAlive.</span><span class="sxs-lookup"><span data-stu-id="8016a-1081">This completes the keepalive transaction.</span></span>

<span data-ttu-id="8016a-1082">De manera predeterminada, la característica KeepAlive no está habilitada.</span><span class="sxs-lookup"><span data-stu-id="8016a-1082">By default the keepalive feature is not enabled.</span></span> <span data-ttu-id="8016a-1083">Para usar esta característica, se debe compilar la biblioteca de NetX con \***NX_ENABLE_TCP_KEEPALIVE** _ definido.</span><span class="sxs-lookup"><span data-stu-id="8016a-1083">To use this feature, NetX library must be built with \***NX_ENABLE_TCP_KEEPALIVE** _ defined.</span></span> <span data-ttu-id="8016a-1084">El símbolo _ *_NX_TCP_KEEPALIVE_INITIAL_*\* especifica el número de segundos de inactividad antes de que se inicie el marco de KeepAlive.</span><span class="sxs-lookup"><span data-stu-id="8016a-1084">The symbol _ *_NX_TCP_KEEPALIVE_INITIAL_*\* specifies the number of seconds of inactivity before the keepalive frame is initiated.</span></span>

### <a name="tcp-packet-receive"></a><span data-ttu-id="8016a-1085">Recepción de paquetes TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1085">TCP Packet Receive</span></span>

<span data-ttu-id="8016a-1086">El procesamiento de paquetes de recepción TCP (llamado desde el subproceso auxiliar de IP) es responsable de administrar varias acciones de conexión y desconexión, así como de transmitir el procesamiento de confirmación.</span><span class="sxs-lookup"><span data-stu-id="8016a-1086">The TCP receive packet processing (called from the IP helper thread) is responsible for handling various connection and disconnection actions as well as transmit acknowledge processing.</span></span> <span data-ttu-id="8016a-1087">Además, el procesamiento de paquetes de recepción TCP es responsable de colocar los paquetes con los datos recibidos en la cola de recepción del socket TCP correspondiente o de entregar el paquete al primer subproceso suspendido a la espera de un paquete.</span><span class="sxs-lookup"><span data-stu-id="8016a-1087">In addition, the TCP receive packet processing is responsible for placing packets with receive data on the appropriate TCP socket's receive queue or delivering the packet to the first suspended thread waiting for a packet.</span></span>

### <a name="tcp-receive-notify"></a><span data-ttu-id="8016a-1088">Notificación de recepción de TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1088">TCP Receive Notify</span></span>

<span data-ttu-id="8016a-1089">Si el subproceso de la aplicación debe procesar los datos recibidos desde más de un socket, se debe usar la función ***nx_tcp_socket_receive_notify***.</span><span class="sxs-lookup"><span data-stu-id="8016a-1089">If the application thread needs to process received data from more than one socket, the ***nx_tcp_socket_receive_notify*** function should be used.</span></span> <span data-ttu-id="8016a-1090">Esta función registra una función de devolución de llamada de paquetes de recepción para el socket.</span><span class="sxs-lookup"><span data-stu-id="8016a-1090">This function registers a receive packet callback function for the socket.</span></span> <span data-ttu-id="8016a-1091">Cada vez que se recibe un paquete en el socket, se ejecuta la función de devolución de llamada.</span><span class="sxs-lookup"><span data-stu-id="8016a-1091">Whenever a packet is received on the socket, the callback function is executed.</span></span>

<span data-ttu-id="8016a-1092">El contenido de la función de devolución de llamada es específico de la aplicación; sin embargo, la función probablemente contendría lógica para informar al subproceso de procesamiento de que está disponible un paquete en el socket correspondiente.</span><span class="sxs-lookup"><span data-stu-id="8016a-1092">The contents of the callback function are application-specific; however, the function would most likely contain logic to inform the processing thread that a packet is available on the corresponding socket.</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="8016a-1093">Suspensión de subprocesos</span><span class="sxs-lookup"><span data-stu-id="8016a-1093">Thread Suspension</span></span>

<span data-ttu-id="8016a-1094">Como se ha mencionado anteriormente, los subprocesos de la aplicación se pueden suspender al intentar recibir datos desde un puerto TCP determinado.</span><span class="sxs-lookup"><span data-stu-id="8016a-1094">As mentioned previously, application threads can suspend while attempting to receive data from a particular TCP port.</span></span> <span data-ttu-id="8016a-1095">Una vez que se recibe un paquete en ese puerto, se asigna al primer subproceso suspendido y, a continuación, se reanuda el subproceso.</span><span class="sxs-lookup"><span data-stu-id="8016a-1095">After a packet is received on that port, it is given to the first thread suspended and that thread is then resumed.</span></span> <span data-ttu-id="8016a-1096">Está disponible un tiempo de espera opcional cuando hay una suspensión en la recepción de un paquete TCP, una característica disponible para la mayoría de los servicios de NetX.</span><span class="sxs-lookup"><span data-stu-id="8016a-1096">An optional timeout is available when suspending on a TCP receive packet, a feature available for most NetX services.</span></span>

<span data-ttu-id="8016a-1097">La suspensión de subprocesos también está disponible para los servicios de conexión (cliente y servidor), enlace de cliente y desconexión.</span><span class="sxs-lookup"><span data-stu-id="8016a-1097">Thread suspension is also available for connection (both client and server), client binding, and disconnection services.</span></span>

### <a name="tcp-socket-statistics-and-errors"></a><span data-ttu-id="8016a-1098">Estadísticas y errores del socket TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1098">TCP Socket Statistics and Errors</span></span>

<span data-ttu-id="8016a-1099">Si se habilita, el software de socket TCP de NetX realiza un seguimiento de varias estadísticas y errores que pueden ser útiles para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="8016a-1099">If enabled, the NetX TCP socket software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="8016a-1100">Se mantienen las estadísticas y los informes de errores siguientes para cada instancia de IP/TCP:</span><span class="sxs-lookup"><span data-stu-id="8016a-1100">The following statistics and error reports are maintained for each IP/TCP instance:</span></span>

- <span data-ttu-id="8016a-1101">Número total de paquetes TCP enviados</span><span class="sxs-lookup"><span data-stu-id="8016a-1101">Total TCP Packets Sent</span></span>
- <span data-ttu-id="8016a-1102">Número total de bytes TCP enviados</span><span class="sxs-lookup"><span data-stu-id="8016a-1102">Total TCP Bytes Sent</span></span>
- <span data-ttu-id="8016a-1103">Número total de paquetes TCP recibidos</span><span class="sxs-lookup"><span data-stu-id="8016a-1103">Total TCP Packets Received</span></span>
- <span data-ttu-id="8016a-1104">Número total de bytes TCP recibidos</span><span class="sxs-lookup"><span data-stu-id="8016a-1104">Total TCP Bytes Received</span></span>
- <span data-ttu-id="8016a-1105">Número total de paquetes TCP no válidos</span><span class="sxs-lookup"><span data-stu-id="8016a-1105">Total TCP Invalid Packets</span></span>
- <span data-ttu-id="8016a-1106">Número total de paquetes de recepción de TCP eliminados</span><span class="sxs-lookup"><span data-stu-id="8016a-1106">Total TCP Receive Packets Dropped</span></span>
- <span data-ttu-id="8016a-1107">Número total de errores de suma de comprobación de recepción de TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1107">Total TCP Receive Checksum Errors</span></span>
- <span data-ttu-id="8016a-1108">Número total de conexiones TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1108">Total TCP Connections</span></span>
- <span data-ttu-id="8016a-1109">Número total de desconexiones TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1109">Total TCP Disconnections</span></span>
- <span data-ttu-id="8016a-1110">Número total de conexiones TCP eliminadas</span><span class="sxs-lookup"><span data-stu-id="8016a-1110">Total TCP Connections Dropped</span></span>
- <span data-ttu-id="8016a-1111">Número total de retransmisiones de paquetes TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1111">Total TCP Packet Retransmits</span></span>
- <span data-ttu-id="8016a-1112">Paquetes de socket TCP enviados</span><span class="sxs-lookup"><span data-stu-id="8016a-1112">TCP Socket Packets Sent</span></span>
- <span data-ttu-id="8016a-1113">Bytes de socket TCP enviados</span><span class="sxs-lookup"><span data-stu-id="8016a-1113">TCP Socket Bytes Sent</span></span>
- <span data-ttu-id="8016a-1114">Paquetes de socket TCP recibidos</span><span class="sxs-lookup"><span data-stu-id="8016a-1114">TCP Socket Packets Received</span></span>
- <span data-ttu-id="8016a-1115">Bytes de socket TCP recibidos</span><span class="sxs-lookup"><span data-stu-id="8016a-1115">TCP Socket Bytes Received</span></span>
- <span data-ttu-id="8016a-1116">Retransmisiones de paquetes de socket TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1116">TCP Socket Packet Retransmits</span></span>
- <span data-ttu-id="8016a-1117">Paquetes de socket TCP puestos en cola</span><span class="sxs-lookup"><span data-stu-id="8016a-1117">TCP Socket Packets Queued</span></span>
- <span data-ttu-id="8016a-1118">Errores de suma de comprobación del socket TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1118">TCP Socket Checksum Errors</span></span>
- <span data-ttu-id="8016a-1119">Estado del socket TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1119">TCP Socket State</span></span>
- <span data-ttu-id="8016a-1120">Profundidad de la cola de transmisión del socket TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1120">TCP Socket Transmit Queue Depth</span></span>
- <span data-ttu-id="8016a-1121">Tamaño de la ventana de transmisión del socket TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1121">TCP Socket Transmit Window Size</span></span>
- <span data-ttu-id="8016a-1122">Tamaño de la ventana de recepción del socket TCP</span><span class="sxs-lookup"><span data-stu-id="8016a-1122">TCP Socket Receive Window Size</span></span>

<span data-ttu-id="8016a-1123">Todas estas estadísticas e informes de errores están disponibles para la aplicación con el servicio ***nx_tcp_info_get** _ para las estadísticas totales de TCP y con el servicio _ *_nx_tcp_socket_info_get_** para las estadísticas de TCP de cada socket.</span><span class="sxs-lookup"><span data-stu-id="8016a-1123">All these statistics and error reports are available to the application with the ***nx_tcp_info_get** _ service for total TCP statistics and the _ *_nx_tcp_socket_info_get_** service for TCP statistics per socket.</span></span>

## <a name="tcp-socket-control-block-nx_tcp_socket"></a><span data-ttu-id="8016a-1124">Bloque de control de socket TCP NX_TCP_SOCKET</span><span class="sxs-lookup"><span data-stu-id="8016a-1124">TCP Socket Control Block NX_TCP_SOCKET</span></span>

<span data-ttu-id="8016a-1125">Las características de cada socket TCP se encuentran en el bloque de control *NX_TCP_SOCKET* asociado, que contiene información útil, como el vínculo a la estructura de datos IP, la interfaz de la conexión de red, el puerto enlazado y la cola de paquetes de recepción.</span><span class="sxs-lookup"><span data-stu-id="8016a-1125">The characteristics of each TCP socket are found in the associated *NX_TCP_SOCKET* control block, which contains useful information such as the link to the IP data structure, the network connection interface, the bound port, and the receive packet queue.</span></span> <span data-ttu-id="8016a-1126">Esta estructura se define en el archivo ***tx_api.h***.</span><span class="sxs-lookup"><span data-stu-id="8016a-1126">This structure is defined in the ***nx_api.h*** file.</span></span>
