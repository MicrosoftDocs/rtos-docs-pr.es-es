---
title: 'Capítulo 3: Componentes funcionales de Azure RTOS NetX Duo'
description: Este capítulo contiene una descripción de la pila TCP/IP de alto rendimiento de Azure RTOS NetX Duo desde una perspectiva funcional.
author: philmea
ms.author: philmea
ms.date: 05/19/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 31900c7b822c88079e4b9fe28a8a388d20f819aa
ms.sourcegitcommit: 60ad844b58639d88830f2660ab0c4ff86b92c10f
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 04/07/2021
ms.locfileid: "106549851"
---
# <a name="chapter-3---functional-components-of-azure-rtos-netx-duo"></a><span data-ttu-id="24501-103">Capítulo 3: Componentes funcionales de Azure RTOS NetX Duo</span><span class="sxs-lookup"><span data-stu-id="24501-103">Chapter 3 - Functional Components of Azure RTOS NetX Duo</span></span>

<span data-ttu-id="24501-104">Este capítulo contiene una descripción de la pila TCP/IP de alto rendimiento de Azure RTOS NetX Duo desde una perspectiva funcional.</span><span class="sxs-lookup"><span data-stu-id="24501-104">This chapter contains a description of the high- performance Azure RTOS NetX Duo TCP/IP stack from a functional perspective.</span></span> 

## <a name="execution-overview"></a><span data-ttu-id="24501-105">Información general sobre la ejecución</span><span class="sxs-lookup"><span data-stu-id="24501-105">Execution Overview</span></span>

<span data-ttu-id="24501-106">Hay cinco tipos de ejecución de programa en una aplicación NetX Duo: inicialización, llamadas a la interfaz de la aplicación, subproceso de IP interno, temporizadores periódicos de IP y el controlador de red.</span><span class="sxs-lookup"><span data-stu-id="24501-106">There are five types of program execution within a NetX Duo application: initialization, application interface calls, internal IP thread, IP periodic timers, and the network driver.</span></span>

> [!NOTE]
> <span data-ttu-id="24501-107">*NetX Duo da por hecha la existencia de ThreadX y depende de la ejecución de subprocesos, la suspensión, los temporizadores periódicos y los recursos de exclusión mutua.*</span><span class="sxs-lookup"><span data-stu-id="24501-107">*NetX Duo assumes the existence of ThreadX and depends on its thread execution, suspension, periodic timers, and mutual exclusion facilities.*</span></span>

### <a name="initialization"></a><span data-ttu-id="24501-108">Inicialización</span><span class="sxs-lookup"><span data-stu-id="24501-108">Initialization</span></span>

<span data-ttu-id="24501-109">Se debe llamar al servicio \***nx_system_initialize** _ antes de llamar a ningún otro servicio de NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-109">The service \***nx_system_initialize** _ must be called before any other NetX Duo service is called.</span></span> <span data-ttu-id="24501-110">Se puede llamar a la inicialización del sistema desde la función _ *_tx_application_define_*\* de ThreadX o desde los subprocesos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-110">System initialization can be called either from the ThreadX _ *_tx_application_define_*\* function or from application threads.</span></span>

<span data-ttu-id="24501-111">Después de volver de \***nx_system_initialize** _, el sistema está listo para crear grupos de paquetes e instancias de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-111">After \***nx_system_initialize** _ returns, the system is ready to create packet pools and IP instances.</span></span> <span data-ttu-id="24501-112">Dado que la creación de una instancia de IP requiere un grupo de paquetes predeterminado, debe existir al menos un grupo de paquetes de NetX Duo antes de crear una instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-112">Because creating an IP instance requires a default packet pool, at least one NetX Duo packet pool must exist prior to creating an IP instance.</span></span> <span data-ttu-id="24501-113">Se permite crear grupos de paquetes e instancias de IP desde la función de inicialización de ThreadX _ *_tx_application_define_*\* y desde los subprocesos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-113">Creating packet pools and IP instances are allowed from the ThreadX initialization function _ *_tx_application_define_*\* and from application threads.</span></span>

<span data-ttu-id="24501-114">Internamente, la creación de una instancia de IP se realiza en dos partes: la primera parte se realiza en el contexto del autor de llamada, ya sea desde ***tx_application_define*** o desde el contexto de un subproceso de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-114">Internally, creating an IP instance is accomplished in two parts: The first part is done within the context of the caller, either from ***tx_application_define*** or from an application thread's context.</span></span> <span data-ttu-id="24501-115">Esto incluye la configuración de la estructura de datos de IP y la creación de varios recursos de IP, incluido el subproceso de IP interno.</span><span class="sxs-lookup"><span data-stu-id="24501-115">This includes setting up the IP data structure and creating various IP resources, including the internal IP thread.</span></span> <span data-ttu-id="24501-116">La segunda parte se realiza durante la ejecución inicial desde el subproceso de IP interno.</span><span class="sxs-lookup"><span data-stu-id="24501-116">The second part is performed during the initial execution from the internal IP thread.</span></span> <span data-ttu-id="24501-117">Aquí es donde se llama primero al controlador de red, proporcionado durante la primera parte de la creación de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-117">This is where the network driver, supplied during the first part of IP creation, is first called.</span></span> <span data-ttu-id="24501-118">La llamada al controlador de red desde el subproceso de IP interno permite que el controlador realice la E/S y la suspensión durante su procesamiento de inicialización.</span><span class="sxs-lookup"><span data-stu-id="24501-118">Calling the network driver from the internal IP thread enables the driver to perform I/O and suspend during its initialization processing.</span></span>

<span data-ttu-id="24501-119">Cuando el controlador de red vuelve de su procesamiento de inicialización, se completa la creación de la instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-119">When the network driver returns from its initialization processing, the IP creation is complete.</span></span>

<span data-ttu-id="24501-120">La inicialización de IPv6 en NetX Duo requiere algunos servicios adicionales de NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-120">Initialization of IPv6 in NetX Duo requires a few additional NetX Duo services.</span></span> <span data-ttu-id="24501-121">Estos se describen con más detalle en la sección [IPv6 en NetX Duo](#ipv6-in-netx-duo) más adelante en este capítulo.</span><span class="sxs-lookup"><span data-stu-id="24501-121">These are described in greater detail in the section [IPv6 in NetX Duo](#ipv6-in-netx-duo) later in this chapter.</span></span>

> [!NOTE]
> <span data-ttu-id="24501-122">*El servicio **nx_ip_status_check** de NetX Duo está disponible para obtener información sobre la instancia de IP y el estado de su interfaz principal. Esta información de estado incluye si el vínculo está inicializado y habilitado y si se ha resuelto la dirección IP. Esta información se usa para sincronizar los subprocesos de la aplicación que necesitan usar una instancia de IP recién creada. En el caso de los sistemas de host múltiple, consulte [Compatibilidad con host múltiple](#multihome-support). **nx_ip_interface_status_check** está disponible para obtener información sobre la interfaz especificada.*</span><span class="sxs-lookup"><span data-stu-id="24501-122">*The NetX Duo service **nx_ip_status_check** is available to obtain information on the IP instance and its primary interface status. Such status information includes whether or not the link is initialized, enabled and IP address is resolved. This information is used to synchronize application threads needing to use a newly created IP instance. For multihome systems, see [Multihome Support](#multihome-support). **nx_ip_interface_status_check** is available to obtain 3information on the specified interface.*</span></span>

### <a name="application-interface-calls"></a><span data-ttu-id="24501-123">Llamadas a la interfaz de la aplicación</span><span class="sxs-lookup"><span data-stu-id="24501-123">Application Interface Calls</span></span>

<span data-ttu-id="24501-124">Las llamadas desde la aplicación se realizan en gran medida desde los subprocesos de la aplicación que se ejecutan en RTOS ThreadX.</span><span class="sxs-lookup"><span data-stu-id="24501-124">Calls from the application are largely made from application threads running under the ThreadX RTOS.</span></span> <span data-ttu-id="24501-125">Sin embargo, se puede llamar a algunos servicios de inicialización, creación y habilitación desde ***tx_application_define***.</span><span class="sxs-lookup"><span data-stu-id="24501-125">However, some initialization, create, and enable services may be called from ***tx_application_define***.</span></span> <span data-ttu-id="24501-126">Las secciones "Permitido desde" del [Capítulo 4: Descripción de los servicios de Azure RTOS NetX Duo](chapter4.md) indican la ubicación desde la que se puede llamar a cada servicio de NETX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-126">The "Allowed From" sections in [Chapter 4 - Description of Azure RTOS NetX Duo Services](chapter4.md) indicate from which each NetX Duo service can be called.</span></span>

<span data-ttu-id="24501-127">En su mayor parte, el procesamiento de actividades intensivas como el cálculo de sumas de comprobación se realiza en el contexto del subproceso de llamada, sin impedir a otros subprocesos el acceso a la instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-127">For the most part, processing intensive activities such as computing checksums is done within the calling thread's context—without blocking access of other threads to the IP instance.</span></span> <span data-ttu-id="24501-128">Por ejemplo, en la transmisión, el cálculo de la suma de comprobación de UDP se realiza en el servicio \***nx_udp_socket_send** _, antes de llamar a la función de envío de IP subyacente.</span><span class="sxs-lookup"><span data-stu-id="24501-128">For example, on transmission, the UDP checksum calculation is performed inside the \***nx_udp_socket_send** _ service, prior to calling the underlying IP send function.</span></span> <span data-ttu-id="24501-129">En un paquete recibido, la suma de comprobación de UDP se calcula en el servicio _ \*_nx_udp_socket_receive_\*\*, que se ejecuta en el subproceso de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-129">On a received packet, the UDP checksum is calculated in the _ *_nx_udp_socket_receive_*\* service, executed in the  of the application thread.</span></span> <span data-ttu-id="24501-130">Esto ayuda a evitar la detención de solicitudes de red de subprocesos de mayor prioridad debido al procesamiento intensivo de sumas de comprobación en subprocesos de menor prioridad.</span><span class="sxs-lookup"><span data-stu-id="24501-130">This helps prevent stalling network requests of higher-priority threads because of processing intensive checksum computation in lower-priority threads.</span></span>

<span data-ttu-id="24501-131">Los valores, como las direcciones IP y los números de puerto, se pasan a las API en el orden de bytes del host.</span><span class="sxs-lookup"><span data-stu-id="24501-131">Values, such as IP addresses and port numbers, are passed to APIs in host byte order.</span></span> <span data-ttu-id="24501-132">Internamente, estos valores también se almacenan en el orden de bytes del host.</span><span class="sxs-lookup"><span data-stu-id="24501-132">Internally these values are stored in host byte order as well.</span></span> <span data-ttu-id="24501-133">Esto permite a los desarrolladores ver fácilmente los valores mediante un depurador.</span><span class="sxs-lookup"><span data-stu-id="24501-133">This allows developers to easily view the values via a debugger.</span></span> <span data-ttu-id="24501-134">Cuando estos valores se programan en un marco para la transmisión, se convierten al orden de bytes de la red.</span><span class="sxs-lookup"><span data-stu-id="24501-134">When these values are programmed into a frame for transmission, they are converted to network byte order.</span></span>

### <a name="internal-ip-thread"></a><span data-ttu-id="24501-135">Subproceso de IP interno</span><span class="sxs-lookup"><span data-stu-id="24501-135">Internal IP Thread</span></span>

<span data-ttu-id="24501-136">Como se ha mencionado, cada instancia de IP en NetX Duo tiene su propio subproceso.</span><span class="sxs-lookup"><span data-stu-id="24501-136">As mentioned, each IP instance in NetX Duo has its own thread.</span></span> <span data-ttu-id="24501-137">La prioridad y el tamaño de la pila del subproceso de IP interno se define en el servicio ***nx_ip_create***.</span><span class="sxs-lookup"><span data-stu-id="24501-137">The priority and stack size of the internal IP thread is defined in the ***nx_ip_create*** service.</span></span> <span data-ttu-id="24501-138">El subproceso de IP interno se crea en un modo listo para ejecutarse.</span><span class="sxs-lookup"><span data-stu-id="24501-138">The internal IP thread is created in a ready-to-execute mode.</span></span> <span data-ttu-id="24501-139">Si el subproceso de IP tiene una prioridad más alta que el subproceso que realiza la llamada, se puede producir un adelantamiento dentro de la llamada de creación de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-139">If the IP thread has a higher priority than the calling thread, preemption may occur inside the IP create call.</span></span>

<span data-ttu-id="24501-140">El punto de entrada del subproceso de IP interno está en la función interna ***_nx_ip_thread_entry***.</span><span class="sxs-lookup"><span data-stu-id="24501-140">The entry point of the internal IP thread is at the internal function _ ***nx_ip_thread_entry***.</span></span> <span data-ttu-id="24501-141">Cuando se inicia, el subproceso de IP interno completa primero la inicialización del controlador de red, que consiste en realizar tres llamadas al controlador de red específico de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-141">When started, the internal IP thread first completes network driver initialization, which consists of making three calls to the application-specific network driver.</span></span> <span data-ttu-id="24501-142">La primera llamada es para conectar el controlador de red a la instancia de IP, seguida de una llamada de inicialización, que permite al controlador de red pasar por el proceso de inicialización.</span><span class="sxs-lookup"><span data-stu-id="24501-142">The first call is to attach the network driver to the IP instance, followed by an initialization call, which allows the network driver to go through the initialization process.</span></span> <span data-ttu-id="24501-143">Cuando el controlador de red vuelve de la inicialización (se puede suspender mientras espera a que el hardware se configure correctamente), el subproceso de IP interno vuelve a llamar al controlador de red para habilitar el vínculo.</span><span class="sxs-lookup"><span data-stu-id="24501-143">After the network driver returns from initialization (it may suspend while waiting for the hardware to be properly set up), the internal IP thread calls the network driver again to enable the link.</span></span> <span data-ttu-id="24501-144">Después de que el controlador de red vuelva de la llamada para habilitar el vínculo, el subproceso de IP interno entra en una comprobación de bucle eterna de varios eventos que necesitan procesamiento para esta instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-144">After the network driver returns from the link enable call, the internal IP thread enters a forever loop checking for various events that need processing for this IP instance.</span></span> <span data-ttu-id="24501-145">Entre los eventos procesados en este bucle se incluyen la recepción de paquetes IP diferida, el ensamblado de fragmentos de paquetes IP, el procesamiento de ping de ICMP, el procesamiento de IGMP, el procesamiento de la cola de paquetes TCP, el procesamiento periódico de TCP, los tiempos de espera de ensamblado de fragmentos IP y el procesamiento periódico de IGMP.</span><span class="sxs-lookup"><span data-stu-id="24501-145">Events processed in this loop include deferred IP packet reception, IP packet fragment assembly, ICMP ping processing, IGMP processing, TCP packet queue processing, TCP periodic processing, IP fragment assembly timeouts, and IGMP periodic processing.</span></span> <span data-ttu-id="24501-146">Los eventos también incluyen actividades de resolución de direcciones: procesamiento de paquetes ARP y procesamiento periódico de ARP en IPv4, detección de direcciones duplicadas, solicitudes de enrutador y detección de equipos cercanos en IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-146">Events also include address resolution activities; ARP packet processing and ARP periodic processing in IPv4, Duplicate Address Detection, Router Solicitation, and Neighbor Discovery in IPv6.</span></span>

> [!CAUTION]
> <span data-ttu-id="24501-147">*Las funciones de devolución de llamada de NetX Duo, incluidas las devoluciones de llamada de escucha y desconexión, se llaman desde el subproceso de IP interno, no desde el subproceso de llamada original. La aplicación debe tener cuidado de no entrar en suspensión dentro de cualquier función de devolución de llamada de NetX Duo.*</span><span class="sxs-lookup"><span data-stu-id="24501-147">*The NetX Duo callback functions, including listen and disconnect callbacks, are called from the internal IP thread—not the original calling thread. The application must take care not to suspend inside any NetX Duo callback function.*</span></span>

### <a name="ip-periodic-timers"></a><span data-ttu-id="24501-148">Temporizadores periódicos de IP</span><span class="sxs-lookup"><span data-stu-id="24501-148">IP Periodic Timers</span></span>

<span data-ttu-id="24501-149">Se utilizan dos temporizadores periódicos de ThreadX para cada instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-149">There are two ThreadX periodic timers used for each IP instance.</span></span> <span data-ttu-id="24501-150">El primero es un temporizador de un segundo para el tiempo de espera de TCP, ARP e IGMP, que también controla el procesamiento del reensamblado de fragmentos IP.</span><span class="sxs-lookup"><span data-stu-id="24501-150">The first one is a one-second timer for ARP, IGMP, TCP timeout, and it also drives IP fragment reassemble processing.</span></span> <span data-ttu-id="24501-151">El segundo es un temporizador de 100 ms para controlar el tiempo de espera de la retransmisión TCP y las operaciones relacionadas con IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-151">The second timer is a 100ms timer to drive the TCP retransmission timeout and IPv6-related operations.</span></span>

### <a name="network-driver"></a><span data-ttu-id="24501-152">Controlador de red</span><span class="sxs-lookup"><span data-stu-id="24501-152">Network Driver</span></span>

<span data-ttu-id="24501-153">Cada instancia de IP en NetX Duo tiene una interfaz principal, que se identifica mediante el controlador de dispositivo especificado en el servicio ***nx_ip_create***.</span><span class="sxs-lookup"><span data-stu-id="24501-153">Each IP instance in NetX Duo has a primary interface, which is identified by its device driver specified in the ***nx_ip_create*** service.</span></span> <span data-ttu-id="24501-154">El controlador de red es responsable de controlar varias solicitudes de NetX Duo, como la transmisión de paquetes, la recepción de paquetes y las solicitudes de estado y control.</span><span class="sxs-lookup"><span data-stu-id="24501-154">The network driver is responsible for handling various NetX Duo requests, including packet transmission, packet reception, and requests for status and control.</span></span> 

<span data-ttu-id="24501-155">En el caso de un sistema de host múltiple, la instancia de IP tiene varias interfaces, cada una con un controlador de red asociado que realiza estas tareas para la interfaz correspondiente.</span><span class="sxs-lookup"><span data-stu-id="24501-155">For a multi-home system, the IP instance has multiple interfaces, each with an associated network driver that performs these tasks for the respective interface.</span></span>

<span data-ttu-id="24501-156">El controlador de red también debe controlar los eventos asincrónicos que se producen en el soporte físico.</span><span class="sxs-lookup"><span data-stu-id="24501-156">The network driver must also handle asynchronous events occurring on the media.</span></span> <span data-ttu-id="24501-157">Los eventos asincrónicos del soporte físico incluyen la recepción de paquetes, la finalización de la transmisión de paquetes y los cambios de estado.</span><span class="sxs-lookup"><span data-stu-id="24501-157">Asynchronous events from the media include packet reception, packet transmission completion, and status changes.</span></span> <span data-ttu-id="24501-158">NetX Duo proporciona al controlador de red varias funciones de acceso para controlar varios eventos.</span><span class="sxs-lookup"><span data-stu-id="24501-158">NetX Duo provides the network driver with several access functions to handle various events.</span></span> <span data-ttu-id="24501-159">Estas funciones están diseñadas para ser llamadas desde la parte de rutina del servicio de interrupciones del controlador de red.</span><span class="sxs-lookup"><span data-stu-id="24501-159">These functions are designed to be called from the  interrupt service routine portion of the network driver.</span></span> <span data-ttu-id="24501-160">En el caso de las redes IPv4, el controlador de red debe reenviar todos los paquetes ARP recibidos a la función interna ***_nx_arp_packet_deferred_receive***.</span><span class="sxs-lookup"><span data-stu-id="24501-160">For IPv4 networks, the network driver should forward all ARP packets received to the ***_nx_arp_packet_deferred_receive*** internal function.</span></span> <span data-ttu-id="24501-161">Todos los paquetes RARP se deben reenviar a la función interna \* **_nx_rarp_packet_deferred_receive** _.</span><span class="sxs-lookup"><span data-stu-id="24501-161">All RARP packets should be forwarded to \***_nx_rarp_packet_deferred_receive** _ internal function.</span></span> <span data-ttu-id="24501-162">Hay dos opciones para los paquetes IP.</span><span class="sxs-lookup"><span data-stu-id="24501-162">There are two options for IP packets.</span></span> <span data-ttu-id="24501-163">Si se requiere el envío rápido de paquetes IP, los paquetes IP entrantes se deben reenviar a _ *_ _nx_ip_packet_receive_* _ para su procesamiento inmediato.</span><span class="sxs-lookup"><span data-stu-id="24501-163">If fast dispatch of IP packets is required, incoming IP packets should be forwarded to _ *_ _nx_ip_packet_receive_* _ for immediate processing.</span></span> <span data-ttu-id="24501-164">Esto mejora considerablemente el rendimiento de NetX Duo en el control de paquetes IP.</span><span class="sxs-lookup"><span data-stu-id="24501-164">This greatly improves NetX Duo performance in handling IP packets.</span></span> <span data-ttu-id="24501-165">De lo contrario, debe reenviar los paquetes IP a _ \*_ _nx_ip_packet_deferred_receive_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-165">Otherwise, forwarding IP packets to _ *_ _nx_ip_packet_deferred_receive_*\* should be done.</span></span> <span data-ttu-id="24501-166">Este servicio coloca el paquete IP en la cola de procesamiento diferido, donde posteriormente lo controla el subproceso de IP interno, lo que da lugar a la mínima cantidad de tiempo de procesamiento de ISR.</span><span class="sxs-lookup"><span data-stu-id="24501-166">This service places the IP packet in the deferred processing queue where it is then handled by the internal IP thread, which results in the least amount of ISR processing time.</span></span>

<span data-ttu-id="24501-167">El controlador de red también puede diferir el procesamiento de interrupciones para quedarse fuera del contexto del subproceso de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-167">The network driver can also defer interrupt processing to run out of the context of the IP thread.</span></span> <span data-ttu-id="24501-168">En este modo, el ISR debe guardar la información necesaria, llamar a la función interna ***_nx_ip_driver_deferred_processing*** y confirmar el controlador de interrupciones.</span><span class="sxs-lookup"><span data-stu-id="24501-168">In this mode, the ISR shall save the necessary information, call the internal function ***_nx_ip_driver_deferred_processing***, and acknowledge the interrupt controller.</span></span> <span data-ttu-id="24501-169">Este servicio notifica al subproceso de IP que programe una devolución de llamada al controlador del dispositivo para completar el proceso del evento que provoca la interrupción.</span><span class="sxs-lookup"><span data-stu-id="24501-169">This service notifies IP thread to schedule a callback to the device driver to complete the process of the event that causes the interrupt.</span></span>

<span data-ttu-id="24501-170">Algunos controladores de red pueden realizar el cálculo y la validación de la suma de comprobación de encabezados TCP/IP en hardware, sin ocupar recursos de CPU valiosos.</span><span class="sxs-lookup"><span data-stu-id="24501-170">Some network controllers are capable of performing TCP/IP header checksum computation and validation in hardware, without taking up valuable CPU resources.</span></span> <span data-ttu-id="24501-171">Para aprovechar la ventaja de la característica de capacidad de hardware, NetX Duo proporciona opciones para habilitar o deshabilitar el cálculo de la suma de comprobación de software en el momento de la compilación, así como para activar o desactivar el cálculo de suma de comprobación en tiempo de ejecución, si el controlador de dispositivo es capaz de comunicarse con el nivel de IP acerca de las capacidades de hardware.</span><span class="sxs-lookup"><span data-stu-id="24501-171">To take advantage of the hardware capability feature, NetX Duo provides options to enable or disable various software checksum computation at compilation time, as well as turning on or off checksum computation at run time, if the device driver is able to communicate with the IP layer about is hardware capabilities.</span></span> <span data-ttu-id="24501-172">Consulte [Capítulo 5: Controladores de red de Azure RTOS NetX Duo](chapter5.md) para obtener información más detallada sobre la escritura de controladores de red de NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-172">See [Chapter 5 - Azure RTOS NetX Duo Network Drivers](chapter5.md) for more detailed information on writing NetX Duo network drivers.</span></span>

### <a name="multihome-support"></a><span data-ttu-id="24501-173">Compatibilidad con host múltiple</span><span class="sxs-lookup"><span data-stu-id="24501-173">Multihome Support</span></span>

<span data-ttu-id="24501-174">NetX Duo admite sistemas conectados a varios dispositivos físicos mediante una única instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-174">NetX Duo supports systems connected to multiple physical devices using a single IP instance.</span></span> <span data-ttu-id="24501-175">Cada interfaz física se asigna a un bloque de control de interfaz en la instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-175">Each physical interface is assigned to an interface control block in the IP instance.</span></span> <span data-ttu-id="24501-176">Las aplicaciones que deseen usar un sistema de host múltiple deben definir el valor de \***NX_MAX_PHSYCIAL_INTERFACES** _ en el número de dispositivos físicos conectados al sistema y volver a compilar la biblioteca de NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-176">Applications wishing to use a multihome system must define the value for \***NX_MAX_PHSYCIAL_INTERFACES** _ to the number of physical devices attached to the system, and rebuild NetX Duo library.</span></span> <span data-ttu-id="24501-177">De manera predeterminada, _ *_NX_MAX_PHYSICAL_INTERFACES_*\* está establecido en uno, de forma que se crea un bloque de control de interfaz en la instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-177">By default _ *_NX_MAX_PHYSICAL_INTERFACES_*\* is set to one, creating one interface control block in the IP instance.</span></span>

<span data-ttu-id="24501-178">La aplicación NetX Duo crea una única instancia de IP para el dispositivo primario mediante el servicio \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="24501-178">The NetX Duo application creates a single IP instance for the primary device using the \***nx_ip_create** _ service.</span></span> <span data-ttu-id="24501-179">Para cada dispositivo de red adicional, la aplicación conecta el dispositivo a la instancia de IP mediante el servicio _ \*_nx_ip_interface_attach_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-179">For each additional network devices, the application attaches the device to the IP instance using the _ *_nx_ip_interface_attach_*\* service.</span></span>

<span data-ttu-id="24501-180">Cada estructura de la interfaz de red contiene un subconjunto de información de red sobre la interfaz de red que se encuentra en el bloque de control IP, incluida la dirección IPv4 de la interfaz, la máscara de subred, el tamaño de MTU de IP y la información de dirección de capa MAC.</span><span class="sxs-lookup"><span data-stu-id="24501-180">Each network interface structure contains a subset of network information about the network interface that is contained in the IP control block, including interface IPv4 address, subnet mask, IP MTU size, and MAC-layer address information.</span></span>

> [!NOTE]
> <span data-ttu-id="24501-181">*NetX Duo con compatibilidad con host múltiple es compatible con versiones anteriores de NetX Duo. Los servicios que no toman información explícita de la interfaz tienen como valor predeterminado el dispositivo de red primario.*</span><span class="sxs-lookup"><span data-stu-id="24501-181">*NetX Duo with multihome support is backward compatible with earlier versions of NetX Duo. Services that do not take explicit interface information default to the primary network device.*</span></span>

<span data-ttu-id="24501-182">La interfaz principal tiene el índice cero en la lista de instancias de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-182">The primary interface has index zero in the IP instance list.</span></span> <span data-ttu-id="24501-183">A cada dispositivo subsiguiente conectado a la instancia de IP se le asigna el siguiente índice.</span><span class="sxs-lookup"><span data-stu-id="24501-183">Each subsequent device attached to the IP instance is assigned the next index.</span></span>

<span data-ttu-id="24501-184">Todos los servicios de protocolo de capa superior para los que la instancia de IP está habilitada, incluidos TCP, UDP, ICMP e IGMP, están disponibles para todos los dispositivos conectados.</span><span class="sxs-lookup"><span data-stu-id="24501-184">All upper layer protocol services for which the IP instance is enabled, including TCP, UDP, ICMP, and IGMP, are available to all the attached devices.</span></span>

<span data-ttu-id="24501-185">En la mayoría de los casos, NetX Duo puede determinar la mejor dirección de origen que se va a usar al transmitir un paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-185">In most cases, NetX Duo can determine the best source address to use when transmitting a packet.</span></span> <span data-ttu-id="24501-186">La selección de la dirección de origen se basa en la dirección de destino.</span><span class="sxs-lookup"><span data-stu-id="24501-186">The source address selection is based on the destination address.</span></span> <span data-ttu-id="24501-187">Se han agregado servicios de NetX Duo para permitir que las aplicaciones especifiquen la dirección de origen específica que se usará, en los casos en los que no se puede determinar la más adecuada en función de la dirección de destino.</span><span class="sxs-lookup"><span data-stu-id="24501-187">NetX Duo services are added to allow applications to specify a specific source address to use, in cases where the most suitable one cannot be determined by the destination address.</span></span> <span data-ttu-id="24501-188">Un ejemplo sería en un sistema de host múltiple, una aplicación debe enviar un paquete a una difusión IPv4 o a direcciones de destino de multidifusión.</span><span class="sxs-lookup"><span data-stu-id="24501-188">An example would be in a multihome system, an application needs to send a packet to an IPv4 broadcast or multicast destination addresses.</span></span>

<span data-ttu-id="24501-189">Entre los servicios específicos para desarrollar aplicaciones de host múltiple se incluyen los siguientes:</span><span class="sxs-lookup"><span data-stu-id="24501-189">Services specifically for developing multihome applications include the following:</span></span>

- <span data-ttu-id="24501-190">*nx_igmp_multicast_interface_join*</span><span class="sxs-lookup"><span data-stu-id="24501-190">*nx_igmp_multicast_interface_join*</span></span>
- <span data-ttu-id="24501-191">*nx_igmp_multicast_interface_leave*</span><span class="sxs-lookup"><span data-stu-id="24501-191">*nx_igmp_multicast_interface_leave*</span></span>
- <span data-ttu-id="24501-192">*nx_ip_driver_interface_direct_command*</span><span class="sxs-lookup"><span data-stu-id="24501-192">*nx_ip_driver_interface_direct_command*</span></span>
- <span data-ttu-id="24501-193">*nx_ip_interface_address_get*</span><span class="sxs-lookup"><span data-stu-id="24501-193">*nx_ip_interface_address_get*</span></span>
- <span data-ttu-id="24501-194">*nx_ip_interface_address_mapping_configure*</span><span class="sxs-lookup"><span data-stu-id="24501-194">*nx_ip_interface_address_mapping_configure*</span></span>
- <span data-ttu-id="24501-195">*nx_ip_interface_address_set*</span><span class="sxs-lookup"><span data-stu-id="24501-195">*nx_ip_interface_address_set*</span></span>  
- <span data-ttu-id="24501-196">*nx_ip_interface_attach*</span><span class="sxs-lookup"><span data-stu-id="24501-196">*nx_ip_interface_attach*</span></span>
- <span data-ttu-id="24501-197">*nx_ip_interface_capability_get*</span><span class="sxs-lookup"><span data-stu-id="24501-197">*nx_ip_interface_capability_get*</span></span> 
- <span data-ttu-id="24501-198">*nx_ip_interface_capability_set*</span><span class="sxs-lookup"><span data-stu-id="24501-198">*nx_ip_interface_capability_set*</span></span>
- <span data-ttu-id="24501-199">*nx_ip_interface_detach*</span><span class="sxs-lookup"><span data-stu-id="24501-199">*nx_ip_interface_detach*</span></span>
- <span data-ttu-id="24501-200">*nx_ip_interface_info_get*</span><span class="sxs-lookup"><span data-stu-id="24501-200">*nx_ip_interface_info_get*</span></span>
- <span data-ttu-id="24501-201">*nx_ip_interface_mtu_set*</span><span class="sxs-lookup"><span data-stu-id="24501-201">*nx_ip_interface_mtu_set*</span></span>
- <span data-ttu-id="24501-202">*nx_ip_interface_physical_address_get*</span><span class="sxs-lookup"><span data-stu-id="24501-202">*nx_ip_interface_physical_address_get*</span></span>
- <span data-ttu-id="24501-203">*nx_ip_interface_physical_address_set*</span><span class="sxs-lookup"><span data-stu-id="24501-203">*nx_ip_interface_physical_address_set*</span></span>
- <span data-ttu-id="24501-204">*nx_ip_interface_status_check*</span><span class="sxs-lookup"><span data-stu-id="24501-204">*nx_ip_interface_status_check*</span></span>
- <span data-ttu-id="24501-205">*nx_ip_raw_packet_source_send*</span><span class="sxs-lookup"><span data-stu-id="24501-205">*nx_ip_raw_packet_source_send*</span></span>
- <span data-ttu-id="24501-206">*nx_ipv4_multicast_interface_join*</span><span class="sxs-lookup"><span data-stu-id="24501-206">*nx_ipv4_multicast_interface_join*</span></span>
- <span data-ttu-id="24501-207">*nx_ipv4_multicast_interface_leave*</span><span class="sxs-lookup"><span data-stu-id="24501-207">*nx_ipv4_multicast_interface_leave*</span></span>
- <span data-ttu-id="24501-208">*nx_udp_socket_source_send*</span><span class="sxs-lookup"><span data-stu-id="24501-208">*nx_udp_socket_source_send*</span></span>
- <span data-ttu-id="24501-209">*nxd_ipv6_multicast_interface_join*</span><span class="sxs-lookup"><span data-stu-id="24501-209">*nxd_ipv6_multicast_interface_join*</span></span>
- <span data-ttu-id="24501-210">*nxd_ipv6_multicast_interface_leave*</span><span class="sxs-lookup"><span data-stu-id="24501-210">*nxd_ipv6_multicast_interface_leave*</span></span> 
- <span data-ttu-id="24501-211">*nxd_udp_socket_source_send*</span><span class="sxs-lookup"><span data-stu-id="24501-211">*nxd_udp_socket_source_send*</span></span>
- <span data-ttu-id="24501-212">*nxd_icmp_source_ping*</span><span class="sxs-lookup"><span data-stu-id="24501-212">*nxd_icmp_source_ping*</span></span>
- <span data-ttu-id="24501-213">*nxd_ip_raw_packet_source_send*</span><span class="sxs-lookup"><span data-stu-id="24501-213">*nxd_ip_raw_packet_source_send*</span></span>
- <span data-ttu-id="24501-214">*nxd_udp_socket_source_send*</span><span class="sxs-lookup"><span data-stu-id="24501-214">*nxd_udp_socket_source_send*</span></span>

<span data-ttu-id="24501-215">Estos servicios se explican con mayor detalle en la [Descripción de los servicios de NetX Duo](chapter4.md).</span><span class="sxs-lookup"><span data-stu-id="24501-215">These services are explained in greater detail in [Description of NetX Duo Services](chapter4.md).</span></span>

### <a name="loopback-interface"></a><span data-ttu-id="24501-216">Interfaz de bucle invertido</span><span class="sxs-lookup"><span data-stu-id="24501-216">Loopback Interface</span></span>

<span data-ttu-id="24501-217">La interfaz de bucle invertido es una interfaz de red especial sin un vínculo físico conectado a ella.</span><span class="sxs-lookup"><span data-stu-id="24501-217">The loopback interface is a special network interface without an physical link attached to.</span></span> <span data-ttu-id="24501-218">La interfaz de bucle invertido permite que las aplicaciones se comuniquen mediante la dirección de bucle invertido IPv4 127.0.0.1. Para usar una interfaz de bucle invertido lógico, asegúrese de que la opción configurable ***NX_DISABLE_LOOPBACK_INTERFACE*** no esté establecida.</span><span class="sxs-lookup"><span data-stu-id="24501-218">The loopback interface allows applications to communicate using the IPv4 loopback address 127.0.0.1 To utilize a logical loopback interface, ensure the configurable option ***NX_DISABLE_LOOPBACK_INTERFACE*** is not set.</span></span>

### <a name="interface-control-blocks"></a><span data-ttu-id="24501-219">Bloques de control de interfaz</span><span class="sxs-lookup"><span data-stu-id="24501-219">Interface Control Blocks</span></span>

<span data-ttu-id="24501-220">El número de bloques de control de interfaz de la instancia de IP es el número de interfaces físicas (definidas por \***NX_MAX_PHYSICAL_INTERFACES** _) más la interfaz de bucle invertido, si está habilitada.</span><span class="sxs-lookup"><span data-stu-id="24501-220">The number of interface control blocks in the IP instance is the number of physical interfaces (defined by \***NX_MAX_PHYSICAL_INTERFACES** _) plus the loopback interface if it is enabled.</span></span> <span data-ttu-id="24501-221">El número total de interfaces se define en _\*_NX_MAX_IP_INTERFACES_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-221">The total number of interfaces is defined in _\*_NX_MAX_IP_INTERFACES_\*\*.</span></span>

## <a name="protocol-layering"></a><span data-ttu-id="24501-222">Capas de protocolos</span><span class="sxs-lookup"><span data-stu-id="24501-222">Protocol Layering</span></span>

<span data-ttu-id="24501-223">El protocolo TCP/IP implementado por NetX Duo es un protocolo en capas, lo que significa que los protocolos más complejos se crean a partir de protocolos subyacentes más simples.</span><span class="sxs-lookup"><span data-stu-id="24501-223">The TCP/IP implemented by NetX Duo is a layered protocol, which means more complex protocols are built on top of simpler underlying protocols.</span></span> <span data-ttu-id="24501-224">En TCP/IP, el protocolo de la capa más baja está en el *nivel de vínculo* y lo controla el controlador de red.</span><span class="sxs-lookup"><span data-stu-id="24501-224">In TCP/IP, the lowest layer protocol is at the *link level* and is handled by the network driver.</span></span> <span data-ttu-id="24501-225">Normalmente, este nivel se dirige hacia Ethernet, pero también podría ser fibra, serie o prácticamente cualquier medio físico.</span><span class="sxs-lookup"><span data-stu-id="24501-225">This level is typically targeted towards Ethernet, but it could also be fiber, serial, or virtually any physical media.</span></span>

<span data-ttu-id="24501-226">Sobre el nivel de vínculo está la *capa de red*.</span><span class="sxs-lookup"><span data-stu-id="24501-226">On top of the link layer is the *network layer*.</span></span> <span data-ttu-id="24501-227">En TCP/IP se trata del protocolo IP, que básicamente es responsable de enviar y recibir paquetes simples de la mejor forma posible a través de la red.</span><span class="sxs-lookup"><span data-stu-id="24501-227">In TCP/IP, this is the IP, which is basically responsible for sending and receiving simple packets—in a best-effort manner—across the network.</span></span> <span data-ttu-id="24501-228">Los protocolos de tipo de administración como ICMP e IGMP normalmente también se clasifican como capas de red, aunque se basan en IP para el envío y la recepción.</span><span class="sxs-lookup"><span data-stu-id="24501-228">Management-type protocols like ICMP and IGMP are typically also categorized as network layers, even though they rely on IP for sending and receiving.</span></span>

<span data-ttu-id="24501-229">La *capa de transporte* se sitúa sobre la capa de red.</span><span class="sxs-lookup"><span data-stu-id="24501-229">The *transport layer* rests on top of the network layer.</span></span> <span data-ttu-id="24501-230">Esta capa es responsable de administrar el flujo de datos entre los hosts de la red.</span><span class="sxs-lookup"><span data-stu-id="24501-230">This layer is responsible for managing the flow of data between hosts on the network.</span></span> <span data-ttu-id="24501-231">Hay dos tipos de servicios de transporte admitidos por NetX Duo: UDP y TCP.</span><span class="sxs-lookup"><span data-stu-id="24501-231">There are two types of transport services supported by NetX Duo: UDP and TCP.</span></span> <span data-ttu-id="24501-232">Los servicios de UDP proporcionan la mejor opción para enviar y recibir datos entre dos hosts de una manera sin conexión, mientras que TCP proporciona un servicio orientado a la conexión confiable entre dos entidades host.</span><span class="sxs-lookup"><span data-stu-id="24501-232">UDP services provide best-effort sending and receiving of data between two hosts in a connectionless manner, while TCP provides reliable connection-oriented service between two host entities.</span></span>

<span data-ttu-id="24501-233">Esta estructura en capas se refleja en los paquetes de datos de red reales.</span><span class="sxs-lookup"><span data-stu-id="24501-233">This layering is reflected in the actual network data packets.</span></span> <span data-ttu-id="24501-234">Cada capa de TCP/IP contiene un bloque de información llamado encabezado.</span><span class="sxs-lookup"><span data-stu-id="24501-234">Each layer in TCP/IP contains a block of information called a header.</span></span> <span data-ttu-id="24501-235">Esta técnica de rodear los datos (y posiblemente la información de protocolo) con un encabezado se llama normalmente encapsulación de datos.</span><span class="sxs-lookup"><span data-stu-id="24501-235">This technique of surrounding data (and possibly protocol information) with a header is typically called data encapsulation.</span></span> <span data-ttu-id="24501-236">La figura 1 muestra un ejemplo de la disposición en capas de NetX Duo y la figura 2 muestra la encapsulación de datos resultante para los datos de UDP que se envían.</span><span class="sxs-lookup"><span data-stu-id="24501-236">Figure 1 shows an example of NetX Duo layering and Figure 2 shows the resulting data encapsulation for UDP data being sent.</span></span>

![Capas de protocolos](./media/user-guide/image12.jpg)

<span data-ttu-id="24501-238">**FIGURA 1. Capas de protocolos**</span><span class="sxs-lookup"><span data-stu-id="24501-238">**FIGURE 1. Protocol Layering**</span></span>

## <a name="packet-pools"></a><span data-ttu-id="24501-239">Grupos de paquetes</span><span class="sxs-lookup"><span data-stu-id="24501-239">Packet Pools</span></span>

<span data-ttu-id="24501-240">En las aplicaciones de redes en tiempo real, la asignación de paquetes de una manera rápida y determinista siempre es un desafío.</span><span class="sxs-lookup"><span data-stu-id="24501-240">Allocating packets in a fast and deterministic manner is always a challenge in real-time networking applications.</span></span> <span data-ttu-id="24501-241">Con esto en mente, NetX Duo proporciona la capacidad de crear y administrar varios grupos de paquetes de red de tamaño fijo.</span><span class="sxs-lookup"><span data-stu-id="24501-241">With this in mind, NetX Duo provides the ability to create and manage multiple pools of fixed-size network packets.</span></span>

<span data-ttu-id="24501-242">Dado que los grupos de paquetes de NetX Duo se componen de bloques de memoria de tamaño fijo, nunca hay problemas de fragmentación interna.</span><span class="sxs-lookup"><span data-stu-id="24501-242">Because NetX Duo packet pools consist of fixed-size memory blocks, there are never any internal fragmentation problems.</span></span> <span data-ttu-id="24501-243">Por supuesto, la fragmentación provoca un comportamiento que es inherentemente no determinista.</span><span class="sxs-lookup"><span data-stu-id="24501-243">Of course, fragmentation causes behavior that is inherently nondeterministic.</span></span> <span data-ttu-id="24501-244">Además, el tiempo necesario para asignar y liberar un paquete de NetX Duo equivale a la manipulación de una lista vinculada simple.</span><span class="sxs-lookup"><span data-stu-id="24501-244">In addition, the time required to allocate and free a NetX Duo packet amounts to simple linked-list manipulation.</span></span> <span data-ttu-id="24501-245">Además, la asignación y desasignación de paquetes se realiza al inicio de la lista disponible.</span><span class="sxs-lookup"><span data-stu-id="24501-245">Furthermore, packet allocation and deallocation is done at the head of the available list.</span></span> <span data-ttu-id="24501-246">Esto proporciona el procesamiento de la lista vinculada más rápido posible.</span><span class="sxs-lookup"><span data-stu-id="24501-246">This provides the fastest possible linked list processing.</span></span>

![Encapsulación de datos de UDP](./media/user-guide/image13.png)

<span data-ttu-id="24501-248">**FIGURA 2. Encapsulación de datos de UDP**</span><span class="sxs-lookup"><span data-stu-id="24501-248">**FIGURE 2. UDP Data Encapsulation**</span></span>

<span data-ttu-id="24501-249">La falta de flexibilidad suele ser el principal inconveniente de los grupos de paquetes de tamaño fijo.</span><span class="sxs-lookup"><span data-stu-id="24501-249">Lack of flexibility is typically the main drawback of fixed-size packet pools.</span></span> <span data-ttu-id="24501-250">La determinación del tamaño óptimo de la carga del paquete, que también controla el paquete entrante en el peor de los casos, es una tarea difícil.</span><span class="sxs-lookup"><span data-stu-id="24501-250">Determining the optimal packet payload size that also handles the worst-case incoming packet is a difficult task.</span></span> <span data-ttu-id="24501-251">Los paquetes de NetX Duo solucionan este problema con una característica opcional llamada "encadenamiento de paquetes".</span><span class="sxs-lookup"><span data-stu-id="24501-251">NetX Duo packets address this problem with an optional feature called packet chaining.</span></span> <span data-ttu-id="24501-252">Un paquete de red real puede constar de uno o varios paquetes de NetX Duo vinculados entre sí.</span><span class="sxs-lookup"><span data-stu-id="24501-252">An actual network packet can be made of one or more NetX Duo packets linked together.</span></span> <span data-ttu-id="24501-253">Además, el encabezado del paquete mantiene un puntero a la parte superior del paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-253">In addition, the packet header maintains a pointer to the top of the packet.</span></span> <span data-ttu-id="24501-254">A medida que se agregan protocolos adicionales, este puntero simplemente se mueve hacia atrás y el nuevo encabezado se escribe directamente delante de los datos.</span><span class="sxs-lookup"><span data-stu-id="24501-254">As additional protocols are added, this pointer is simply moved backwards and the new header is written directly in front of the data.</span></span> <span data-ttu-id="24501-255">Sin una tecnología de paquetes flexible, la pila tendría que asignar otro búfer y copiar los datos en un nuevo búfer con el nuevo encabezado, lo que es intensivo en procesamiento.</span><span class="sxs-lookup"><span data-stu-id="24501-255">Without the flexible packet technology, the stack would have to allocate another buffer and copy the data into a new buffer with the new header, which is processing intensive.</span></span>

<span data-ttu-id="24501-256">Dado que el tamaño de la carga de cada paquete es fijo para un grupo de paquetes determinado, los datos de la aplicación mayores que el tamaño de la carga requerirían varios paquetes encadenados juntos.</span><span class="sxs-lookup"><span data-stu-id="24501-256">Since each packet payload size is fixed for a given packet pool, application data larger than the payload size would require multiple packets chained together.</span></span> <span data-ttu-id="24501-257">Al rellenar un paquete con datos del usuario, la aplicación deberá usar el servicio ***nx_packet_data_append***.</span><span class="sxs-lookup"><span data-stu-id="24501-257">When filling a packet with user data, the application shall use the service ***nx_packet_data_append***.</span></span> <span data-ttu-id="24501-258">Este servicio mueve los datos de la aplicación a un paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-258">This service moves application data into a packet.</span></span> <span data-ttu-id="24501-259">En situaciones en las que un paquete no es suficiente para contener los datos del usuario, se asignan paquetes adicionales para almacenar los datos de usuario.</span><span class="sxs-lookup"><span data-stu-id="24501-259">In situations where a packet is not enough to hold user data, additional packets are allocated to store user data.</span></span> <span data-ttu-id="24501-260">Para usar el encadenamiento de paquetes, el controlador debe ser capaz de recibir o transmitir paquetes encadenados.</span><span class="sxs-lookup"><span data-stu-id="24501-260">To use packet chaining, the driver must be able to receive into or transmit from chained packets.</span></span>

<span data-ttu-id="24501-261">En el caso de los sistemas insertados que no necesitan usar la característica de encadenamiento de paquetes, la biblioteca de NetX Duo se puede compilar con \***NX_DISABLE_PACKET_CHAIN** _ para quitar la lógica de encadenamiento de paquetes.</span><span class="sxs-lookup"><span data-stu-id="24501-261">For embedded systems that do not need to use the packet chaining feature, the NetX Duo library can be built with \***NX_DISABLE_PACKET_CHAIN** _ to remove the packet chaining logic.</span></span> <span data-ttu-id="24501-262">Tenga en cuenta que la característica de fragmentación y reensamblado de IP puede necesitar usar la característica de paquetes encadenados.</span><span class="sxs-lookup"><span data-stu-id="24501-262">Note that the IP fragmentation and reassembly feature may need to utilize the chained packet feature.</span></span> <span data-ttu-id="24501-263">Por lo tanto, la definición de _*_NX_DISABLE_PACKET_CHAIN_*_ requiere que también se defina _ \*_NX_DISABLE_FRAGMENTATION_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-263">Therefore defining _*_NX_DISABLE_PACKET_CHAIN_*_ requires _ *_NX_DISABLE_FRAGMENTATION_*\* also be defined.</span></span> 

<span data-ttu-id="24501-264">Cada grupo de memoria de paquetes de NetX Duo es un recurso público.</span><span class="sxs-lookup"><span data-stu-id="24501-264">Each NetX Duo packet memory pool is a public resource.</span></span> <span data-ttu-id="24501-265">NetX Duo no aplica restricciones sobre cómo se usan los grupos.</span><span class="sxs-lookup"><span data-stu-id="24501-265">NetX Duo places no constraints on how packet pools are used.</span></span> 

### <a name="packet-pool-memory-area"></a><span data-ttu-id="24501-266">Área de memoria del grupo de paquetes</span><span class="sxs-lookup"><span data-stu-id="24501-266">Packet Pool Memory Area</span></span>

<span data-ttu-id="24501-267">El área de memoria del grupo de paquetes se especifica durante la creación.</span><span class="sxs-lookup"><span data-stu-id="24501-267">The memory area for the packet pool is specified during creation.</span></span> <span data-ttu-id="24501-268">Como sucede con otras áreas de memoria de objetos de ThreadX y NetX Duo, se puede ubicar en cualquier parte del espacio de direcciones del destino.</span><span class="sxs-lookup"><span data-stu-id="24501-268">Like other memory areas for ThreadX and NetX Duo objects, it can be located anywhere in the target's address space.</span></span> 

<span data-ttu-id="24501-269">Se trata de una característica importante porque ofrece a la aplicación una flexibilidad considerable.</span><span class="sxs-lookup"><span data-stu-id="24501-269">This is an important feature because of the considerable flexibility it gives the application.</span></span> <span data-ttu-id="24501-270">Por ejemplo, imagine que un producto de comunicación tiene un área de memoria de alta velocidad para los búferes de red.</span><span class="sxs-lookup"><span data-stu-id="24501-270">For example, suppose that a communication product has a high-speed memory area for network buffers.</span></span> <span data-ttu-id="24501-271">Este área de memoria se emplea fácilmente convirtiéndola en un grupo de memoria de paquetes de NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-271">This memory area is easily utilized by making it into a NetX Duo packet memory pool.</span></span>

### <a name="creating-packet-pools"></a><span data-ttu-id="24501-272">Creación de grupos de paquetes</span><span class="sxs-lookup"><span data-stu-id="24501-272">Creating Packet Pools</span></span>

<span data-ttu-id="24501-273">Los grupos de paquetes se crean durante la inicialización o en tiempo de ejecución mediante subprocesos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-273">Packet pools are created either during initialization or during runtime by  application threads.</span></span> <span data-ttu-id="24501-274">No hay ningún límite en el número de grupos de memoria de paquetes en una aplicación de NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-274">There are no limits on the number of packet memory pools in a NetX Duo application.</span></span>

### <a name="dual-packet-pool"></a><span data-ttu-id="24501-275">Grupo de paquetes dual</span><span class="sxs-lookup"><span data-stu-id="24501-275">Dual Packet Pool</span></span>

<span data-ttu-id="24501-276">Normalmente, el tamaño de carga del grupo de paquetes IP predeterminado es lo suficientemente grande como para acomodar el tamaño del marco hasta la MTU de la interfaz de red.</span><span class="sxs-lookup"><span data-stu-id="24501-276">Typically the payload size of the default IP packet pool is large enough to accommodate frame size up to the network interface MTU.</span></span> <span data-ttu-id="24501-277">Durante el funcionamiento normal, el subproceso de IP necesita enviar mensajes como ARP, mensajes de control TCP, mensajes de IGMP o mensajes de ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-277">During normal operation, the IP thread needs to send messages such as ARP, TCP control messages, IGMP messages, ICMPv6 messages.</span></span> <span data-ttu-id="24501-278">Estos mensajes usan los paquetes asignados del grupo de paquetes predeterminado en la instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-278">These messages use the packets allocated from the default packet pool in the IP instance.</span></span> <span data-ttu-id="24501-279">En un sistema con memoria restringida donde la cantidad de memoria disponible para el grupo de paquetes es limitada, es posible que el uso de un único grupo de paquetes (con el tamaño de carga grande para que coincida con el tamaño de la MTU) no sea una solución óptima.</span><span class="sxs-lookup"><span data-stu-id="24501-279">On a memory-constrained system where the amount of memory available for packet pool is limited, using a single packet pool (with the large payload size to match MTU size) may not be an optimal solution.</span></span> <span data-ttu-id="24501-280">NetX Duo permite a la aplicación instalar un grupo de paquetes auxiliar, donde el tamaño de carga es menor.</span><span class="sxs-lookup"><span data-stu-id="24501-280">NetX Duo allows application to install an auxiliary packet pool, where the payload size is smaller.</span></span> <span data-ttu-id="24501-281">Una vez instalado el grupo de paquetes auxiliar, el subproceso auxiliar de IP asignaría los paquetes del grupo de paquetes predeterminado o del grupo auxiliar, dependiendo del tamaño del mensaje que transmita.</span><span class="sxs-lookup"><span data-stu-id="24501-281">Once the auxiliary packet pool is installed, the IP helper thread would allocate packets from either the default packet pool or the auxiliary pool, depending on the size of the message it transmits.</span></span> <span data-ttu-id="24501-282">Para un grupo de paquetes auxiliar, un tamaño de carga de 200 bytes funcionaría con la mayoría de los mensajes que el subproceso auxiliar de IP transmite.</span><span class="sxs-lookup"><span data-stu-id="24501-282">For an auxiliary packet pool, a payload size of 200 bytes would work with most of the messages the IP helper thread transmits.</span></span>

<span data-ttu-id="24501-283">De forma predeterminada, la biblioteca de NetX Duo se crea sin habilitar el grupo de paquetes dual.</span><span class="sxs-lookup"><span data-stu-id="24501-283">By default NetX Duo library is built without enabling dual packet pool.</span></span> <span data-ttu-id="24501-284">Para habilitar la característica, compile la biblioteca con \***NX_DUAL_PACKET_POOL_ENABLE** _ definido.</span><span class="sxs-lookup"><span data-stu-id="24501-284">To enable the feature, build the library with \***NX_DUAL_PACKET_POOL_ENABLE** _ defined.</span></span> <span data-ttu-id="24501-285">A continuación, se puede establecer el grupo de paquetes auxiliar mediante una llamada a _\*_nx_ip_auxiliary_packet_pool_set_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-285">Then the auxiliary packet pool can be set by calling _\*_nx_ip_auxiliary_packet_pool_set_\*\*.</span></span>

<span data-ttu-id="24501-286">También existe la opción de crear más de un grupo de paquetes.</span><span class="sxs-lookup"><span data-stu-id="24501-286">There is also the option of creating more than one packet pool.</span></span> <span data-ttu-id="24501-287">Por ejemplo, un grupo de paquetes de transmisión se crea con un tamaño de carga óptimo para los tamaños de mensaje esperados.</span><span class="sxs-lookup"><span data-stu-id="24501-287">For example a transmit packet pool is created with optimal payload size for expected message sizes.</span></span> <span data-ttu-id="24501-288">Se crea un grupo de paquetes de recepción en el controlador con un tamaño de carga establecido en la MTU del controlador, ya que no se puede predecir el tamaño de los paquetes recibidos.</span><span class="sxs-lookup"><span data-stu-id="24501-288">A receive packet pool is created in the driver with a payload size set to the driver MTU, since one cannot predict the size of received packets.</span></span>

### <a name="packet-header-nx_packet"></a><span data-ttu-id="24501-289">Encabezado de paquete NX_PACKET</span><span class="sxs-lookup"><span data-stu-id="24501-289">Packet Header NX_PACKET</span></span>   
<span data-ttu-id="24501-290">De manera predeterminada, NetX Duo coloca el encabezado del paquete inmediatamente antes del área de la carga del paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-290">By default, NetX Duo places the packet header immediately before the packet payload area.</span></span> <span data-ttu-id="24501-291">El grupo de memoria de paquetes es básicamente una serie de paquetes: encabezados seguidos inmediatamente por la carga del paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-291">The packet memory pool is basically a series of packets— headers followed immediately by the packet payload.</span></span> <span data-ttu-id="24501-292">El encabezado del paquete (***NX_PACKET***) y el diseño del grupo de paquetes se muestran en la figura 3.</span><span class="sxs-lookup"><span data-stu-id="24501-292">The packet header (***NX_PACKET***) and the layout of the packet pool are pictured in Figure 3.</span></span>

<span data-ttu-id="24501-293">En el caso del controlador de dispositivos de red que pueden realizar operaciones sin copia, normalmente la dirección inicial del área de la carga del paquete se programa en la lógica de DMA.</span><span class="sxs-lookup"><span data-stu-id="24501-293">For network devices driver that are able to perform zero copy operations, typically the starting address of the packet payload area is programmed into the DMA logic.</span></span> <span data-ttu-id="24501-294">Algunos motores de DMA tienen un requisito de alineación en el área de la carga.</span><span class="sxs-lookup"><span data-stu-id="24501-294">Certain DMA engines have alignment requirement on the payload area.</span></span> <span data-ttu-id="24501-295">Para que la dirección inicial del área de carga se alinee correctamente con el motor DMA o la operación de caché, el usuario puede definir el símbolo ***NX_PACKET_ALIGNMENT***.</span><span class="sxs-lookup"><span data-stu-id="24501-295">To make the starting address of the payload area align properly for the DMA engine, or the cache operation, the user can define the symbol ***NX_PACKET_ALIGNMENT***.</span></span>

> [!WARNING]
> <span data-ttu-id="24501-296">*Es importante que el controlador de red use la función **nx_packet_transmit_release** cuando se complete la transmisión de un paquete. Esta función realiza una comprobación para asegurarse de que el paquete no forma parte de una cola de salida TCP antes de que se vuelva a colocar en el grupo disponible.*</span><span class="sxs-lookup"><span data-stu-id="24501-296">*It is important for the network driver to use the **nx_packet_transmit_release** function when transmission of a packet is complete. This function checks to make sure the packet is not part of a TCP output queue before it is actually placed back in the available pool.*</span></span>

![Diseño del encabezado del paquete y del grupo de paquetes](./media/user-guide/image14.jpg)

<span data-ttu-id="24501-298">**FIGURA 3. Diseño del encabezado del paquete y del grupo de paquetes**</span><span class="sxs-lookup"><span data-stu-id="24501-298">**FIGURE 3. Packet Header and Packet Pool Layout**</span></span>

<span data-ttu-id="24501-299">Los campos del encabezado del paquete se definen de la siguiente manera.</span><span class="sxs-lookup"><span data-stu-id="24501-299">The fields of the packet header are defined as follows.</span></span> <span data-ttu-id="24501-300">Tenga en cuenta que esta tabla no es una lista exhaustiva de todos los miembros de la estructura *NX_PACKET*.</span><span class="sxs-lookup"><span data-stu-id="24501-300">Note that this table is not a comprehensive list of all the members in the *NX_PACKET* structure.</span></span>

|<span data-ttu-id="24501-301">Encabezado de paquete</span><span class="sxs-lookup"><span data-stu-id="24501-301">Packet header</span></span> | <span data-ttu-id="24501-302">Fin</span><span class="sxs-lookup"><span data-stu-id="24501-302">Purpose</span></span> |
|---|---|
|<span data-ttu-id="24501-303">***nx_packet_pool_owner***</span><span class="sxs-lookup"><span data-stu-id="24501-303">***nx_packet_pool_owner***</span></span>|<span data-ttu-id="24501-304">Este campo apunta al grupo de paquetes que posee este paquete en particular.</span><span class="sxs-lookup"><span data-stu-id="24501-304">This field points to the packet pool that owns this particular packet.</span></span> <span data-ttu-id="24501-305">Cuando se libera el paquete, se libera a este grupo en particular.</span><span class="sxs-lookup"><span data-stu-id="24501-305">When the packet is released, it is released to this particular pool.</span></span> <span data-ttu-id="24501-306">Con la propiedad del grupo dentro de cada paquete, es posible que un datagrama abarque varios paquetes de varios grupos de paquetes.</span><span class="sxs-lookup"><span data-stu-id="24501-306">With the pool ownership inside each packet, it is possible for a datagram to span multiple packets from multiple packet pools.</span></span>|
|<span data-ttu-id="24501-307">\***nx_packet_next** _</span><span class="sxs-lookup"><span data-stu-id="24501-307">\***nx_packet_next** _</span></span>|<span data-ttu-id="24501-308">Este campo apunta al siguiente paquete dentro del mismo marco.</span><span class="sxs-lookup"><span data-stu-id="24501-308">This field points to the next packet within the same frame.</span></span> <span data-ttu-id="24501-309">Si es NULL, no hay paquetes adicionales que formen parte del marco.</span><span class="sxs-lookup"><span data-stu-id="24501-309">If NULL, there are no additional packets that are part of the frame.</span></span> <span data-ttu-id="24501-310">Este campo se usa para mantener los paquetes fragmentados hasta que se pueda volver a ensamblar todo el paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-310">This field is also used to hold fragmented packets until the entire packet can be re-assembled.</span></span> <span data-ttu-id="24501-311">Se quita si se define _\*_NX_DISABLE_PACKET_CHAIN_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-311">it is removed if _\*_NX_DISABLE_PACKET_CHAIN_\*\*is defined.</span></span>|
|<span data-ttu-id="24501-312">\***nx_packet_last** _</span><span class="sxs-lookup"><span data-stu-id="24501-312">\***nx_packet_last** _</span></span>|<span data-ttu-id="24501-313">Este campo apunta al último paquete que se encuentra en el mismo paquete de red.</span><span class="sxs-lookup"><span data-stu-id="24501-313">This field points to the last packet within the same network packet.</span></span> <span data-ttu-id="24501-314">Si es NULL, este paquete representa todo el paquete de red.</span><span class="sxs-lookup"><span data-stu-id="24501-314">If NULL, this packet represents the entire network packet.</span></span> <span data-ttu-id="24501-315">Este campo se quita si se define _\*_NX_DISABLE_PACKET_CHAIN_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-315">This field is removed if _\*_NX_DISABLE_PACKET_CHAIN_\*\*is defined.</span></span>|
|<span data-ttu-id="24501-316">\***nx_packet_length** _</span><span class="sxs-lookup"><span data-stu-id="24501-316">\***nx_packet_length** _</span></span>| <span data-ttu-id="24501-317">Este campo contiene el número total de bytes de todo el paquete de red, incluido el total de todos los bytes de todos los paquetes encadenados mediante el miembro _nx_packet_next\*.</span><span class="sxs-lookup"><span data-stu-id="24501-317">This field contains the total number of bytes in the entire network packet, including the total of all bytes in all packets chained together by the _nx_packet_next\*member.</span></span>|
|<span data-ttu-id="24501-318">***nx_packet_ip_interface***</span><span class="sxs-lookup"><span data-stu-id="24501-318">***nx_packet_ip_interface***</span></span>| <span data-ttu-id="24501-319">Este campo es el bloque de control de la interfaz, que se asigna al paquete cuando lo recibe el controlador de interfaz y por NetX Duo para los paquetes salientes.</span><span class="sxs-lookup"><span data-stu-id="24501-319">This field is the interface control block which is assigned to the packet when it is received by the interface driver, and by NetX Duo for outgoing packets.</span></span> <span data-ttu-id="24501-320">Un bloque de control de interfaz describe la interfaz, por ejemplo, la dirección de red, la dirección MAC, la dirección IP y el estado de la interfaz, como el vínculo habilitado y la asignación física necesaria.</span><span class="sxs-lookup"><span data-stu-id="24501-320">An interface control block describes the interface e.g. network address, MAC address, IP address and interface status such as link enabled and physical mapping required.</span></span>|
|<span data-ttu-id="24501-321">\***nx_packet_data_start** _</span><span class="sxs-lookup"><span data-stu-id="24501-321">\***nx_packet_data_start** _</span></span>| <span data-ttu-id="24501-322">Este campo apunta al inicio del área de la carga física de este paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-322">This field points to the start of the physical payload area of this packet.</span></span> <span data-ttu-id="24501-323">No tiene que estar inmediatamente después del encabezado NX_PACKET, pero ese es el valor predeterminado para el servicio _ \*_nx_packet_pool_create_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-323">It does not have to be immediately following the NX_PACKET header, but that is the default for the _ *_nx_packet_pool_create_*\* service.</span></span>|
|<span data-ttu-id="24501-324">\***nx_packet_data_end** _</span><span class="sxs-lookup"><span data-stu-id="24501-324">\***nx_packet_data_end** _</span></span>|<span data-ttu-id="24501-325">Este campo apunta al final del área de la carga física de este paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-325">This field points to the end of the physical payload area of this packet.</span></span> <span data-ttu-id="24501-326">La diferencia entre este campo y el campo _nx_packet_data_start\* representa el tamaño de la carga.</span><span class="sxs-lookup"><span data-stu-id="24501-326">The difference between this field and the _nx_packet_data_start\* field represents the payload size.</span></span>|
|<span data-ttu-id="24501-327">\***nx_packet_prepend_ptr** _</span><span class="sxs-lookup"><span data-stu-id="24501-327">\***nx_packet_prepend_ptr** _</span></span>|<span data-ttu-id="24501-328">Este campo apunta a la ubicación donde se agregan los datos de los paquetes, ya sea el encabezado de protocolo o los datos reales, delante de los datos de los paquetes existentes (si existen) en el área de carga de paquetes.</span><span class="sxs-lookup"><span data-stu-id="24501-328">This field points to the location of where packet data, either protocol header or actual data, is added in front of the existing packet data (if any) in the packet payload area.</span></span> <span data-ttu-id="24501-329">Debe ser mayor o igual que la ubicación del puntero _nx_packet_data_start\* y menor o igual que el puntero *nx_packet_append_ptr*.</span><span class="sxs-lookup"><span data-stu-id="24501-329">It must be greater than or equal to the _nx_packet_data_start\* pointer location and less than or equal to the *nx_packet_append_ptr* pointer.</span></span>|
> [!CAUTION]
> <span data-ttu-id="24501-330">*Por motivos de rendimiento, NetX Duo supone que cuando el paquete se pasa a los servicios de NetX Duo para su transmisión, el puntero antepuesto apunta a una dirección alineada para palabra larga.*</span><span class="sxs-lookup"><span data-stu-id="24501-330">*For performance reasons, NetX Duo assumes that when the packet is passed into NetX Duo services for transmission, the prepend pointer points to long word aligned address.*</span></span>

| <span data-ttu-id="24501-331">Encabezado de paquete</span><span class="sxs-lookup"><span data-stu-id="24501-331">Packet header</span></span> | <span data-ttu-id="24501-332">Fin</span><span class="sxs-lookup"><span data-stu-id="24501-332">Purpose</span></span> |
|---|---|
|<span data-ttu-id="24501-333">\***nx_packet_append_ptr** _</span><span class="sxs-lookup"><span data-stu-id="24501-333">\***nx_packet_append_ptr** _</span></span>|<span data-ttu-id="24501-334">Este campo apunta al final de los datos que se encuentran actualmente en el área de carga de paquetes.</span><span class="sxs-lookup"><span data-stu-id="24501-334">This field points to the end of the data currently in the packet payload area.</span></span> <span data-ttu-id="24501-335">Debe encontrarse entre la ubicación de memoria a la que apuntan _nx_packet_prepend_ptr\* y *nx_packet_data_end.*</span><span class="sxs-lookup"><span data-stu-id="24501-335">It must be in between the memory location pointed to by _nx_packet_prepend_ptr\* and *nx_packet_data_end.*</span></span> <span data-ttu-id="24501-336">La diferencia entre este campo y el campo *nx_packet_prepend_ptr* representa la cantidad de datos de este paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-336">The difference between this field and the *nx_packet_prepend_ptr* field represents the amount of data in this packet.</span></span>|
|<span data-ttu-id="24501-337">\***nx_packet_packet_pad** _</span><span class="sxs-lookup"><span data-stu-id="24501-337">\***nx_packet_packet_pad** _</span></span>|<span data-ttu-id="24501-338">Este campo define la longitud del relleno en palabras de 4 bytes para lograr el requisito de alineación deseado.</span><span class="sxs-lookup"><span data-stu-id="24501-338">This fields defines the length of padding in 4-byte words to achieve the desired alignment requirement.</span></span> <span data-ttu-id="24501-339">Este campo se quita si no se define _*_NX_PACKET_HEADER_PAD_*_.</span><span class="sxs-lookup"><span data-stu-id="24501-339">This field is removed if _*_NX_PACKET_HEADER_PAD_*_ is not defined.</span></span> <span data-ttu-id="24501-340">Como alternativa, se puede usar _*_NX_PACKET_ALIGNMENT_*_ en lugar de definir _nx_packet_header_pad.\*</span><span class="sxs-lookup"><span data-stu-id="24501-340">Alternatively _*_NX_PACKET_ALIGNMENT_*_ can be used instead of defining _nx_packet_header_pad.\*</span></span>|

### <a name="packet-header-offsets"></a><span data-ttu-id="24501-341">Desplazamientos de encabezados de paquetes</span><span class="sxs-lookup"><span data-stu-id="24501-341">Packet Header Offsets</span></span>

<span data-ttu-id="24501-342">El tamaño del encabezado del paquete se define para dejar espacio suficiente para acomodar el tamaño del encabezado.</span><span class="sxs-lookup"><span data-stu-id="24501-342">Packet header size is defined to allow enough room  to accommodate the size of the header.</span></span> <span data-ttu-id="24501-343">El servicio ***nx_packet_allocate*** se utiliza para asignar un paquete y ajusta el puntero antepuesto del paquete según el tipo de paquete especificado.</span><span class="sxs-lookup"><span data-stu-id="24501-343">The ***nx_packet_allocate*** service is used to allocate a packet and adjusts the prepend pointer in the packet according to the type of packet specified.</span></span> <span data-ttu-id="24501-344">El tipo de paquete indica a NetX Duo el desplazamiento necesario para insertar el encabezado de protocolo (por ejemplo, UDP, TCP o ICMP) delante de los datos del protocolo.</span><span class="sxs-lookup"><span data-stu-id="24501-344">The packet type tells NetX Duo the offset required for inserting the protocol header (such as UDP, TCP, or ICMP) in front of the protocol data.</span></span>

<span data-ttu-id="24501-345">Los siguientes tipos se definen en NetX Duo para tener en cuenta el encabezado IP y el encabezado de capa física (Ethernet) del paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-345">The following types are defined in NetX Duo to take into account the IP header and physical layer (Ethernet) header in the packet.</span></span> <span data-ttu-id="24501-346">En el último caso, se supone que tiene 16 bytes para tener en cuenta la alineación de 4 bytes necesaria.</span><span class="sxs-lookup"><span data-stu-id="24501-346">In the latter case, it is assumed to be 16 bytes taking the required 4-byte alignment into consideration.</span></span> <span data-ttu-id="24501-347">Los paquetes IPv4 siguen definidos en NetX Duo para que las aplicaciones asignen paquetes para redes IPv4.</span><span class="sxs-lookup"><span data-stu-id="24501-347">IPv4 packets are still defined in NetX Duo for applications to allocate packets for IPv4 networks.</span></span> <span data-ttu-id="24501-348">Tenga en cuenta que si la biblioteca de NetX Duo se compila con IPv6 habilitado, los tipos de paquetes genéricos (como NX_IP_PACKET) se asignan a la versión de IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-348">Note that if the NetX Duo library is built with IPv6 enabled, the generic packet types (such as NX_IP_PACKET) are mapped to the IPv6 version.</span></span> <span data-ttu-id="24501-349">Si la biblioteca de NetX Duo se compila sin habilitar IPv6, estos tipos de paquetes genéricos se asignan a la versión IPv4.</span><span class="sxs-lookup"><span data-stu-id="24501-349">If the NetX Duo Library is built without IPv6 enabled, these generic packet types are mapped to the IPv4 version.</span></span>

<span data-ttu-id="24501-350">En la tabla siguiente se muestran los símbolos definidos con IPv6 habilitado:</span><span class="sxs-lookup"><span data-stu-id="24501-350">The following table shows symbols defined with IPv6 enabled:</span></span>

|<span data-ttu-id="24501-351">**Tipo de paquete**</span><span class="sxs-lookup"><span data-stu-id="24501-351">**Packet Type**</span></span> |<span data-ttu-id="24501-352">**Valor**</span><span class="sxs-lookup"><span data-stu-id="24501-352">**Value**</span></span> |
|---|---|
|<span data-ttu-id="24501-353">NX_IPv6_PACKET (NX_IP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="24501-353">NX_IPv6_PACKET (NX_IP_PACKET)</span></span> | <span data-ttu-id="24501-354">0x38</span><span class="sxs-lookup"><span data-stu-id="24501-354">0x38</span></span> |
|<span data-ttu-id="24501-355">NX_UDPv6_PACKET (NX_UDP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="24501-355">NX_UDPv6_PACKET (NX_UDP_PACKET)</span></span> |<span data-ttu-id="24501-356">0x40</span><span class="sxs-lookup"><span data-stu-id="24501-356">0x40</span></span> |
|<span data-ttu-id="24501-357">NX_TCPv6_PACKET (NX_TCP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="24501-357">NX_TCPv6_PACKET (NX_TCP_PACKET)</span></span> |<span data-ttu-id="24501-358">0x4c</span><span class="sxs-lookup"><span data-stu-id="24501-358">0x4c</span></span> |
|<span data-ttu-id="24501-359">NX_IPv4_PACKET</span><span class="sxs-lookup"><span data-stu-id="24501-359">NX_IPv4_PACKET</span></span> |<span data-ttu-id="24501-360">0x24</span><span class="sxs-lookup"><span data-stu-id="24501-360">0x24</span></span> |
|<span data-ttu-id="24501-361">NX_IPv4_UDP_PACKET</span><span class="sxs-lookup"><span data-stu-id="24501-361">NX_IPv4_UDP_PACKET</span></span> |<span data-ttu-id="24501-362">0x2c</span><span class="sxs-lookup"><span data-stu-id="24501-362">0x2c</span></span> |
|<span data-ttu-id="24501-363">NX_IPv4_TCP_PACKET</span><span class="sxs-lookup"><span data-stu-id="24501-363">NX_IPv4_TCP_PACKET</span></span> |<span data-ttu-id="24501-364">0x38</span><span class="sxs-lookup"><span data-stu-id="24501-364">0x38</span></span> |

<span data-ttu-id="24501-365">En la tabla siguiente se muestran los símbolos definidos con IPv6 deshabilitado:</span><span class="sxs-lookup"><span data-stu-id="24501-365">The following table shows symbols defined with IPv6 disabled:</span></span>

|<span data-ttu-id="24501-366">**Tipo de paquete**</span><span class="sxs-lookup"><span data-stu-id="24501-366">**Packet Type**</span></span> |<span data-ttu-id="24501-367">**Valor**</span><span class="sxs-lookup"><span data-stu-id="24501-367">**Value**</span></span> |
|---|---|
|<span data-ttu-id="24501-368">NX_IPv4_PACKET (NX_IP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="24501-368">NX_IPv4_PACKET (NX_IP_PACKET)</span></span> |<span data-ttu-id="24501-369">0x24</span><span class="sxs-lookup"><span data-stu-id="24501-369">0x24</span></span> |
|<span data-ttu-id="24501-370">NX_IPv4_UDP_PACKET (NX_UDP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="24501-370">NX_IPv4_UDP_PACKET (NX_UDP_PACKET)</span></span> |<span data-ttu-id="24501-371">0x2c</span><span class="sxs-lookup"><span data-stu-id="24501-371">0x2c</span></span> |
|<span data-ttu-id="24501-372">NX_IPv4_TCP_PACKET (NX_TCP_PACKET)</span><span class="sxs-lookup"><span data-stu-id="24501-372">NX_IPv4_TCP_PACKET (NX_TCP_PACKET)</span></span> |<span data-ttu-id="24501-373">0x38</span><span class="sxs-lookup"><span data-stu-id="24501-373">0x38</span></span> |

<span data-ttu-id="24501-374">Tenga en cuenta que estos valores cambiarán si se define *NX_IPSEC_ENABLE*.</span><span class="sxs-lookup"><span data-stu-id="24501-374">Note that these values will change if *NX_IPSEC_ENABLE* is defined.</span></span> <span data-ttu-id="24501-375">Para obtener más información sobre la aplicación que usa IPsec, consulte la guía de usuario de NetX Duo IPsec.</span><span class="sxs-lookup"><span data-stu-id="24501-375">For application using IPsec, refer to NetX Duo IPsec User Guide for more information.</span></span>

### <a name="pool-capacity"></a><span data-ttu-id="24501-376">Capacidad del grupo</span><span class="sxs-lookup"><span data-stu-id="24501-376">Pool Capacity</span></span>

<span data-ttu-id="24501-377">El número de paquetes de un grupo de paquetes es una función del tamaño de la carga y el número total de bytes del área de memoria proporcionado al servicio de creación del grupo de paquetes.</span><span class="sxs-lookup"><span data-stu-id="24501-377">The number of packets in a packet pool is a function of the payload size and the total number of bytes in the memory area supplied to the packet pool create service.</span></span> <span data-ttu-id="24501-378">La capacidad del grupo se calcula dividiendo el tamaño del paquete (incluido el tamaño del encabezado NX_PACKET, el tamaño de carga útil y la alineación adecuada) en el número total de bytes del área de memoria proporcionada.</span><span class="sxs-lookup"><span data-stu-id="24501-378">The capacity of the pool is calculated by dividing the packet size (including the size of the NX_PACKET header, the payload size, and proper alignment) into the total number of bytes in the supplied memory area.</span></span>

### <a name="payload-area-alignment"></a><span data-ttu-id="24501-379">Alineación del área de carga</span><span class="sxs-lookup"><span data-stu-id="24501-379">Payload Area Alignment</span></span>

<span data-ttu-id="24501-380">El diseño del grupo de paquetes de NetX Duo admite la operación sin copia.</span><span class="sxs-lookup"><span data-stu-id="24501-380">Packet pool design in NetX Duo supports zero-copy.</span></span> <span data-ttu-id="24501-381">En el nivel de controlador de dispositivo, el controlador puede asignar el área de carga directamente a los descriptores del búfer para la recepción de datos.</span><span class="sxs-lookup"><span data-stu-id="24501-381">At the device driver level, the driver is able to assign the payload area directly into buffer descriptors for data reception.</span></span> <span data-ttu-id="24501-382">A veces, el motor DMA o el mecanismo de sincronización de caché requieren que la dirección inicial del área de carga tenga un determinado requisito de alineación.</span><span class="sxs-lookup"><span data-stu-id="24501-382">Sometimes the DMA engine or the cache synchronization mechanism requires the starting address of the payload area to have a certain alignment requirement.</span></span> <span data-ttu-id="24501-383">Esto puede lograrse mediante la definición del requisito de alineación deseado (en bytes) en ***NX_PACKET_ALIGNMENT***.</span><span class="sxs-lookup"><span data-stu-id="24501-383">This can be achieved by defining the desired alignment requirement (in bytes) in ***NX_PACKET_ALIGNMENT***.</span></span> <span data-ttu-id="24501-384">Al crear un grupo de paquetes, la dirección inicial del área de carga se alineará con este valor.</span><span class="sxs-lookup"><span data-stu-id="24501-384">When creating a packet pool, the starting address of the payload area will aligned to this value.</span></span> <span data-ttu-id="24501-385">De forma predeterminada, la dirección de inicio tiene una alineación de 4 bytes.</span><span class="sxs-lookup"><span data-stu-id="24501-385">By default, starting address is 4-byte aligned.</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="24501-386">Suspensión de subprocesos</span><span class="sxs-lookup"><span data-stu-id="24501-386">Thread Suspension</span></span>

<span data-ttu-id="24501-387">Los subprocesos de la aplicación se pueden suspender mientras se espera un paquete de un grupo vacío.</span><span class="sxs-lookup"><span data-stu-id="24501-387">Application threads can suspend while waiting for a packet from an empty pool.</span></span> <span data-ttu-id="24501-388">Cuando se devuelve un paquete al grupo, el subproceso suspendido recibe este paquete y se reanuda.</span><span class="sxs-lookup"><span data-stu-id="24501-388">When a packet is returned to the pool, the suspended thread is given this packet and resumed.</span></span>

<span data-ttu-id="24501-389">Si se suspenden varios subprocesos en el mismo grupo de paquetes, se reanudan en el orden en que se suspendieron (FIFO).</span><span class="sxs-lookup"><span data-stu-id="24501-389">If multiple threads are suspended on the same packet pool, they  resumed in the order they were suspended (FIFO).</span></span>

### <a name="pool-statistics-and-errors"></a><span data-ttu-id="24501-390">Estadísticas y errores del grupo</span><span class="sxs-lookup"><span data-stu-id="24501-390">Pool Statistics and Errors</span></span>

<span data-ttu-id="24501-391">Si está habilitado, el software de administración de paquetes de NetX Duo realiza el seguimiento de varias estadísticas y errores que pueden ser útiles para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-391">If enabled, the NetX Duo packet management software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="24501-392">Se mantienen las estadísticas y los informes de errores siguientes para los grupos de paquetes:</span><span class="sxs-lookup"><span data-stu-id="24501-392">The following statistics and error reports are maintained for packet pools:</span></span>

- <span data-ttu-id="24501-393">Número total de paquetes en el grupo</span><span class="sxs-lookup"><span data-stu-id="24501-393">Total Packets in Pool</span></span>
- <span data-ttu-id="24501-394">Paquetes libres en el grupo</span><span class="sxs-lookup"><span data-stu-id="24501-394">Free Packets in Pool</span></span>
- <span data-ttu-id="24501-395">Total de asignaciones de paquetes</span><span class="sxs-lookup"><span data-stu-id="24501-395">Total Packet Allocations</span></span>
- <span data-ttu-id="24501-396">Solicitudes de asignación de grupos vacíos</span><span class="sxs-lookup"><span data-stu-id="24501-396">Pool Empty Allocation Requests</span></span>
- <span data-ttu-id="24501-397">Suspensiones de asignación de grupos vacíos</span><span class="sxs-lookup"><span data-stu-id="24501-397">Pool Empty Allocation Suspensions</span></span>
- <span data-ttu-id="24501-398">Liberaciones de paquetes no válidas</span><span class="sxs-lookup"><span data-stu-id="24501-398">Invalid Packet Releases</span></span>

<span data-ttu-id="24501-399">Todos estos informes de errores y estadísticas, excepto el total y el número de paquetes libres del grupo, están integrados en la biblioteca de NetX Duo a menos que se defina \***NX_DISABLE_PACKET_INFO** _.</span><span class="sxs-lookup"><span data-stu-id="24501-399">All of these statistics and error reports, except for total and free packet count in pool, are built into NetX Duo library unless \***NX_DISABLE_PACKET_INFO** _ is defined.</span></span> <span data-ttu-id="24501-400">Estos datos están disponibles para la aplicación con el servicio _ \*_nx_packet_pool_info_get_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-400">This data is available to the application with the _ *_nx_packet_pool_info_get_*\* service.</span></span>

### <a name="packet-pool-control-block-nx_packet_pool"></a><span data-ttu-id="24501-401">Bloque de control del grupo de paquetes NX_PACKET_POOL</span><span class="sxs-lookup"><span data-stu-id="24501-401">Packet Pool Control Block NX_PACKET_POOL</span></span>

<span data-ttu-id="24501-402">Las características de cada grupo de memoria de paquetes se encuentran en su bloque de control.</span><span class="sxs-lookup"><span data-stu-id="24501-402">The characteristics of each packet memory pool are found in its control block.</span></span> <span data-ttu-id="24501-403">Contiene información útil, como la lista vinculada de paquetes libres, el número de paquetes libres y el tamaño de la carga de los paquetes de este grupo.</span><span class="sxs-lookup"><span data-stu-id="24501-403">It contains useful information such as the linked list of free packets, the number of free packets, and the payload size for packets in this pool.</span></span> <span data-ttu-id="24501-404">Esta estructura se define en el archivo ***tx_api.h***.</span><span class="sxs-lookup"><span data-stu-id="24501-404">This structure is defined in the ***nx_api.h*** file.</span></span>

<span data-ttu-id="24501-405">Los bloques de control del grupo de paquetes se pueden ubicar en cualquier parte de la memoria, pero es más común convertir el bloque de control en una estructura global mediante su definición fuera del ámbito de cualquier función.</span><span class="sxs-lookup"><span data-stu-id="24501-405">Packet pool control blocks can be located anywhere in memory, but it is most common to make the control block a global structure by defining it outside the scope of any function.</span></span>

## <a name="ipv4-protocol"></a><span data-ttu-id="24501-406">Protocolo IPv4</span><span class="sxs-lookup"><span data-stu-id="24501-406">IPv4 Protocol</span></span>

<span data-ttu-id="24501-407">El componente del protocolo de Internet (IP) de NetX Duo es responsable de enviar y recibir paquetes IPv4 en Internet.</span><span class="sxs-lookup"><span data-stu-id="24501-407">The Internet Protocol (IP) component of NetX Duo is responsible for sending and receiving IPv4 packets on the Internet.</span></span> <span data-ttu-id="24501-408">En NetX Duo, es el componente responsable en última instancia de enviar y recibir mensajes TCP, UDP, ICMP e IGMP, mediante el controlador de red subyacente.</span><span class="sxs-lookup"><span data-stu-id="24501-408">In NetX Duo, it is the component ultimately responsible for sending and receiving TCP, UDP, ICMP, and IGMP messages, utilizing the underlying network driver.</span></span>

<span data-ttu-id="24501-409">NetX Duo es compatible con el protocolo IPv4 (RFC 791) y el protocolo IPv6 (RFC 2460).</span><span class="sxs-lookup"><span data-stu-id="24501-409">NetX Duo supports both IPv4 protocol (RFC 791) and IPv6 protocol (RFC 2460).</span></span> <span data-ttu-id="24501-410">En esta sección se describe IPv4.</span><span class="sxs-lookup"><span data-stu-id="24501-410">This section discusses IPv4.</span></span> <span data-ttu-id="24501-411">IPv6 se describe en la sección siguiente.</span><span class="sxs-lookup"><span data-stu-id="24501-411">IPv6 is discussed in the next section.</span></span>

### <a name="ipv4-addresses"></a><span data-ttu-id="24501-412">Direcciones IPv4</span><span class="sxs-lookup"><span data-stu-id="24501-412">IPv4 Addresses</span></span>

<span data-ttu-id="24501-413">Cada host de Internet tiene un identificador único de 32 bits que se conoce como una dirección IP.</span><span class="sxs-lookup"><span data-stu-id="24501-413">Each host on the Internet has a unique 32-bit identifier called an IP address.</span></span> <span data-ttu-id="24501-414">Hay cinco clases de direcciones IPv4, como se describe en la figura 4.</span><span class="sxs-lookup"><span data-stu-id="24501-414">There are five classes of IPv4 addresses as described in Figure 4.</span></span> <span data-ttu-id="24501-415">Los intervalos de las cinco clases de direcciones IPv4 son los siguientes:</span><span class="sxs-lookup"><span data-stu-id="24501-415">The ranges of the five IPv4 address classes are as follows:</span></span>

|<span data-ttu-id="24501-416">Clase</span><span class="sxs-lookup"><span data-stu-id="24501-416">Class</span></span>|<span data-ttu-id="24501-417">Intervalo</span><span class="sxs-lookup"><span data-stu-id="24501-417">Range</span></span>|
|---|---|
|<span data-ttu-id="24501-418">A</span><span class="sxs-lookup"><span data-stu-id="24501-418">A</span></span> |<span data-ttu-id="24501-419">0.0.0.0 a 127.255.255.255</span><span class="sxs-lookup"><span data-stu-id="24501-419">0.0.0.0 to 127.255.255.255</span></span>|
|<span data-ttu-id="24501-420">B</span><span class="sxs-lookup"><span data-stu-id="24501-420">B</span></span> |<span data-ttu-id="24501-421">128.0.0.0 a 191.255.255.255</span><span class="sxs-lookup"><span data-stu-id="24501-421">128.0.0.0 to 191.255.255.255</span></span>|
|<span data-ttu-id="24501-422">C</span><span class="sxs-lookup"><span data-stu-id="24501-422">C</span></span> |<span data-ttu-id="24501-423">192.0.0.0 a 223.255.255.255</span><span class="sxs-lookup"><span data-stu-id="24501-423">192.0.0.0 to 223.255.255.255</span></span>|
|<span data-ttu-id="24501-424">D</span><span class="sxs-lookup"><span data-stu-id="24501-424">D</span></span> |<span data-ttu-id="24501-425">224.0.0.0 a 239.255.255.255</span><span class="sxs-lookup"><span data-stu-id="24501-425">224.0.0.0 to 239.255.255.255</span></span>|
|<span data-ttu-id="24501-426">E</span><span class="sxs-lookup"><span data-stu-id="24501-426">E</span></span> |<span data-ttu-id="24501-427">240.0.0.0 a 247.255.255.255</span><span class="sxs-lookup"><span data-stu-id="24501-427">240.0.0.0 to 247.255.255.255</span></span>|

![Diagrama de la estructura de direcciones IPv4.](./media/user-guide/ipv4-address-structure.png)

### <a name="figure-4-ipv4-address-structure"></a><span data-ttu-id="24501-429">FIGURA 4.</span><span class="sxs-lookup"><span data-stu-id="24501-429">FIGURE 4.</span></span> <span data-ttu-id="24501-430">Estructura de una dirección IPv4</span><span class="sxs-lookup"><span data-stu-id="24501-430">IPv4 Address Structure</span></span>

<span data-ttu-id="24501-431">También hay tres tipos de especificaciones de dirección: *unidifusión*, *difusión* y *multidifusión*.</span><span class="sxs-lookup"><span data-stu-id="24501-431">There are also three types of address specifications: *unicast*, *broadcast*, and *multicast*.</span></span> <span data-ttu-id="24501-432">Las direcciones de unidifusión son aquellas direcciones IPv4 que identifican un host específico en Internet.</span><span class="sxs-lookup"><span data-stu-id="24501-432">Unicast addresses are those IPv4 addresses that identify a specific host on the Internet.</span></span> <span data-ttu-id="24501-433">Las direcciones de unidifusión pueden ser una dirección IPv4 de origen o de destino.</span><span class="sxs-lookup"><span data-stu-id="24501-433">Unicast addresses can be either a source or a destination IPv4 address.</span></span> <span data-ttu-id="24501-434">Las direcciones de difusión identifican todos los hosts de una red o subred específicas y solo se pueden usar como direcciones de destino.</span><span class="sxs-lookup"><span data-stu-id="24501-434">A broadcast address identifies all hosts on a specific network or sub-network and can only be used as destination addresses.</span></span> <span data-ttu-id="24501-435">Las direcciones de difusión se especifican con la parte del identificador de host de la dirección establecida en unos.</span><span class="sxs-lookup"><span data-stu-id="24501-435">Broadcast addresses are specified by having the host ID portion of the address set to ones.</span></span> <span data-ttu-id="24501-436">Las direcciones de multidifusión (clase D) especifican un grupo dinámico de hosts en Internet.</span><span class="sxs-lookup"><span data-stu-id="24501-436">Multicast addresses (Class D) specify a dynamic group of hosts on the Internet.</span></span> <span data-ttu-id="24501-437">Los miembros del grupo de multidifusión pueden unirse y salir siempre que lo deseen.</span><span class="sxs-lookup"><span data-stu-id="24501-437">Members of the multicast group may join and leave whenever they wish.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="24501-438">*Solo los protocolos sin conexión como UDP sobre IPv4 pueden emplear la difusión y la funcionalidad de difusión limitada del grupo de multidifusión.*</span><span class="sxs-lookup"><span data-stu-id="24501-438">*Only connectionless protocols like UDP over IPv4 can utilize broadcast and the limited broadcast capability of the multicast group.*</span></span>

> [!IMPORTANT]
> <span data-ttu-id="24501-439">\*La macro *IP_ADDRESS*  se define en el archivo \***nx_api.h** _.</span><span class="sxs-lookup"><span data-stu-id="24501-439">\*The macro *IP_ADDRESS* is defined in \***nx_api.h** _.</span></span> <span data-ttu-id="24501-440">Permite una especificación sencilla de direcciones IPv4 mediante comas en lugar de puntos.</span><span class="sxs-lookup"><span data-stu-id="24501-440">It allows easy specification of IPv4 addresses using commas instead of a periods.</span></span> <span data-ttu-id="24501-441">Por ejemplo, _IP_ADDRESS(128, 0, 0, 0)\* especifica la primera dirección de clase B que se muestra en la figura 4.\*</span><span class="sxs-lookup"><span data-stu-id="24501-441">For example, _IP_ADDRESS(128,0,0,0)\* specifies the first class B address shown in Figure 4.\*</span></span>

### <a name="ipv4-gateway-address"></a><span data-ttu-id="24501-442">Dirección de puerta de enlace IPv4</span><span class="sxs-lookup"><span data-stu-id="24501-442">IPv4 Gateway Address</span></span>

<span data-ttu-id="24501-443">Las puertas de enlace de red ayudan a los hosts de sus redes a retransmitir paquetes destinados a destinos fuera del dominio local.</span><span class="sxs-lookup"><span data-stu-id="24501-443">Network gateways assist hosts on their networks to relay packets destined to destinations outside the local domain.</span></span> <span data-ttu-id="24501-444">Cada nodo tiene cierto conocimiento del próximo salto al que se va hacer el envío, ya sea el destino de uno de sus equipos cercanos o mediante una tabla de enrutamiento estático programada previamente.</span><span class="sxs-lookup"><span data-stu-id="24501-444">Each node has some knowledge of which next hop to send to, either the destination one of its neighbors, or through a pre-programmed static routing table.</span></span> <span data-ttu-id="24501-445">Sin embargo, si se produce un error en estos enfoques, el nodo debe reenviar el paquete a su puerta de enlace predeterminada, que conoce mejor cómo enrutar el paquete a su destino.</span><span class="sxs-lookup"><span data-stu-id="24501-445">However if these approaches fail, the node should forward the packet to its default gateway which has better knowledge on how to route the packet to its destination.</span></span> <span data-ttu-id="24501-446">Tenga en cuenta que la puerta de enlace predeterminada debe ser accesible directamente mediante una de las interfaces físicas asociadas a la instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-446">Note that the default gateway must be directly accessible through one of the physical interfaces attached to the IP instance.</span></span> <span data-ttu-id="24501-447">La aplicación llama a \***nx_ip_gateway_address_set** _ para configurar la dirección de la puerta de enlace predeterminada de IPv4.</span><span class="sxs-lookup"><span data-stu-id="24501-447">The application calls \***nx_ip_gateway_address_set** _ to configure IPv4 default gateway address.</span></span> <span data-ttu-id="24501-448">Use el servicio _*_nx_ip_gateway_address_get_*_ para recuperar la configuración actual de la puerta de enlace de IPv4.</span><span class="sxs-lookup"><span data-stu-id="24501-448">Use the service _*_nx_ip_gateway_address_get_*_ to retrieve the current IPv4 gateway settings.</span></span> <span data-ttu-id="24501-449">La aplicación usará el servicio _ *_nx_ip_gateway_address_clear_*\* para borrar la configuración de la puerta de enlace.</span><span class="sxs-lookup"><span data-stu-id="24501-449">Application shall use the service _ *_nx_ip_gateway_address_clear_*\* to clear the gateway setting.</span></span>

### <a name="ipv4-header"></a><span data-ttu-id="24501-450">Encabezado IPv4</span><span class="sxs-lookup"><span data-stu-id="24501-450">IPv4 Header</span></span>

<span data-ttu-id="24501-451">Para que cualquier paquete IPv4 se envíe a Internet, debe tener un encabezado IPv4.</span><span class="sxs-lookup"><span data-stu-id="24501-451">For any IPv4 packet to be sent on the Internet, it must have an IPv4 header.</span></span> <span data-ttu-id="24501-452">Cuando los protocolos de nivel superior (UDP, TCP, ICMP o IGMP) llaman al componente IP para enviar un paquete, el módulo de transmisión IPv4 coloca un encabezado IPv4 delante de los datos.</span><span class="sxs-lookup"><span data-stu-id="24501-452">When higher-level protocols (UDP, TCP, ICMP, or IGMP) call the IP component to send a packet, the IPv4 transmit module places an IPv4 header in front of the data.</span></span> <span data-ttu-id="24501-453">Por el contrario, cuando se reciben paquetes IP de la red, el componente IP quita el encabezado IPv4 del paquete antes de entregarlo a los protocolos de nivel superior.</span><span class="sxs-lookup"><span data-stu-id="24501-453">Conversely, when IP packets are received from the network, the IP component removes the IPv4 header from the packet before delivery to the higher-level protocols.</span></span> <span data-ttu-id="24501-454">En la figura 5 se muestra el formato del encabezado IP.</span><span class="sxs-lookup"><span data-stu-id="24501-454">Figure 5 shows the format of the IP header.</span></span>

![Formato del encabezado IPv4](./media/user-guide/ipv4-header-format.png)

### <a name="figure-5-ipv4-header-format"></a><span data-ttu-id="24501-456">FIGURA 5.</span><span class="sxs-lookup"><span data-stu-id="24501-456">FIGURE 5.</span></span> <span data-ttu-id="24501-457">Formato del encabezado IPv4</span><span class="sxs-lookup"><span data-stu-id="24501-457">IPv4 Header Format</span></span>

> [!IMPORTANT]
> <span data-ttu-id="24501-458">*Se espera que todos los encabezados de la implementación de TCP/IP estén en formato **big endian**. En este formato, el byte más significativo de la palabra reside en la dirección de bytes más baja. Por ejemplo, la versión de 4 bits y la longitud del encabezado de 4 bits del encabezado IP deben estar ubicadas en el primer byte del encabezado.*</span><span class="sxs-lookup"><span data-stu-id="24501-458">*All headers in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address. For example, the 4-bit version and the 4-bit header length of the IP header must be located on the first byte of the header.*</span></span>

<span data-ttu-id="24501-459">Los campos del encabezado IPv4 se definen de la siguiente manera:</span><span class="sxs-lookup"><span data-stu-id="24501-459">The fields of the IPv4 header are defined as follows:</span></span>

|<span data-ttu-id="24501-460">Campo&nbsp;de encabezado&nbsp;IPv4</span><span class="sxs-lookup"><span data-stu-id="24501-460">IPv4&nbsp;Header&nbsp;Field</span></span> |<span data-ttu-id="24501-461">Fin</span><span class="sxs-lookup"><span data-stu-id="24501-461">Purpose</span></span> |
|---|---|
|<span data-ttu-id="24501-462">***4-bit version***</span><span class="sxs-lookup"><span data-stu-id="24501-462">***4-bit version***</span></span> |<span data-ttu-id="24501-463">Este campo contiene la versión de IP que representa este encabezado.</span><span class="sxs-lookup"><span data-stu-id="24501-463">This field contains the version of IP this header represents.</span></span> <span data-ttu-id="24501-464">En el caso de IP versión 4, que es lo que admite NetX Duo, el valor de este campo es 4.</span><span class="sxs-lookup"><span data-stu-id="24501-464">For IP version 4, which is what NetX Duo supports, the value of this field is 4.</span></span> |
|<span data-ttu-id="24501-465">***Longitud del encabezado de 4 bits***</span><span class="sxs-lookup"><span data-stu-id="24501-465">***4-bit header length***</span></span> |<span data-ttu-id="24501-466">Este campo especifica el número de palabras de 32 bits del encabezado IP.</span><span class="sxs-lookup"><span data-stu-id="24501-466">This field specifies the number of 32-bit words in the IP header.</span></span> <span data-ttu-id="24501-467">Si no hay palabras de opción presentes, el valor de este campo es 5.</span><span class="sxs-lookup"><span data-stu-id="24501-467">If no option words are present, the value for this field is 5.</span></span> |
|<span data-ttu-id="24501-468">***Tipo de servicio (TOS) de 8 bits***</span><span class="sxs-lookup"><span data-stu-id="24501-468">***8-bit type of service (TOS)***</span></span> |<span data-ttu-id="24501-469">Este campo especifica el tipo de servicio solicitado para este paquete IP.</span><span class="sxs-lookup"><span data-stu-id="24501-469">This field specifies the type of service requested for this IP packet.</span></span> <span data-ttu-id="24501-470">Las solicitudes válidas son las siguientes:</span><span class="sxs-lookup"><span data-stu-id="24501-470">Valid requests are as follows:</span></span><br /><span data-ttu-id="24501-471">- Normal: 0x00</span><span class="sxs-lookup"><span data-stu-id="24501-471">- Normal: 0x00</span></span> <br /><span data-ttu-id="24501-472">- Retraso mínimo: 0x00</span><span class="sxs-lookup"><span data-stu-id="24501-472">- Minimum Delay: 0x00</span></span><br /><span data-ttu-id="24501-473">- Datos máximos: 0x08</span><span class="sxs-lookup"><span data-stu-id="24501-473">- Maximum Data: 0x08</span></span><br /><span data-ttu-id="24501-474">- Confiabilidad máxima: 0x04</span><span class="sxs-lookup"><span data-stu-id="24501-474">- Maximum Reliability: 0x04</span></span><br /><span data-ttu-id="24501-475">- Costo mínimo: 0x02</span><span class="sxs-lookup"><span data-stu-id="24501-475">- Minimum Cost: 0x02</span></span> |
|<span data-ttu-id="24501-476">***Longitud total de 16 bits***</span><span class="sxs-lookup"><span data-stu-id="24501-476">***16-bit total length***</span></span> |<span data-ttu-id="24501-477">Este campo contiene la longitud total del datagrama IP en bytes, incluido el encabezado IP.</span><span class="sxs-lookup"><span data-stu-id="24501-477">This field contains the total length of the IP datagram in bytes, including the IP header.</span></span> <span data-ttu-id="24501-478">Un datagrama IP es la unidad básica de información que se encuentra en una red de Internet con TCP/IP.</span><span class="sxs-lookup"><span data-stu-id="24501-478">An IP datagram is the basic unit of information found on a TCP/IP Internet.</span></span> <span data-ttu-id="24501-479">Contiene una dirección de origen y una de destino, además de los datos.</span><span class="sxs-lookup"><span data-stu-id="24501-479">It contains a destination and source address in addition to data.</span></span> <span data-ttu-id="24501-480">Dado que es un campo de 16 bits, el tamaño máximo de un datagrama IP es de 65 535 bytes.</span><span class="sxs-lookup"><span data-stu-id="24501-480">Because it is a 16-bit field, the maximum size of an IP datagram is 65,535 bytes.</span></span>|
|<span data-ttu-id="24501-481">***identificación de 16 bits***</span><span class="sxs-lookup"><span data-stu-id="24501-481">***16-bit identification***</span></span> |<span data-ttu-id="24501-482">El campo es un número que se usa para identificar de forma única cada datagrama IP enviado desde un host.</span><span class="sxs-lookup"><span data-stu-id="24501-482">The field is a number used to uniquely identify each IP datagram sent from a host.</span></span> <span data-ttu-id="24501-483">Normalmente, este número se incrementa después de enviar un datagrama IP.</span><span class="sxs-lookup"><span data-stu-id="24501-483">This number is typically incremented after an IP datagram is sent.</span></span> <span data-ttu-id="24501-484">Es especialmente útil para ensamblar fragmentos de paquetes IP recibidos.</span><span class="sxs-lookup"><span data-stu-id="24501-484">It is especially useful in assembling received IP packet fragments.</span></span>|
|<span data-ttu-id="24501-485">***Marcas de 3 bits***</span><span class="sxs-lookup"><span data-stu-id="24501-485">***3-bit flags***</span></span> |<span data-ttu-id="24501-486">Este campo contiene información de fragmentación de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-486">This field contains IP fragmentation information.</span></span> <span data-ttu-id="24501-487">El bit 14 es el bit "no fragmentar".</span><span class="sxs-lookup"><span data-stu-id="24501-487">Bit 14 is the "don't fragment" bit.</span></span> <span data-ttu-id="24501-488">Si se establece este bit, el datagrama IP saliente no se fragmentará.</span><span class="sxs-lookup"><span data-stu-id="24501-488">If this bit is set, the outgoing IP datagram will not be fragmented.</span></span> <span data-ttu-id="24501-489">El bit 13 es el bit "más fragmentos".</span><span class="sxs-lookup"><span data-stu-id="24501-489">Bit 13 is the "more fragments" bit.</span></span> <span data-ttu-id="24501-490">Si se establece este bit, hay más fragmentos.</span><span class="sxs-lookup"><span data-stu-id="24501-490">If this bit is set, there are more fragments.</span></span> <span data-ttu-id="24501-491">Si este bit está a cero, se trata del último fragmento del paquete IP.</span><span class="sxs-lookup"><span data-stu-id="24501-491">If this bit is clear, this is the last fragment of the IP packet.</span></span>|
|<span data-ttu-id="24501-492">***Desplazamiento de fragmento de 13 bits***</span><span class="sxs-lookup"><span data-stu-id="24501-492">***13-bit fragment offset***</span></span> |<span data-ttu-id="24501-493">Este campo contiene los 13 bits superiores del desplazamiento del fragmento.</span><span class="sxs-lookup"><span data-stu-id="24501-493">This field contains the upper 13-bits of the fragment offset.</span></span> <span data-ttu-id="24501-494">Por este motivo, los desplazamientos de fragmentos solo se permiten en límites de 8 bytes.</span><span class="sxs-lookup"><span data-stu-id="24501-494">Because of this, fragment offsets are only allowed on 8-byte boundaries.</span></span> <span data-ttu-id="24501-495">El primer fragmento de un datagrama IP fragmentado tendrá el bit "más fragmentos" establecido y tendrá un desplazamiento de 0.</span><span class="sxs-lookup"><span data-stu-id="24501-495">The first fragment of a fragmented IP datagram will have the "more fragments" bit set and have an offset of 0.</span></span>|
|<span data-ttu-id="24501-496">***Período de vida (TTL) de 8 bits***</span><span class="sxs-lookup"><span data-stu-id="24501-496">***8-bit time to live (TTL)***</span></span> |<span data-ttu-id="24501-497">Este campo contiene el número de enrutadores que puede pasar este datagrama, lo que básicamente limita la vigencia del datagrama.</span><span class="sxs-lookup"><span data-stu-id="24501-497">This field contains the number of routers this datagram can pass, which basically limits the lifetime of the datagram.</span></span>|
|<span data-ttu-id="24501-498">***Protocolo de 8 bits***</span><span class="sxs-lookup"><span data-stu-id="24501-498">***8-bit protocol***</span></span>|<span data-ttu-id="24501-499">Este campo especifica el protocolo que usa el datagrama IP.</span><span class="sxs-lookup"><span data-stu-id="24501-499">This field specifies which protocol is using the IP datagram.</span></span> <span data-ttu-id="24501-500">A continuación se muestra una lista de protocolos válidos y sus valores:</span><span class="sxs-lookup"><span data-stu-id="24501-500">The following is a list of valid protocols and their values:</span></span><br /><span data-ttu-id="24501-501">- ICMP: 0x01</span><span class="sxs-lookup"><span data-stu-id="24501-501">- ICMP: 0x01</span></span> <br /><span data-ttu-id="24501-502">- IGMP: 0x02</span><span class="sxs-lookup"><span data-stu-id="24501-502">- IGMP: 0x02</span></span><br /><span data-ttu-id="24501-503">- TCP: 0X06</span><span class="sxs-lookup"><span data-stu-id="24501-503">- TCP: 0X06</span></span><br /><span data-ttu-id="24501-504">- UDP: 0X11</span><span class="sxs-lookup"><span data-stu-id="24501-504">- UDP: 0X11</span></span> |
|<span data-ttu-id="24501-505">***Suma de comprobación de 16 bits***</span><span class="sxs-lookup"><span data-stu-id="24501-505">***16-bit checksum***</span></span> |<span data-ttu-id="24501-506">Este campo contiene la suma de comprobación de 16 bits solo para el encabezado IP.</span><span class="sxs-lookup"><span data-stu-id="24501-506">This field contains the 16-bit checksum that covers the IP header only.</span></span> <span data-ttu-id="24501-507">Hay sumas de comprobación adicionales en los protocolos de nivel superior para la carga de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-507">There are additional checksums in the higher level protocols that cover the IP payload.</span></span> |
|<span data-ttu-id="24501-508">***Dirección IP de origen de 32 bits***</span><span class="sxs-lookup"><span data-stu-id="24501-508">***32-bit source IP address***</span></span> |<span data-ttu-id="24501-509">Este campo contiene la dirección IP del remitente y siempre es una dirección de host.</span><span class="sxs-lookup"><span data-stu-id="24501-509">This field contains the IP address of the sender and is always a host address.</span></span> |
|<span data-ttu-id="24501-510">***Dirección IP de destino de 32 bits***</span><span class="sxs-lookup"><span data-stu-id="24501-510">***32-bit destination IP address***</span></span> |<span data-ttu-id="24501-511">Este campo contiene la dirección IP del receptor o los receptores, si la dirección es una dirección de difusión o multidifusión.</span><span class="sxs-lookup"><span data-stu-id="24501-511">This field contains the IP address of the receiver or receivers if the address is a broadcast or multicast address.</span></span> |

### <a name="creating-ip-instances"></a><span data-ttu-id="24501-512">Creación de instancias de IP</span><span class="sxs-lookup"><span data-stu-id="24501-512">Creating IP Instances</span></span>

<span data-ttu-id="24501-513">Las instancias de IP se crean durante la inicialización o en tiempo de ejecución mediante subprocesos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-513">IP instances are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="24501-514">La dirección IPv4 inicial, la máscara de red, el grupo de paquetes predeterminado, el controlador multimedia, y la memoria y la prioridad del subproceso IP interno se definen mediante el servicio de ***nx_ip_create***, aunque la aplicación tenga previsto usar solo redes IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-514">The initial IPv4 address, network mask, default packet pool, media driver, and memory and priority of the internal IP thread are defined by the ***nx_ip_create*** service even if the application intends to use IPv6 networks only.</span></span> <span data-ttu-id="24501-515">Si la aplicación inicializa la instancia de IP con su dirección IPv4 establecida en una dirección no válida (0.0.0.0), se supone que la dirección de la interfaz se resolverá con una configuración manual más adelante, mediante RARP, DHCP o protocolos similares.</span><span class="sxs-lookup"><span data-stu-id="24501-515">If the application initializes the IP instance with its IPv4 address set to an invalid address(0.0.0.0), it is assumed that the interface address is going to resolved by manual configuration later, via RARP, or through DHCP or similar protocols.</span></span>

<span data-ttu-id="24501-516">En sistemas con varias interfaces de red, la interfaz principal se designa al llamar a \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="24501-516">For systems with multiple network interfaces, the primary interface is designated when calling \***nx_ip_create** _.</span></span> <span data-ttu-id="24501-517">Cada interfaz adicional se puede conectar a la misma instancia de IP mediante una llamada a _\*_nx_ip_interface_attach_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-517">Each additional interface can be attached to the same IP instance by calling _\*_nx_ip_interface_attach_\*\*.</span></span> <span data-ttu-id="24501-518">Este servicio almacena información sobre la interfaz de red (como la dirección IP o la máscara de red) en el bloque de control de la interfaz y asocia la instancia del controlador con el bloque de control de la interfaz en la instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-518">This service stores information about the network interface (such as IP address, network mask) in the interface control block, and associates the driver instance with the interface control block in the IP instance.</span></span> <span data-ttu-id="24501-519">Cuando el controlador recibe un paquete de datos, debe almacenar la información de la interfaz en la estructura NX_PACKET antes de reenviarlo a la lógica de recepción de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-519">As the driver receives a data packet, it needs to store the interface information in the NX_PACKET structure before forwarding it to the IP receive logic.</span></span> <span data-ttu-id="24501-520">Tenga en cuenta que se debe haber creado una instancia de IP antes de conectar cualquier interfaz.</span><span class="sxs-lookup"><span data-stu-id="24501-520">Note an IP instance must already be created before attaching any interfaces.</span></span>

<span data-ttu-id="24501-521">Los servicios IPv6 no se inician después de llamar a \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="24501-521">IPv6 services are not started after calling \***nx_ip_create** _.</span></span> <span data-ttu-id="24501-522">Las aplicaciones que deseen usar servicios IPv6 deben llamar al servicio _ *_nx_ipv6_enable_*\* para iniciar IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-522">Applications wishing to use IPv6 services must call the service _ *_nx_ipv6_enable_*\* to start IPv6.</span></span>

<span data-ttu-id="24501-523">En la red IPv6, cada interfaz de una instancia de IP puede tener varias direcciones globales de IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-523">On the IPv6 network, each interface in an IP instance may have multiple IPv6 global addresses.</span></span> <span data-ttu-id="24501-524">Además de usar DHCPv6 para la asignación de direcciones IPv6, un dispositivo también puede usar la configuración automática de direcciones sin estado.</span><span class="sxs-lookup"><span data-stu-id="24501-524">In addition to using DHCPv6 for IPv6 address assignment, a device may also use Stateless Address Autoconfiguration.</span></span> <span data-ttu-id="24501-525">Puede encontrar más información en las secciones "Bloque de control de IP" y "Resolución de direcciones IPv6" más adelante en este capítulo.</span><span class="sxs-lookup"><span data-stu-id="24501-525">More information is available in the "IP Control Block" and "IPv6 Address Resolution" sections later in this chapter.</span></span>

### <a name="ip-send"></a><span data-ttu-id="24501-526">Envío de IP</span><span class="sxs-lookup"><span data-stu-id="24501-526">IP Send</span></span>

<span data-ttu-id="24501-527">El procesamiento del envío de IP en NetX Duo está muy optimizado.</span><span class="sxs-lookup"><span data-stu-id="24501-527">The IP send processing in NetX Duo is very streamlined.</span></span> <span data-ttu-id="24501-528">El puntero antepuesto del paquete se mueve hacia atrás para acomodar el encabezado IP.</span><span class="sxs-lookup"><span data-stu-id="24501-528">The prepend pointer in the packet is moved backwards to accommodate the IP header.</span></span> <span data-ttu-id="24501-529">Se completa el encabezado IP (con todas las opciones especificadas por la capa de protocolo de llamada), se calcula en línea la suma de comprobación de IP (solo para paquetes IPv4) y se envía el paquete al controlador de red asociado.</span><span class="sxs-lookup"><span data-stu-id="24501-529">The IP header is completed (with all the options specified by the calling protocol layer), the IP checksum is computed in-line (for IPv4 packets only), and the packet is dispatched to the associated network driver.</span></span> <span data-ttu-id="24501-530">Además, la fragmentación de salida también se coordina desde el procesamiento de envío de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-530">In addition, outgoing fragmentation is also coordinated from within the IP send processing.</span></span>

<span data-ttu-id="24501-531">En el caso de IPv4, NetX Duo inicia solicitudes ARP si se necesita asignación física para la dirección IP de destino.</span><span class="sxs-lookup"><span data-stu-id="24501-531">For IPv4, NetX Duo initiates ARP requests if physical mapping is needed for the destination IP address.</span></span> <span data-ttu-id="24501-532">IPv6 usa la detección de equipos cercanos para la asignación de la dirección IPv6 a una dirección física.</span><span class="sxs-lookup"><span data-stu-id="24501-532">IPv6 uses Neighbor Discovery for IPv6-address-tophysical-address mapping.</span></span>

> [!NOTE]
> <span data-ttu-id="24501-533">*En cuanto a la conectividad IPv4, los paquetes que requieren la resolución de direcciones IP (por ejemplo, la asignación física) se ponen en la cola de ARP hasta que el número de paquetes de la cola supera la profundidad de la cola de ARP (definida por el símbolo **NX_ARP_MAX_QUEUE_DEPTH**). Si se alcanza la profundidad de la cola, NetX Duo quitará el paquete más antiguo de la cola y seguirá esperando a la resolución de direcciones para el resto de paquetes en cola. Por otro lado, si no se resuelve una entrada de ARP, los paquetes pendientes en la entrada de ARP se liberan tras el tiempo de espera de entrada de ARP.*</span><span class="sxs-lookup"><span data-stu-id="24501-533">*For IPv4 connectivity, packets that require IP address resolution (i.e., physical mapping) are enqueued on the ARP queue until the number of packets queued exceeds the ARP queue depth (defined by the symbol **NX_ARP_MAX_QUEUE_DEPTH**). If the queue depth is reached, NetX Duo will remove the oldest packet on the queue and continue waiting for address resolution for the remaining packets enqueued. On the other hand, if an ARP entry is not resolved, the pending packets on the ARP entry are released upon ARP entry timeout.*</span></span>

<span data-ttu-id="24501-534">En el caso de sistemas con varias interfaces de red, NetX Duo elige una interfaz en función de la dirección IP de destino.</span><span class="sxs-lookup"><span data-stu-id="24501-534">For systems with multiple network interfaces, NetX Duo chooses an interface based on the destination IP address.</span></span> <span data-ttu-id="24501-535">El siguiente procedimiento se aplica al proceso de selección:</span><span class="sxs-lookup"><span data-stu-id="24501-535">The following procedure applies to the selection process:</span></span>

1. <span data-ttu-id="24501-536">Si el remitente especifica una interfaz de salida que es válida, úsela.</span><span class="sxs-lookup"><span data-stu-id="24501-536">If the sender specifies an outgoing interface and the interface is valid, use that interface.</span></span>
2. <span data-ttu-id="24501-537">Si una dirección de destino es de difusión o multidifusión IPv4, se usa la primera interfaz física habilitada.</span><span class="sxs-lookup"><span data-stu-id="24501-537">If a destination address is IPv4 broadcast or multicast, the first enabled physical interface is used.</span></span>
3. <span data-ttu-id="24501-538">Si la dirección de destino se encuentra en la tabla de enrutamiento estático, se usa la interfaz asociada a la puerta de enlace.</span><span class="sxs-lookup"><span data-stu-id="24501-538">If the destination address is found in the static routing table, the interface associated with the gateway is used.</span></span>
4. <span data-ttu-id="24501-539">Si el destino es en vínculo, se usa la interfaz en vínculo.</span><span class="sxs-lookup"><span data-stu-id="24501-539">If the destination is on-link, the on-link interface is used.</span></span>
5. <span data-ttu-id="24501-540">Si la dirección de destino es una dirección local de vínculo (169.254.0.0/16), se usa la primera interfaz válida.</span><span class="sxs-lookup"><span data-stu-id="24501-540">If the destination address is a link-local address (169.254.0.0/16), the first valid interface is used.</span></span>
6. <span data-ttu-id="24501-541">Si la puerta de enlace predeterminada está configurada correctamente, se usa la interfaz asociada a la puerta de enlace predeterminada para transmitir el paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-541">If the default gateway is configured, use the interface associated with the default gateway to transmit the packet.</span></span>
7. <span data-ttu-id="24501-542">Por último, si una de las direcciones IP de interfaz válida es una dirección local de vínculo (169.254.0.0/16), esta interfaz se utiliza como dirección de origen para la transmisión.</span><span class="sxs-lookup"><span data-stu-id="24501-542">Finally, if one of the valid interface IP address is link-local address (169.254.0.0/16), this interface is used as source address for the transmission.</span></span>
8. <span data-ttu-id="24501-543">El paquete de salida se elimina si fracasa todo lo anterior.</span><span class="sxs-lookup"><span data-stu-id="24501-543">The output packet is dropped if all above fails.</span></span>

### <a name="ip-receive"></a><span data-ttu-id="24501-544">Recepción de IP</span><span class="sxs-lookup"><span data-stu-id="24501-544">IP Receive</span></span>

<span data-ttu-id="24501-545">El procesamiento de recepción de IP se llama desde el controlador de red o desde el subproceso de IP interno (para procesar los paquetes de la cola de paquetes recibidos diferida).</span><span class="sxs-lookup"><span data-stu-id="24501-545">The IP receive processing is either called from the network driver or the internal IP thread (for processing packets on the deferred received packet queue).</span></span> <span data-ttu-id="24501-546">El procesamiento de recepción de IP examina el campo de protocolo e intenta enviar el paquete al componente de protocolo adecuado.</span><span class="sxs-lookup"><span data-stu-id="24501-546">The IP receive processing examines the protocol field and attempts to dispatch the packet to the proper protocol component.</span></span> <span data-ttu-id="24501-547">Antes de que el paquete se envíe realmente, el encabezado IP se quita, para lo cual se avanza el puntero antepuesto después del encabezado IP.</span><span class="sxs-lookup"><span data-stu-id="24501-547">Before the packet is actually dispatched, the IP header is removed by advancing the prepend pointer past the IP header.</span></span>

<span data-ttu-id="24501-548">El procesamiento de recepción de IP también detecta paquetes IP fragmentados y realiza los pasos necesarios para volver a ensamblarlos si la fragmentación está habilitada.</span><span class="sxs-lookup"><span data-stu-id="24501-548">IP receive processing also detects fragmented IP packets and performs the necessary steps to reassemble them if fragmentation is enabled.</span></span> <span data-ttu-id="24501-549">Si la fragmentación es necesaria pero no está habilitada, se elimina el paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-549">If fragmentation is needed but not enabled, the packet is dropped.</span></span>

<span data-ttu-id="24501-550">NetX Duo determina la interfaz de red adecuada en función de la interfaz especificada en el paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-550">NetX Duo determines the appropriate network interface based on the interface specified in the packet.</span></span> <span data-ttu-id="24501-551">Si la interfaz del paquete es NULL, el valor predeterminado de NetX Duo es la interfaz principal.</span><span class="sxs-lookup"><span data-stu-id="24501-551">If the packet interface is NULL, NetX Duo defaults to the primary interface.</span></span> <span data-ttu-id="24501-552">Esto se hace para garantizar la compatibilidad con controladores Ethernet de NetX Duo heredados.</span><span class="sxs-lookup"><span data-stu-id="24501-552">This is done to guarantee compatibility with legacy NetX Duo Ethernet drivers.</span></span>

### <a name="raw-ip-send"></a><span data-ttu-id="24501-553">Envío de Raw IP</span><span class="sxs-lookup"><span data-stu-id="24501-553">Raw IP Send</span></span>

<span data-ttu-id="24501-554">Un paquete Raw IP es un marco IP que contiene una carga de protocolo de nivel superior no admitida directamente (ni procesada) por NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-554">A raw IP packet is an IP frame that contains upper layer protocol payload not directly supported (and processed) by NetX Duo.</span></span> <span data-ttu-id="24501-555">Un paquete sin formato permite a los desarrolladores definir sus propias aplicaciones basadas en IP.</span><span class="sxs-lookup"><span data-stu-id="24501-555">A raw packet allows developers to define their own IP-based applications.</span></span> <span data-ttu-id="24501-556">Una aplicación puede enviar paquetes Raw IP directamente mediante el servicio ***nxd_ip_raw_packet_send** _ si se ha habilitado el procesamiento de paquetes Raw IP con el servicio _*_nx_ip_raw_packet_enabled_\*_.</span><span class="sxs-lookup"><span data-stu-id="24501-556">An application may send raw IP packets directly using the ***nxd_ip_raw_packet_send** _ service if raw IP packet processing has been enabled with the _*_nx_ip_raw_packet_enabled_\*_ service.</span></span> <span data-ttu-id="24501-557">Cuando se transmite un paquete de unidifusión en una red IPv6, NetX Duo determina automáticamente la mejor dirección IPv6 de origen que se debe usar para enviar los paquetes en función de la dirección de destino.</span><span class="sxs-lookup"><span data-stu-id="24501-557">When transmitting a unicast packet on an IPv6 network, NetX Duo automatically determines the best source IPv6 address to use to send the packets out on, based on the destination address.</span></span> <span data-ttu-id="24501-558">Sin embargo, si la dirección de destino es una dirección de multidifusión (o de difusión para IPv4), el valor predeterminado de NetX Duo es la primera interfaz (principal).</span><span class="sxs-lookup"><span data-stu-id="24501-558">If the destination address is a multicast (or broadcast for IPv4) address, however, NetX Duo will default to the first (primary) interface.</span></span> <span data-ttu-id="24501-559">Por lo tanto, para enviar estos paquetes mediante las interfaces secundarias, la aplicación debe usar el servicio _ *_nx_ip_raw_packet_source_send_*\* para especificar la dirección de origen que se va a utilizar para el paquete saliente.</span><span class="sxs-lookup"><span data-stu-id="24501-559">Therefore, to send such packets out on secondary interfaces, the application must use the _ *_nx_ip_raw_packet_source_send_*\* service to specify the source address to use for the outgoing packet.</span></span>

### <a name="raw-ip-receive"></a><span data-ttu-id="24501-560">Recepción de IP sin formato</span><span class="sxs-lookup"><span data-stu-id="24501-560">Raw IP Receive</span></span>

<span data-ttu-id="24501-561">Si está habilitado el procesamiento de paquetes Raw IP, la aplicación puede recibir paquetes Raw IP mediante el servicio \***nx_ip_raw_packet_receive** _.</span><span class="sxs-lookup"><span data-stu-id="24501-561">If raw IP packet processing is enabled, the application may receive raw IP packets through the \***nx_ip_raw_packet_receive** _ service.</span></span> <span data-ttu-id="24501-562">Todos los paquetes entrantes se procesan según el protocolo especificado en el encabezado IP.</span><span class="sxs-lookup"><span data-stu-id="24501-562">All incoming packets are processed according to the protocol specified in the IP header.</span></span> <span data-ttu-id="24501-563">Si el protocolo especifica UDP, TCP, IGMP o ICMP, NetX Duo procesará el paquete con el controlador adecuado para el tipo de protocolo del paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-563">If the protocol specifies UDP, TCP, IGMP or ICMP, NetX Duo will process the packet using the appropriate handler for the packet protocol type.</span></span> <span data-ttu-id="24501-564">Si el protocolo no es uno de los indicados y la recepción de Raw IP está habilitada, el paquete entrante se colocará en la cola de paquetes sin procesar en espera de que la aplicación lo reciba a través del servicio _\*_nx_ip_raw_packet_receive_\*\*. Además, los subprocesos de aplicación se pueden suspender con un tiempo de espera opcional mientras esperan un paquete Raw IP. El número de paquetes que se pueden poner en cola en la cola de paquetes sin procesar es limitado. El valor máximo se define en \***NX_IP_RAW_MAX_QUEUE_DEPTH**_, cuyo valor predeterminado es 20.</span><span class="sxs-lookup"><span data-stu-id="24501-564">If the protocol is not one of these protocols, and raw IP receive is enabled, the incoming packet will be put into the raw packet queue waiting for the application to receive it via the _*_nx_ip_raw_packet_receive_*\* service. In addition, application threads may suspend with an optional timeout while waiting for a raw IP packet. The number of packets that can be queued on the raw packet queue is limited. The maximum value is defined in \***NX_IP_RAW_MAX_QUEUE_DEPTH**_, whose default value is 20.</span></span> <span data-ttu-id="24501-565">Una aplicación puede cambiar el valor máximo mediante una llamada al servicio _ \*_nx_ip_raw_receive_queue_max_set_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-565">An application may change the maximum value by calling the _ *_nx_ip_raw_receive_queue_max_set_*\* service.</span></span>

<span data-ttu-id="24501-566">Como alternativa, la biblioteca de NetX Duo puede compilarse con \***NX_ENABLE_IP_RAW_PACKET_FILTER\*.**</span><span class="sxs-lookup"><span data-stu-id="24501-566">Alternatively, the NetX Duo library may be built with \***NX_ENABLE_IP_RAW_PACKET_FILTER\*.**</span></span> <span data-ttu-id="24501-567">En este modo de funcionamiento, la aplicación proporciona una función de devolución de llamada que se invoca cada vez que se recibe un paquete con un tipo de protocolo no controlado.</span><span class="sxs-lookup"><span data-stu-id="24501-567">In this mode of operation, the application provides a callback function that is invoked every time a packet with an unhandled protocol type is received.</span></span> <span data-ttu-id="24501-568">La lógica de recepción de IP reenvía el paquete a la rutina de filtro de recepción de paquetes sin procesar definida por el usuario.</span><span class="sxs-lookup"><span data-stu-id="24501-568">The IP receive logic forwards the packet to the user-defined raw packet receive filter routine.</span></span> <span data-ttu-id="24501-569">La rutina de filtro decide si se debe mantener el paquete sin procesar para futuros procesos.</span><span class="sxs-lookup"><span data-stu-id="24501-569">The filter routine decides whether or not to keep the raw packet for future process.</span></span> <span data-ttu-id="24501-570">El valor devuelto de la rutina de devolución de llamada indica si el paquete se ha procesado mediante el filtro de recepción de paquetes sin procesar.</span><span class="sxs-lookup"><span data-stu-id="24501-570">The return value from the callback routine indicates whether the packet has been processed by the raw packet receive filter.</span></span> <span data-ttu-id="24501-571">Si la función de devolución de llamada procesa el paquete, el paquete debe liberarse cuando la aplicación termine de utilizarlo.</span><span class="sxs-lookup"><span data-stu-id="24501-571">If the packet is processed by the callback function, the packet should be released after the application is done with the packet.</span></span> <span data-ttu-id="24501-572">De lo contrario, NetX Duo es responsable de liberar el paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-572">Otherwise, NetX Duo is responsible for releasing the packet.</span></span> <span data-ttu-id="24501-573">Consulte **_nx_ip_raw_packet_filter_set_** para obtener más información sobre cómo usar la función de filtro de paquetes sin procesar.</span><span class="sxs-lookup"><span data-stu-id="24501-573">Refer to the **_nx_ip_raw_packet_filter_set_** for more information on how to use the raw packet filter function.</span></span>

> [!NOTE]
> <span data-ttu-id="24501-574">\*La función de contenedor BSD para NetX Duo se basa en la función de filtro de paquetes sin procesar para controlar los sockets sin procesar de BSD.</span><span class="sxs-lookup"><span data-stu-id="24501-574">\*The BSD wrapper function for NetX Duo relies on the raw packet filter function to handle BSD raw sockets.</span></span> <span data-ttu-id="24501-575">Por lo tanto, para admitir sockets sin procesar en el contenedor BSD, la biblioteca de NetX Duo debe compilarse con ***NX_ENABLE_IP_RAW_PACKET_FILTER** _ definido, y la aplicación no debe usar _*_nx_ip_raw_packet_filter_set_\*_ para instalar sus propias funciones de filtro de paquetes sin procesar._</span><span class="sxs-lookup"><span data-stu-id="24501-575">Therefore, to support raw socket in the BSD wrapper, the NetX Duo library must be built with ***NX_ENABLE_IP_RAW_PACKET_FILTER** _ defined, and the application should not use the _*_nx_ip_raw_packet_filter_set_\*_ to install its own raw packet filter functions._</span></span>

### <a name="default-packet-pool"></a><span data-ttu-id="24501-576">Grupo de paquetes predeterminado</span><span class="sxs-lookup"><span data-stu-id="24501-576">Default Packet Pool</span></span>

<span data-ttu-id="24501-577">A cada instancia de IP se le asigna un grupo de paquetes predeterminado durante la creación.</span><span class="sxs-lookup"><span data-stu-id="24501-577">Each IP instance is given a default packet pool during creation.</span></span> <span data-ttu-id="24501-578">Este grupo de paquetes se usa para asignar paquetes para ARP, RARP, ICMP, IGMP, distintos paquetes de control TCP (SYN, ACK, etc.), detección de equipos cercanos, detección de enrutadores y detección de direcciones duplicadas.</span><span class="sxs-lookup"><span data-stu-id="24501-578">This packet pool is used to allocate packets for ARP, RARP, ICMP, IGMP, various TCP control packets (SYN, ACK, and so on), Neighbor Discovery, Router Discovery, and Duplicate Address Detection.</span></span> <span data-ttu-id="24501-579">Si el grupo de paquetes predeterminado está vacío cuando NetX Duo necesita asignar un paquete, es posible que NetX Duo deba cancelar esa operación específica y devolverá un mensaje de error si es posible.</span><span class="sxs-lookup"><span data-stu-id="24501-579">If the default packet pool is empty when NetX Duo needs to allocate a packet, NetX Duo may have to abort the particular operation, and will return an error message if possible.</span></span>

### <a name="ip-helper-thread"></a><span data-ttu-id="24501-580">Subproceso auxiliar de IP</span><span class="sxs-lookup"><span data-stu-id="24501-580">IP Helper Thread</span></span>

<span data-ttu-id="24501-581">Cada instancia de IP tiene un subproceso auxiliar.</span><span class="sxs-lookup"><span data-stu-id="24501-581">Each IP instance has a helper thread.</span></span> <span data-ttu-id="24501-582">Este subproceso es responsable de controlar todo el procesamiento de paquetes diferido y todo el procesamiento periódico.</span><span class="sxs-lookup"><span data-stu-id="24501-582">This thread is responsible for handling all deferred packet processing and all periodic processing.</span></span> <span data-ttu-id="24501-583">El subproceso auxiliar de IP se crea en ***nx_ip_create***.Aquí es donde el subproceso tiene su pila y prioridad.</span><span class="sxs-lookup"><span data-stu-id="24501-583">The IP helper thread is created in ***nx_ip_create.*** This is where the thread is given its stack and priority.</span></span> <span data-ttu-id="24501-584">Tenga en cuenta que el primer procesamiento del subproceso auxiliar de IP es para finalizar la inicialización del controlador de red asociado con el servicio de creación de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-584">Note that the first processing in the IP helper thread is to finish the network driver initialization associated with the IP create service.</span></span> <span data-ttu-id="24501-585">Una vez completada la inicialización del controlador de red, el subproceso auxiliar inicia un bucle sin fin para procesar paquetes y solicitudes periódicas.</span><span class="sxs-lookup"><span data-stu-id="24501-585">After the network driver initialization is complete, the helper thread starts an endless loop to process packet and periodic requests.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="24501-586">*Si se observa un comportamiento no explicado en el subproceso auxiliar de IP, el primer paso de depuración es el aumento del tamaño de la pila durante el servicio de creación de IP. Si la pila es demasiado pequeña, es posible que el subproceso auxiliar de IP sobrescriba la memoria, lo que puede causar problemas inusuales.*</span><span class="sxs-lookup"><span data-stu-id="24501-586">*If unexplained behavior is seen within the IP helper thread, increasing its stack size during the IP create service is the first debugging step. If the stack is too small, the IP helper thread could possibly be overwriting memory, which may cause unusual problems.*</span></span>

### <a name="thread-suspension"></a><span data-ttu-id="24501-587">Suspensión de subprocesos</span><span class="sxs-lookup"><span data-stu-id="24501-587">Thread Suspension</span></span>

<span data-ttu-id="24501-588">Los subprocesos de la aplicación se pueden suspender al intentar recibir paquetes Raw IP.</span><span class="sxs-lookup"><span data-stu-id="24501-588">Application threads can suspend while attempting to receive raw IP packets.</span></span> <span data-ttu-id="24501-589">Después de recibir un paquete sin formato, se asigna el nuevo paquete al primer subproceso suspendido y se reanuda dicho subproceso.</span><span class="sxs-lookup"><span data-stu-id="24501-589">After a raw packet is received, the new packet is given to the first thread suspended and that thread is resumed.</span></span> <span data-ttu-id="24501-590">Todos los servicios de NetX Duo para la recepción de paquetes tienen un tiempo de espera de suspensión opcional.</span><span class="sxs-lookup"><span data-stu-id="24501-590">NetX Duo services for receiving packets all have an optional suspension timeout.</span></span> <span data-ttu-id="24501-591">Cuando se recibe un paquete o se agota el tiempo de espera, el subproceso de la aplicación se reanuda con el estado de finalización adecuado.</span><span class="sxs-lookup"><span data-stu-id="24501-591">When a packet is received or the timeout expires, the application thread is resumed with the appropriate completion status.</span></span>

### <a name="ip-statistics-and-errors"></a><span data-ttu-id="24501-592">Estadísticas y errores de IP</span><span class="sxs-lookup"><span data-stu-id="24501-592">IP Statistics and Errors</span></span>

<span data-ttu-id="24501-593">Si se habilita, NetX Duo realiza un seguimiento de varias estadísticas y errores que pueden ser útiles para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-593">If enabled, the NetX Duo keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="24501-594">Se mantienen las estadísticas y los informes de errores siguientes para cada instancia de IP:</span><span class="sxs-lookup"><span data-stu-id="24501-594">The following statistics and error reports are maintained for each IP instance:</span></span>

- <span data-ttu-id="24501-595">Número total de paquetes IP enviados</span><span class="sxs-lookup"><span data-stu-id="24501-595">Total IP Packets Sent</span></span>
- <span data-ttu-id="24501-596">Número total de bytes IP enviados</span><span class="sxs-lookup"><span data-stu-id="24501-596">Total IP Bytes Sent</span></span>
- <span data-ttu-id="24501-597">Número total de paquetes IP recibidos</span><span class="sxs-lookup"><span data-stu-id="24501-597">Total IP Packets Received</span></span>
- <span data-ttu-id="24501-598">Número total de bytes IP recibidos</span><span class="sxs-lookup"><span data-stu-id="24501-598">Total IP Bytes Received</span></span>
- <span data-ttu-id="24501-599">Número total de paquetes IP no válidos</span><span class="sxs-lookup"><span data-stu-id="24501-599">Total IP Invalid Packets</span></span>
- <span data-ttu-id="24501-600">Número total de paquetes de recepción de IP eliminados</span><span class="sxs-lookup"><span data-stu-id="24501-600">Total IP Receive Packets Dropped</span></span>
- <span data-ttu-id="24501-601">Número total de errores de suma de comprobación de recepción de IP</span><span class="sxs-lookup"><span data-stu-id="24501-601">Total IP Receive Checksum Errors</span></span>
- <span data-ttu-id="24501-602">Número total de paquetes de envío de IP eliminados</span><span class="sxs-lookup"><span data-stu-id="24501-602">Total IP Send Packets Dropped</span></span>
- <span data-ttu-id="24501-603">Número total de fragmentos IP enviados</span><span class="sxs-lookup"><span data-stu-id="24501-603">Total IP Fragments Sent</span></span>
- <span data-ttu-id="24501-604">Número total de fragmentos IP recibidos</span><span class="sxs-lookup"><span data-stu-id="24501-604">Total IP Fragments Received</span></span>

<span data-ttu-id="24501-605">Todos estos informes de errores y estadísticas están disponibles para la aplicación con el servicio ***nx_ip_info_get***.</span><span class="sxs-lookup"><span data-stu-id="24501-605">All of these statistics and error reports are available to the application with the ***nx_ip_info_get*** service.</span></span>

### <a name="ip-control-block-nx_ip"></a><span data-ttu-id="24501-606">Bloque de control de IP NX_IP</span><span class="sxs-lookup"><span data-stu-id="24501-606">IP Control Block NX_IP</span></span>

<span data-ttu-id="24501-607">Las características de cada instancia de IP se encuentran en su bloque de control.</span><span class="sxs-lookup"><span data-stu-id="24501-607">The characteristics of each IP instance are found in its control block.</span></span> <span data-ttu-id="24501-608">Contiene información útil, como las direcciones IP y las máscaras de red de cada dispositivo de red, y una tabla de asignación de direcciones IP de equipos cercanos y hardware físico.</span><span class="sxs-lookup"><span data-stu-id="24501-608">It contains useful information such as the IP addresses and network masks of each network device, and a table of neighbor IP and physical hardware address mapping.</span></span> <span data-ttu-id="24501-609">Esta estructura se define en el archivo \***nx_api.h**.</span><span class="sxs-lookup"><span data-stu-id="24501-609">This structure is defined in the \***nx_api.h** _file.</span></span> <span data-ttu-id="24501-610">Si IPv6 está habilitado, también contiene una matriz de direcciones IPv6, cuyo número se especifica mediante la opción configurable por el usuario _\*_NX_MAX_IPV6_ADDRESSES_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-610">If IPv6 is enabled, it also contains an array of IPv6 address, the number of which is specified by the user configurable option _\*_NX_MAX_IPV6_ADDRESSES_\*\*.</span></span> <span data-ttu-id="24501-611">El valor predeterminado permite que cada interfaz de red física tenga tres direcciones IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-611">The default value allows each physical network interface to have three IPv6 addresses.</span></span>

<span data-ttu-id="24501-612">Los bloques de control de instancias de IP se pueden ubicar en cualquier parte de la memoria, pero es más común convertir el bloque de control en una estructura global definiéndolo fuera del ámbito de cualquier función.</span><span class="sxs-lookup"><span data-stu-id="24501-612">IP instance control blocks can be located anywhere in memory, but it is most common to make the control block a global structure by defining it outside the scope of any function.</span></span>

### <a name="static-ipv4-routing"></a><span data-ttu-id="24501-613">Enrutamiento IPv4 estático</span><span class="sxs-lookup"><span data-stu-id="24501-613">Static IPv4 Routing</span></span>

<span data-ttu-id="24501-614">La característica de enrutamiento estático permite que una aplicación especifique una red IPv4 y una dirección de próximo salto para direcciones IP de destino específicas fuera de la red.</span><span class="sxs-lookup"><span data-stu-id="24501-614">The static routing feature allows an application to specify an IPv4 network and next hop address for specific out of network destination IP addresses.</span></span> <span data-ttu-id="24501-615">Si está habilitado el enrutamiento estático, NetX Duo busca en la tabla de enrutamiento estática una entrada que coincida con la dirección de destino del paquete que se va a enviar.</span><span class="sxs-lookup"><span data-stu-id="24501-615">If static routing is enabled, NetX Duo searches through the static routing table for an entry matching the destination address of the packet to send.</span></span> <span data-ttu-id="24501-616">Si no se encuentra ninguna coincidencia, NetX Duo busca en la lista de interfaces físicas y elige una dirección IP de origen y una dirección del próximo salto en función de la dirección IP de destino y la máscara de red.</span><span class="sxs-lookup"><span data-stu-id="24501-616">If no match is found, NetX Duo searches through the list of physical interfaces and chooses a source IP address and next hop address based on the destination IP address and the network mask.</span></span> <span data-ttu-id="24501-617">Si el destino no coincide con ninguna de las direcciones IP de los controladores de red conectados a la instancia de IP, NetX Duo elige una interfaz que esté conectada directamente a la puerta de enlace predeterminada y usa la dirección IP de la interfaz como dirección de origen y la puerta de enlace predeterminada como el próximo salto.</span><span class="sxs-lookup"><span data-stu-id="24501-617">If the destination does not match any of the IP addresses of the network drivers attached to the IP instance, NetX Duo chooses an interface that is directly connected to the default gateway, and uses the IP address of the interface as source address, and the default gateway as the next hop.</span></span>

<span data-ttu-id="24501-618">Se pueden agregar y quitar entradas de la tabla de enrutamiento estático mediante los servicios \***nx_ip_static_route_add** _ y _ \*_nx_ip_static_route_delete_\*\*, respectivamente.</span><span class="sxs-lookup"><span data-stu-id="24501-618">Entries can be added and removed from the static routing table using the ***nx_ip_static_route_add** _ and _ *_nx_ip_static_route_delete_** services, respectively.</span></span> <span data-ttu-id="24501-619">Para usar el enrutamiento estático, la aplicación host debe habilitar esta característica mediante la definición de ***NX_ENABLE_IP_STATIC_ROUTING.***</span><span class="sxs-lookup"><span data-stu-id="24501-619">To use static routing, the host application must enable this feature by defining ***NX_ENABLE_IP_STATIC_ROUTING.***</span></span>

> [!NOTE]
> <span data-ttu-id="24501-620">*Cuando se agrega una entrada a la tabla de enrutamiento estático, NetX Duo comprueba si ya hay una entrada coincidente para la dirección de destino especificada en la tabla. Si existe una, da preferencia a la entrada con la red más pequeña (prefijo más largo) de la máscara de red.*</span><span class="sxs-lookup"><span data-stu-id="24501-620">*When adding an entry to the static routing table, NetX Duo checks for a matching entry for the specified destination address already in the table. If one exists, it gives preference to the entry with the smaller network (longer prefix) in the network mask.*</span></span>

### <a name="ipv4-forwarding"></a><span data-ttu-id="24501-621">Reenvío IPv4</span><span class="sxs-lookup"><span data-stu-id="24501-621">IPv4 Forwarding</span></span>

<span data-ttu-id="24501-622">Si el paquete IPv4 entrante no está destinado a este nodo y la característica de reenvío IPv4 está habilitada, NetX Duo intenta reenviar el paquete a través de las otras interfaces.</span><span class="sxs-lookup"><span data-stu-id="24501-622">If the incoming IPv4 packet is not destined for this node and IPv4 forwarding feature is enabled, NetX Duo attempts to forward the packet out via the other interfaces.</span></span>  

### <a name="ip-fragmentation"></a><span data-ttu-id="24501-623">Fragmentación de IP</span><span class="sxs-lookup"><span data-stu-id="24501-623">IP Fragmentation</span></span>

<span data-ttu-id="24501-624">El dispositivo de red puede tener límites en cuanto al tamaño de los paquetes salientes.</span><span class="sxs-lookup"><span data-stu-id="24501-624">The network device may have limits on the size of outgoing packets.</span></span> <span data-ttu-id="24501-625">Este límite se llama unidad de transmisión máxima (MTU).</span><span class="sxs-lookup"><span data-stu-id="24501-625">This limit is called the maximum transmission unit (MTU).</span></span> <span data-ttu-id="24501-626">La MTU de IP es el tamaño de marco de IP más grande que un controlador de capa de vínculo puede transmitir sin fragmentar el paquete IP.</span><span class="sxs-lookup"><span data-stu-id="24501-626">IP MTU is the largest IP frame size a link layer driver is able to transmit without fragmenting the IP packet.</span></span> <span data-ttu-id="24501-627">Durante la fase de inicialización de un controlador de dispositivo, el módulo del controlador debe configurar su tamaño de MTU de IP mediante el servicio ***nx_ip_interface_mtu_set.***</span><span class="sxs-lookup"><span data-stu-id="24501-627">During a device driver initialization phase, the driver module must configure its IP MTU size via the service ***nx_ip_interface_mtu_set.***</span></span>

<span data-ttu-id="24501-628">Aunque no se recomienda, la aplicación puede generar datagramas mayores que la MTU de IP subyacente admitida por el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="24501-628">Although not recommended, the application may generate datagrams larger than the underlying IP MTU supported by the device.</span></span> <span data-ttu-id="24501-629">Antes de transmitir este tipo de datagrama IP, la capa de IP debe fragmentar estos paquetes.</span><span class="sxs-lookup"><span data-stu-id="24501-629">Before transmitting such IP datagram, the IP layer must fragment these packets.</span></span> <span data-ttu-id="24501-630">Al recibir marcos IP fragmentados, el extremo receptor debe almacenar todos los marcos IP fragmentados con el mismo identificador de fragmentación y volver a ensamblarlos en orden.</span><span class="sxs-lookup"><span data-stu-id="24501-630">On receiving fragmented IP frames, the receiving end must store all fragmented IP frames with the same fragmentation ID, and reassemble them in order.</span></span> <span data-ttu-id="24501-631">Si la lógica de recepción de IP no puede recopilar todos los fragmentos para restaurar el marco de IP original a tiempo, se liberan todos los fragmentos.</span><span class="sxs-lookup"><span data-stu-id="24501-631">If the IP receive logic is unable to collect all the fragments to restore the original IP frame in time, all the fragments are released.</span></span> <span data-ttu-id="24501-632">El protocolo de la capa superior debe detectar esta pérdida de paquetes y realizar la recuperación pertinente.</span><span class="sxs-lookup"><span data-stu-id="24501-632">It is up to the upper layer protocol to detect such packet loss and recover from it.</span></span>

<span data-ttu-id="24501-633">La fragmentación de IP se aplica a los paquetes IPv4 e IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-633">The IP fragmentation applies to both IPv4 and IPv6 packets.</span></span>

<span data-ttu-id="24501-634">Con el fin de admitir la fragmentación de IP y la operación de reensamblado, el diseñador del sistema debe habilitar la característica de fragmentación de IP en NetX Duo mediante el servicio ***nx_ip_fragment_enable***.</span><span class="sxs-lookup"><span data-stu-id="24501-634">In order to support IP fragmentation and reassembly operation, the system designer must enable the IP fragmentation feature in NetX Duo using the ***nx_ip_fragment_enable*** service.</span></span> <span data-ttu-id="24501-635">Si esta característica no está habilitada, se descartan los paquetes IP fragmentados entrantes, así como los paquetes que superan la MTU del controlador de red.</span><span class="sxs-lookup"><span data-stu-id="24501-635">If this feature is not enabled, incoming fragmented IP packets are discarded, as well as packets that exceed the network driver's MTU.</span></span>

> [!NOTE]
> <span data-ttu-id="24501-636">\*La lógica de fragmentación de IP se puede quitar por completo mediante la definición de \***NX_DISABLE_FRAGMENTATION** _ al compilar la biblioteca de NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-636">\*The IP Fragmentation logic can be removed completely by defining \***NX_DISABLE_FRAGMENTATION** _ when building the NetX Duo library.</span></span> <span data-ttu-id="24501-637">Esto ayuda a reducir el tamaño del código de NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-637">Doing so helps reduce the code size of NetX Duo.</span></span> <span data-ttu-id="24501-638">Tenga en cuenta que, en esta situación, las funciones de fragmentación y reensamblado de IPv4 e IPv6 se deshabilitan._</span><span class="sxs-lookup"><span data-stu-id="24501-638">Note that in this situation, both the IPv4 and IPv6 fragmentation/reassembly functions are disabled._</span></span>

> [!NOTE]
> <span data-ttu-id="24501-639">*Si se define **NX_DISABLE_CHAINED_PACKET**, se debe deshabilitar la fragmentación de IP.*</span><span class="sxs-lookup"><span data-stu-id="24501-639">*If **NX_DISABLE_CHAINED_PACKET** is defined, IP fragmentation must be disabled.*</span></span>

> [!NOTE]
> <span data-ttu-id="24501-640">*En una red IPv6, los enrutadores no fragmentan un datagrama si su tamaño supera el tamaño mínimo de la MTU. Por lo tanto, el dispositivo de envío debe determinar la MTU mínima entre el origen y el destino, y asegurarse de que el tamaño del datagrama IP no supera la MTU de la ruta de acceso. En NetX Duo, la detección de MTU de la ruta de acceso IPv6 se puede habilitar mediante la compilación de la biblioteca de NetX Duo con el símbolo **NX_ENABLE_IPV6_PATH_MTU_DISCOVERY** definido.*</span><span class="sxs-lookup"><span data-stu-id="24501-640">*In an IPv6 network, routers do not fragment a datagram if the size of the datagram exceeds its minimum MTU size. Therefore, it is up to the sending device to determine the minimum MTU between the source and the destination, and to ensure the IP datagram size does not exceed the path MTU. In NetX Duo, IPv6 PATH MTU discovery can be enabled by building NetX Duo library with the symbol **NX_ENABLE_IPV6_PATH_MTU_DISCOVERY** defined.*</span></span>

## <a name="address-resolution-protocol-arp-in-ipv4"></a><span data-ttu-id="24501-641">Protocolo de resolución de direcciones (ARP) en IPv4</span><span class="sxs-lookup"><span data-stu-id="24501-641">Address Resolution Protocol (ARP) in IPv4</span></span>

<span data-ttu-id="24501-642">El protocolo de resolución de direcciones (ARP) es responsable de asignar de forma dinámica las direcciones IPv4 de 32 bits a las de los soportes físicos subyacentes (RFC 826).</span><span class="sxs-lookup"><span data-stu-id="24501-642">The Address Resolution Protocol (ARP) is responsible for dynamically mapping 32-bit IPv4 addresses to those of the underlying physical media (RFC 826).</span></span> <span data-ttu-id="24501-643">Ethernet es el soporte físico más típico y admite direcciones de 48 bits.</span><span class="sxs-lookup"><span data-stu-id="24501-643">Ethernet is the most typical physical media, and it supports 48-bit addresses.</span></span> <span data-ttu-id="24501-644">La necesidad de ARP viene determinada por el controlador de red proporcionado al servicio \***nx_ip_create** _.</span><span class="sxs-lookup"><span data-stu-id="24501-644">The need for ARP is determined by the network driver supplied to the \***nx_ip_create** _ service.</span></span> <span data-ttu-id="24501-645">Si se requiere la asignación física, el controlador de red debe usar el servicio _ *_nx_interface_address_mapping_needed_*\* para configurar la interfaz del controlador correctamente.</span><span class="sxs-lookup"><span data-stu-id="24501-645">If physical mapping is required, the network driver must use the _ *_nx_interface_address_mapping_needed_*\* service to configure the driver interface properly.</span></span>

### <a name="arp-enable"></a><span data-ttu-id="24501-646">Habilitación de ARP</span><span class="sxs-lookup"><span data-stu-id="24501-646">ARP Enable</span></span>

<span data-ttu-id="24501-647">Para que el protocolo ARP funcione correctamente, la aplicación debe habilitarlo primero con el servicio ***nx_arp_enable***.</span><span class="sxs-lookup"><span data-stu-id="24501-647">For ARP to function properly, it must first be enabled by the application with the ***nx_arp_enable*** service.</span></span> <span data-ttu-id="24501-648">Este servicio configura varias estructuras de datos para el procesamiento de ARP, incluida la creación de un área de memoria caché de ARP desde la memoria suministrada al servicio de habilitación de ARP.</span><span class="sxs-lookup"><span data-stu-id="24501-648">This service sets up various data structures for ARP processing, including the creation of an ARP cache area from the memory supplied to the ARP enable service.</span></span>

### <a name="arp-cache"></a><span data-ttu-id="24501-649">Memoria caché de ARP</span><span class="sxs-lookup"><span data-stu-id="24501-649">ARP Cache</span></span>

<span data-ttu-id="24501-650">La memoria caché de ARP se puede ver como una matriz de estructuras de datos de asignaciones de ARP internas.</span><span class="sxs-lookup"><span data-stu-id="24501-650">The ARP cache can be viewed as an array of internal ARP mapping data structures.</span></span> <span data-ttu-id="24501-651">Cada estructura interna es capaz de mantener la relación entre una dirección IP y una dirección de hardware físico.</span><span class="sxs-lookup"><span data-stu-id="24501-651">Each internal structure is capable of maintaining the relationship between an IP address and a physical hardware address.</span></span> <span data-ttu-id="24501-652">Además, cada estructura de datos tiene punteros de vínculo para que pueda formar parte de varias listas de vínculos.</span><span class="sxs-lookup"><span data-stu-id="24501-652">In addition, each data structure has link pointers so it can be part of multiple linked lists.</span></span>

<span data-ttu-id="24501-653">La aplicación puede buscar una dirección IP desde la memoria caché de ARP proporcionando una dirección MAC de hardware mediante el servicio \***nx_arp_ip_address_find** _ si la asignación existe en la tabla de ARP.</span><span class="sxs-lookup"><span data-stu-id="24501-653">Application can look up an IP address from the ARP cache by supplying hardware MAC address using the service \***nx_arp_ip_address_find** _ if the mapping exists in the ARP table.</span></span> <span data-ttu-id="24501-654">De forma similar, el servicio _ *_nx_arp_hardware_address_find_*\* devuelve la dirección MAC correspondiente a una dirección IP determinada.</span><span class="sxs-lookup"><span data-stu-id="24501-654">Similarly, the service _ *_nx_arp_hardware_address_find_*\* returns the MAC address for a given IP address.</span></span>

### <a name="arp-dynamic-entries"></a><span data-ttu-id="24501-655">Entradas dinámicas de ARP</span><span class="sxs-lookup"><span data-stu-id="24501-655">ARP Dynamic Entries</span></span>

<span data-ttu-id="24501-656">De manera predeterminada, el servicio de habilitación de ARP coloca todas las entradas de la memoria caché de ARP en la lista de entradas de ARP dinámicas disponibles.</span><span class="sxs-lookup"><span data-stu-id="24501-656">By default, the ARP enable service places all entries in the ARP cache on the list of available dynamic ARP entries.</span></span> <span data-ttu-id="24501-657">NetX Duo asigna una entrada de ARP dinámica de esta lista cuando se detecta una solicitud de envío a una dirección IP no asignada.</span><span class="sxs-lookup"><span data-stu-id="24501-657">A dynamic ARP entry is allocated from this list by NetX Duo when a send request to an unmapped IP address is detected.</span></span> <span data-ttu-id="24501-658">Después de la asignación, se configura la entrada de ARP y se envía una solicitud ARP al soporte físico.</span><span class="sxs-lookup"><span data-stu-id="24501-658">After allocation, the ARP entry is set up and an ARP request is sent to the physical media.</span></span>

<span data-ttu-id="24501-659">También se puede crear una entrada dinámica mediante el servicio ***nx_arp_dynamic_entry_set***.</span><span class="sxs-lookup"><span data-stu-id="24501-659">A dynamic entry can also be created by the service ***nx_arp_dynamic_entry_set***.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="24501-660">*Si todas las entradas de ARP dinámicas están en uso, la entrada de ARP usada menos recientemente se reemplaza por una nueva asignación.*</span><span class="sxs-lookup"><span data-stu-id="24501-660">*If all dynamic ARP entries are in use, the least recently used ARP entry is replaced with a new mapping.*</span></span>

### <a name="arp-static-entries"></a><span data-ttu-id="24501-661">Entradas estáticas de ARP</span><span class="sxs-lookup"><span data-stu-id="24501-661">ARP Static Entries</span></span>

<span data-ttu-id="24501-662">La aplicación también puede configurar una asignación de ARP estática mediante el servicio \***nx_arp_static_entry_create** _.</span><span class="sxs-lookup"><span data-stu-id="24501-662">The application can also set up static ARP mapping by using the \***nx_arp_static_entry_create** _service.</span></span> <span data-ttu-id="24501-663">Este servicio asigna una entrada de ARP de la lista de entradas de ARP dinámicas y la coloca en la lista estática con la información de asignación proporcionada por la aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-663">This service allocates an ARP entry from the dynamic ARP entry list and places it on the static list with the mapping information supplied by the application.</span></span> <span data-ttu-id="24501-664">Las entradas de ARP estáticas no están sujetas a reutilización o caducidad.</span><span class="sxs-lookup"><span data-stu-id="24501-664">Static ARP entries are not subject to reuse or aging.</span></span> <span data-ttu-id="24501-665">La aplicación puede eliminar una entrada estática mediante el servicio _*_nx_arp_static_entry_delete_*_.</span><span class="sxs-lookup"><span data-stu-id="24501-665">The application can delete a static entry by using the service _*_nx_arp_static_entry_delete_*_.</span></span> <span data-ttu-id="24501-666">Para quitar todas las entradas estáticas de la tabla de ARP, la aplicación puede utilizar el servicio _\*_nx_arp_static_entries_delete_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-666">To remove all static entries in the ARP table, the application may use the service _\*_nx_arp_static_entries_delete_\*\*.</span></span>

### <a name="automatic-arp-entry"></a><span data-ttu-id="24501-667">Entrada de ARP automática</span><span class="sxs-lookup"><span data-stu-id="24501-667">Automatic ARP Entry</span></span>

<span data-ttu-id="24501-668">NetX Duo registra la asignación entre IP y MAC del nodo del mismo nivel después de las respuestas del nodo del mismo nivel a la solicitud ARP.</span><span class="sxs-lookup"><span data-stu-id="24501-668">NetX Duo records the peer's IP/MAC mapping after the peer responses to the ARP request.</span></span> <span data-ttu-id="24501-669">NetX Duo también implementa la característica de entrada de ARP automática, con la que se registra la asignación de direcciones IP y MAC del nodo del mismo nivel en función de solicitudes ARP no realizadas desde la red.</span><span class="sxs-lookup"><span data-stu-id="24501-669">NetX Duo also implements the automatic ARP entry feature where it records peer IP/MAC address mapping based on unsolicited ARP requests from the network.</span></span> <span data-ttu-id="24501-670">Esta característica permite que la tabla de ARP se rellene con información de los nodos del mismo nivel, lo que reduce el retraso necesario para pasar por el ciclo de solicitud y respuesta de ARP.</span><span class="sxs-lookup"><span data-stu-id="24501-670">This feature allows the ARP table to be populated with peer information, reducing the delay needed to go through the ARP request/response cycle.</span></span> <span data-ttu-id="24501-671">Sin embargo, el inconveniente de habilitar ARP automático es que la tabla de ARP tiende a llenarse rápidamente en una red ocupada con muchos nodos en el vínculo local, lo que finalmente provocaría el reemplazo de las entradas de ARP.</span><span class="sxs-lookup"><span data-stu-id="24501-671">However the downside with enabling automatic ARP is that the ARP table tend to fill up quickly on a busy network with many nodes on the local link, which would eventually lead to ARP entry replacement.</span></span>

<span data-ttu-id="24501-672">Esta característica está habilitada de forma predeterminada.</span><span class="sxs-lookup"><span data-stu-id="24501-672">This feature is enabled by default.</span></span> <span data-ttu-id="24501-673">Para deshabilitarla, se debe compilar la biblioteca de NetX Duo con el símbolo ***NX_DISABLE_ARP_AUTO_ENTRY*** definido.</span><span class="sxs-lookup"><span data-stu-id="24501-673">To disable it, the NetX Duo library must be compiled with the symbol ***NX_DISABLE_ARP_AUTO_ENTRY*** defined.</span></span></p>

### <a name="arp-messages"></a><span data-ttu-id="24501-674">Mensajes de ARP</span><span class="sxs-lookup"><span data-stu-id="24501-674">ARP Messages</span></span>

<span data-ttu-id="24501-675">Como se ha mencionado anteriormente, se envía un mensaje de solicitud ARP cuando la tarea de IP detecta que es necesaria una asignación para una dirección IP.</span><span class="sxs-lookup"><span data-stu-id="24501-675">As mentioned previously, an ARP request message is sent when the IP task detects that mapping is needed for an IP address.</span></span> <span data-ttu-id="24501-676">Las solicitudes ARP se envían periódicamente (cada \***NX_ARP_UPDATE_RATE** _ segundos) hasta que se recibe una respuesta de ARP correspondiente.</span><span class="sxs-lookup"><span data-stu-id="24501-676">ARP requests are sent periodically (every \***NX_ARP_UPDATE_RATE** _ seconds) until a corresponding ARP response is received.</span></span> <span data-ttu-id="24501-677">Se realiza un total de _ *_NX_ARP_MAXIMUM_RETRIES_*\* solicitudes ARP antes de que se abandone el intento de ARP.</span><span class="sxs-lookup"><span data-stu-id="24501-677">A total of _ *_NX_ARP_MAXIMUM_RETRIES_*\* ARP requests are made before the ARP attempt is abandoned.</span></span> <span data-ttu-id="24501-678">Cuando se recibe una respuesta de ARP, la información de la dirección física asociada se almacena en la entrada de ARP que se encuentra en la memoria caché.</span><span class="sxs-lookup"><span data-stu-id="24501-678">When an ARP response is received, the associated physical address information is stored in the ARP entry that is in the cache.</span></span>

<span data-ttu-id="24501-679">En el caso de los sistemas de host múltiple, NetX Duo determina la interfaz que va a enviar las solicitudes y respuestas de ARP en función de la dirección de destino especificada.</span><span class="sxs-lookup"><span data-stu-id="24501-679">For multihome systems, NetX Duo determines which interface to send the ARP requests and responses based on destination address specified.</span></span>

> [!NOTE]
> <span data-ttu-id="24501-680">*Los paquetes IP salientes se ponen en cola mientras que NetX Duo espera la respuesta de ARP. El número de paquetes IP salientes en cola se define mediante la constante **NX_ARP_MAX_QUEUE_DEPTH**.*</span><span class="sxs-lookup"><span data-stu-id="24501-680">*Outgoing IP packets are queued while NetX Duo waits for the ARP response. The number of outgoing IP packets queued is defined by the constant **NX_ARP_MAX_QUEUE_DEPTH**.*</span></span>

<span data-ttu-id="24501-681">NetX Duo también responde a las solicitudes ARP de otros nodos de la red IPv4 local.</span><span class="sxs-lookup"><span data-stu-id="24501-681">NetX Duo also responds to ARP requests from other nodes on the local IPv4 network.</span></span> <span data-ttu-id="24501-682">Cuando se realiza una solicitud ARP externa que coincide con la dirección IP actual de la interfaz que recibe la solicitud ARP, NetX Duo crea un mensaje de respuesta de ARP que contiene la dirección física actual.</span><span class="sxs-lookup"><span data-stu-id="24501-682">When an external ARP request is made that matches the current IP address of the interface that receives the ARP request, NetX Duo builds an ARP response message that contains the current physical address.</span></span>

<span data-ttu-id="24501-683">Los formatos de las solicitudes y respuestas de ARP para Ethernet se muestran en la figura 6 y se describen a continuación.</span><span class="sxs-lookup"><span data-stu-id="24501-683">The formats of Ethernet ARP requests and responses are shown in Figure 6 and are described below.</span></span>

| <span data-ttu-id="24501-684">**Campo de&nbsp;solicitud/respuesta**</span><span class="sxs-lookup"><span data-stu-id="24501-684">**Request/Response&nbsp;Field**</span></span>         | <span data-ttu-id="24501-685">**Propósito**</span><span class="sxs-lookup"><span data-stu-id="24501-685">**Purpose**</span></span>            |
| ---------------------------------- | ---------------------- |
| <span data-ttu-id="24501-686">***Dirección Ethernet de destino***</span><span class="sxs-lookup"><span data-stu-id="24501-686">***Ethernet Destination Address***</span></span> | <span data-ttu-id="24501-687">Este campo de 6 bytes contiene la dirección de destino de la respuesta de ARP y es de tipo difusión (todo unos) para las solicitudes ARP.</span><span class="sxs-lookup"><span data-stu-id="24501-687">This 6-byte field contains the destination address for the ARP response and is a broadcast (all ones) for ARP requests.</span></span> <span data-ttu-id="24501-688">Este campo lo configura el controlador de red.</span><span class="sxs-lookup"><span data-stu-id="24501-688">This field is setup by the network driver.</span></span> 
| <span data-ttu-id="24501-689">***Dirección Ethernet de origen***</span><span class="sxs-lookup"><span data-stu-id="24501-689">***Ethernet Source Address***</span></span>      | <span data-ttu-id="24501-690">Este campo de 6 bytes contiene la dirección del remitente de la solicitud o respuesta de ARP y lo configura el controlador de red.</span><span class="sxs-lookup"><span data-stu-id="24501-690">This 6-byte field contains the address of the sender of the ARP request or response and is set up by the network driver.</span></span> |
| <span data-ttu-id="24501-691">***Tipo de marco***</span><span class="sxs-lookup"><span data-stu-id="24501-691">***Frame Type***</span></span> | <span data-ttu-id="24501-692">Este campo de 2 bytes contiene el tipo de marco Ethernet presente y, para las solicitudes y respuestas de ARP, es igual a 0x0806.</span><span class="sxs-lookup"><span data-stu-id="24501-692">This 2-byte field contains the type of Ethernet frame present and, for ARP requests and responses, this is equal to 0x0806.</span></span> <span data-ttu-id="24501-693">Este es el último campo que el controlador de red tiene la responsabilidad de configurar.</span><span class="sxs-lookup"><span data-stu-id="24501-693">This is the last field the network driver is responsible for setting up.</span></span> |
| <span data-ttu-id="24501-694">***Tipo de hardware***</span><span class="sxs-lookup"><span data-stu-id="24501-694">***Hardware Type***</span></span> | <span data-ttu-id="24501-695">Este campo de 2 bytes contiene el tipo de hardware, que es 0x0001 para Ethernet.</span><span class="sxs-lookup"><span data-stu-id="24501-695">This 2-byte field contains the hardware type, which is 0x0001 for Ethernet.</span></span> |
| <span data-ttu-id="24501-696">***Tipo de protocolo***</span><span class="sxs-lookup"><span data-stu-id="24501-696">***Protocol Type***</span></span> | <span data-ttu-id="24501-697">Este campo de 2 bytes contiene el tipo de protocolo, que es 0x0800 para las direcciones IP.</span><span class="sxs-lookup"><span data-stu-id="24501-697">This 2-byte field contains the protocol type, which is 0x0800 for IP addresses.</span></span> |
| <span data-ttu-id="24501-698">***Tamaño de hardware***</span><span class="sxs-lookup"><span data-stu-id="24501-698">***Hardware Size***</span></span> | <span data-ttu-id="24501-699">Este campo de 1 byte contiene el tamaño de la dirección de hardware, que es 6 para las direcciones Ethernet.</span><span class="sxs-lookup"><span data-stu-id="24501-699">This 1-byte field contains the hardware address size, which is 6 for Ethernet addresses.</span></span> |

![Diagrama del formato de paquetes ARP.](./media/user-guide/arp-packet-format.png)

<span data-ttu-id="24501-701">**FIGURA 6. Formato de paquetes ARP**</span><span class="sxs-lookup"><span data-stu-id="24501-701">**FIGURE 6. ARP Packet Format**</span></span>

| <span data-ttu-id="24501-702">Campo de&nbsp;solicitud/respuesta</span><span class="sxs-lookup"><span data-stu-id="24501-702">Request/Response&nbsp;Field</span></span> | <span data-ttu-id="24501-703">Fin</span><span class="sxs-lookup"><span data-stu-id="24501-703">Purpose</span></span> |
|---|---|
| <span data-ttu-id="24501-704">***Tamaño de protocolo***</span><span class="sxs-lookup"><span data-stu-id="24501-704">***Protocol Size***</span></span> | <span data-ttu-id="24501-705">Este campo de 1 byte contiene el tamaño de la dirección IP, que es 4 para las direcciones IP.</span><span class="sxs-lookup"><span data-stu-id="24501-705">This 1-byte field contains the IP address size, which is 4 for IP addresses.</span></span> |
| <span data-ttu-id="24501-706">***Código de la operación***</span><span class="sxs-lookup"><span data-stu-id="24501-706">***Operation Code***</span></span> | <span data-ttu-id="24501-707">Este campo de 2 bytes contiene la operación para este paquete ARP.</span><span class="sxs-lookup"><span data-stu-id="24501-707">This 2-byte field contains the operation for this ARP packet.</span></span> <span data-ttu-id="24501-708">Una solicitud ARP se especifica con el valor 0x0001, mientras que una respuesta de ARP se representa con el valor 0x0002.</span><span class="sxs-lookup"><span data-stu-id="24501-708">An ARP request is specified with the value of 0x0001, while an ARP response is represented by a value of 0x0002.</span></span> |
| <span data-ttu-id="24501-709">***Dirección Ethernet del remitente***</span><span class="sxs-lookup"><span data-stu-id="24501-709">***Sender Ethernet Address***</span></span> | <span data-ttu-id="24501-710">Este campo de 6 bytes contiene la dirección Ethernet del remitente.</span><span class="sxs-lookup"><span data-stu-id="24501-710">This 6-byte field contains the sender's Ethernet address.</span></span> |
| <span data-ttu-id="24501-711">***Dirección IP del remitente***</span><span class="sxs-lookup"><span data-stu-id="24501-711">***Sender IP Address***</span></span> | <span data-ttu-id="24501-712">Este campo de 4 bytes contiene la dirección IP del remitente.</span><span class="sxs-lookup"><span data-stu-id="24501-712">This 4-byte field contains the sender's IP address.</span></span> |
| <span data-ttu-id="24501-713">***Dirección Ethernet de destino***</span><span class="sxs-lookup"><span data-stu-id="24501-713">***Target Ethernet Address***</span></span> | <span data-ttu-id="24501-714">Este campo de 6 bytes contiene la dirección Ethernet de destino.</span><span class="sxs-lookup"><span data-stu-id="24501-714">This 6-byte field contains the target's Ethernet address.</span></span> |
| <span data-ttu-id="24501-715">***Dirección IP de destino***</span><span class="sxs-lookup"><span data-stu-id="24501-715">***Target IP Address***</span></span> | <span data-ttu-id="24501-716">Este campo de 4 bytes contiene la dirección IP de destino.</span><span class="sxs-lookup"><span data-stu-id="24501-716">This 4-byte field contains the target's IP address.</span></span> |

> [!NOTE]
> <span data-ttu-id="24501-717">*Las solicitudes y respuestas de ARP son paquetes de nivel Ethernet. Todos los demás paquetes TCP/IP se encapsulan con un encabezado de paquete IP.*</span><span class="sxs-lookup"><span data-stu-id="24501-717">*ARP requests and responses are Ethernet-level packets. All other TCP/IP packets are encapsulated by an IP packet header.*</span></span>

> [!NOTE]
> <span data-ttu-id="24501-718">*Se espera que todos los mensajes de ARP de la implementación de TCP/IP estén en formato **big endian**. En este formato, el byte más significativo de la palabra reside en la dirección de bytes más baja.*</span><span class="sxs-lookup"><span data-stu-id="24501-718">*All ARP messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="arp-aging"></a><span data-ttu-id="24501-719">Caducidad de ARP</span><span class="sxs-lookup"><span data-stu-id="24501-719">ARP Aging</span></span>

<span data-ttu-id="24501-720">NetX admite la invalidación automática de las entradas de ARP dinámicas.</span><span class="sxs-lookup"><span data-stu-id="24501-720">NetX supports automatic dynamic ARP entry invalidation.</span></span><span data-ttu-id="24501-721">\ ***NX_ARP_EXPIRATION_RATE** _ especifica el número de segundos que una dirección IP establecida en una asignación física sigue siendo válida.</span><span class="sxs-lookup"><span data-stu-id="24501-721">\ ***NX_ARP_EXPIRATION_RATE** _ specifies the number of seconds an established IP address to physical mapping stays valid.</span></span> <span data-ttu-id="24501-722">Después de la expiración, la entrada de ARP se quita de la memoria caché de ARP.</span><span class="sxs-lookup"><span data-stu-id="24501-722">After expiration, the ARP entry is removed from the ARP cache.</span></span> <span data-ttu-id="24501-723">El siguiente intento de envío a la dirección IP correspondiente dará como resultado una nueva solicitud ARP.</span><span class="sxs-lookup"><span data-stu-id="24501-723">The next attempt to send to the corresponding IP address will result in a new ARP request.</span></span> <span data-ttu-id="24501-724">Si se establece _ *_NX_ARP_EXPIRATION_RATE_*\* en cero, se deshabilita la caducidad de ARP, que es la configuración predeterminada.</span><span class="sxs-lookup"><span data-stu-id="24501-724">Setting _ *_NX_ARP_EXPIRATION_RATE_*\* to zero disables ARP aging, which is the default configuration.</span></span>

### <a name="arp-defend"></a><span data-ttu-id="24501-725">Protección de ARP</span><span class="sxs-lookup"><span data-stu-id="24501-725">ARP Defend</span></span>

<span data-ttu-id="24501-726">Cuando se recibe una solicitud ARP o un paquete de respuesta de ARP y el remitente tiene la misma dirección IP, que entra en conflicto con la dirección IP de este nodo, NetX Duo envía una solicitud ARP para esa dirección como protección.</span><span class="sxs-lookup"><span data-stu-id="24501-726">When an ARP request or ARP response packet is received and the sender has the same IP address, which conflicts with the IP address of this node, NetX Duo sends an ARP request for that address as a defense.</span></span> <span data-ttu-id="24501-727">Si el paquete ARP en conflicto se recibe más de una vez en 10 segundos, NetX no envía más paquetes de protección.</span><span class="sxs-lookup"><span data-stu-id="24501-727">If the conflict ARP packet is received more than once in 10 seconds, NetX Duo does not send more defend packets.</span></span> <span data-ttu-id="24501-728">El intervalo predeterminado de 10 segundos se puede redefinir mediante \***NX_ARP_DEFEND_INTERVAL** _.</span><span class="sxs-lookup"><span data-stu-id="24501-728">The default interval 10 seconds can be redefined by \***NX_ARP_DEFEND_INTERVAL** _.</span></span> <span data-ttu-id="24501-729">Este comportamiento sigue la directiva especificada en el punto 2.4(c) de RFC5227.</span><span class="sxs-lookup"><span data-stu-id="24501-729">This behavior follows the policy specified in 2.4(c) of RFC5227.</span></span> <span data-ttu-id="24501-730">Dado que Windows XP omite el anuncio de ARP como respuesta para su sondeo de ARP, el usuario puede definir _ *_NX_ARP_DEFEND_BY_REPLY_*\* para enviar la respuesta de ARP como protección adicional.</span><span class="sxs-lookup"><span data-stu-id="24501-730">Since Windows XP ignores ARP announcement as a response for its ARP probe, user can define _ *_NX_ARP_DEFEND_BY_REPLY_*\* to send ARP response as additional defence.</span></span>

### <a name="arp-statistics-and-errors"></a><span data-ttu-id="24501-731">Estadísticas y errores de ARP</span><span class="sxs-lookup"><span data-stu-id="24501-731">ARP Statistics and Errors</span></span>

<span data-ttu-id="24501-732">Si se habilita, el software de ARP de NetX Duo realiza un seguimiento de varias estadísticas y errores que pueden ser útiles para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-732">If enabled, the NetX Duo ARP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="24501-733">Se mantienen las estadísticas y los informes de errores siguientes para cada procesamiento de ARP de IP:</span><span class="sxs-lookup"><span data-stu-id="24501-733">The following statistics and error reports are maintained for each IP's ARP processing:</span></span>

- <span data-ttu-id="24501-734">Número total de solicitudes ARP enviadas</span><span class="sxs-lookup"><span data-stu-id="24501-734">Total ARP Requests Sent</span></span>
- <span data-ttu-id="24501-735">Número total de solicitudes ARP recibidas</span><span class="sxs-lookup"><span data-stu-id="24501-735">Total ARP Requests Received</span></span>
- <span data-ttu-id="24501-736">Número total de respuestas de ARP enviadas</span><span class="sxs-lookup"><span data-stu-id="24501-736">Total ARP Responses Sent</span></span> 
- <span data-ttu-id="24501-737">Número total de respuestas de ARP recibidas</span><span class="sxs-lookup"><span data-stu-id="24501-737">Total ARP Responses Received</span></span> 
- <span data-ttu-id="24501-738">Número total de entradas dinámicas de ARP</span><span class="sxs-lookup"><span data-stu-id="24501-738">Total ARP Dynamic Entries</span></span> 
- <span data-ttu-id="24501-739">Número total de entradas estáticas de ARP</span><span class="sxs-lookup"><span data-stu-id="24501-739">Total ARP Static Entries</span></span> 
- <span data-ttu-id="24501-740">Número total de entradas caducadas de ARP</span><span class="sxs-lookup"><span data-stu-id="24501-740">Total ARP Aged Entries</span></span> 
- <span data-ttu-id="24501-741">Número total de mensajes no válidos de ARP</span><span class="sxs-lookup"><span data-stu-id="24501-741">Total ARP Invalid Messages</span></span> 

<span data-ttu-id="24501-742">Todos estos informes de errores y estadísticas están disponibles para la aplicación con el servicio ***nx_arp_info_get***.</span><span class="sxs-lookup"><span data-stu-id="24501-742">All these statistics and error reports are available to the application with the ***nx_arp_info_get*** service.</span></span>

## <a name="reverse-address-resolution-protocol-rarp-in-ipv4"></a><span data-ttu-id="24501-743">Protocolo de resolución inversa de direcciones (RARP) en IPv4</span><span class="sxs-lookup"><span data-stu-id="24501-743">Reverse Address Resolution Protocol (RARP) in IPv4</span></span>

<span data-ttu-id="24501-744">El protocolo de resolución inversa de direcciones (RARP) es el protocolo para solicitar la asignación de red de las direcciones IP de 32 bits del host (RFC 903).</span><span class="sxs-lookup"><span data-stu-id="24501-744">The Reverse Address Resolution Protocol (RARP) is the protocol for requesting network assignment of the host's 32-bit IP addresses (RFC 903).</span></span> <span data-ttu-id="24501-745">Esto se realiza mediante una solicitud RARP y continúa periódicamente hasta que un miembro de la red asigna una dirección IP a la interfaz de red del host en una respuesta de RARP.</span><span class="sxs-lookup"><span data-stu-id="24501-745">This is done through an RARP request and continues periodically until a network member assigns an IP address to the host network interface in an RARP response.</span></span> <span data-ttu-id="24501-746">La aplicación crea una instancia de IP mediante el servicio ***nx_ip_create*** con una dirección IP establecida en cero.</span><span class="sxs-lookup"><span data-stu-id="24501-746">The application creates an IP instance by the service ***nx_ip_create*** with a zero IP address.</span></span> <span data-ttu-id="24501-747">Si la aplicación habilita RARP, puede usar el protocolo RARP para solicitar una dirección IP del servidor de red accesible mediante la interfaz que tiene una dirección IP establecida en cero.</span><span class="sxs-lookup"><span data-stu-id="24501-747">If RARP is enabled by the application, it can use the RARP protocol to request an IP address from the network server accessible through the interface that has a zero IP address.</span></span>

### <a name="rarp-enable"></a><span data-ttu-id="24501-748">Habilitación de RARP</span><span class="sxs-lookup"><span data-stu-id="24501-748">RARP Enable</span></span>

<span data-ttu-id="24501-749">Para usar RARP, la aplicación debe crear la instancia de IP con una dirección IP establecida en cero y, a continuación, habilitar RARP con el servicio ***nx_rarp_enable***.</span><span class="sxs-lookup"><span data-stu-id="24501-749">To use RARP, the application must create the IP instance with an IP address of zero, then enable RARP using the service ***nx_rarp_enable***.</span></span> <span data-ttu-id="24501-750">En el caso de los sistemas de host múltiple, al menos un dispositivo de red asociado a la instancia de IP debe tener una dirección IP establecida en cero.</span><span class="sxs-lookup"><span data-stu-id="24501-750">For multihome systems, at least one network device associated with the IP instance must have an IP address of zero.</span></span> <span data-ttu-id="24501-751">El procesamiento de RARP envía periódicamente mensajes de solicitud RARP al sistema de NetX Duo en el que requiere una dirección IP hasta que se recibe una respuesta de RARP válida con la dirección IP designada por la red.</span><span class="sxs-lookup"><span data-stu-id="24501-751">The RARP processing periodically sends RARP request messages for the NetX Duo system requiring an IP address until a valid RARP reply with the network designated IP address is received.</span></span> <span data-ttu-id="24501-752">En este momento, se ha completado el procesamiento de RARP.</span><span class="sxs-lookup"><span data-stu-id="24501-752">At this point, RARP processing is complete.</span></span>

<span data-ttu-id="24501-753">Una vez habilitado RARP, se deshabilitará automáticamente una vez que se resuelvan todas las direcciones de las interfaces.</span><span class="sxs-lookup"><span data-stu-id="24501-753">After RARP has been enabled, it is disabled automatically after all interface addresses are resolved.</span></span> <span data-ttu-id="24501-754">La aplicación puede forzar la finalización de RARP con el servicio ***nx_rarp_disable***.</span><span class="sxs-lookup"><span data-stu-id="24501-754">The application may force RARP to terminate by using the service ***nx_rarp_disable***.</span></span>

### <a name="rarp-request"></a><span data-ttu-id="24501-755">Solicitud RARP</span><span class="sxs-lookup"><span data-stu-id="24501-755">RARP Request</span></span>

<span data-ttu-id="24501-756">El formato de un paquete de solicitud RARP es casi idéntico al paquete ARP que se muestra en la [figura 6](#arp-messages). La única diferencia es que el campo de tipo de marco es 0x8035 y el valor del campo *Código de la operación* es 3, lo que designa una solicitud RARP.</span><span class="sxs-lookup"><span data-stu-id="24501-756">The format of an RARP request packet is almost identical to the ARP packet shown in [Figure 6](#arp-messages).The only difference is the frame type field is 0x8035 and the *Operation Code* field is 3, designating an RARP request.</span></span> <span data-ttu-id="24501-757">Como se ha mencionado anteriormente, las solicitudes RARP se enviarán periódicamente (cada ***NX_RARP_UPDATE_RATE*** segundos) hasta que se reciba una respuesta de RARP con la dirección IP asignada por la red.</span><span class="sxs-lookup"><span data-stu-id="24501-757">As mentioned previously, RARP requests will be sent periodically (every ***NX_RARP_UPDATE_RATE*** seconds) until a RARP reply with the network assigned IP address is received.</span></span>

> [!NOTE]
> <span data-ttu-id="24501-758">*Se espera que todos los mensajes de RARP de la implementación de TCP/IP estén en formato **big endian**. En este formato, el byte más significativo de la palabra reside en la dirección de bytes más baja.*</span><span class="sxs-lookup"><span data-stu-id="24501-758">*All RARP messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="rarp-reply"></a><span data-ttu-id="24501-759">Respuesta de RARP</span><span class="sxs-lookup"><span data-stu-id="24501-759">RARP Reply</span></span>

<span data-ttu-id="24501-760">Los mensajes de respuesta de RARP se reciben de la red y contienen la dirección IP que la red ha asignado para este host.</span><span class="sxs-lookup"><span data-stu-id="24501-760">RARP reply messages are received from the network and contain the network assigned IP address for this host.</span></span> <span data-ttu-id="24501-761">El formato de un paquete de respuesta de RARP es casi idéntico al paquete ARP que se muestra en la figura 6.</span><span class="sxs-lookup"><span data-stu-id="24501-761">The format of an RARP reply packet is almost identical to the ARP packet shown in Figure 6.</span></span> <span data-ttu-id="24501-762">La única diferencia es que el campo de tipo de marco es 0x8035 y el valor del campo *Código de la operación* es 4, lo que designa una respuesta de RARP.</span><span class="sxs-lookup"><span data-stu-id="24501-762">The only difference is the frame type field is 0x8035 and the *Operation Code* field is 4, which designates an RARP reply.</span></span> <span data-ttu-id="24501-763">Después de la recepción, se configura la dirección IP en la instancia de IP, se deshabilita la solicitud RARP periódica y la instancia de IP ahora está lista para la operación de red normal.</span><span class="sxs-lookup"><span data-stu-id="24501-763">After received, the IP address is setup in the IP instance, the periodic RARP request is disabled, and the IP instance is now ready for normal network operation.</span></span>

<span data-ttu-id="24501-764">En el caso de hosts múltiples, la dirección IP se aplica a la interfaz de red que lo solicita.</span><span class="sxs-lookup"><span data-stu-id="24501-764">For multihome hosts, the IP address is applied to the requesting network interface.</span></span> <span data-ttu-id="24501-765">Si hay otras interfaces de red que aún solicitan una asignación de dirección IP, el servicio RARP periódico continúa hasta que se resuelven todas las solicitudes de direcciones IP de las interfaces.</span><span class="sxs-lookup"><span data-stu-id="24501-765">If there are other network interfaces still requesting an IP address assignment, the periodic RARP service continues until all interface IP address requests are resolved.</span></span>

> [!NOTE]
> <span data-ttu-id="24501-766">*La aplicación no debe utilizar la instancia de IP hasta que se complete el procesamiento de RARP. Las aplicaciones pueden usar **nx_ip_status_check** para esperar la finalización de RARP. En el caso de sistemas de host múltiple, la aplicación no debe usar la interfaz de la solicitud hasta que se complete el procesamiento de RARP en esa interfaz. El estado de la dirección IP del dispositivo secundario se puede comprobar con el servicio **nx_ip_interface_status_check**.*</span><span class="sxs-lookup"><span data-stu-id="24501-766">*The application should not use the IP instance until the RARP processing is complete. The **nx_ip_status_check** may be used by applications to wait for the RARP completion. For multihome systems, the application should not use the requesting interface until the RARP processing is complete on that interface. Status of the IP address on the secondary device can be checked with the **nx_ip_interface_status_check** service.*</span></span>

### <a name="rarp-statistics-and-errors"></a><span data-ttu-id="24501-767">Estadísticas y errores de RARP</span><span class="sxs-lookup"><span data-stu-id="24501-767">RARP Statistics and Errors</span></span>

<span data-ttu-id="24501-768">Si se habilita, el software de RARP de NetX Duo realiza un seguimiento de varios errores y estadísticas que pueden ser útiles para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-768">If enabled, the NetX Duo RARP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="24501-769">Se mantienen las estadísticas y los informes de errores siguientes para cada procesamiento de RARP de IP:</span><span class="sxs-lookup"><span data-stu-id="24501-769">The following statistics and error reports are maintained for each IP's RARP processing:</span></span>

- <span data-ttu-id="24501-770">Número total de solicitudes RARP enviadas</span><span class="sxs-lookup"><span data-stu-id="24501-770">Total RARP Requests Sent</span></span>
- <span data-ttu-id="24501-771">Número total de respuestas de RARP recibidas</span><span class="sxs-lookup"><span data-stu-id="24501-771">Total RARP Responses Received</span></span>
- <span data-ttu-id="24501-772">Número total de mensajes no válidos de RARP</span><span class="sxs-lookup"><span data-stu-id="24501-772">Total RARP Invalid Messages</span></span>

<span data-ttu-id="24501-773">Todas estas estadísticas e informes de errores están disponibles para la aplicación con el servicio ***nx_rarp_info_get***.</span><span class="sxs-lookup"><span data-stu-id="24501-773">All these statistics and error reports are available to the application with the ***nx_rarp_info_get*** service.</span></span>

## <a name="internet-control-message-protocol-icmp"></a><span data-ttu-id="24501-774">Protocolo de mensajes de control de Internet (ICMP)</span><span class="sxs-lookup"><span data-stu-id="24501-774">Internet Control Message Protocol (ICMP)</span></span>

<span data-ttu-id="24501-775">El protocolo de mensajes de control de Internet (ICMP) para IPv4 se limita a pasar información de errores y de control entre los miembros de la red IP.</span><span class="sxs-lookup"><span data-stu-id="24501-775">Internet Control Message Protocol for IPv4 (ICMP) is limited to passing error and control information between IP network members.</span></span> <span data-ttu-id="24501-776">El protocolo de mensajes de control de Internet para IPv6 (ICMPv6) también controla la información de errores y de control, y es necesario para los protocolos de resolución de direcciones, como la detección de direcciones duplicadas (DAD) y la configuración automática de direcciones sin estado.</span><span class="sxs-lookup"><span data-stu-id="24501-776">Internet Control Message Protocol for IPv6 (ICMPv6) also handles error and control information and is required for address resolution protocols such as Duplicate Address Detection (DAD) and stateless address autoconfiguration.</span></span>

<span data-ttu-id="24501-777">Como la mayoría de los mensajes de la capa de aplicación (por ejemplo, TCP/IP), los mensajes de ICMP e ICMPv6 se encapsulan con un encabezado IP con la designación del protocolo ICMP (o ICMPv6).</span><span class="sxs-lookup"><span data-stu-id="24501-777">Like most other application layer (e.g., TCP/IP) messages, ICMP and ICMPv6 messages are encapsulated by an IP header with the ICMP (or ICMPv6) protocol designation.</span></span>

### <a name="icmp-statistics-and-errors"></a><span data-ttu-id="24501-778">Estadísticas y errores de ICMP</span><span class="sxs-lookup"><span data-stu-id="24501-778">ICMP Statistics and Errors</span></span>

<span data-ttu-id="24501-779">Si se habilita, NetX Duo realiza un seguimiento de varios errores y estadísticas de ICMP que pueden ser útiles para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-779">If enabled, NetX Duo keeps track of several ICMP statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="24501-780">Se mantienen las estadísticas y los informes de errores siguientes para cada procesamiento de ICMP de IP:</span><span class="sxs-lookup"><span data-stu-id="24501-780">The following statistics and error reports are maintained for each IP's ICMP processing:</span></span> 

- <span data-ttu-id="24501-781">Número total de pings de ICMP enviados</span><span class="sxs-lookup"><span data-stu-id="24501-781">Total ICMP Pings Sent</span></span>  
- <span data-ttu-id="24501-782">Número total de tiempos de expiración de pings de ICMP</span><span class="sxs-lookup"><span data-stu-id="24501-782">Total ICMP Ping Timeouts</span></span> 
- <span data-ttu-id="24501-783">Número total de subprocesos de ping de ICMP suspendidos</span><span class="sxs-lookup"><span data-stu-id="24501-783">Total ICMP Ping Threads Suspended</span></span> 
- <span data-ttu-id="24501-784">Número total de respuestas de ping de ICMP recibidas</span><span class="sxs-lookup"><span data-stu-id="24501-784">Total ICMP Ping Responses Received</span></span> 
- <span data-ttu-id="24501-785">Número total de errores de suma de comprobación de ICMP</span><span class="sxs-lookup"><span data-stu-id="24501-785">Total ICMP Checksum Errors</span></span> 
- <span data-ttu-id="24501-786">Número total de mensajes de ICMP no controlados</span><span class="sxs-lookup"><span data-stu-id="24501-786">Total ICMP Unhandled Messages</span></span> 

<span data-ttu-id="24501-787">Todos estos informes de errores y estadísticas están disponibles para la aplicación con el servicio ***nx_icmp_info_get***.</span><span class="sxs-lookup"><span data-stu-id="24501-787">All these statistics and error reports are available to the application with the ***nx_icmp_info_get*** service.</span></span>

## <a name="icmpv4-services-in-netx-duo"></a><span data-ttu-id="24501-788">Servicios ICMPv4 en NetX Duo</span><span class="sxs-lookup"><span data-stu-id="24501-788">ICMPv4 Services in NetX Duo</span></span>

### <a name="icmpv4-enable"></a><span data-ttu-id="24501-789">Habilitación de ICMPv4</span><span class="sxs-lookup"><span data-stu-id="24501-789">ICMPv4 Enable</span></span>

<span data-ttu-id="24501-790">Para que NetX Duo pueda procesar los mensajes de ICMPv4, la aplicación debe llamar al servicio ***nx_icmp_enable*** para habilitar el procesamiento de ICMPv4.</span><span class="sxs-lookup"><span data-stu-id="24501-790">Before ICMPv4 messages can be processed by NetX Duo, the application must call the ***nx_icmp_enable*** service to enable ICMPv4 processing.</span></span> <span data-ttu-id="24501-791">Una vez hecho esto, la aplicación puede emitir solicitudes de ping y paquetes de ping entrantes de campo.</span><span class="sxs-lookup"><span data-stu-id="24501-791">After this is done, the application can issue ping requests and field incoming ping packets.</span></span>  

### <a name="icmpv4-echo-request"></a><span data-ttu-id="24501-792">Solicitud de eco de ICMPv4</span><span class="sxs-lookup"><span data-stu-id="24501-792">ICMPv4 Echo Request</span></span>

<span data-ttu-id="24501-793">Una solicitud de eco es un tipo de mensaje de ICMPv4 que se suele usar para comprobar la existencia de un nodo específico en la red, como se identifica por su dirección IP del host.</span><span class="sxs-lookup"><span data-stu-id="24501-793">An echo request is one type of ICMPv4 message that is typically used to check for the existence of a specific node on the network, as identified by its host IP address.</span></span> <span data-ttu-id="24501-794">El popular comando ping se implementa mediante mensajes de solicitud y respuesta de eco de ICMP.</span><span class="sxs-lookup"><span data-stu-id="24501-794">The popular ping command is implemented using ICMP echo request/echo reply messages.</span></span> <span data-ttu-id="24501-795">Si el host específico está presente, su pila de red procesa la solicitud de ping y responde con una respuesta de ping.</span><span class="sxs-lookup"><span data-stu-id="24501-795">If the specific host is present, its network stack processes the ping request and responses with a ping response.</span></span> <span data-ttu-id="24501-796">En la figura 7 se detalla el formato del mensaje de ping de ICMPv4.</span><span class="sxs-lookup"><span data-stu-id="24501-796">Figure 7 details the ICMPv4 ping message format.</span></span>

![Mensaje de ping de ICMPv4](./media/user-guide/icmpv4-ping-message.png)  

<span data-ttu-id="24501-798">**FIGURA 7. Mensaje de ping de ICMPv4**</span><span class="sxs-lookup"><span data-stu-id="24501-798">**FIGURE 7. ICMPv4 Ping Message**</span></span>

> [!NOTE]
> <span data-ttu-id="24501-799">*Se espera que todos los mensajes ICMPv4 de la implementación de TCP/IP estén en formato **big endian**. En este formato, el byte más significativo de la palabra reside en la dirección de bytes más baja.*</span><span class="sxs-lookup"><span data-stu-id="24501-799">*All ICMPv4 messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

<span data-ttu-id="24501-800">A continuación se describe el formato de encabezado de ICMPv4:</span><span class="sxs-lookup"><span data-stu-id="24501-800">The following describes the ICMPv4 header format:</span></span>

|<span data-ttu-id="24501-801">Campo del encabezado</span><span class="sxs-lookup"><span data-stu-id="24501-801">Header Field</span></span> |<span data-ttu-id="24501-802">Fin</span><span class="sxs-lookup"><span data-stu-id="24501-802">Purpose</span></span> |
|---|---|
|<span data-ttu-id="24501-803">**Tipo**</span><span class="sxs-lookup"><span data-stu-id="24501-803">**Type**</span></span> |<span data-ttu-id="24501-804">Este campo especifica el mensaje de ICMPv4 (bits del 31 al 24).</span><span class="sxs-lookup"><span data-stu-id="24501-804">This field specifies the ICMPv4 message (bits 31-24).</span></span> <span data-ttu-id="24501-805">Los más comunes son:</span><span class="sxs-lookup"><span data-stu-id="24501-805">The most common are:</span></span><br /><span data-ttu-id="24501-806">- 0: respuesta de eco</span><span class="sxs-lookup"><span data-stu-id="24501-806">-  0: Echo Reply</span></span><br /><span data-ttu-id="24501-807">- 3: destino no accesible</span><span class="sxs-lookup"><span data-stu-id="24501-807">- 3: Destination Unreachable</span></span><br /><span data-ttu-id="24501-808">- 8: solicitud de eco</span><span class="sxs-lookup"><span data-stu-id="24501-808">- 8: Echo Request</span></span><br /><span data-ttu-id="24501-809">- 11: tiempo superado</span><span class="sxs-lookup"><span data-stu-id="24501-809">- 11: Time Exceeded</span></span><br /><span data-ttu-id="24501-810">- 12: problema de parámetro</span><span class="sxs-lookup"><span data-stu-id="24501-810">- 12: Parameter Problem</span></span> |
|<span data-ttu-id="24501-811">**Código**</span><span class="sxs-lookup"><span data-stu-id="24501-811">**Code**</span></span> |<span data-ttu-id="24501-812">Este campo es específico del contexto del campo de tipo (bits del 23 al 16).</span><span class="sxs-lookup"><span data-stu-id="24501-812">This field is context specific on the type field (bits 23-16).</span></span> <span data-ttu-id="24501-813">En el caso de una solicitud o respuesta de eco, el código se establece en cero.</span><span class="sxs-lookup"><span data-stu-id="24501-813">For an echo request or reply the code is set to zero.</span></span>|
|<span data-ttu-id="24501-814">**Checksum**</span><span class="sxs-lookup"><span data-stu-id="24501-814">**Checksum**</span></span> |<span data-ttu-id="24501-815">Este campo contiene la suma de comprobación de 16 bits de la suma del complemento a uno del mensaje de ICMPv4, incluido el encabezado ICMPv4 completo a partir del campo de tipo.</span><span class="sxs-lookup"><span data-stu-id="24501-815">This field contains the 16-bit checksum of the one's complement sum of the ICMPv4 message including the entire the ICMPv4 header starting with the Type field.</span></span> <span data-ttu-id="24501-816">Antes de generar la suma de comprobación, se borra el campo de la suma de comprobación.</span><span class="sxs-lookup"><span data-stu-id="24501-816">Before generating the checksum, the checksum field is cleared.</span></span>|
|<span data-ttu-id="24501-817">**Identificación**</span><span class="sxs-lookup"><span data-stu-id="24501-817">**Identification**</span></span> | <span data-ttu-id="24501-818">Este campo contiene un valor de identificador que identifica al host; un host debe utilizar el identificador extraído de una solicitud de eco en la respuesta de eco (bits del 31 al 16).</span><span class="sxs-lookup"><span data-stu-id="24501-818">This field contains an ID value identifying the host; a host should use the ID extracted from an ECHO request in the ECHO REPLY (bits 31-16).</span></span>|
|<span data-ttu-id="24501-819">**Número de secuencia**</span><span class="sxs-lookup"><span data-stu-id="24501-819">**Sequence number**</span></span> |<span data-ttu-id="24501-820">Este campo contiene un valor de identificador; un host debe utilizar el identificador extraído de una solicitud de eco en la respuesta de eco (bits del 31 al 16).</span><span class="sxs-lookup"><span data-stu-id="24501-820">This field contains an ID value; a host should use the ID extracted from an ECHO request in the ECHO REPLY (bits 31-16).</span></span> <span data-ttu-id="24501-821">A diferencia del campo de identificador, este valor cambiará en una solicitud de eco subsiguiente del mismo host (bits del 15 al 0).</span><span class="sxs-lookup"><span data-stu-id="24501-821">Unlike the identifier field, this value will change in a subsequent Echo request from the same host (bits 15-0).</span></span>|

### <a name="icmpv4-echo-response"></a><span data-ttu-id="24501-822">Respuesta de eco de ICMPv4</span><span class="sxs-lookup"><span data-stu-id="24501-822">ICMPv4 Echo Response</span></span>    
<span data-ttu-id="24501-823">Una respuesta de ping es otro tipo de mensaje de ICMP que el componente de ICMP genera internamente en respuesta a una solicitud de ping externa.</span><span class="sxs-lookup"><span data-stu-id="24501-823">A ping response is another type of ICMP message that is generated internally by the ICMP component in response to an external ping request.</span></span> <span data-ttu-id="24501-824">Además de la confirmación, la respuesta de ping también contiene una copia de los datos de usuario proporcionados en la solicitud de ping.</span><span class="sxs-lookup"><span data-stu-id="24501-824">In addition to acknowledgement, the ping response also contains a copy of the user data supplied in the ping request.</span></span>

### <a name="icmpv4-error-messages"></a><span data-ttu-id="24501-825">Mensajes de error de ICMPv4</span><span class="sxs-lookup"><span data-stu-id="24501-825">ICMPv4 Error Messages</span></span>   
<span data-ttu-id="24501-826">Se admiten los siguientes mensajes de error de ICMPv4 en NetX Duo:</span><span class="sxs-lookup"><span data-stu-id="24501-826">The following ICMPv4 error messages are supported in NetX Duo:</span></span> 
- <span data-ttu-id="24501-827">Destino no accesible</span><span class="sxs-lookup"><span data-stu-id="24501-827">Destination Unreachable</span></span> 
- <span data-ttu-id="24501-828">Tiempo superado</span><span class="sxs-lookup"><span data-stu-id="24501-828">Time Exceed</span></span> 
- <span data-ttu-id="24501-829">Problema de parámetro</span><span class="sxs-lookup"><span data-stu-id="24501-829">Parameter Problem</span></span>

## <a name="internet-group-management-protocol-igmp"></a><span data-ttu-id="24501-830">Protocolo de administración de grupos de Internet (IGMP)</span><span class="sxs-lookup"><span data-stu-id="24501-830">Internet Group Management Protocol (IGMP)</span></span>

<span data-ttu-id="24501-831">El protocolo de administración de grupos de Internet (IGMP) proporciona un dispositivo para comunicarse con sus equipos cercanos y sus enrutadores que pretenden recibir, o unirse, a un grupo de multidifusión IPv4 (RFC 1112 y RFC 2236).</span><span class="sxs-lookup"><span data-stu-id="24501-831">The Internet Group Management Protocol (IGMP) provides a device to communicate with its neighbors and its routers that it intends to receive, or join, an IPv4 multicast group (RFC 1112 and RFC 2236).</span></span> <span data-ttu-id="24501-832">Un grupo de multidifusión es básicamente una colección dinámica de miembros de la red y se representa mediante una dirección IP de clase D.</span><span class="sxs-lookup"><span data-stu-id="24501-832">A multicast group is basically a dynamic collection of network members and is represented by a Class D IP address.</span></span> <span data-ttu-id="24501-833">Los miembros del grupo de multidifusión pueden salir en cualquier momento y los nuevos miembros pueden unirse en cualquier momento.</span><span class="sxs-lookup"><span data-stu-id="24501-833">Members of the multicast group may leave at any time, and new members may join at any time.</span></span> <span data-ttu-id="24501-834">La coordinación implicada en la unión y la salida del grupo es responsabilidad de IGMP.</span><span class="sxs-lookup"><span data-stu-id="24501-834">The coordination involved in joining and leaving the group is the responsibility of IGMP.</span></span>

> [!NOTE]
> <span data-ttu-id="24501-835">*IGMP está diseñado únicamente para grupos de multidifusión IPv4. No se puede usar en la red IPv6.*</span><span class="sxs-lookup"><span data-stu-id="24501-835">*IGMP is designed only for IPv4 multicast groups. It cannot be used on the IPv6 network.*</span></span>

### <a name="igmp-enable"></a><span data-ttu-id="24501-836">Habilitación de IGMP</span><span class="sxs-lookup"><span data-stu-id="24501-836">IGMP Enable</span></span>     
<span data-ttu-id="24501-837">Para que se pueda llevar a cabo cualquier actividad de multidifusión en NetX Duo, la aplicación debe llamar al servicio ***nx_igmp_enable***.</span><span class="sxs-lookup"><span data-stu-id="24501-837">Before any multicasting activity can take place in NetX Duo, the application must call the ***nx_igmp_enable*** service.</span></span> <span data-ttu-id="24501-838">Este servicio realiza la inicialización básica de IGMP como preparación para las solicitudes de multidifusión.</span><span class="sxs-lookup"><span data-stu-id="24501-838">This service performs basic IGMP initialization in preparation for multicast requests.</span></span>

### <a name="multicast-ipv4-addressing"></a><span data-ttu-id="24501-839">Direccionamiento IPv4 de multidifusión</span><span class="sxs-lookup"><span data-stu-id="24501-839">Multicast IPv4 Addressing</span></span>  
<span data-ttu-id="24501-840">Como se ha mencionado anteriormente, las direcciones de multidifusión son realmente direcciones IP de clase D, tal como se muestra en la [figura 4](#ipv4-addresses).</span><span class="sxs-lookup"><span data-stu-id="24501-840">As mentioned previously, multicast addresses are actually Class D IP addresses as shown in [Figure 4](#ipv4-addresses).</span></span> <span data-ttu-id="24501-841">Los 28 bits inferiores de la dirección de clase D se corresponden con el identificador del grupo de multidifusión.</span><span class="sxs-lookup"><span data-stu-id="24501-841">The lower 28-bits of the Class D address correspond to the multicast group ID.</span></span> <span data-ttu-id="24501-842">Hay una serie de direcciones de multidifusión predefinidas; sin embargo, la *dirección de todos los hosts* (244.0.0.1) es especialmente importante para el procesamiento de IGMP.</span><span class="sxs-lookup"><span data-stu-id="24501-842">There are a series of pre-defined multicast addresses; however, the *all hosts address* (244.0.0.1) is particularly important to IGMP processing.</span></span> <span data-ttu-id="24501-843">Los enrutadores usan la *dirección de todos los hosts* para consultar a todos los miembros de multidifusión sobre los grupos de multidifusión a los que pertenecen.</span><span class="sxs-lookup"><span data-stu-id="24501-843">The *all hosts address* is used by routers to query all multicast members to report on which multicast groups they belong to.</span></span>  

### <a name="physical-address-mapping-in-ipv4"></a><span data-ttu-id="24501-844">Asignación de dirección física en IPv4</span><span class="sxs-lookup"><span data-stu-id="24501-844">Physical Address Mapping in IPv4</span></span>
<span data-ttu-id="24501-845">Las direcciones de multidifusión de clase D se asignan directamente a direcciones Ethernet físicas que van de la 01.00.5e.00.00.00 a la 01.00.5e.7f.ff.ff.</span><span class="sxs-lookup"><span data-stu-id="24501-845">Class D multicast addresses map directly to physical Ethernet addresses ranging from 01.00.5e.00.00.00 through 01.00.5e.7f.ff.ff.</span></span> <span data-ttu-id="24501-846">Los 23 bits inferiores de la dirección de multidifusión IP se asignan directamente a los 23 bits inferiores de la dirección Ethernet.</span><span class="sxs-lookup"><span data-stu-id="24501-846">The lower 23 bits of the IP multicast address map directly to the lower 23 bits of the Ethernet address.</span></span>

### <a name="multicast-group-join"></a><span data-ttu-id="24501-847">Unión a un grupo de multidifusión</span><span class="sxs-lookup"><span data-stu-id="24501-847">Multicast Group Join</span></span>
<span data-ttu-id="24501-848">Las aplicaciones que necesiten unirse a un grupo de multidifusión determinado pueden hacerlo mediante una llamada al servicio ***nx_igmp_multicast_join***.</span><span class="sxs-lookup"><span data-stu-id="24501-848">Applications that need to join a particular multicast group may do so by calling the ***nx_igmp_multicast_join*** service.</span></span> <span data-ttu-id="24501-849">Este servicio realiza un seguimiento del número de solicitudes para unirse a este grupo de multidifusión.</span><span class="sxs-lookup"><span data-stu-id="24501-849">This service keeps track of the number of requests to join this multicast group.</span></span> <span data-ttu-id="24501-850">Si esta es la primera solicitud de la aplicación para unirse al grupo de multidifusión, se envía un informe de IGMP a la red principal que indica la intención de este host de unirse al grupo.</span><span class="sxs-lookup"><span data-stu-id="24501-850">If this is the first application requestto join the multicast group, an IGMP report is sent out on the primary network indicating this host's intention to join the group.</span></span> <span data-ttu-id="24501-851">A continuación, se llama al controlador de red para realizar escuchas de paquetes con la dirección Ethernet de este grupo de multidifusión.</span><span class="sxs-lookup"><span data-stu-id="24501-851">Next, the network driver is called to set up for listening for packets with the Ethernet address for this multicast group.</span></span>

<span data-ttu-id="24501-852">En un sistema de host múltiple, si el grupo de multidifusión es accesible mediante una interfaz específica, la aplicación debe usar el servicio ***nx_igmp_multicast_interface_join** _ en lugar de _*_nx_igmp_multicast_join_\*\*, que está limitado a los grupos de multidifusión de la red principal.</span><span class="sxs-lookup"><span data-stu-id="24501-852">In a multihome system, if the multicast group is accessible via a specific interface, application shall use the service ***nx_igmp_multicast_interface_join** _ instead of _*_nx_igmp_multicast_join_\*\*, which is limited to multicast groups on the primary network.</span></span>

### <a name="multicast-group-leave"></a><span data-ttu-id="24501-853">Salida de un grupo de multidifusión</span><span class="sxs-lookup"><span data-stu-id="24501-853">Multicast Group Leave</span></span>   
<span data-ttu-id="24501-854">Las aplicaciones que necesiten salir de un grupo de multidifusión al que se han unido anteriormente pueden hacerlo mediante una llamada al servicio ***nx_igmp_multicast_leave***.</span><span class="sxs-lookup"><span data-stu-id="24501-854">Applications that need to leave a previously joined multicast group may do so by calling the ***nx_igmp_multicast_leave*** service.</span></span> <span data-ttu-id="24501-855">Este servicio reduce el recuento interno asociado con el número de veces que se han realizado uniones al grupo.</span><span class="sxs-lookup"><span data-stu-id="24501-855">This service reduces the internal count associated with how many times the group was joined.</span></span> <span data-ttu-id="24501-856">Si no hay ninguna solicitud de unión pendiente para un grupo, se llama al controlador de red para deshabilitar la escucha de paquetes con la dirección Ethernet de este grupo de multidifusión.</span><span class="sxs-lookup"><span data-stu-id="24501-856">If there are no outstanding join requests for a group, the network driver is called to disable listening for packets with this multicast group's Ethernet address.</span></span>

### <a name="multicast-loopback"></a><span data-ttu-id="24501-857">Bucle invertido de multidifusión</span><span class="sxs-lookup"><span data-stu-id="24501-857">Multicast Loopback</span></span>    
<span data-ttu-id="24501-858">Es posible que una aplicación desee recibir tráfico de multidifusión procedente de uno de los orígenes del mismo nodo.</span><span class="sxs-lookup"><span data-stu-id="24501-858">An application may wish to receive multicast traffic originated from one of the sources on the same node.</span></span> <span data-ttu-id="24501-859">Esto requiere que el componente de multidifusión de IP tenga habilitado el bucle invertido mediante el servicio ***nx_igmp_loopback_enable***.</span><span class="sxs-lookup"><span data-stu-id="24501-859">This requires the IP multicast component to have loopback enabled by using the service ***nx_igmp_loopback_enable***.</span></span>

### <a name="igmp-report-message"></a><span data-ttu-id="24501-860">Mensaje de informe de IGMP</span><span class="sxs-lookup"><span data-stu-id="24501-860">IGMP Report Message</span></span>      
<span data-ttu-id="24501-861">Cuando la aplicación se une a un grupo de multidifusión, se envía un mensaje de informe de IGMP mediante la red para indicar la intención del host de unirse a un grupo de multidifusión determinado.</span><span class="sxs-lookup"><span data-stu-id="24501-861">When the application joins a multicast group, an IGMP report message is sent via the network to indicate the host's intention to join a particular multicast group.</span></span> <span data-ttu-id="24501-862">En la figura 8 se muestra el formato del mensaje de informe de IGMP.</span><span class="sxs-lookup"><span data-stu-id="24501-862">The format of the IGMP report message is shown in Figure 8.</span></span> <span data-ttu-id="24501-863">La dirección del grupo de multidifusión se usa para el mensaje de grupo en el mensaje de informe de IGMP y para la dirección IP de destino.</span><span class="sxs-lookup"><span data-stu-id="24501-863">The multicast group address is used for both the group message in the IGMP report message and the destination IP address.</span></span>

<span data-ttu-id="24501-864">En la figura 8 siguiente, el encabezado IGMP contiene un campo de versión/tipo, respuesta máxima</span><span class="sxs-lookup"><span data-stu-id="24501-864">In the figure above (Figure 8), the IGMP header contains a version/type field, maximum response</span></span>

![Diagrama de un mensaje de informe de IGMP.](./media/user-guide/image17.jpg)

<span data-ttu-id="24501-866">**FIGURA 8. Mensaje de informe de IGMP**</span><span class="sxs-lookup"><span data-stu-id="24501-866">**FIGURE 8. IGMP Report Message**</span></span>

<span data-ttu-id="24501-867">Un campo de tiempo, uno de suma de comprobación y otro de dirección de grupo de multidifusión.</span><span class="sxs-lookup"><span data-stu-id="24501-867">time, a checksum field, and a multicast group address field.</span></span> <span data-ttu-id="24501-868">En el caso de los mensajes de IGMPv1, el campo de tiempo de respuesta máximo siempre se establece en cero, ya que no forma parte del protocolo IGMPv1.</span><span class="sxs-lookup"><span data-stu-id="24501-868">For IGMPv1 messages, the Maximum Response Time field is always set to zero, as this is not part of the IGMPv1 protocol.</span></span> <span data-ttu-id="24501-869">El campo de tiempo de respuesta máximo se establece cuando el host recibe un mensaje de IGMP de tipo consulta y se borra cuando un host recibe un mensaje de tipo informe de otro host, tal como se define en el protocolo IGMPv2.</span><span class="sxs-lookup"><span data-stu-id="24501-869">The Maximum Response Time field is set when the host receives a Query type IGMP message and cleared when a host receives another host's Report type message as defined by the IGMPv2 protocol.</span></span>

<span data-ttu-id="24501-870">A continuación se describe el formato de encabezado IGMP:</span><span class="sxs-lookup"><span data-stu-id="24501-870">The following describes the IGMP header format:</span></span>

|<span data-ttu-id="24501-871">Campo del encabezado</span><span class="sxs-lookup"><span data-stu-id="24501-871">Header Field</span></span>|<span data-ttu-id="24501-872">Fin</span><span class="sxs-lookup"><span data-stu-id="24501-872">Purpose</span></span>|
|---|---|
|<span data-ttu-id="24501-873">**Versión**</span><span class="sxs-lookup"><span data-stu-id="24501-873">**Version**</span></span> |<span data-ttu-id="24501-874">Este campo especifica la versión de IGMP (bits del 31 al 28).</span><span class="sxs-lookup"><span data-stu-id="24501-874">This field specifies the IGMP version (bits 31- 28).</span></span>|
|<span data-ttu-id="24501-875">**Tipo**</span><span class="sxs-lookup"><span data-stu-id="24501-875">**Type**</span></span> |<span data-ttu-id="24501-876">Este campo especifica el tipo de mensaje de IGMP (bits del 27 al 24).</span><span class="sxs-lookup"><span data-stu-id="24501-876">This field specifies the type of IGMP message (bits 27 -24).</span></span>|
|<span data-ttu-id="24501-877">**Tiempo de respuesta máximo**</span><span class="sxs-lookup"><span data-stu-id="24501-877">**Maximum Response Time**</span></span> |<span data-ttu-id="24501-878">No se utiliza en IGMP v1.</span><span class="sxs-lookup"><span data-stu-id="24501-878">Not used in IGMP v1.</span></span> <span data-ttu-id="24501-879">En IGMP v2, este campo actúa como el tiempo de respuesta máximo.</span><span class="sxs-lookup"><span data-stu-id="24501-879">In IGMP v2 this field serves as the maximum response time.</span></span>|
|<span data-ttu-id="24501-880">**Checksum**</span><span class="sxs-lookup"><span data-stu-id="24501-880">**Checksum**</span></span> |<span data-ttu-id="24501-881">Este campo contiene la suma de comprobación de 16 bits de la suma del complemento a uno del mensaje de IGMP a partir de la versión de IGMP (bits del 0 al 15).</span><span class="sxs-lookup"><span data-stu-id="24501-881">This field contains the 16-bit checksum of the one's complement sum of the IGMP message starting with the IGMP version (bits 0-15)</span></span>|
|<span data-ttu-id="24501-882">**Dirección del grupo**</span><span class="sxs-lookup"><span data-stu-id="24501-882">**Group Address**</span></span> |<span data-ttu-id="24501-883">Dirección IP del grupo de clase D de 32 bits</span><span class="sxs-lookup"><span data-stu-id="24501-883">32-bit class D group IP address</span></span>|

<span data-ttu-id="24501-884">Los mensajes de informe de IGMP también se envían en respuesta a los mensajes de consulta de IGMP enviados por un enrutador de multidifusión.</span><span class="sxs-lookup"><span data-stu-id="24501-884">IGMP report messages are also sent in response to IGMP query messages sent by a multicast router.</span></span> <span data-ttu-id="24501-885">Los enrutadores de multidifusión envían periódicamente mensajes de consulta para ver qué hosts siguen requiriendo pertenencia a grupos.</span><span class="sxs-lookup"><span data-stu-id="24501-885">Multicast routers periodically send query messages out to see which hosts still require group membership.</span></span> <span data-ttu-id="24501-886">Los mensajes de consulta tienen el mismo formato que el mensaje de informe de IGMP que se muestra en la figura 8.</span><span class="sxs-lookup"><span data-stu-id="24501-886">Query messages have the same format as the IGMP Report message shown in Figure 8.</span></span> <span data-ttu-id="24501-887">Las únicas diferencias son que el tipo de IGMP es igual a 1 y que el campo de dirección del grupo se establece en 0.</span><span class="sxs-lookup"><span data-stu-id="24501-887">The only differences are the IGMP type is equal to 1 and the group address field is set to 0.</span></span> <span data-ttu-id="24501-888">El enrutador de multidifusión envía los mensajes de consulta de IGMP a la dirección IP de *todos los hosts*.</span><span class="sxs-lookup"><span data-stu-id="24501-888">IGMP Query messages are sent to the *all hosts* IP address by the multicast router.</span></span> <span data-ttu-id="24501-889">Un host que aún desea mantener la pertenencia a grupos responde mediante el envío de otro mensaje de informe de IGMP.</span><span class="sxs-lookup"><span data-stu-id="24501-889">A host that still wishes to maintain group membership responds by sending another IGMP Report message.</span></span>

> [!NOTE]
> <span data-ttu-id="24501-890">*Se espera que todos los mensajes de la implementación de TCP/IP estén en formato **big endian**. En este formato, el byte más significativo de la palabra reside en la dirección de bytes más baja.*</span><span class="sxs-lookup"><span data-stu-id="24501-890">*All messages in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

### <a name="igmp-statistics-and-errors"></a><span data-ttu-id="24501-891">Estadísticas y errores de IGMP</span><span class="sxs-lookup"><span data-stu-id="24501-891">IGMP Statistics and Errors</span></span>    
<th><p><span data-ttu-id="24501-892">Si se habilita, el software de IGMP de NetX Duo realiza un seguimiento de varios errores y estadísticas que pueden ser útiles para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-892">If enabled, the NetX Duo IGMP software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="24501-893">Se mantienen las estadísticas y los informes de errores siguientes para cada procesamiento de IGMP de IP:</span><span class="sxs-lookup"><span data-stu-id="24501-893">The following statistics and error reports are maintained for each IP's IGMP processing:</span></span> 

- <span data-ttu-id="24501-894">Número total de informes de IGMP enviados</span><span class="sxs-lookup"><span data-stu-id="24501-894">Total IGMP Reports Sent</span></span> 
- <span data-ttu-id="24501-895">Número total de consultas de IGMP recibidas</span><span class="sxs-lookup"><span data-stu-id="24501-895">Total IGMP Queries Received</span></span> 
- <span data-ttu-id="24501-896">Número total de errores de suma de comprobación de IGMP</span><span class="sxs-lookup"><span data-stu-id="24501-896">Total IGMP Checksum Errors</span></span> 
- <span data-ttu-id="24501-897">Número total de grupos unidos actualmente a IGMP</span><span class="sxs-lookup"><span data-stu-id="24501-897">Total IGMP Current Groups Joined</span></span> 

<span data-ttu-id="24501-898">Todos estos informes de errores y estadísticas están disponibles para la aplicación con el servicio ***nx_igmp_info_get***.</span><span class="sxs-lookup"><span data-stu-id="24501-898">All these statistics and error reports are available to the application with the ***nx_igmp_info_get*** service.</span></span> 

### <a name="multicast-without-igmp"></a><span data-ttu-id="24501-899">Multidifusión sin IGMP</span><span class="sxs-lookup"><span data-stu-id="24501-899">Multicast without IGMP</span></span>  
<span data-ttu-id="24501-900">La aplicación que espera el tráfico de multidifusión IPv4 puede unirse a una dirección de grupo de multidifusión sin invocar mensajes de IGMP mediante el servicio ***nx_ipv4_multicast_interface_join***.</span><span class="sxs-lookup"><span data-stu-id="24501-900">Application expecting IPv4 multicast traffic can join a multicast group address without invoking IGMP messages by using the service ***nx_ipv4_multicast_interface_join***.</span></span> <span data-ttu-id="24501-901">Este servicio indica a la capa IPv4 y al controlador de interfaz subyacente que acepte paquetes de la dirección IPv4 de multidifusión designada.</span><span class="sxs-lookup"><span data-stu-id="24501-901">This service instructs the IPv4 layer and the underlying interface driver to accept packets from the designated IPv4 multicast address.</span></span> <span data-ttu-id="24501-902">Sin embargo, no se está enviando o procesando mensajes de administración de grupo de IGMP para este grupo.</span><span class="sxs-lookup"><span data-stu-id="24501-902">However there is no IGMP group management messages being sent or processed for this group.</span></span>

<span data-ttu-id="24501-903">La aplicación que ya no quiere recibir tráfico del grupo puede usar el servicio ***nx_ipv4_multicast_interface_leave.***</span><span class="sxs-lookup"><span data-stu-id="24501-903">Application no longer wish to receive traffic from the group can use the service ***nx_ipv4_multicast_interface_leave.***</span></span>

## <a name="ipv6-in-netx-duo"></a><span data-ttu-id="24501-904">IPv6 en NetX Duo</span><span class="sxs-lookup"><span data-stu-id="24501-904">IPv6 in NetX Duo</span></span>

### <a name="ipv6-addresses"></a><span data-ttu-id="24501-905">Direcciones IPv6</span><span class="sxs-lookup"><span data-stu-id="24501-905">IPv6 Addresses</span></span>   
<span data-ttu-id="24501-906">Las direcciones IPv6 son de 128 bits.</span><span class="sxs-lookup"><span data-stu-id="24501-906">IPv6 addresses are 128 bits.</span></span> <span data-ttu-id="24501-907">La arquitectura de la dirección IPv6 se describe en RFC 4291.</span><span class="sxs-lookup"><span data-stu-id="24501-907">The architecture of IPv6 address is described in RFC 4291.</span></span> <span data-ttu-id="24501-908">La dirección se divide en un prefijo que contiene los bits más significativos y una dirección de host que contiene los bits inferiores.</span><span class="sxs-lookup"><span data-stu-id="24501-908">The address is divided into a prefix containing the most significant bits and a host address containing the lower bits.</span></span> <span data-ttu-id="24501-909">El prefijo indica el tipo de dirección y equivale aproximadamente a la dirección de red de la red IPv4.</span><span class="sxs-lookup"><span data-stu-id="24501-909">The prefix indicates the type of address and is roughly the equivalent of the network address in IPv4 network.</span></span>

<span data-ttu-id="24501-910">IPv6 tiene tres tipos de especificaciones de direcciones: unidifusión, difusión por proximidad (no se admite en NetX Duo) y multidifusión.</span><span class="sxs-lookup"><span data-stu-id="24501-910">IPv6 has three types of address specifications: unicast, anycast (not supported in NetX Duo), and multicast.</span></span> <span data-ttu-id="24501-911">Las direcciones de unidifusión son aquellas direcciones IP que identifican un host específico en Internet.</span><span class="sxs-lookup"><span data-stu-id="24501-911">Unicast addresses are those IP addresses that identify a specific host on the Internet.</span></span> <span data-ttu-id="24501-912">Las direcciones de unidifusión pueden ser una dirección IP de origen o de destino.</span><span class="sxs-lookup"><span data-stu-id="24501-912">Unicast addresses can be either a source or a destination IP address.</span></span> <span data-ttu-id="24501-913">Las direcciones de multidifusión especifican un grupo dinámico de hosts en Internet.</span><span class="sxs-lookup"><span data-stu-id="24501-913">Multicast addresses specify a dynamic group of hosts on the Internet.</span></span> <span data-ttu-id="24501-914">Los miembros del grupo de multidifusión pueden unirse y salir siempre que lo deseen.</span><span class="sxs-lookup"><span data-stu-id="24501-914">Members of the multicast group may join and leave whenever they wish.</span></span>

<span data-ttu-id="24501-915">IPv6 no tiene el equivalente del mecanismo de difusión de IPv4.</span><span class="sxs-lookup"><span data-stu-id="24501-915">IPv6 does not have the equivalent of the IPv4 broadcast mechanism.</span></span> <span data-ttu-id="24501-916">La capacidad de enviar un paquete a todos los hosts se puede lograr mediante el envío de un paquete al grupo de multidifusión local de vínculo de todos los hosts.</span><span class="sxs-lookup"><span data-stu-id="24501-916">The ability to send a packet to all hosts can be achieved by sending a packet to the link-local all hosts multicast group.</span></span>

<span data-ttu-id="24501-917">IPv6 emplea direcciones de multidifusión para realizar los procedimientos de detección de equipos cercanos, detección de enrutadores y configuración automática de direcciones sin estado.</span><span class="sxs-lookup"><span data-stu-id="24501-917">IPv6 utilizes multicast addresses to perform Neighbor Discovery, Router Discovery, and Stateless Address Auto Configuration procedures.</span></span>

<span data-ttu-id="24501-918">Hay dos tipos de direcciones IPv6 de unidifusión: las direcciones locales de vínculo, que normalmente se crean mediante la combinación del prefijo local de vínculo conocido con la dirección MAC de la interfaz, y las direcciones IP globales, que también tienen la parte del prefijo y la parte del identificador de host.</span><span class="sxs-lookup"><span data-stu-id="24501-918">There are two types of IPv6 unicast addresses: link local addresses, typically constructed by combining the well-known link local prefix with the interface MAC address, and global IP addresses, which also has the prefix portion and the host ID portion.</span></span> <span data-ttu-id="24501-919">Una dirección global puede configurarse manualmente o a través de la configuración automática de direcciones sin estado o DHCPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-919">A global address may be configured manually, or through the Stateless Address Autoconfiguration or DHCPv6.</span></span> <span data-ttu-id="24501-920">NetX Duo admite la dirección local de vínculo y la dirección global.</span><span class="sxs-lookup"><span data-stu-id="24501-920">NetX Duo supports both link local address and global address.</span></span>

<span data-ttu-id="24501-921">Para dar cabida a los formatos IPv4 e IPv6, NetX Duo proporciona un nuevo tipo de datos, NXD_ADDRESS, para almacenar direcciones IPv4 e IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-921">To accommodate both IPv4 and IPv6 formats, NetX Duo provides a new data type, NXD_ADDRESS, for holding IPv4 and IPv6 addresses.</span></span> <span data-ttu-id="24501-922">A continuación se muestra la definición de esta estructura.</span><span class="sxs-lookup"><span data-stu-id="24501-922">The definition of this structure is shown below.</span></span> <span data-ttu-id="24501-923">El campo de dirección es una unión de direcciones IPv4 e IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-923">The address field is a union of IPv4 and IPv6 addresses.</span></span>

```c
typedef struct NXD_ADDRESS_STRUCT
{
    ULONG nxd_ip_version;
    union
    {
        ULONG v4;
        ULONG v6[4];
    } nxd_ip_address;
} NXD_ADDRESS;
```

<span data-ttu-id="24501-924">En la estructura de NXD_ADDRESS, el primer elemento, *nxd_ip_version*, indica la versión IPv4 o IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-924">In the NXD_ADDRESS structure, the first element, *nxd_ip_version*, indicates IPv4 or IPv6 version.</span></span> <span data-ttu-id="24501-925">Los valores admitidos son NX_IP_VERSION_V4 o NX_IP_VERSION_V6.</span><span class="sxs-lookup"><span data-stu-id="24501-925">Supported values are either NX_IP_VERSION_V4 or NX_IP_VERSION_V6.</span></span> <span data-ttu-id="24501-926">*nxd_ip_version* indica el campo de la unión de *nxd_ip_address* que se usará como dirección IP.</span><span class="sxs-lookup"><span data-stu-id="24501-926">*nxd_ip_version* indicates which field in the *nxd_ip_address* union to use as the IP address.</span></span> <span data-ttu-id="24501-927">Los servicios de API de NetX Duo suelen tomar un puntero a la estructura NXD_ADDRESS como argumento de entrada en lugar de la dirección IP de ULONG (32 bits).</span><span class="sxs-lookup"><span data-stu-id="24501-927">NetX Duo API services typically take a pointer to NXD_ADDRESS structure as input argument in lieu of the ULONG (32 bit) IP address.</span></span>

### <a name="link-local-addresses"></a><span data-ttu-id="24501-928">Direcciones locales de vínculo</span><span class="sxs-lookup"><span data-stu-id="24501-928">Link Local Addresses</span></span>     
<span data-ttu-id="24501-929">Una dirección local de vínculo solo es válida en la red local.</span><span class="sxs-lookup"><span data-stu-id="24501-929">A link-local address is only valid on the local network.</span></span> <span data-ttu-id="24501-930">Un dispositivo puede enviar y recibir paquetes a otro dispositivo en la misma red después de que se le asigne una dirección local de vínculo válida.</span><span class="sxs-lookup"><span data-stu-id="24501-930">A device can send and receive packets to another device on the same network after a valid link local address is assigned to it.</span></span> <span data-ttu-id="24501-931">Una aplicación asigna una dirección local de vínculo mediante una llamada al servicio ***nxd_ipv6_address_set*** de NetX Duo, con el parámetro de longitud de prefijo establecido en 10.</span><span class="sxs-lookup"><span data-stu-id="24501-931">An application assigns a link-local address by calling the NetX Duo service ***nxd_ipv6_address_set***, with the prefix length parameter set to 10.</span></span> <span data-ttu-id="24501-932">La aplicación puede proporcionar una dirección local de vínculo al servicio o simplemente usar NX_NULL como dirección local de vínculo y permitir que NetX Duo cree una dirección local de vínculo basada en la dirección MAC del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="24501-932">The application may supply a link-local address to the service, or it may simply use NX_NULL as the link-local address and allow NetX Duo to construct a link-local address based on the device's MAC address.</span></span>

<span data-ttu-id="24501-933">En el ejemplo siguiente se indica a NetX Duo que configure la dirección local de vínculo con una longitud de prefijo de 10 en el dispositivo principal (índice 0) mediante su dirección MAC:</span><span class="sxs-lookup"><span data-stu-id="24501-933">The following example instructs NetX Duo to configure the link-local address with a prefix length of 10 on the primary device (index 0) using its MAC address:</span></span>

```c
nxd_ipv6_address_set(ip_ptr, 0, NX_NULL, 10, NX_NULL);
```
<span data-ttu-id="24501-934">En el ejemplo anterior, si la dirección MAC de la interfaz es 54:32:10:1A:BC:67, la dirección local de vínculo correspondiente sería:</span><span class="sxs-lookup"><span data-stu-id="24501-934">In the example above, if the MAC address of the interface is 54:32:10:1A:BC:67, the corresponding link-local address would be:</span></span>

```c
FE80::5632:10FF:FE1A:BC67
```
<span data-ttu-id="24501-935">Tenga en cuenta que la parte del identificador de host de la dirección IPv6 (**5632:10FF:FE1A:BC67**) se compone de la dirección Mac de 6 bytes, con las siguientes modificaciones:</span><span class="sxs-lookup"><span data-stu-id="24501-935">Note that the host ID portion of the IPv6 address (**5632:10FF:FE1A:BC67**) is made up of the 6-byte MAC address, with the following modifications:</span></span>

- <span data-ttu-id="24501-936">**0xFFFE** insertado entre el byte 3 y el byte 4 de la dirección MAC.</span><span class="sxs-lookup"><span data-stu-id="24501-936">**0xFFFE** inserted between byte 3 and byte 4 of the MAC address</span></span>
- <span data-ttu-id="24501-937">El segundo bit más bajo del primer byte de la dirección MAC (bit U/L) se establece en 1.</span><span class="sxs-lookup"><span data-stu-id="24501-937">Second lowest bit of the first byte of the MAC address (U/L bit) is set to 1</span></span>

<span data-ttu-id="24501-938">Consulte RFC 2464 (transmisión de paquetes IPv6 a través de la red Ethernet) para obtener más información sobre cómo crear la parte del host de una dirección IPv6 a partir de la dirección MAC de la interfaz.</span><span class="sxs-lookup"><span data-stu-id="24501-938">Refer to RFC 2464 (Transmission of IPv6 Packets over Ethernet Network) for more information on how to construct the host portion of an IPv6 address from its interface MAC address.</span></span>

<span data-ttu-id="24501-939">Hay algunas direcciones de multidifusión especiales para enviar mensajes de multidifusión a uno o varios hosts en IPv6:</span><span class="sxs-lookup"><span data-stu-id="24501-939">There are a few special multicast addresses for sending multicast messages to one or more hosts in IPv6:</span></span>

| <span data-ttu-id="24501-940">Group (Grupo)</span><span class="sxs-lookup"><span data-stu-id="24501-940">Group</span></span>  | <span data-ttu-id="24501-941">Dirección</span><span class="sxs-lookup"><span data-stu-id="24501-941">Address</span></span>   | <span data-ttu-id="24501-942">Descripción</span><span class="sxs-lookup"><span data-stu-id="24501-942">Description</span></span>  |
|---|---|---|
|<span data-ttu-id="24501-943">Grupo de todos los nodos</span><span class="sxs-lookup"><span data-stu-id="24501-943">All nodes group</span></span> |<span data-ttu-id="24501-944">**FF02::1**</span><span class="sxs-lookup"><span data-stu-id="24501-944">**FF02::1**</span></span> |<span data-ttu-id="24501-945">Todos los hosts de la red local</span><span class="sxs-lookup"><span data-stu-id="24501-945">All hosts on the local network</span></span>|
|<span data-ttu-id="24501-946">Grupo de todos los enrutadores</span><span class="sxs-lookup"><span data-stu-id="24501-946">All routers group</span></span> |<span data-ttu-id="24501-947">**FF02::2**</span><span class="sxs-lookup"><span data-stu-id="24501-947">**FF02::2**</span></span> |<span data-ttu-id="24501-948">Todos los enrutadores de la red local</span><span class="sxs-lookup"><span data-stu-id="24501-948">All routers on the local network</span></span>|
|<span data-ttu-id="24501-949">Nodo solicitado</span><span class="sxs-lookup"><span data-stu-id="24501-949">Solicited-node</span></span> |<span data-ttu-id="24501-950">**FF02::1:FF00:0/104**</span><span class="sxs-lookup"><span data-stu-id="24501-950">**FF02::1:FF00:0/104**</span></span> |<span data-ttu-id="24501-951">Se explica a continuación</span><span class="sxs-lookup"><span data-stu-id="24501-951">Explained below</span></span>|

<span data-ttu-id="24501-952">Una dirección de multidifusión de nodo solicitado se dirige a hosts específicos en el vínculo local en lugar de a todos los hosts IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-952">A solicited-node multicast address targets specific hosts on the local link rather than all the IPv6 hosts.</span></span> <span data-ttu-id="24501-953">Consta del prefijo **FF02::1:FF00:0/104**, que tiene 104 bits y los últimos 24 bits de la dirección IPv6 de destino.</span><span class="sxs-lookup"><span data-stu-id="24501-953">It consists of the prefix **FF02::1:FF00:0/104**, which is 104 bits and the last 24-bits of the target IPv6 address.</span></span> <span data-ttu-id="24501-954">Por ejemplo, una dirección IPv6 **205B:209D:D028::F058:D1C8:1024** tiene una dirección de multidifusión de nodo solicitado **FF02::1:FFC8:1024**.</span><span class="sxs-lookup"><span data-stu-id="24501-954">For example, an IPv6 address **205B:209D:D028::F058:D1C8:1024** has a solicitednode multicast address of address **FF02::1:FFC8:1024**.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="24501-955">*La notación de dos puntos dobles indica que los bits intermedios son ceros. **FF02::1:FF00:0/104** totalmente expandido sería* **FF02:0000:0000:0000:0000:0001:FF00:0000**.</span><span class="sxs-lookup"><span data-stu-id="24501-955">*The double colon notation indicates the intervening bits are all zeroes. **FF02::1:FF00:0/104** fully expanded looks like* **FF02:0000:0000:0000:0000:0001:FF00:0000**</span></span>

### <a name="global-addresses"></a><span data-ttu-id="24501-956">Direcciones globales</span><span class="sxs-lookup"><span data-stu-id="24501-956">Global Addresses</span></span>    
<span data-ttu-id="24501-957">Un ejemplo de una dirección global IPv6 es **2001:0123:4567:89AB:CDEF::1**. NetX Duo almacena direcciones IPv6 en la estructura NXD_ADDRESS.</span><span class="sxs-lookup"><span data-stu-id="24501-957">An example of an IPv6 global address is **2001:0123:4567:89AB:CDEF::1** NetX Duo stores IPv6 addresses in the NXD_ADDRESS structure.</span></span> <span data-ttu-id="24501-958">En el ejemplo siguiente, la variable de NXD_ADDRESS **global_ipv6_address** contiene una dirección IPv6 de unidifusión.</span><span class="sxs-lookup"><span data-stu-id="24501-958">In the example below, the NXD_ADDRESS variable **global_ipv6_address** contains a unicast IPv6 address.</span></span> <span data-ttu-id="24501-959">En el ejemplo siguiente se muestra un dispositivo NetX Duo que crea una dirección IPv6 global específica para su dispositivo primario:</span><span class="sxs-lookup"><span data-stu-id="24501-959">The following example demonstrates a NetX Duo device creating a specific IPv6 global address for its primary device:</span></span>

```c
NXD_ADDRESS global_ipv6_address;
UINT        primary_interface_index = 0;

global_ipv6_address.nxd_ip_version = NX_IP_VERSION_V6;
global_ipv6_address.nxd_ip_address.v6[0] = 0x20010123;
global_ipv6_address.nxd_ip_address.v6[1] = 0x456789AB;
global_ipv6_address.nxd_ip_address.v6[2] = 0xCDEF0000;
global_ipv6_address.nxd_ip_address.v6[3] = 0x00000001;

status = nxd_ipv6_address_set(
            &ip_0,
            primary_interface_index,
            &global_ipv6_address,
            64,
            NX_NULL);
```
<span data-ttu-id="24501-960">Tenga en cuenta que el prefijo de esta dirección IPv6 es **2001:0123:4567:89AB**, que tiene 64 bits de longitud y es una longitud de prefijo común para las direcciones IPv6 de unidifusión globales en Ethernet.</span><span class="sxs-lookup"><span data-stu-id="24501-960">Note that the prefix of this IPv6 address is **2001:0123:4567:89AB**, which is 64 bits long and is a common prefix length for global unicast IPv6 addresses on Ethernet.</span></span>

<span data-ttu-id="24501-961">La estructura de NXD_ADDRESS también contiene direcciones IPv4.</span><span class="sxs-lookup"><span data-stu-id="24501-961">The NXD_ADDRESS structure also holds IPv4 addresses.</span></span> <span data-ttu-id="24501-962">Una dirección IP de **192.1.168.10** (**0xC001A80A**) almacenada en global_ipv4_address tendría el siguiente diseño de memoria:</span><span class="sxs-lookup"><span data-stu-id="24501-962">An IP address of **192.1.168.10** (**0xC001A80A**) stored in global_ipv4_address would have the following memory layout:</span></span>

|<span data-ttu-id="24501-963">Campo</span><span class="sxs-lookup"><span data-stu-id="24501-963">Field</span></span> |<span data-ttu-id="24501-964">Value</span><span class="sxs-lookup"><span data-stu-id="24501-964">Value</span></span> |
|---|---|
|<span data-ttu-id="24501-965">global_ipv4_address.nxd_ip_version</span><span class="sxs-lookup"><span data-stu-id="24501-965">global_ipv4_address.nxd_ip_version</span></span> |<span data-ttu-id="24501-966">NX_IP_VERSION_V4</span><span class="sxs-lookup"><span data-stu-id="24501-966">NX_IP_VERSION_V4</span></span>|
|<span data-ttu-id="24501-967">global_ipv4_address.nxd_ip_address.v4</span><span class="sxs-lookup"><span data-stu-id="24501-967">global_ipv4_address.nxd_ip_address.v4</span></span> |<span data-ttu-id="24501-968">0xC001A80A</span><span class="sxs-lookup"><span data-stu-id="24501-968">0xC001A80A</span></span>|

<span data-ttu-id="24501-969">Cuando una aplicación pasa una dirección a los servicios de NetX Duo, el campo *nxd_ip_version* debe especificar la versión de IP correcta para el control de paquetes adecuado.</span><span class="sxs-lookup"><span data-stu-id="24501-969">When an application passes an address to NetX Duo services, the *nxd_ip_version* field must specify the correct IP version for proper packet handling.</span></span>

<span data-ttu-id="24501-970">Para ser compatible con versiones anteriores de las aplicaciones de NetX existentes, NetX Duo admite todos los servicios de NetX.</span><span class="sxs-lookup"><span data-stu-id="24501-970">To be backward compatible with existing NetX applications, NetX Duo supports all NetX services.</span></span> <span data-ttu-id="24501-971">Internamente, NetX Duo convierte el tipo de dirección IPv4 ULONG en un tipo de datos NXD_ADDRESS antes de reenviarlo al servicio de NetX Duo real.</span><span class="sxs-lookup"><span data-stu-id="24501-971">Internally, NetX Duo converts the IPv4 address type ULONG to an NXD_ADDRESS data type before forwarding it to the actual NetX Duo service.</span></span>

<span data-ttu-id="24501-972">En el ejemplo siguiente se muestran la similitud y las diferencias entre los servicios de NetX y NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-972">The following example illustrates the similarity and the differences between services in NetX and NetX Duo.</span></span>

```c
/* Make a connection to the destination IPv4 address
   192.1.168.12 through an already created TCP socket bound
   to the well known HTTP port number 80. */

global_ipv4_address.nxd_ip_version = NX_IP_VERSION_V4;
global_ipv4_address.nxd_ip_address.v4 = 0xC001A80C;

nxd_tcp_client_socket_connect(&tcp_socket,
                              &global_ipv4_address,
                              port_number,
                              NX_WAIT_FOREVER);
```

<span data-ttu-id="24501-973">A continuación se muestra la API de NetX equivalente:</span><span class="sxs-lookup"><span data-stu-id="24501-973">The following is the equivalent NetX API:</span></span>

```c
ULONG         server_ip = 0xC001A80C;
NX_TCP_SOCKET tcp_socket;
UINT          port_number = 80;

nx_tcp_client_socket_connect(&tcp_socket,
                             server_ip,
                             port_number,
                             NX_WAIT_FOREVER); 
```

> [!IMPORTANT]
> <span data-ttu-id="24501-974">*Se recomienda a los desarrolladores de aplicaciones que usen la versión nxd de estas API*.</span><span class="sxs-lookup"><span data-stu-id="24501-974">*Application developers are encouraged to use the nxd version of these APIs*.</span></span>

### <a name="ipv6-default-routers"></a><span data-ttu-id="24501-975">Enrutadores IPv6 predeterminados</span><span class="sxs-lookup"><span data-stu-id="24501-975">IPv6 Default Routers</span></span>    
<span data-ttu-id="24501-976">IPv6 usa un enrutador predeterminado para reenviar paquetes a destinos fuera del enlace.</span><span class="sxs-lookup"><span data-stu-id="24501-976">IPv6 uses a default router to forward packets to offlink destinations.</span></span> <span data-ttu-id="24501-977">El servicio ***nxd_ipv6_default_router_add*** de NetX Duo permite que una aplicación agregue un enrutador IPv6 a la tabla de enrutadores predeterminados.</span><span class="sxs-lookup"><span data-stu-id="24501-977">The NetX Duo service ***nxd_ipv6_default_router_add*** enables an application to add an IPv6 router to the default router table.</span></span> <span data-ttu-id="24501-978">Consulte el capítulo 4 "Descripción de los servicios" para conocer los demás servicios de enrutador predeterminados que ofrece NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-978">See Chapter 4 "Description of Services" for more default router services offered by NetX Duo.</span></span>  

<span data-ttu-id="24501-979">Al reenviar paquetes IPv6, NetX Duo comprueba primero si el destino del paquete está en el vínculo.</span><span class="sxs-lookup"><span data-stu-id="24501-979">When forwarding IPv6 packets, NetX Duo first checks if the packet destination is on-link.</span></span> <span data-ttu-id="24501-980">Si no es así, NetX Duo busca en la tabla de enrutamiento predeterminada un enrutador válido al que reenviar el paquete fuera de vínculo.</span><span class="sxs-lookup"><span data-stu-id="24501-980">If not, NetX Duo checks the default routing table for a valid router to forward the off-link packet to.</span></span>  

<span data-ttu-id="24501-981">Para quitar un enrutador de la tabla de enrutadores predeterminados IPv6, la aplicación debe usar el servicio \***nxd_ipv6_default_router_delete** _.</span><span class="sxs-lookup"><span data-stu-id="24501-981">To remove a router from the IPv6 default router table, application shall use the service \***nxd_ipv6_default_router_delete** _.</span></span> <span data-ttu-id="24501-982">Para obtener las entradas de la tabla de enrutadores predeterminados IPv6, use el servicio _\*_nxd_ipv6_default_router_entry_get_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-982">To obtain entries of the IPv6 default router table, use the service _\*_nxd_ipv6_default_router_entry_get_\*\*.</span></span>

### <a name="ipv6-header"></a><span data-ttu-id="24501-983">Encabezado IPv6</span><span class="sxs-lookup"><span data-stu-id="24501-983">IPv6 Header</span></span>    
<span data-ttu-id="24501-984">El encabezado IPv6 se ha modificado a partir del encabezado IPv4.</span><span class="sxs-lookup"><span data-stu-id="24501-984">The IPv6 header has been modified from the IPv4 header.</span></span> <span data-ttu-id="24501-985">Al asignar un paquete, el autor de la llamada especifica el protocolo de la aplicación (por ejemplo, UDP, TCP), el tamaño del búfer en bytes y el límite de saltos.</span><span class="sxs-lookup"><span data-stu-id="24501-985">When allocating a packet, the caller specifies the application protocol (e.g., UDP, TCP), buffer size in bytes, and hop limit.</span></span>   

<span data-ttu-id="24501-986">En la ilustración 9 se muestra el formato del encabezado IPv6 y en la tabla se enumeran los componentes de encabezado.</span><span class="sxs-lookup"><span data-stu-id="24501-986">Figure 9 shows the format of the IPv6 header and the table lists the header components.</span></span>

![Diagrama del formato de encabezado IPv6.](./media/user-guide/image18.png)

<span data-ttu-id="24501-988">**FIGURA 9. Formato del encabezado IPv6**</span><span class="sxs-lookup"><span data-stu-id="24501-988">**FIGURE 9. IPv6 Header Format**</span></span>

|<span data-ttu-id="24501-989">Encabezado IP</span><span class="sxs-lookup"><span data-stu-id="24501-989">IP header</span></span> | <span data-ttu-id="24501-990">Fin</span><span class="sxs-lookup"><span data-stu-id="24501-990">Purpose</span></span> |
|---|---|
|<span data-ttu-id="24501-991">Versión</span><span class="sxs-lookup"><span data-stu-id="24501-991">Version</span></span> |<span data-ttu-id="24501-992">Campo de 4 bits para la versión de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-992">4-bit field for IP version.</span></span> <span data-ttu-id="24501-993">En el caso de las redes IPv6, el valor de este campo debe ser 6; en el caso de las redes IPv4, debe ser 4.</span><span class="sxs-lookup"><span data-stu-id="24501-993">For IPv6 networks, the value in this field must be 6; For IPv4 networks it must be 4.</span></span>|
|<span data-ttu-id="24501-994">Clase de tráfico</span><span class="sxs-lookup"><span data-stu-id="24501-994">Traffic Class</span></span> |<span data-ttu-id="24501-995">Campo de 8 bits que almacena la información de la clase de tráfico.</span><span class="sxs-lookup"><span data-stu-id="24501-995">8-bit field that stores the traffic class information.</span></span> <span data-ttu-id="24501-996">NetX Duo no usa este campo.</span><span class="sxs-lookup"><span data-stu-id="24501-996">This field is not used by NetX Duo.</span></span>|
|<span data-ttu-id="24501-997">Etiqueta de flujo</span><span class="sxs-lookup"><span data-stu-id="24501-997">Flow Label</span></span> |<span data-ttu-id="24501-998">Campo de 20 bits para identificar de forma única el flujo, si existe, al que está asociado un paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-998">20-bit field to uniquely identify the flow, if any, that a packet is associated with.</span></span> <span data-ttu-id="24501-999">Un valor de cero indica que el paquete no pertenece a ningún flujo concreto.</span><span class="sxs-lookup"><span data-stu-id="24501-999">A value of zero indicates the packet does not belong to a particular flow.</span></span> <span data-ttu-id="24501-1000">Este campo reemplaza el campo *TOS* de IPv4.</span><span class="sxs-lookup"><span data-stu-id="24501-1000">This field replaces the *TOS* field in IPv4.</span></span>|
|<span data-ttu-id="24501-1001">Longitud de carga útil</span><span class="sxs-lookup"><span data-stu-id="24501-1001">Payload Length</span></span> |<span data-ttu-id="24501-1002">Campo de 16 bits que indica la cantidad de datos en bytes del paquete IPv6 después del encabezado base de IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1002">16-bit field indicating the amount of data in bytes of the IPv6 packet following the IPv6 base header.</span></span> <span data-ttu-id="24501-1003">Incluye todos los datos y el encabezado del protocolo encapsulado.</span><span class="sxs-lookup"><span data-stu-id="24501-1003">This includes all encapsulated protocol header and data.</span></span>|
|<span data-ttu-id="24501-1004">Encabezado siguiente</span><span class="sxs-lookup"><span data-stu-id="24501-1004">Next Header</span></span> | <span data-ttu-id="24501-1005">Campo de 8 bits que indica el tipo del encabezado de extensión después del encabezado base de IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1005">8-bit field indicating the type of the extension header that follows the IPv6 base header.</span></span> <span data-ttu-id="24501-1006">Este campo reemplaza el campo *Protocolo* de IPv4.</span><span class="sxs-lookup"><span data-stu-id="24501-1006">This field replaces the *Protocol* field in IPv4.</span></span>|
|<span data-ttu-id="24501-1007">Límite de saltos</span><span class="sxs-lookup"><span data-stu-id="24501-1007">Hop Limit</span></span> |<span data-ttu-id="24501-1008">Campo de 8 bits que limita el número de enrutadores que puede pasar el paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-1008">8-bit field that limits the number of routers the packet is allowed to go through.</span></span> <span data-ttu-id="24501-1009">Este campo reemplaza el campo *TTL* de IPv4.</span><span class="sxs-lookup"><span data-stu-id="24501-1009">This field replaces the *TTL* field in IPv4.</span></span>|
|<span data-ttu-id="24501-1010">Dirección de origen</span><span class="sxs-lookup"><span data-stu-id="24501-1010">Source Address</span></span> |<span data-ttu-id="24501-1011">Campo de 128 bits que almacena la dirección IPv6 del remitente.</span><span class="sxs-lookup"><span data-stu-id="24501-1011">128-bit field that stores the IPv6 address of the sender.</span></span>|
|<span data-ttu-id="24501-1012">Dirección de destino</span><span class="sxs-lookup"><span data-stu-id="24501-1012">Destination Address</span></span> |<span data-ttu-id="24501-1013">Campo de 128 bits que almacena la dirección IPv6 del destino.</span><span class="sxs-lookup"><span data-stu-id="24501-1013">128-bit field that sores the IPv6 address of the destination.</span></span>|

### <a name="enabling-ipv6-in-netx-duo"></a><span data-ttu-id="24501-1014">Habilitación de IPv6 en NetX Duo</span><span class="sxs-lookup"><span data-stu-id="24501-1014">Enabling IPv6 in NetX Duo</span></span>    
<span data-ttu-id="24501-1015">IPv6 está habilitado de forma predeterminada en NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-1015">By default IPv6 is enabled in NetX Duo.</span></span> <span data-ttu-id="24501-1016">Los servicios IPv6 están habilitados en NetX Duo si la opción configurable ***NX_DISABLE_IPV6** _ de _nx_user.h* no está definida.</span><span class="sxs-lookup"><span data-stu-id="24501-1016">IPv6 services are enabled in NetX Duo if the configurable option ***NX_DISABLE_IPV6** _ in _nx_user.h* is not defined.</span></span> <span data-ttu-id="24501-1017">Si ***NX_DISABLE_IPV6*** está definido, NetX Duo solo ofrecerá servicios IPv4, y ninguno de los módulos y servicios relacionados con IPv6 no estarán integrados en la biblioteca de NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-1017">If ***NX_DISABLE_IPV6*** is defined, NetX Duo will only offer IPv4 services, and all the IPv6-related modules and services are not built into NetX Duo library.</span></span>

<span data-ttu-id="24501-1018">El siguiente servicio se proporciona para que las aplicaciones configuren la dirección IPv6 del dispositivo: ***nxd_ipv6_address_set***.</span><span class="sxs-lookup"><span data-stu-id="24501-1018">The following service is provided for applications to configure the device IPv6 address: ***nxd_ipv6_address_set***</span></span>

<span data-ttu-id="24501-1019">Además de establecer manualmente las direcciones IPv6 del dispositivo, el sistema también puede usar la configuración automática de direcciones sin estado.</span><span class="sxs-lookup"><span data-stu-id="24501-1019">In addition to manually setting the device's IPv6 addresses, the system may also use Stateless Address Autoconfiguration.</span></span> <span data-ttu-id="24501-1020">Para usar esta opción, la aplicación debe llamar a \***nxd_ipv6_enable** _ para iniciar los servicios IPv6 en el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="24501-1020">To use this option, the application must call \***nxd_ipv6_enable** _ to start IPv6 services on the device.</span></span> <span data-ttu-id="24501-1021">Además, los servicios ICMPv6 deben iniciarse mediante una llamada a _*_nxd_icmp_enable_*_, que permite que NetX Duo realice servicios como la solicitud de enrutador, la detección de equipos cercanos y la detección de direcciones duplicadas.</span><span class="sxs-lookup"><span data-stu-id="24501-1021">In addition, ICMPv6 services must be started by calling _*_nxd_icmp_enable_*_, which enables NetX Duo to perform services such as Router Solicitation, Neighbor Discovery, and Duplicate Address Detection.</span></span> <span data-ttu-id="24501-1022">Tenga en cuenta que _*_nx_icmp_enable_*_ solo inicia ICMP para servicios IPv4.</span><span class="sxs-lookup"><span data-stu-id="24501-1022">Note that _*_nx_icmp_enable_*_ only starts ICMP for IPv4 services.</span></span> <span data-ttu-id="24501-1023">_*_nxd_icmp_enable_*_ inicia servicios ICMP para IPv4 e IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1023">_*_nxd_icmp_enable_*_ starts ICMP services for both IPv4 and IPv6.</span></span> <span data-ttu-id="24501-1024">Si el sistema no necesita los servicios ICMPv6, se puede usar _ *_nx_icmp_enable_*\* para que el módulo ICMPv6 no esté vinculado al sistema.</span><span class="sxs-lookup"><span data-stu-id="24501-1024">If the system does not need ICMPv6 services, then _ *_nx_icmp_enable_*\* can be used so the ICMPv6 module is not linked into the system.</span></span>

<span data-ttu-id="24501-1025">En el ejemplo siguiente se muestra un procedimiento de inicialización de IPv6 típico de NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-1025">The following example shows a typical NetX Duo IPv6 initialization procedure.</span></span>

```c
/* Assume ip_0 has been created and IPv4 services (such as ARP,
   ICMP, have been enabled. */
#define SECONDARY_INTERFACE 1

/* Enable IPv6 */
status = nxd_ipv6_enable(&ip_0);

if(status != NX_SUCCESS)
{
    /* nxd_ipv6_enable failed. */
}

/* Enable ICMPv6 */
status = nxd_icmp_enable(&ip_0);
if(status != NX_SUCCESS)
{
    /* nxd_icmp_enable failed. */
}

/* Configure the link local address on the primary interface. */
status = nxd_ipv6_address_set(&ip_0, 0, NX_NULL, 10, NX_NULL);

/* Configure ip_0 primary interface global address. */
ip_address.nxd_ip_version = NX_IP_VERSION_V6
ip_address.nxd_ip_address.v6[0] = 0x20010db8;
ip_address.nxd_ip_address.v6[1] = 0x0000f101;
ip_address.nxd_ip_address.v6[2] = 0;
ip_address.nxd_ip_address.v6[3] = 0x202;

/* Configure global address of the primary interface. */
status = nxd_ipv6_address_set(&ip_0, SECONDARY_INTERFACE,
                              &ip_address, 64, NX_NULL);
```                              

<span data-ttu-id="24501-1026">Los protocolos de nivel superior (como TCP y UDP) pueden habilitarse antes o después de que se inicie IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1026">Upper layer protocols (such as TCP and UDP) can be enabled either before or after IPv6 starts.</span></span>

> [!IMPORTANT]  
> <span data-ttu-id="24501-1027">*Los servicios de IPv6 solo están disponibles después de inicializar el subproceso de IP y de habilitar el dispositivo.*</span><span class="sxs-lookup"><span data-stu-id="24501-1027">*IPv6 services are available only after IP thread is initialized and the device is enabled.*</span></span>

<span data-ttu-id="24501-1028">Una vez que la interfaz está habilitada (es decir, el controlador de dispositivo de la interfaz está listo para enviar y recibir datos, y se ha obtenido una dirección local de vínculo válida), el dispositivo puede obtener direcciones IPv6 globales mediante uno de estos métodos:</span><span class="sxs-lookup"><span data-stu-id="24501-1028">After the interface is enabled (i.e.,the interface device driver is ready to send and receive data, and a valid link local address has been obtained), the device may obtain global IPv6 addresses by one of the these methods:</span></span>

- <span data-ttu-id="24501-1029">Configuración automática de direcciones sin estado.</span><span class="sxs-lookup"><span data-stu-id="24501-1029">Stateless Address Auto Configuration;</span></span>  
- <span data-ttu-id="24501-1030">Configuración manual de direcciones IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1030">Manual IPv6 address configuration;</span></span>  
- <span data-ttu-id="24501-1031">Configuración de direcciones a través de DHCPv6 (con un paquete DHCPv6 opcional)</span><span class="sxs-lookup"><span data-stu-id="24501-1031">Address configuration via DHCPv6 (with optional DHCPv6 package)</span></span>

<span data-ttu-id="24501-1032">Los dos primeros métodos se describen a continuación.</span><span class="sxs-lookup"><span data-stu-id="24501-1032">The first two methods are described below.</span></span> <span data-ttu-id="24501-1033">El tercer método (DHCPv6) se describe en el paquete DHCP.</span><span class="sxs-lookup"><span data-stu-id="24501-1033">The 3rd method (DHCPv6) is described in the DHCP package.</span></span>

### <a name="stateless-address-autoconfiguration-using-router-solicitation"></a><span data-ttu-id="24501-1034">Configuración automática de direcciones sin estado mediante la solicitud de enrutador</span><span class="sxs-lookup"><span data-stu-id="24501-1034">Stateless Address Autoconfiguration Using Router Solicitation</span></span>      
<span data-ttu-id="24501-1035">Los dispositivos NetX Duo pueden configurar sus interfaces automáticamente cuando se conectan a una red IPv6 con un enrutador que proporciona información de prefijo.</span><span class="sxs-lookup"><span data-stu-id="24501-1035">NetX Duo devices can configure their interfaces automatically when connected to an IPv6 network with a router that supplies prefix information.</span></span> <span data-ttu-id="24501-1036">Los dispositivos que requieren la configuración automática de direcciones sin estado envían mensajes de solicitud de enrutador (RS).</span><span class="sxs-lookup"><span data-stu-id="24501-1036">Devices that require Stateless Address Autoconfiguration send out router solicitation (RS) messages.</span></span> <span data-ttu-id="24501-1037">Los enrutadores de la red responden con mensajes de anuncios de enrutador solicitados (RA).</span><span class="sxs-lookup"><span data-stu-id="24501-1037">Routers on the network respond with solicited router advertisement (RA) messages.</span></span> <span data-ttu-id="24501-1038">Los mensajes de RA anuncian prefijos que identifican las direcciones de red asociadas a un vínculo.</span><span class="sxs-lookup"><span data-stu-id="24501-1038">RA messages advertise prefixes that identify the network addresses associated with a link.</span></span> <span data-ttu-id="24501-1039">A continuación, los dispositivos generan un identificador único para la red a la que está conectado el dispositivo.</span><span class="sxs-lookup"><span data-stu-id="24501-1039">Devices then generate a unique identifier for the network the device is attached to.</span></span> <span data-ttu-id="24501-1040">La dirección se forma combinando el prefijo y su identificador único.</span><span class="sxs-lookup"><span data-stu-id="24501-1040">The address is formed by combining the prefix and its unique identifier.</span></span> <span data-ttu-id="24501-1041">De esta manera, al recibir los mensajes de RA, los hosts generan su dirección IP.</span><span class="sxs-lookup"><span data-stu-id="24501-1041">In this manner on receiving the RA messages, hosts generate their IP address.</span></span> <span data-ttu-id="24501-1042">Los enrutadores también pueden enviar mensajes de RA no solicitados periódicos.</span><span class="sxs-lookup"><span data-stu-id="24501-1042">Routers may also send periodic unsolicited RA messages.</span></span> 

> [!WARNING]
> <span data-ttu-id="24501-1043">*NetX Duo permite a una aplicación habilitar o deshabilitar la configuración automática de direcciones sin estado en tiempo de ejecución. Para habilitar esta característica, la biblioteca de NetX Duo se debe compilar con **NX_IPV6_STATELESS_AUTOCONFIG_CONTROL** definido. Una vez habilitada esta característica, las aplicaciones pueden usar **nxd_ipv6_stateless_address_autoconfigure_enable** y **nxd_ipv6_stateless_address_autocofigure_disable** para habilitar o deshabilitar la configuración automática de direcciones IPv6 sin estado*.</span><span class="sxs-lookup"><span data-stu-id="24501-1043">*NetX Duo allows an application to enable or disable Stateless Address Autoconfiguration at run time. To enable this feature, NetX Duo library must be compiled with **NX_IPV6_STATELESS_AUTOCONFIG_CONTROL** defined. Once this feature is enabled, applications may use **nxd_ipv6_stateless_address_autoconfigure_enable** and **nxd_ipv6_stateless_address_autocofigure_disable** to enable or disable IPv6 stateless address autoconfiguration*.</span></span>

### <a name="manual-ipv6-address-configuration"></a><span data-ttu-id="24501-1044">Configuración manual de la dirección IPv6</span><span class="sxs-lookup"><span data-stu-id="24501-1044">Manual IPv6 Address Configuration</span></span>     
<span data-ttu-id="24501-1045">Si se necesita una dirección IPv6 específica, la aplicación puede usar ***nxd_ipv6_address_set*** para configurar manualmente una dirección IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1045">If a specific IPv6 address is needed, the application may use ***nxd_ipv6_address_set*** to manually configure an IPv6 address.</span></span> <span data-ttu-id="24501-1046">Una interfaz de red puede tener varias direcciones IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1046">A network interface may have multiple IPv6 addresses.</span></span> <span data-ttu-id="24501-1047">Sin embargo, tenga en cuenta que el número total de direcciones IPv6 de un sistema, ya sea obtenido a través de la configuración automática de direcciones sin estado o a través de la configuración manual, no puede superar el valor de ***NX_MAX_IPV6_ADDRESSES***.</span><span class="sxs-lookup"><span data-stu-id="24501-1047">However keep in mind that the total number of IPv6 addresses in a system, either obtained through Stateless Address Autoconfiguration, or through the Manual Configuration, cannot exceed ***NX_MAX_IPV6_ADDRESSES***.</span></span>

<span data-ttu-id="24501-1048">En el ejemplo siguiente se muestra cómo configurar manualmente una dirección global en la interfaz principal (dispositivo 0) en ip_0:</span><span class="sxs-lookup"><span data-stu-id="24501-1048">The following example illustrates how to manually configure a global address on the primary interface (device 0) in ip_0:</span></span>

```c
NXD_ADDRESS global_address;
global_address.nxd_ip_version = NX_IP_VERSION_V6;
global_address.nxd_ip_address.v6[0] = 0x20010000;
global_address.nxd_ip_address.v6[1] = 0x00000000;
global_address.nxd_ip_address.v6[2] = 0x00000000;
global_address.nxd_ip_address.v6[3] = 0x0000ABCD;
```

<span data-ttu-id="24501-1049">A continuación, el host llama al siguiente servicio de NetX Duo para asignar esta dirección como su dirección IP global:</span><span class="sxs-lookup"><span data-stu-id="24501-1049">The host then calls the following NetX Duo service to assign this address as its global IP address:</span></span>

```c
status = nxd_ipv6_address_set(&ip_0, 0,  
                              &global_address, 64
                              NX_NULL);
```

### <a name="duplicate-address-detection-dad"></a><span data-ttu-id="24501-1050">Detección de direcciones duplicadas (DAD)</span><span class="sxs-lookup"><span data-stu-id="24501-1050">Duplicate Address Detection (DAD)</span></span>    
<span data-ttu-id="24501-1051">Cuando un sistema configura su dirección IPv6, la dirección se marca como provisional (*TENTATIVE*).</span><span class="sxs-lookup"><span data-stu-id="24501-1051">After a system configures its IPv6 address, the address is marked as *TENTATIVE*.</span></span> <span data-ttu-id="24501-1052">Si la detección de direcciones duplicadas (DAD), que se describe en RFC 4862, está habilitada, NetX Duo envía automáticamente mensajes de solicitud de equipos cercanos (NS) con esta dirección provisional como destino.</span><span class="sxs-lookup"><span data-stu-id="24501-1052">If Duplicate Address Detection (DAD), described in RFC 4862, is enabled, NetX Duo automatically sends neighbor solicitation (NS) messages with this tentative address as the destination.</span></span> <span data-ttu-id="24501-1053">Si ningún host de la red responde a estos mensajes de NS dentro de un período de tiempo determinado, se supone que la dirección es única en el vínculo local y su estado pasa al estado VALID.</span><span class="sxs-lookup"><span data-stu-id="24501-1053">If no hosts on the network respond to these NS messages within a given period of time, the address is assumed to be unique on the local link, and its state transits to the VALID state.</span></span> <span data-ttu-id="24501-1054">Llegados a este punto, la aplicación puede empezar a usar esta dirección IP para la comunicación.</span><span class="sxs-lookup"><span data-stu-id="24501-1054">At this point the application may start using this IP address for communication.</span></span>  

<span data-ttu-id="24501-1055">La funcionalidad DAD forma parte del módulo ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1055">The DAD functionality is part of the ICMPv6 module.</span></span> <span data-ttu-id="24501-1056">Por lo tanto, la aplicación debe habilitar los servicios ICMPv6 para que una dirección configurada recientemente pueda someterse al proceso DAD.</span><span class="sxs-lookup"><span data-stu-id="24501-1056">Therefore, the application must enable ICMPv6 services before a newly configured address can go through the DAD process.</span></span> <span data-ttu-id="24501-1057">Como alternativa, para desactivar el proceso DAD se puede definir la opción ***NX_DISABLE_IPV6_DAD** _ en el entorno de compilación de la biblioteca de NetX Duo (definido como _*_nx_user.h_\*_).</span><span class="sxs-lookup"><span data-stu-id="24501-1057">Alternatively, the DAD process may be turned off by defining ***NX_DISABLE_IPV6_DAD** _ option in the NetX Duo library build environment (defined as _*_nx_user.h_\*_).</span></span> <span data-ttu-id="24501-1058">Durante el proceso DAD, el parámetro _*_NX_IPV6_DAD_TRANSMITS_*_ determina el número de mensajes de NS que envía NetX Duo sin recibir una respuesta para determinar que la dirección es única.</span><span class="sxs-lookup"><span data-stu-id="24501-1058">During the DAD process, the _*_NX_IPV6_DAD_TRANSMITS_*_ parameter determines the number of NS messages sent by NetX Duo without receiving a response to determine that the address is unique.</span></span> <span data-ttu-id="24501-1059">De forma predeterminada y de acuerdo con la recomendación de RFC 4862, _ *_NX_IPV6_DAD_TRANSMITS_*\* se establece en 3.</span><span class="sxs-lookup"><span data-stu-id="24501-1059">By default and recommended by RFC 4862, _ *_NX_IPV6_DAD_TRANSMITS_*\* is set at 3.</span></span> <span data-ttu-id="24501-1060">Si se establece este símbolo en cero, DAD se deshabilita de forma efectiva.</span><span class="sxs-lookup"><span data-stu-id="24501-1060">Setting this symbol to zero effectively disables DAD.</span></span>

<span data-ttu-id="24501-1061">Si ICMPv6 o DAD no están habilitados en el momento en que la aplicación asigna una dirección IPv6, no se realiza el proceso DAD y NetX Duo establece el estado de la dirección IPv6 en VALID inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="24501-1061">If ICMPv6 or DAD is not enabled at the time the application assigns an IPv6 address, DAD is not performed and NetX Duo sets the state of the IPv6 address to VALID immediately.</span></span>

<span data-ttu-id="24501-1062">NetX Duo no puede comunicarse en la red IPv6 hasta que la dirección global o local de vínculo es válida.</span><span class="sxs-lookup"><span data-stu-id="24501-1062">NetX Duo cannot communicate on the IPv6 network until its link local and/or global address is valid.</span></span> <span data-ttu-id="24501-1063">Después de obtener una dirección válida, NetX Duo intenta hacer coincidir la dirección de destino de un paquete entrante con una de sus direcciones IPv6 configuradas o con una dirección de multidifusión habilitada.</span><span class="sxs-lookup"><span data-stu-id="24501-1063">After a valid address is obtained, NetX Duo attempts to match the destination address of an incoming packet against one of its configured IPv6 address or an enabled multicast address.</span></span> <span data-ttu-id="24501-1064">Si no se encuentra ninguna coincidencia, se quita el paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-1064">If no matches are found, the packet is dropped.</span></span> 

> [!WARNING]  
> <span data-ttu-id="24501-1065">\*Durante el proceso DAD, el número de paquetes NS de DAD que se van a transmitir se define mediante \***NX_IPV6_DAD_TRANSMITS** _, cuyo valor predeterminado es 3 y, de forma predeterminada, se envía un retraso de un segundo entre cada mensaje de NS de DAD. Por lo tanto, en un sistema con DAD habilitado, después de que se asigne una dirección IPv6 (y suponiendo que no sea una dirección duplicada), hay aproximadamente 3 segundos de retraso antes de que la dirección IP esté en estado VALID y lista para la comunicación._</span><span class="sxs-lookup"><span data-stu-id="24501-1065">\*During the DAD process, the number of DAD NS packets to be transmitted is defined by \***NX_IPV6_DAD_TRANSMITS**_, which defaults to 3, and by default there is a one second delay between each DAD NS message is sent. Therefore, in a system with DAD enabled, after an IPv6 address is assigned (and assuming this is not a duplicated address), there is approximately 3 seconds delay before the IP address is in a VALID state and is ready for communication._</span></span>

<span data-ttu-id="24501-1066">Es posible que las aplicaciones deseen recibir notificaciones cuando se cambien las direcciones IPv6 en el sistema.</span><span class="sxs-lookup"><span data-stu-id="24501-1066">Applications may want to receive notifications when IPv6 addresses in the system are changed.</span></span> <span data-ttu-id="24501-1067">Para habilitar la característica de notificación de cambio de dirección IPv6, la biblioteca de NetX Duo debe compilarse con el símbolo **NX_ENABLE_IPV6_ADDRESS_CHANGE_NOTIFY** definido.</span><span class="sxs-lookup"><span data-stu-id="24501-1067">To enable the IPv6 address change notification feature, the NetX Duo library must be built with the symbol **NX_ENABLE_IPV6_ADDRESS_CHANGE_NOTIFY** defined.</span></span> <span data-ttu-id="24501-1068">Una vez habilitada la característica, las aplicaciones pueden instalar la función de devolución de llamada mediante el servicio **_nxd_ipv6_address_change_notify_**.</span><span class="sxs-lookup"><span data-stu-id="24501-1068">Once the feature is enabled, applications may install the callback function by using the **_nxd_ipv6_address_change_notify_** service.</span></span>

<span data-ttu-id="24501-1069">Cuando una dirección IPv6 se cambia o deja de ser válida, se invoca la función de devolución de llamada proporcionada por el usuario con la siguiente información:</span><span class="sxs-lookup"><span data-stu-id="24501-1069">Once an IPv6 address is changed, or becomes invalid, the user-supplied callback function is invoked with the following information:</span></span>

| <span data-ttu-id="24501-1070">Función</span><span class="sxs-lookup"><span data-stu-id="24501-1070">Function</span></span>  | <span data-ttu-id="24501-1071">Descripción</span><span class="sxs-lookup"><span data-stu-id="24501-1071">Description</span></span>  |
|---|---|
|<span data-ttu-id="24501-1072">ip_ptr</span><span class="sxs-lookup"><span data-stu-id="24501-1072">ip_ptr</span></span> |<span data-ttu-id="24501-1073">Puntero a la instancia de IP.</span><span class="sxs-lookup"><span data-stu-id="24501-1073">Pointer to the IP instance</span></span>|
|<span data-ttu-id="24501-1074">interface_index</span><span class="sxs-lookup"><span data-stu-id="24501-1074">interface_index</span></span> |<span data-ttu-id="24501-1075">Índice de la interfaz de red a la que está asociada esta dirección IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1075">Index to the network interface that this IPv6 address is associated with</span></span>
|<span data-ttu-id="24501-1076">ipv6_addr_index</span><span class="sxs-lookup"><span data-stu-id="24501-1076">ipv6_addr_index</span></span> |<span data-ttu-id="24501-1077">Índice para la tabla de direcciones IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1077">Index to the IPv6 address table</span></span>|
|<span data-ttu-id="24501-1078">ipv6_address</span><span class="sxs-lookup"><span data-stu-id="24501-1078">ipv6_address</span></span> |<span data-ttu-id="24501-1079">Puntero a la dirección IPv6, en forma de matriz de cuatro enteros de tipo ULONG.</span><span class="sxs-lookup"><span data-stu-id="24501-1079">Pointer to the IPv6 address, in the form of an array of four ULONG integers.</span></span> <span data-ttu-id="24501-1080">Las direcciones Pv6 se presentan en el orden de bytes del host.</span><span class="sxs-lookup"><span data-stu-id="24501-1080">Pv6 addresses are presented in host byte order.</span></span>|

### <a name="ipv6-multicast-support-in-netx-duo"></a><span data-ttu-id="24501-1081">Compatibilidad con multidifusión IPv6 en NetX Duo</span><span class="sxs-lookup"><span data-stu-id="24501-1081">IPv6 Multicast Support In NetX Duo</span></span>      
<span data-ttu-id="24501-1082">Las direcciones de multidifusión especifican un grupo dinámico de hosts en Internet.</span><span class="sxs-lookup"><span data-stu-id="24501-1082">Multicast addresses specify a dynamic group of hosts on the Internet.</span></span> <span data-ttu-id="24501-1083">Los miembros del grupo de multidifusión pueden unirse y salir siempre que lo deseen.</span><span class="sxs-lookup"><span data-stu-id="24501-1083">Members of the multicast group may join and leave whenever they wish.</span></span> <span data-ttu-id="24501-1084">NetX Duo implementa varios protocolos ICMPv6, como la detección de direcciones duplicadas, la detección de equipos cercanos y la detección de enrutadores, que requieren la capacidad de multidifusión IP.</span><span class="sxs-lookup"><span data-stu-id="24501-1084">NetX Duo implements several ICMPv6 protocols, including Duplicate Address Detection, Neighbor Discovery, and Router Discovery, which require IP multicast capability.</span></span> <span data-ttu-id="24501-1085">Por lo tanto, NetX Duo espera que el controlador de dispositivo subyacente admita las operaciones de multidifusión.</span><span class="sxs-lookup"><span data-stu-id="24501-1085">Therefore, NetX Duo expects the underlying device driver to support multicast operations.</span></span>

<span data-ttu-id="24501-1086">Cuando NetX Duo necesita unirse o abandonar un grupo de multidifusión (por ejemplo, la dirección de multidifusión de todos los nodos y la dirección de multidifusión de *nodo solicitado*), emite un comando de controlador al controlador de dispositivo para unirse a una dirección MAC de multidifusión o abandonarla.</span><span class="sxs-lookup"><span data-stu-id="24501-1086">When NetX Duo needs to join or leave a multicast group (such as the all-node multicast address, and the *solicited-node* multicast address), it issues a driver command to the device driver to join or leave a multicast MAC address.</span></span> <span data-ttu-id="24501-1087">El comando de controlador para unirse a la dirección de multidifusión es \***NX_LINK_MULTICAST_JOIN** _.</span><span class="sxs-lookup"><span data-stu-id="24501-1087">The driver command for joining the multicast address is \***NX_LINK_MULTICAST_JOIN** _.</span></span> <span data-ttu-id="24501-1088">Para abandonar una dirección de multidifusión, NetX Duo emite el comando de controlador _\*_NX_LINK_MULTICAST_LEAVE_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-1088">To leave a multicast address, NetX Duo issues the driver command _\*_NX_LINK_MULTICAST_LEAVE_\*\*.</span></span> <span data-ttu-id="24501-1089">El controlador de dispositivo debe implementar estos dos comandos para que los protocolos ICMPv6 funcionen correctamente.</span><span class="sxs-lookup"><span data-stu-id="24501-1089">The device driver must implement these two commands for ICMPv6 protocols to work properly.</span></span>

<span data-ttu-id="24501-1090">Las aplicaciones pueden unirse a un grupo de multidifusión IPv6 mediante el servicio \***nxd_ipv6_multicast_interface_join\*.**</span><span class="sxs-lookup"><span data-stu-id="24501-1090">Applications may join an IPv6 multicast group by using the service \***nxd_ipv6_multicast_interface_join\*.**</span></span> <span data-ttu-id="24501-1091">Este servicio registra la dirección de multidifusión con la pila IP y, a continuación, notifica al controlador de dispositivo especificado la dirección de multidifusión IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1091">This service registers the multicast address with the IP stack, and then notifies the specified device driver of the IPv6 multicast address.</span></span> <span data-ttu-id="24501-1092">Para dejar un grupo de multidifusión, las aplicaciones usan el servicio ***nxd_ipv6_multicast_interface_leave.***</span><span class="sxs-lookup"><span data-stu-id="24501-1092">To leave a multicast group, applications use the service ***nxd_ipv6_multicast_interface_leave.***</span></span>

### <a name="neighbor-discovery-nd"></a><span data-ttu-id="24501-1093">Detección de equipos cercanos (ND)</span><span class="sxs-lookup"><span data-stu-id="24501-1093">Neighbor Discovery (ND)</span></span>    
<span data-ttu-id="24501-1094">La detección de equipos cercanos es un protocolo de redes IPv6 para asignar direcciones físicas a las direcciones IPv6 (dirección global o dirección local de vínculo).</span><span class="sxs-lookup"><span data-stu-id="24501-1094">Neighbor Discovery is a protocol in IPv6 networks for mapping physical addresses to the IPv6 addresses (global address or link-local address).</span></span> <span data-ttu-id="24501-1095">Esta asignación se mantiene en la caché de detección de equipos cercanos (caché de ND).</span><span class="sxs-lookup"><span data-stu-id="24501-1095">This mapping is maintained in the Neighbor Discovery Cache (ND Cache).</span></span> <span data-ttu-id="24501-1096">El proceso de ND es el equivalente al proceso de ARP de IPv4, y la caché de ND es similar a la tabla de ARP.</span><span class="sxs-lookup"><span data-stu-id="24501-1096">The ND process is the equivalent of the ARP process in IPv4, and the ND Cache is similar to the ARP table.</span></span> <span data-ttu-id="24501-1097">Un nodo IPv6 puede obtener la dirección MAC de su equipo cercano mediante el protocolo de detección de equipos cercanos (ND).</span><span class="sxs-lookup"><span data-stu-id="24501-1097">An IPv6 node can obtain its neighbor's MAC address using the Neighbor Discovery (ND) protocol.</span></span> <span data-ttu-id="24501-1098">Envía un mensaje de solicitud de equipo cercano (NS) a la dirección de multidifusión de nodo solicitado de todos los nodos y espera un mensaje de anuncio de vecino (NA) correspondiente.</span><span class="sxs-lookup"><span data-stu-id="24501-1098">It sends out a neighbor solicitation (NS) message to the all-node solicited node multicast address, and waits for a corresponding neighbor advertisement (NA) message.</span></span> <span data-ttu-id="24501-1099">La dirección MAC obtenida a través de este proceso se almacena en la memoria caché de ND.</span><span class="sxs-lookup"><span data-stu-id="24501-1099">The MAC address obtained through this process is stored in the ND Cache.</span></span>

<span data-ttu-id="24501-1100">Cada instancia de IP tiene una caché de ND.</span><span class="sxs-lookup"><span data-stu-id="24501-1100">Each IP instance has one ND cache.</span></span> <span data-ttu-id="24501-1101">La caché de ND se mantiene como una matriz de entradas.</span><span class="sxs-lookup"><span data-stu-id="24501-1101">The ND Cache is maintained as an array of entries.</span></span> <span data-ttu-id="24501-1102">El tamaño de la matriz se define en el momento de la compilación. Para ello, se establece la opción ***NX_IPV6_NEIGHBOR_CACHE_SIZE** _ en _*_nx_user.h_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-1102">The size of the array is defined at compilation time by setting the option ***NX_IPV6_NEIGHBOR_CACHE_SIZE** _ which in _*_nx_user.h_\*\*.</span></span> <span data-ttu-id="24501-1103">Tenga en cuenta que todas las interfaces asociadas a una instancia de IP comparten la misma caché de ND.</span><span class="sxs-lookup"><span data-stu-id="24501-1103">Note that all interfaces attached to an IP instance share the same ND cache.</span></span>

<span data-ttu-id="24501-1104">La caché de ND completa está vacía cuando se inicia NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-1104">The entire ND Cache is empty when NetX Duo starts up.</span></span> <span data-ttu-id="24501-1105">A medida que se ejecuta el sistema, NetX Duo actualiza automáticamente la caché de ND, y agrega y elimina entradas según el protocolo ND.</span><span class="sxs-lookup"><span data-stu-id="24501-1105">As the system runs, NetX Duo automatically updates the ND Cache, adding and deleting entries as per ND protocol.</span></span> <span data-ttu-id="24501-1106">Sin embargo, una aplicación también puede actualizar la caché de ND mediante la adición y eliminación de entradas de caché manualmente con los siguientes servicios de NetX Duo:</span><span class="sxs-lookup"><span data-stu-id="24501-1106">However, an application may also update the ND Cache by manually adding and deleting cache entries using the following NetX Duo services:</span></span>

- <span data-ttu-id="24501-1107">***nxd_nd_cache_entry_delete***</span><span class="sxs-lookup"><span data-stu-id="24501-1107">***nxd_nd_cache_entry_delete***</span></span>  
- <span data-ttu-id="24501-1108">***nxd_nd_cache_entry_set***</span><span class="sxs-lookup"><span data-stu-id="24501-1108">***nxd_nd_cache_entry_set***</span></span>   
- <span data-ttu-id="24501-1109">***nxd_nd_cache_invalidate***</span><span class="sxs-lookup"><span data-stu-id="24501-1109">***nxd_nd_cache_invalidate***</span></span>

<span data-ttu-id="24501-1110">Al enviar y recibir paquetes IPv6, NetX Duo actualiza automáticamente la tabla de la caché de ND.</span><span class="sxs-lookup"><span data-stu-id="24501-1110">When sending and receiving IPv6 packets, NetX Duo automatically updates the ND Cache table.</span></span>

## <a name="internet-control-message-protocol-in-ipv6-icmpv6"></a><span data-ttu-id="24501-1111">Protocolo de mensajes de control de Internet en IPv6 (ICMPv6)</span><span class="sxs-lookup"><span data-stu-id="24501-1111">Internet Control Message Protocol in IPv6 (ICMPv6)</span></span>  

<span data-ttu-id="24501-1112">El rol de ICMPv6 en IPv6 se ha expandido en gran medida para admitir la asignación de direcciones IPv6 y la detección de enrutadores.</span><span class="sxs-lookup"><span data-stu-id="24501-1112">The role of ICMPv6 in IPv6 has been greatly expanded to support IPv6 address mapping and router discovery.</span></span> <span data-ttu-id="24501-1113">Además, NetX Duo ICMPv6 admite solicitudes y respuestas de eco, informes de errores de ICMPv6 y mensajes de redireccionamiento de ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1113">In addition, NetX Duo ICMPv6 supports echo request and response, ICMPv6 error reports, and ICMPv6 redirect messages.</span></span>

### <a name="icmpv6-enable"></a><span data-ttu-id="24501-1114">Habilitación de ICMPv6</span><span class="sxs-lookup"><span data-stu-id="24501-1114">ICMPv6 Enable</span></span>    
<span data-ttu-id="24501-1115">Antes de que NetX Duo pueda procesar los mensajes ICMPv6, la aplicación debe llamar al servicio ***nxd_icmp_enable*** para habilitar el procesamiento de ICMPv6 como se explicó anteriormente.</span><span class="sxs-lookup"><span data-stu-id="24501-1115">Before ICMPv6 messages can be processed by NetX Duo, the application must call the ***nxd_icmp_enable*** service to enable ICMPv6 processing as explained previously.</span></span> 

### <a name="icmpv6-messages"></a><span data-ttu-id="24501-1116">Mensajes de ICMPv6</span><span class="sxs-lookup"><span data-stu-id="24501-1116">ICMPv6 Messages</span></span>     
<span data-ttu-id="24501-1117">La estructura de encabezado de ICMPv6 es similar a la estructura de encabezado de ICMPv4.</span><span class="sxs-lookup"><span data-stu-id="24501-1117">The ICMPv6 header structure is similar to the ICMPv4 header structure.</span></span> <span data-ttu-id="24501-1118">Como se muestra a continuación, el encabezado de ICMPv6 básico contiene tres campos de tipo, código y suma de comprobación, además de la longitud variable de los datos opcionales de ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1118">As shown below, the basic ICMPv6 header contains the three fields, type, code, and checksum, plus variable length of ICMPv6 option data.</span></span> 

![Diagrama de un encabezado de ICMPv6 básico.](./media/user-guide/image19.png)

<span data-ttu-id="24501-1120">**FIGURA 10. Encabezado ICMPv6 básico**</span><span class="sxs-lookup"><span data-stu-id="24501-1120">**FIGURE 10. Basic ICMPv6 Header**</span></span>

|<span data-ttu-id="24501-1121">Campo</span><span class="sxs-lookup"><span data-stu-id="24501-1121">Field</span></span> |<span data-ttu-id="24501-1122">Tamaño (bytes)</span><span class="sxs-lookup"><span data-stu-id="24501-1122">Size(bytes)</span></span> |<span data-ttu-id="24501-1123">Descripción</span><span class="sxs-lookup"><span data-stu-id="24501-1123">Description</span></span> |
|-----|-----|-----|
|     | <span data-ttu-id="24501-1124">1</span><span class="sxs-lookup"><span data-stu-id="24501-1124">1</span></span>   |<span data-ttu-id="24501-1125">Identifica el tipo de mensaje de ICMPv6</span><span class="sxs-lookup"><span data-stu-id="24501-1125">Identifies the ICMPv6 message type;</span></span> |
|     |     |<span data-ttu-id="24501-1126">1 Destino no accesible</span><span class="sxs-lookup"><span data-stu-id="24501-1126">1 Destination Unreachable</span></span> |
|     |     |<span data-ttu-id="24501-1127">2 Paquete demasiado grande</span><span class="sxs-lookup"><span data-stu-id="24501-1127">2 Packet Too Big</span></span> |
|     |     |<span data-ttu-id="24501-1128">3 Tiempo superado</span><span class="sxs-lookup"><span data-stu-id="24501-1128">3 Time Exceeded</span></span> |
|     |     |<span data-ttu-id="24501-1129">4 Problema de parámetro</span><span class="sxs-lookup"><span data-stu-id="24501-1129">4 Parameter Problem</span></span> |
|     |     |<span data-ttu-id="24501-1130">128 Solicitud de eco</span><span class="sxs-lookup"><span data-stu-id="24501-1130">128 Echo Request</span></span> |
|     |     |<span data-ttu-id="24501-1131">129 Respuesta de eco</span><span class="sxs-lookup"><span data-stu-id="24501-1131">129 Echo Reply</span></span> |
|     |     |<span data-ttu-id="24501-1132">133 Solicitud de enrutador</span><span class="sxs-lookup"><span data-stu-id="24501-1132">133 Router Solicitation</span></span> |
|     |     |<span data-ttu-id="24501-1133">134 Anuncio de enrutador</span><span class="sxs-lookup"><span data-stu-id="24501-1133">134 Router Advertisement</span></span> |
|     |     |<span data-ttu-id="24501-1134">135 Solicitud de equipo cercano</span><span class="sxs-lookup"><span data-stu-id="24501-1134">135 Neighbor Solicitation</span></span> |
|     |     |<span data-ttu-id="24501-1135">136 Anuncio de equipo cercano</span><span class="sxs-lookup"><span data-stu-id="24501-1135">136 Neighbor Advertisement</span></span> |
|     |     |<span data-ttu-id="24501-1136">137 Mensaje de redireccionamiento</span><span class="sxs-lookup"><span data-stu-id="24501-1136">137 Redirect Message</span></span> |
|<span data-ttu-id="24501-1137">Código</span><span class="sxs-lookup"><span data-stu-id="24501-1137">Code</span></span> | <span data-ttu-id="24501-1138">1</span><span class="sxs-lookup"><span data-stu-id="24501-1138">1</span></span>   |<span data-ttu-id="24501-1139">Califica aún más el tipo de mensaje de ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1139">Further qualifies the ICMPv6 message type.</span></span> <span data-ttu-id="24501-1140">Se suele usar con los mensajes de error.</span><span class="sxs-lookup"><span data-stu-id="24501-1140">Generally used with error messages.</span></span> <span data-ttu-id="24501-1141">Si no se usa, se establece en cero.</span><span class="sxs-lookup"><span data-stu-id="24501-1141">If not used, it is set to zero.</span></span> <span data-ttu-id="24501-1142">La solicitud/respuesta de eco y los mensajes de NS no los usan.</span><span class="sxs-lookup"><span data-stu-id="24501-1142">Echo request/reply and NS messages do not use it.</span></span>|
|<span data-ttu-id="24501-1143">Suma de comprobación</span><span class="sxs-lookup"><span data-stu-id="24501-1143">Checksum</span></span> | <span data-ttu-id="24501-1144">2</span><span class="sxs-lookup"><span data-stu-id="24501-1144">2</span></span> |<span data-ttu-id="24501-1145">Campo de suma de comprobación de 16 bits para el encabezado de ICMP.</span><span class="sxs-lookup"><span data-stu-id="24501-1145">16-bit checksum field for the ICMP Header.</span></span> <span data-ttu-id="24501-1146">Se trata de un complemento de 16 bits del mensaje de ICMPv6 completo, incluido el encabezado de ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1146">This is a 16-bit complement of the entire ICMPv6 message, including the ICMPv6 header.</span></span> <span data-ttu-id="24501-1147">También incluye un pseudoencabezado de la dirección de origen IPv6, la dirección de destino y la longitud de carga del paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-1147">It also includes a pseudo-header of the IPv6 source address, destination address, and packet payload length.</span></span> |

<span data-ttu-id="24501-1148">A continuación se muestra un encabezado de solicitud de equipo cercano de ejemplo.</span><span class="sxs-lookup"><span data-stu-id="24501-1148">An example Neighbor Solicitation header is shown below.</span></span>

![Diagrama de un encabezado de solicitud de equipo cercano de ejemplo.](./media/user-guide/image20.jpg)

<span data-ttu-id="24501-1150">**FIGURA 11. Encabezado de ICMPv6 para un mensaje de solicitud de equipo cercano**</span><span class="sxs-lookup"><span data-stu-id="24501-1150">**FIGURE 11. ICMPv6 Header for a Neighbor Solicitation Message**</span></span>

|<span data-ttu-id="24501-1151">Campo</span><span class="sxs-lookup"><span data-stu-id="24501-1151">Field</span></span> |<span data-ttu-id="24501-1152">Tamaño (bytes)</span><span class="sxs-lookup"><span data-stu-id="24501-1152">Size(bytes)</span></span> |<span data-ttu-id="24501-1153">Descripción</span><span class="sxs-lookup"><span data-stu-id="24501-1153">Description</span></span> |
|-----|-----|-----|
|<span data-ttu-id="24501-1154">Tipo</span><span class="sxs-lookup"><span data-stu-id="24501-1154">Type</span></span> | <span data-ttu-id="24501-1155">1</span><span class="sxs-lookup"><span data-stu-id="24501-1155">1</span></span>   |<span data-ttu-id="24501-1156">Identifica el tipo de mensaje de ICMPv6 para mensajes de solicitud de equipos cercano.</span><span class="sxs-lookup"><span data-stu-id="24501-1156">Identifies the ICMPv6 message type for neighbor solicitation messages.</span></span> <span data-ttu-id="24501-1157">El valor es 135.</span><span class="sxs-lookup"><span data-stu-id="24501-1157">Value is 135.</span></span> |
|<span data-ttu-id="24501-1158">Código</span><span class="sxs-lookup"><span data-stu-id="24501-1158">Code</span></span> | <span data-ttu-id="24501-1159">1</span><span class="sxs-lookup"><span data-stu-id="24501-1159">1</span></span>   |<span data-ttu-id="24501-1160">No se utiliza.</span><span class="sxs-lookup"><span data-stu-id="24501-1160">Not used.</span></span> <span data-ttu-id="24501-1161">Establecer en 0.</span><span class="sxs-lookup"><span data-stu-id="24501-1161">Set to 0.</span></span> |
|<span data-ttu-id="24501-1162">Suma de comprobación</span><span class="sxs-lookup"><span data-stu-id="24501-1162">Checksum</span></span> | <span data-ttu-id="24501-1163">2</span><span class="sxs-lookup"><span data-stu-id="24501-1163">2</span></span>  |<span data-ttu-id="24501-1164">Campo de suma de comprobación de 16 bits para el encabezado de ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1164">16-bit checksum field for the ICMPv6 header.</span></span> |
|<span data-ttu-id="24501-1165">Reservada</span><span class="sxs-lookup"><span data-stu-id="24501-1165">Reserved</span></span> | <span data-ttu-id="24501-1166">4</span><span class="sxs-lookup"><span data-stu-id="24501-1166">4</span></span>  |<span data-ttu-id="24501-1167">4 bytes reservados establecidos en 0.</span><span class="sxs-lookup"><span data-stu-id="24501-1167">4 reserved bytes set to 0.</span></span> |
|<span data-ttu-id="24501-1168">Dirección de destino</span><span class="sxs-lookup"><span data-stu-id="24501-1168">Target Address</span></span> | <span data-ttu-id="24501-1169">16</span><span class="sxs-lookup"><span data-stu-id="24501-1169">16</span></span>  |<span data-ttu-id="24501-1170">Dirección IPv6 de destino de la solicitud.</span><span class="sxs-lookup"><span data-stu-id="24501-1170">IPv6 address of target of the solicitation.</span></span> <span data-ttu-id="24501-1171">Para la resolución de direcciones IPv6, se trata de la dirección IP de unidifusión real del dispositivo cuya dirección de nivel de vínculo debe resolverse.</span><span class="sxs-lookup"><span data-stu-id="24501-1171">For IPv6 address resolution, this is the actual unicast IP address of the device whose link layer address needs to be resolved.</span></span> |
|<span data-ttu-id="24501-1172">Opciones</span><span class="sxs-lookup"><span data-stu-id="24501-1172">Options</span></span> | <span data-ttu-id="24501-1173">Variable</span><span class="sxs-lookup"><span data-stu-id="24501-1173">Variable</span></span> |<span data-ttu-id="24501-1174">Información opcional especificada por el protocolo de detección de equipos cercanos.</span><span class="sxs-lookup"><span data-stu-id="24501-1174">Optional information specified by the Neighbor Discovery Protocol.</span></span> |

### <a name="icmpv6-ping-request"></a><span data-ttu-id="24501-1175">Solicitud de ping de ICMPv6</span><span class="sxs-lookup"><span data-stu-id="24501-1175">ICMPv6 Ping Request</span></span>
<span data-ttu-id="24501-1176">En las aplicaciones de NetX Duo, use ***nxd_icmp_ping*** para emitir solicitudes de ping de IPv6 o IPv4, en función de la dirección IP de destino especificada en los parámetros.</span><span class="sxs-lookup"><span data-stu-id="24501-1176">In NetX Duo applications use ***nxd_icmp_ping*** to issue either IPv6 or IPv4 ping requests, based on the destination IP address specified in the parameters.</span></span>  

### <a name="icmpv6-ping-response"></a><span data-ttu-id="24501-1177">Respuesta de ping de ICMPv6</span><span class="sxs-lookup"><span data-stu-id="24501-1177">ICMPv6 Ping Response</span></span>
<span data-ttu-id="24501-1178">Una respuesta de ping de ICMPv6 es otro tipo de mensaje de ICMPv6 que el componente de ICMPv6 genera internamente en respuesta a una solicitud de ping de ICMPv6 externa.</span><span class="sxs-lookup"><span data-stu-id="24501-1178">An ICMPv6 ping response is another type of ICMPv6 message that is generated internally by the ICMPv6 component in response to an external ICMPv6 ping request.</span></span> <span data-ttu-id="24501-1179">Además de la confirmación, la respuesta de ping de ICMPv6 también contiene una copia de los datos de usuario proporcionados en la solicitud de ping de ICMPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1179">In additional to acknowledgement, the ICMPv6 ping response also contains a copy of the user data supplied in the ICMPv6 ping request.</span></span>  

### <a name="thread-suspension"></a><span data-ttu-id="24501-1180">Suspensión de subprocesos</span><span class="sxs-lookup"><span data-stu-id="24501-1180">Thread Suspension</span></span>
<span data-ttu-id="24501-1181">Los subprocesos de aplicación se pueden suspender mientras intentan hacer ping en otro miembro de la red.</span><span class="sxs-lookup"><span data-stu-id="24501-1181">Application threads can suspend while attempting to ping another network member.</span></span> <span data-ttu-id="24501-1182">Después de recibir una respuesta de ping, se proporciona el mensaje de respuesta de ping al primer subproceso suspendido y se reanuda el subproceso.</span><span class="sxs-lookup"><span data-stu-id="24501-1182">After a ping response is received, the ping response message is given to the first thread suspended and that thread is resumed.</span></span> <span data-ttu-id="24501-1183">Al igual que todos los servicios de NetX Duo, la suspensión de una solicitud de ping tiene un tiempo de espera opcional.</span><span class="sxs-lookup"><span data-stu-id="24501-1183">Like all NetX Duo services, suspending on a ping request has an optional timeout.</span></span>  

### <a name="other-icmpv6-messages"></a><span data-ttu-id="24501-1184">Otros mensajes de ICMPv6</span><span class="sxs-lookup"><span data-stu-id="24501-1184">Other ICMPv6 Messages</span></span>
<span data-ttu-id="24501-1185">Los mensajes de ICMPv6 son necesarios para las siguientes características:</span><span class="sxs-lookup"><span data-stu-id="24501-1185">ICMPv6 messages are required for the following features:</span></span>  

- <span data-ttu-id="24501-1186">Detección de equipos cercanos</span><span class="sxs-lookup"><span data-stu-id="24501-1186">Neighbor Discovery</span></span>  
- <span data-ttu-id="24501-1187">Configuración automática de direcciones sin estado</span><span class="sxs-lookup"><span data-stu-id="24501-1187">Stateless Address Autoconfiguration</span></span> 
- <span data-ttu-id="24501-1188">Detección de enrutador</span><span class="sxs-lookup"><span data-stu-id="24501-1188">Router Discovery</span></span> 
- <span data-ttu-id="24501-1189">Detección de inaccesibilidad de equipos cercanos</span><span class="sxs-lookup"><span data-stu-id="24501-1189">Neighbor Unreachability Detection</span></span>  

### <a name="neighbor-unreachability-router-and-prefix-discovery"></a><span data-ttu-id="24501-1190">Detección de inaccesibilidad de equipos cercanos, enrutador y prefijo</span><span class="sxs-lookup"><span data-stu-id="24501-1190">Neighbor Unreachability, Router and Prefix Discovery</span></span>    
<span data-ttu-id="24501-1191">La detección de inaccesibilidad de equipos cercanos, de enrutador y de prefijo se basa en el protocolo de detección de equipos cercanos y se describe a continuación.</span><span class="sxs-lookup"><span data-stu-id="24501-1191">Neighbor Unreachability Detection, Router Discovery, and Prefix Discovery are based on the Neighbor Discovery protocol and are described below.</span></span> 

<span data-ttu-id="24501-1192">***Detección de inaccesibilidad de equipos cercanos:*** un dispositivo IPv6 busca en la memoria caché de detección de equipos cercanos (ND) la dirección del nivel de vínculo de destino cuando quiere enviar un paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-1192">***Neighbor Unreachability Detection:*** An IPv6 device searches its Neighbor Discovery (ND) Cache for the destination link layer address when it wishes to send a packet.</span></span> <span data-ttu-id="24501-1193">El destino inmediato, que a veces se denomina "próximo salto", puede ser el destino real en el mismo vínculo o puede ser un enrutador si el destino se encuentra fuera del vínculo.</span><span class="sxs-lookup"><span data-stu-id="24501-1193">The immediate destination, sometimes referred to as the 'next hop,' may be the actual destination on the same link or it may be a router if the destination is off link.</span></span> <span data-ttu-id="24501-1194">Una entrada de caché de ND contiene el estado sobre la inaccesibilidad de un equipo cercano.</span><span class="sxs-lookup"><span data-stu-id="24501-1194">An ND cache entry contains the status on a neighbor's reachability.</span></span>

<span data-ttu-id="24501-1195">Un estado REACHABLE indica que el equipo cercano se considera accesible.</span><span class="sxs-lookup"><span data-stu-id="24501-1195">A REACHABLE status indicates the neighbor is considered reachable.</span></span> <span data-ttu-id="24501-1196">Un equipo cercano es accesible si ha recibido recientemente una confirmación de recepción de los paquetes enviados al equipo cercano.</span><span class="sxs-lookup"><span data-stu-id="24501-1196">A neighbor is reachable if it has recently received confirmation that packets sent to the neighbor have been received.</span></span> <span data-ttu-id="24501-1197">La confirmación en NetX Duo adopta la forma de recepción de un mensaje de NA del equipo cercano en respuesta a un mensaje de NS enviado por el dispositivo NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-1197">Confirmation in NetX Duo take the form of receiving an NA message from the neighbor in response to an NS message sent by the NetX Duo device.</span></span> <span data-ttu-id="24501-1198">NetX Duo también cambiará el estado del equipo cercano a REACHABLE si la aplicación llama al servicio ***nxd_nd_cache_entry_set*** de NetX Duo para introducir manualmente un registro de caché.</span><span class="sxs-lookup"><span data-stu-id="24501-1198">NetX Duo will also change the state of the neighbor status to REACHABLE if the application calls the NetX Duo service ***nxd_nd_cache_entry_set*** to manually enter a cache record.</span></span>

<span data-ttu-id="24501-1199">***Detección de enrutadores:*** un dispositivo IPv6 usa un enrutador para reenviar todos los paquetes previstos para los destinos fuera del vínculo.</span><span class="sxs-lookup"><span data-stu-id="24501-1199">***Router Discovery:*** An IPv6 device uses a router to forward all packets intended for off link destinations.</span></span> <span data-ttu-id="24501-1200">También puede usar la información enviada por el enrutador, como mensajes de anuncio de enrutador (RA), para configurar sus direcciones IPv6 globales.</span><span class="sxs-lookup"><span data-stu-id="24501-1200">It may also use information sent by the router, such as router advertisement (RA) messages, to configure its global IPv6 addresses.</span></span>

<span data-ttu-id="24501-1201">Un dispositivo en la red puede iniciar el proceso de detección del enrutador mediante el envío de un mensaje de solicitud de enrutador (RS) a la dirección de multidifusión de todos los enrutadores (FF01::2).</span><span class="sxs-lookup"><span data-stu-id="24501-1201">A device on the network may initiate the Router Discovery process by sending a router solicitation (RS) message to the all-router multicast address (FF01::2).</span></span> <span data-ttu-id="24501-1202">O bien, puede esperar en la dirección de multidifusión de todos los nodos (FF::1) un RA periódico de los enrutadores.</span><span class="sxs-lookup"><span data-stu-id="24501-1202">Or it can wait on the all-node multicast address (FF::1) for a periodic RA from the routers.</span></span>

<span data-ttu-id="24501-1203">Un mensaje de RA contiene la información del prefijo para configurar una dirección IPv6 para esa red.</span><span class="sxs-lookup"><span data-stu-id="24501-1203">An RA message contains the prefix information for configuring an IPv6 address for that network.</span></span> <span data-ttu-id="24501-1204">En NetX Duo, la solicitud de enrutador está habilitada de forma predeterminada y se puede deshabilitar estableciendo la opción de configuración ***NX_DISABLE_ICMPV6_ROUTER_SOLICITATION** _ en _*_nx_user.h_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-1204">In NetX Duo, router solicitation is by default enabled and can be disabled by setting the configuration option ***NX_DISABLE_ICMPV6_ROUTER_SOLICITATION** _ in _*_nx_user.h_\*\*.</span></span> <span data-ttu-id="24501-1205">Consulte Opciones de configuración en el capítulo "Instalación y uso de NetX Duo" para obtener más detalles sobre cómo establecer los parámetros de solicitud de enrutador.</span><span class="sxs-lookup"><span data-stu-id="24501-1205">See Configuration Options in the "Installation and Use of NetX Duo" chapter for more details on setting Router Solicitation parameters.</span></span> 

<span data-ttu-id="24501-1206">***Detección de prefijos***: un dispositivo IPv6 usa la detección de prefijos para saber qué hosts de destino son accesibles directamente sin pasar por un enrutador.</span><span class="sxs-lookup"><span data-stu-id="24501-1206">***Prefix Discovery***: An IPv6 device uses prefix discovery to learn which target hosts are accessible directly without going through a router.</span></span> <span data-ttu-id="24501-1207">Esta información se pone a disposición del dispositivo IPv6 desde los mensajes de RA del enrutador.</span><span class="sxs-lookup"><span data-stu-id="24501-1207">This information is made available to the IPv6 device from RA messages from the router.</span></span> <span data-ttu-id="24501-1208">El dispositivo IPv6 almacena la información de prefijo en una tabla de prefijos.</span><span class="sxs-lookup"><span data-stu-id="24501-1208">The IPv6 device stores the prefix information in a prefix table.</span></span> <span data-ttu-id="24501-1209">La detección de prefijos hace coincidir un prefijo de la tabla de prefijos de dispositivos IPv6 con una dirección de destino.</span><span class="sxs-lookup"><span data-stu-id="24501-1209">Prefix discovery is matching a prefix from the IPv6 device prefix table to a target address.</span></span> <span data-ttu-id="24501-1210">Un prefijo coincide con una dirección de destino si todos los bits del prefijo coinciden con los bits más significativos de la dirección de destino.</span><span class="sxs-lookup"><span data-stu-id="24501-1210">A prefix matches a target address if all the bits in the prefix match the most significant bits of the target address.</span></span> <span data-ttu-id="24501-1211">Si hay más de un prefijo que cubre una dirección, se selecciona el prefijo más largo.</span><span class="sxs-lookup"><span data-stu-id="24501-1211">If more than one prefix covers an address, the longest prefix is selected.</span></span>

### <a name="icmpv6-error-messages"></a><span data-ttu-id="24501-1212">Mensajes de error de ICMPv6</span><span class="sxs-lookup"><span data-stu-id="24501-1212">ICMPv6 Error Messages</span></span>    
<span data-ttu-id="24501-1213">Se admiten los siguientes mensajes de error de ICMPv6 en NetX Duo:</span><span class="sxs-lookup"><span data-stu-id="24501-1213">The following ICMPv6 error messages are supported in NetX Duo:</span></span>  

- <span data-ttu-id="24501-1214">Destino no accesible</span><span class="sxs-lookup"><span data-stu-id="24501-1214">Destination Unreachable</span></span>  
- <span data-ttu-id="24501-1215">Paquete demasiado grande</span><span class="sxs-lookup"><span data-stu-id="24501-1215">Packet Too Big</span></span>  
- <span data-ttu-id="24501-1216">Tiempo superado</span><span class="sxs-lookup"><span data-stu-id="24501-1216">Time Exceed</span></span>  
- <span data-ttu-id="24501-1217">Problema de parámetro</span><span class="sxs-lookup"><span data-stu-id="24501-1217">Parameter Problem</span></span>  

## <a name="user-datagram-protocol-udp"></a><span data-ttu-id="24501-1218">Protocolo de datagramas de usuario (UDP)</span><span class="sxs-lookup"><span data-stu-id="24501-1218">User Datagram Protocol (UDP)</span></span>

<span data-ttu-id="24501-1219">El protocolo de datagramas de usuario (UDP) proporciona la forma más sencilla de transferencia de datos entre los miembros de la red (RFC 768).</span><span class="sxs-lookup"><span data-stu-id="24501-1219">The User Datagram Protocol (UDP) provides the simplest form of data transfer between network members (RFC 768).</span></span> <span data-ttu-id="24501-1220">Los paquetes de datos de UDP se envían de un miembro de red a otro de la mejor forma posible; es decir, no hay ningún mecanismo integrado para la confirmación por parte del destinatario del paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-1220">UDP data packets are sent from one network member to another in a best effort fashion; i.e., there is no built-in mechanism for acknowledgement by the packet recipient.</span></span> <span data-ttu-id="24501-1221">Además, el envío de un paquete UDP no requiere que se establezca ninguna conexión de antemano.</span><span class="sxs-lookup"><span data-stu-id="24501-1221">In addition, sending a UDP packet does not require any connection to be established in advance.</span></span> <span data-ttu-id="24501-1222">Debido a esto, la transmisión de paquetes UDP es muy eficaz.</span><span class="sxs-lookup"><span data-stu-id="24501-1222">Because of this, UDP packet transmission is very efficient.</span></span>

<span data-ttu-id="24501-1223">Para los desarrolladores que migran sus aplicaciones de NetX a NetX Duo solo hay algunos cambios básicos en la funcionalidad de UDP entre NetX y NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-1223">For developers migrating their NetX applications to NetX Duo there are only a few basic changes in UDP functionality between NetX and NetX Duo.</span></span> <span data-ttu-id="24501-1224">Esto se debe a que IPv6 se ocupa principalmente del nivel de IP subyacente.</span><span class="sxs-lookup"><span data-stu-id="24501-1224">This is because IPv6 is primarily concerned with the underlying IP layer.</span></span> <span data-ttu-id="24501-1225">Todos los servicios de UDP de NetX Duo se pueden usar para la conectividad IPv4 o IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1225">All NetX Duo UDP services can be used for either IPv4 or IPv6 connectivity.</span></span>

### <a name="udp-header"></a><span data-ttu-id="24501-1226">Encabezado UDP</span><span class="sxs-lookup"><span data-stu-id="24501-1226">UDP Header</span></span>       
<span data-ttu-id="24501-1227">UDP coloca un encabezado de paquete simple delante de los datos de la aplicación en la transmisión y quita un encabezado UDP similar del paquete en la recepción antes de entregar un paquete UDP recibido a la aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-1227">UDP places a simple packet header in front of the application's data on transmission, and removes a similar UDP header from the packet on reception before delivering a received UDP packet to the application.</span></span> <span data-ttu-id="24501-1228">UDP emplea el protocolo IP para enviar y recibir paquetes, lo que significa que hay un encabezado IP delante del encabezado UDP cuando el paquete está en la red.</span><span class="sxs-lookup"><span data-stu-id="24501-1228">UDP utilizes the IP protocol for sending and receiving packets, which means there is an IP header in front of the UDP header when the packet is on the network.</span></span> <span data-ttu-id="24501-1229">En la figura 12 se muestra el formato del encabezado UDP.</span><span class="sxs-lookup"><span data-stu-id="24501-1229">Figure 12 shows the format of the UDP header.</span></span>

![Diagrama del formato de encabezado UDP.](./media/user-guide/image21.png)

### <a name="figure-12-udp-header"></a><span data-ttu-id="24501-1231">FIGURA 12.</span><span class="sxs-lookup"><span data-stu-id="24501-1231">FIGURE 12.</span></span> <span data-ttu-id="24501-1232">Encabezado UDP</span><span class="sxs-lookup"><span data-stu-id="24501-1232">UDP Header</span></span>

> [!NOTE]
> <span data-ttu-id="24501-1233">*Se espera que todos los encabezados de la implementación de UDP/IP estén en formato **big endian**. En este formato, el byte más significativo de la palabra reside en la dirección de bytes más baja.*</span><span class="sxs-lookup"><span data-stu-id="24501-1233">*All headers in the UDP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address.*</span></span>

<span data-ttu-id="24501-1234">A continuación se describe el formato de encabezado UDP:</span><span class="sxs-lookup"><span data-stu-id="24501-1234">The following describes the UDP header format:</span></span>

|<span data-ttu-id="24501-1235">Campo del encabezado</span><span class="sxs-lookup"><span data-stu-id="24501-1235">Header Field</span></span> |<span data-ttu-id="24501-1236">Fin</span><span class="sxs-lookup"><span data-stu-id="24501-1236">Purpose</span></span> |
|---|---|
|<span data-ttu-id="24501-1237">**Número de puerto de origen de 16 bits**</span><span class="sxs-lookup"><span data-stu-id="24501-1237">**16-bit source port number**</span></span> |<span data-ttu-id="24501-1238">Este campo contiene el puerto desde el que se envía el paquete UDP.</span><span class="sxs-lookup"><span data-stu-id="24501-1238">This field contains the port on which the UDP packet is being sent from.</span></span> <span data-ttu-id="24501-1239">El intervalo de puertos UDP válidos va del 1 al 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="24501-1239">Valid UDP ports range from 1 through 0xFFFF.</span></span> |
|<span data-ttu-id="24501-1240">**Número de puerto de destino de 16 bits**</span><span class="sxs-lookup"><span data-stu-id="24501-1240">**16-bit destination port number**</span></span> |<span data-ttu-id="24501-1241">Este campo contiene el puerto UDP al que se envía el paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-1241">This field contains the UDP port to which the packet is being sent to.</span></span> <span data-ttu-id="24501-1242">El intervalo de puertos UDP válidos va del 1 al 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="24501-1242">Valid UDP ports range from 1 through 0xFFFF.</span></span> |
|<span data-ttu-id="24501-1243">**Longitud de UDP de 16 bits**</span><span class="sxs-lookup"><span data-stu-id="24501-1243">**16-bit UDP length**</span></span> |<span data-ttu-id="24501-1244">Este campo contiene el número de bytes del paquete UDP, incluido el tamaño del encabezado UDP.</span><span class="sxs-lookup"><span data-stu-id="24501-1244">This field contains the number of bytes in the UDP packet, including the size of the UDP header.</span></span> |
|<span data-ttu-id="24501-1245">**Suma de comprobación de UDP de 16 bits**</span><span class="sxs-lookup"><span data-stu-id="24501-1245">**16-bit UDP checksum**</span></span> |<span data-ttu-id="24501-1246">Este campo contiene la suma de comprobación de 16 bits del paquete, incluidos el encabezado UDP, el área de datos del paquete y el pseudoencabezado IP.</span><span class="sxs-lookup"><span data-stu-id="24501-1246">This field contains the 16-bit checksum for the packet, including the UDP header, the packet data area, and the pseudo IP header.</span></span> |

### <a name="udp-enable"></a><span data-ttu-id="24501-1247">Habilitación de UDP</span><span class="sxs-lookup"><span data-stu-id="24501-1247">UDP Enable</span></span>   
<span data-ttu-id="24501-1248">Para que la transmisión de paquetes UDP sea posible, la aplicación debe habilitar primero UDP mediante una llamada al servicio ***nx_udp_enable***.</span><span class="sxs-lookup"><span data-stu-id="24501-1248">Before UDP packet transmission is possible, the application must first enable UDP by calling the ***nx_udp_enable*** service.</span></span> <span data-ttu-id="24501-1249">Una vez habilitado, la aplicación puede enviar y recibir paquetes UDP.</span><span class="sxs-lookup"><span data-stu-id="24501-1249">After enabled, the application is free to send and receive UDP packets.</span></span>  

### <a name="udp-socket-create"></a><span data-ttu-id="24501-1250">Creación de sockets UDP</span><span class="sxs-lookup"><span data-stu-id="24501-1250">UDP Socket Create</span></span>    
<span data-ttu-id="24501-1251">Los sockets UDP se crean durante la inicialización o en tiempo de ejecución mediante subprocesos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-1251">UDP sockets are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="24501-1252">En el servicio ***nx_udp_socket_create*** se definen el tipo inicial de servicio, el período de vida y la profundidad de la cola de recepción.</span><span class="sxs-lookup"><span data-stu-id="24501-1252">The initial type of service, time to live, and receive queue depth are defined by the ***nx_udp_socket_create*** service.</span></span> <span data-ttu-id="24501-1253">No hay ningún límite en el número de sockets UDP de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-1253">There are no limits on the number of UDP sockets in an application.</span></span>

### <a name="udp-checksum"></a><span data-ttu-id="24501-1254">Suma de comprobación de UDP</span><span class="sxs-lookup"><span data-stu-id="24501-1254">UDP Checksum</span></span>   
<span data-ttu-id="24501-1255">El protocolo IPv6 requiere un cálculo de suma de comprobación de encabezado UDP en los datos de paquetes, mientras que en el protocolo IPv4 es opcional.</span><span class="sxs-lookup"><span data-stu-id="24501-1255">IPv6 protocol requires a UDP header checksum computation on packet data, whereas in the IPv4 protocol it is optional.</span></span>  

<span data-ttu-id="24501-1256">UDP especifica una suma de comprobación de 16 bits del complemento a uno que incluye el pseudoencabezado IP (que consta de la dirección IP de origen, la dirección IP de destino, el protocolo y la longitud de palabra de IP), el encabezado UDP y los datos del paquete UDP.</span><span class="sxs-lookup"><span data-stu-id="24501-1256">UDP specifies a one's complement 16-bit checksum that covers the IP pseudo header (consisting of the source IP address, destination IP address, and the protocol/length IP word), the UDP header, and the UDP packet data.</span></span> <span data-ttu-id="24501-1257">Las únicas diferencias entre las sumas de comprobación de encabezado de paquetes UDP de IPv4 e IPv6 son que las direcciones IP de origen y de destino son de 32 bits en IPv4, mientras que en IPv6 son de 128 bits.</span><span class="sxs-lookup"><span data-stu-id="24501-1257">The only differences between IPv4 and IPv6 UDP packet header checksums is that the source and destination IP addresses are 32 bit in IPv4 while in IPv6 they are 128 bit.</span></span> <span data-ttu-id="24501-1258">Si la suma de comprobación de UDP calculada es 0, se almacena como todo unos (0xFFFF).</span><span class="sxs-lookup"><span data-stu-id="24501-1258">If the calculated UDP checksum is 0, it is stored as all ones (0xFFFF).</span></span> <span data-ttu-id="24501-1259">Si el socket de envío tiene deshabilitada la lógica de la suma de comprobación de UDP, se coloca un cero en el campo de suma de comprobación de UDP para indicar que no se ha calculado la suma de comprobación.</span><span class="sxs-lookup"><span data-stu-id="24501-1259">If the sending socket has the UDP checksum logic disabled, a zero is placed in the UDP checksum field to indicate the checksum was not calculated.</span></span>

<span data-ttu-id="24501-1260">Si la suma de comprobación de UDP no coincide con la suma de comprobación calculada por el receptor, simplemente se descarta el paquete UDP.</span><span class="sxs-lookup"><span data-stu-id="24501-1260">If the UDP checksum does not match the computed checksum by the receiver, the UDP packet is simply discarded.</span></span>

<span data-ttu-id="24501-1261">En la red IPv4, la suma de comprobación de UDP es opcional.</span><span class="sxs-lookup"><span data-stu-id="24501-1261">On the IPv4 network, UDP checksum is optional.</span></span> <span data-ttu-id="24501-1262">NetX Duo permite a una aplicación habilitar o deshabilitar el cálculo de la suma de comprobación de UDP por cada socket.</span><span class="sxs-lookup"><span data-stu-id="24501-1262">NetX Duo allows an application to enable or disable UDP checksum calculation on a per-socket basis.</span></span> <span data-ttu-id="24501-1263">De manera predeterminada, la lógica de la suma de comprobación del socket UDP está habilitada.</span><span class="sxs-lookup"><span data-stu-id="24501-1263">By default, the UDP socket checksum logic is enabled.</span></span> <span data-ttu-id="24501-1264">La aplicación puede deshabilitar la lógica de la suma de comprobación para un socket UDP determinado mediante una llamada al servicio \***nx_udp_socket_checksum_disable** _.</span><span class="sxs-lookup"><span data-stu-id="24501-1264">The application can disable checksum logic for a particular UDP socket by calling the \***nx_udp_socket_checksum_disable** _ service.</span></span> <span data-ttu-id="24501-1265">En la red IPv6, sin embargo, la suma de comprobación de UDP es obligatoria.</span><span class="sxs-lookup"><span data-stu-id="24501-1265">On the IPv6 network, however, UDP checksum is mandatory.</span></span> <span data-ttu-id="24501-1266">Por lo tanto, el servicio _ *_nx_udp_socket_checksum_disable_*\* no deshabilitaría la lógica de suma de comprobación de UDP al enviar un paquete a través de la red IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1266">Therefore, the service _ *_nx_udp_socket_checksum_disable_*\* would not disable UDP checksum logic when sending a packet through the IPv6 network.</span></span>

<span data-ttu-id="24501-1267">Algunos controladores Ethernet pueden generar la suma de comprobación de UDP sobre la marcha.</span><span class="sxs-lookup"><span data-stu-id="24501-1267">Certain Ethernet controllers are able to generate the UDP checksum on the fly.</span></span> <span data-ttu-id="24501-1268">Si el sistema puede usar la característica de cálculo de la suma de comprobación por hardware, la biblioteca de NetX Duo se puede compilar sin la lógica de la suma de comprobación.</span><span class="sxs-lookup"><span data-stu-id="24501-1268">If the system is able to use hardware checksum computation feature, the NetX Duo library can be built without the checksum logic.</span></span> <span data-ttu-id="24501-1269">Para deshabilitar la suma de comprobación del software UDP, la biblioteca de NetX Duo debe compilarse con los siguientes símbolos definidos: ***NX_DISABLE_UDP_TX_CHECKSUM** _ y _*_NX_DISABLE_UDP_RX_CHECKSUM_\*_ (se describen en el segundo capítulo).</span><span class="sxs-lookup"><span data-stu-id="24501-1269">To disable UDP software checksum, the NetX Duo library must be built with the following symbols defined: ***NX_DISABLE_UDP_TX_CHECKSUM** _ and _*_NX_DISABLE_UDP_RX_CHECKSUM_\*_ (described in Chapter two).</span></span> <span data-ttu-id="24501-1270">Las opciones de configuración quitan completamente la lógica de suma de comprobación de UDP de NetX Duo, mientras que la llamada al servicio _ *_nx_udp_socket_checksum_disable_*\* permite a la aplicación deshabilitar el procesamiento de suma de comprobación de UDP de IPv4 por socket.</span><span class="sxs-lookup"><span data-stu-id="24501-1270">The configuration options remove UDP checksum logic from NetX Duo entirely, while calling the _ *_nx_udp_socket_checksum_disable_*\* service allows the application to disable IPv4 UDP checksum processing on a per socket basis.</span></span>

### <a name="udp-ports-and-binding"></a><span data-ttu-id="24501-1271">Enlaces y puertos UDP</span><span class="sxs-lookup"><span data-stu-id="24501-1271">UDP Ports and Binding</span></span>      
<span data-ttu-id="24501-1272">Un puerto UDP es un punto de conexión lógico en el protocolo UDP.</span><span class="sxs-lookup"><span data-stu-id="24501-1272">A UDP port is a logical end point in the UDP protocol.</span></span> <span data-ttu-id="24501-1273">Hay 65 535 puertos válidos en el componente de UDP de NetX Duo, que van del 1 al 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="24501-1273">There are 65,535 valid ports in the UDP component of NetX Duo, ranging from 1 through 0xFFFF.</span></span> <span data-ttu-id="24501-1274">Para enviar o recibir datos UDP, la aplicación debe crear primero un socket UDP y, a continuación, enlazarlo al puerto deseado.</span><span class="sxs-lookup"><span data-stu-id="24501-1274">To send or receive UDP data, the application must first create a UDP socket, then bind it to a desired port.</span></span> <span data-ttu-id="24501-1275">Después de enlazar un socket UDP a un puerto, la aplicación puede enviar y recibir datos en ese socket.</span><span class="sxs-lookup"><span data-stu-id="24501-1275">After binding a UDP socket to a port, the application may send and receive data on that socket.</span></span>

### <a name="udp-fast-pathtrade"></a><span data-ttu-id="24501-1276">UDP Fast Path&trade;</span><span class="sxs-lookup"><span data-stu-id="24501-1276">UDP Fast Path&trade;</span></span>   
<span data-ttu-id="24501-1277">UDP Fast Path&trade; es el nombre de una ruta de baja sobrecarga de paquetes mediante la implementación de UDP de NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-1277">The UDP Fast Path&trade; is the name for a low packet overhead path through the NetX Duo UDP implementation.</span></span> <span data-ttu-id="24501-1278">El envío de un paquete UDP requiere solo algunas llamadas de función: ***nx_udp_socket_send** _, _*_nx_ip_packet_send_\*_ y la llamada eventual al controlador de red.</span><span class="sxs-lookup"><span data-stu-id="24501-1278">Sending a UDP packet requires just a few function calls: ***nx_udp_socket_send** _, _*_nx_ip_packet_send_\*_, and the eventual call to the network driver.</span></span> <span data-ttu-id="24501-1279">_*_nx_udp_socket_send_*_ está disponible en NetX Duo para las aplicaciones de NETX existentes y solo es aplicable a los paquetes IPv4.</span><span class="sxs-lookup"><span data-stu-id="24501-1279">_*_nx_udp_socket_send_*_ is available in NetX Duo for existing NetX applications and is only applicable for IPv4 packets.</span></span> <span data-ttu-id="24501-1280">Sin embargo, el método preferido es usar el servicio _ *_nxd_udp_socket_send_*\* que se describe a continuación.</span><span class="sxs-lookup"><span data-stu-id="24501-1280">The preferred method, however, is to use _ *_nxd_udp_socket_send_*\* service discussed below.</span></span> <span data-ttu-id="24501-1281">En la recepción de paquetes UDP, el paquete UDP se coloca en la cola de recepción del socket UDP adecuado o se entrega a un subproceso de la aplicación en suspensión en una única llamada de función desde el procesamiento de interrupciones de recepción del controlador de red.</span><span class="sxs-lookup"><span data-stu-id="24501-1281">On UDP packet reception, the UDP packet is either placed on the appropriate UDP socket receive queue or delivered to a suspended application thread in a single function call from the network driver's receive interrupt processing.</span></span> <span data-ttu-id="24501-1282">Esta lógica altamente optimizada para enviar y recibir paquetes UDP es la esencia de la tecnología UDP Fast Path.</span><span class="sxs-lookup"><span data-stu-id="24501-1282">This highly optimized logic for sending and receiving UDP packets is the essence of UDP Fast Path technology.</span></span>  

### <a name="udp-packet-send"></a><span data-ttu-id="24501-1283">Envío de paquetes UDP</span><span class="sxs-lookup"><span data-stu-id="24501-1283">UDP Packet Send</span></span>    
<span data-ttu-id="24501-1284">El envío de datos UDP mediante redes IPv6 o IPv4 se realiza fácilmente mediante una llamada a la función \***nxd_udp_socket_send** _.</span><span class="sxs-lookup"><span data-stu-id="24501-1284">Sending UDP data over IPv6 or IPv4 networks is easily accomplished by calling the \***nxd_udp_socket_send** _ function.</span></span> <span data-ttu-id="24501-1285">El autor de la llamada debe establecer la versión de IP en el campo _nx_ip_version\* del parámetro de puntero NXD_ADDRESS.</span><span class="sxs-lookup"><span data-stu-id="24501-1285">The caller must set the IP version in the _nx_ip_version\* field of the NXD_ADDRESS pointer parameter.</span></span> <span data-ttu-id="24501-1286">NetX Duo determinará la mejor dirección de origen para los paquetes UDP transmitidos en función de la dirección IPv4/IPv6 de destino.</span><span class="sxs-lookup"><span data-stu-id="24501-1286">NetX Duo will determine the best source address for transmitted UDP packets based on the destination IPv4/IPv6 address.</span></span> <span data-ttu-id="24501-1287">Este servicio coloca un encabezado UDP delante de los datos del paquete y lo envía a la red mediante una rutina interna de envío IP.</span><span class="sxs-lookup"><span data-stu-id="24501-1287">This service places a UDP header in front of the packet data and sends it out onto the network using an internal IP send routine.</span></span> <span data-ttu-id="24501-1288">No hay ninguna suspensión de subprocesos en el envío de paquetes UDP porque todas las transmisiones de paquetes UDP se procesan inmediatamente.</span><span class="sxs-lookup"><span data-stu-id="24501-1288">There is no thread suspension on sending UDP packets because all UDP packet transmissions are processed immediately.</span></span> 

<span data-ttu-id="24501-1289">En el caso de los destinos de multidifusión o de difusión, la aplicación debe especificar la dirección IP de origen que se usará si el dispositivo con NetX Duo tiene varias direcciones IP para elegir.</span><span class="sxs-lookup"><span data-stu-id="24501-1289">For multicast or broadcast destinations, the application should specify the source IP address to use if the NetX Duo device has multiple IP addresses to choose from.</span></span> <span data-ttu-id="24501-1290">Esto se puede realizar con el servicio ***nxd_udp_socket_source_send.***</span><span class="sxs-lookup"><span data-stu-id="24501-1290">This can be done with the services ***nxd_udp_socket_source_send.***</span></span>

> [!IMPORTANT]    
> <span data-ttu-id="24501-1291">*Si se usa **nx_udp_socket_send** para transmitir paquetes de multidifusión o de difusión, se utiliza la dirección IP de la primera interfaz habilitada como dirección de origen*.</span><span class="sxs-lookup"><span data-stu-id="24501-1291">*If **nx_udp_socket_send** is used for transmitting multicast or broadcast packets, the IP address of the first enabled interface is used as source address*.</span></span>

> [!NOTE] 
> <span data-ttu-id="24501-1292">*Si la lógica de la suma de comprobación de UDP está habilitada para este socket, la operación de suma de comprobación se realiza en el contexto del subproceso de llamada, sin bloquear el acceso a las estructuras de datos de UDP o IP.*</span><span class="sxs-lookup"><span data-stu-id="24501-1292">*If UDP checksum logic is enabled for this socket, the checksum operation is performed in the context of the calling thread, without blocking access to the UDP or IP data structures*.</span></span> 

> [!WARNING]    
> <span data-ttu-id="24501-1293">*Los datos de la carga UDP que residen en la estructura NX_PACKET deben residir en un límite de palabra larga. La aplicación debe dejar espacio suficiente entre el puntero antepuesto y el puntero de inicio de datos de NetX Duo para colocar los encabezados del soporte físico, IP y UDP*.</span><span class="sxs-lookup"><span data-stu-id="24501-1293">*The UDP payload data residing in the NX_PACKET structure should reside on a long-word boundary. The application needs to leave sufficient space between the prepend pointer and the data start pointer for NetX Duo to place the UDP, IP, and physical media headers*.</span></span>

### <a name="udp-packet-receive"></a><span data-ttu-id="24501-1294">Recepción de paquetes UDP</span><span class="sxs-lookup"><span data-stu-id="24501-1294">UDP Packet Receive</span></span>    
<span data-ttu-id="24501-1295">Los subprocesos de la aplicación pueden recibir paquetes UDP de un socket determinado mediante una llamada a ***nx_udp_socket_receive***.</span><span class="sxs-lookup"><span data-stu-id="24501-1295">Application threads may receive UDP packets from a particular socket by calling ***nx_udp_socket_receive***.</span></span> <span data-ttu-id="24501-1296">La función de recepción del socket entrega el paquete más antiguo de la cola de recepción del socket.</span><span class="sxs-lookup"><span data-stu-id="24501-1296">The socket receive function delivers the oldest packet on the socket's receive queue.</span></span> <span data-ttu-id="24501-1297">Si no hay paquetes en la cola de recepción, el subproceso de llamada se puede suspender (con un tiempo de espera opcional) hasta que llegue un paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-1297">If there are no packets on the receive queue, the calling thread can suspend (with an optional timeout) until a packet arrives.</span></span>

<span data-ttu-id="24501-1298">El procesamiento de paquetes de recepción de UDP (normalmente llamado desde el controlador de interrupciones de recepción del controlador de red) es responsable de colocar el paquete en la cola de recepción del socket UDP o de entregarlo al primer subproceso suspendido en espera de un paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-1298">The UDP receive packet processing (usually called from the network driver's receive interrupt handler) is responsible for either placing the packet on the UDP socket's receive queue or delivering it to the first suspended thread waiting for a packet.</span></span> <span data-ttu-id="24501-1299">Si el paquete está en cola, el procesamiento de recepción también comprueba la profundidad máxima de la cola de recepción asociada al socket.</span><span class="sxs-lookup"><span data-stu-id="24501-1299">If the packet is queued, the receive processing also checks the maximum receive queue depth associated with the socket.</span></span> <span data-ttu-id="24501-1300">Si este paquete recién puesto en cola supera la profundidad de la cola, se descarta el paquete más antiguo de la cola.</span><span class="sxs-lookup"><span data-stu-id="24501-1300">If this newly queued packet exceeds the queue depth, the oldest packet in the queue is discarded.</span></span>

### <a name="udp-receive-notify"></a><span data-ttu-id="24501-1301">Notificación de recepción de UDP</span><span class="sxs-lookup"><span data-stu-id="24501-1301">UDP Receive Notify</span></span>   
<span data-ttu-id="24501-1302">Si el subproceso de la aplicación debe procesar los datos recibidos de más de un socket, se debe usar la función ***nx_udp_socket_receive_notify***.</span><span class="sxs-lookup"><span data-stu-id="24501-1302">If the application thread needs to process received data from more than one socket, the ***nx_udp_socket_receive_notify*** function should be used.</span></span> <span data-ttu-id="24501-1303">Esta función registra una función de devolución de llamada de paquetes de recepción para el socket.</span><span class="sxs-lookup"><span data-stu-id="24501-1303">This function registers a receive packet callback function for the socket.</span></span> <span data-ttu-id="24501-1304">Cada vez que se recibe un paquete en el socket, se ejecuta la función de devolución de llamada.</span><span class="sxs-lookup"><span data-stu-id="24501-1304">Whenever a packet is received on the socket, the callback function is executed.</span></span>

<span data-ttu-id="24501-1305">El contenido de la función de devolución de llamada es específico de la aplicación; sin embargo, lo más probable es que contenga lógica para notificar al subproceso de procesamiento que un paquete ahora está disponible en el socket correspondiente.</span><span class="sxs-lookup"><span data-stu-id="24501-1305">The contents of the callback function is applicationspecific; however, it would most likely contain logic to inform the processing thread that a packet is now available on the corresponding socket.</span></span>

### <a name="peer-address-and-port"></a><span data-ttu-id="24501-1306">Dirección y puerto del mismo nivel</span><span class="sxs-lookup"><span data-stu-id="24501-1306">Peer Address and Port</span></span>   
<span data-ttu-id="24501-1307">Al recibir un paquete UDP, la aplicación puede encontrar el número de puerto y la dirección IP del remitente mediante el servicio ***nx_udp_packet_info_extract***.</span><span class="sxs-lookup"><span data-stu-id="24501-1307">On receiving a UDP packet, application may find the sender's IP address and port number by using the service ***nx_udp_packet_info_extract***.</span></span> <span data-ttu-id="24501-1308">Si la devolución es correcta, este servicio proporciona información sobre la dirección IP del remitente, el número de puerto del remitente y la interfaz local a través de la cual se recibió el paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-1308">On successful return, this service provides information on the sender's IP address, sender's port number, and the local interface through which the packet was received.</span></span>  

### <a name="thread-suspension"></a><span data-ttu-id="24501-1309">Suspensión de subprocesos</span><span class="sxs-lookup"><span data-stu-id="24501-1309">Thread Suspension</span></span>   
<span data-ttu-id="24501-1310">Como se mencionó anteriormente, los subprocesos de la aplicación se pueden suspender al intentar recibir un paquete UDP en un puerto UDP determinado.</span><span class="sxs-lookup"><span data-stu-id="24501-1310">As mentioned previously, application threads can suspend while attempting to receive a UDP packet on a particular UDP port.</span></span> <span data-ttu-id="24501-1311">Una vez que se recibe un paquete en ese puerto, se asigna al primer subproceso suspendido y, a continuación, se reanuda el subproceso.</span><span class="sxs-lookup"><span data-stu-id="24501-1311">After a packet is received on that port, it is given to the first thread suspended and that thread is then resumed.</span></span> <span data-ttu-id="24501-1312">Existe un tiempo de espera opcional disponible cuando hay una suspensión en la recepción de un paquete UDP, una característica disponible para la mayoría de los servicios de NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-1312">An optional timeout is available when suspending on a UDP receive packet, a feature available for most NetX Duo services.</span></span>  

### <a name="udp-socket-statistics-and-errors"></a><span data-ttu-id="24501-1313">Estadísticas y errores del socket UDP</span><span class="sxs-lookup"><span data-stu-id="24501-1313">UDP Socket Statistics and Errors</span></span>     
<span data-ttu-id="24501-1314">Si se habilita, el software de socket UDP de NetX Duo realiza un seguimiento de varios errores y estadísticas que pueden ser útiles para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-1314">If enabled, the NetX Duo UDP socket software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="24501-1315">Se mantienen las estadísticas y los informes de errores siguientes para cada instancia de IP/UDP:</span><span class="sxs-lookup"><span data-stu-id="24501-1315">The following statistics and error reports are maintained for each IP/UDP instance:</span></span>

- <span data-ttu-id="24501-1316">Número total de paquetes UDP enviados</span><span class="sxs-lookup"><span data-stu-id="24501-1316">Total UDP Packets Sent</span></span>  
- <span data-ttu-id="24501-1317">Número total de bytes UDP enviados</span><span class="sxs-lookup"><span data-stu-id="24501-1317">Total UDP Bytes Sent</span></span>  
- <span data-ttu-id="24501-1318">Número total de paquetes UDP recibidos</span><span class="sxs-lookup"><span data-stu-id="24501-1318">Total UDP Packets Received</span></span>   
- <span data-ttu-id="24501-1319">Número total de bytes UDP recibidos</span><span class="sxs-lookup"><span data-stu-id="24501-1319">Total UDP Bytes Received</span></span>  
- <span data-ttu-id="24501-1320">Número total de paquetes UDP no válidos</span><span class="sxs-lookup"><span data-stu-id="24501-1320">Total UDP Invalid Packets</span></span>  
- <span data-ttu-id="24501-1321">Número total de paquetes de recepción de UDP eliminados</span><span class="sxs-lookup"><span data-stu-id="24501-1321">Total UDP Receive Packets Dropped</span></span>  
- <span data-ttu-id="24501-1322">Número total de errores de suma de comprobación de recepción de UDP</span><span class="sxs-lookup"><span data-stu-id="24501-1322">Total UDP Receive Checksum Errors</span></span>  
- <span data-ttu-id="24501-1323">Paquetes de socket UDP enviados</span><span class="sxs-lookup"><span data-stu-id="24501-1323">UDP Socket Packets Sent</span></span>  
- <span data-ttu-id="24501-1324">Bytes de socket UDP enviados</span><span class="sxs-lookup"><span data-stu-id="24501-1324">UDP Socket Bytes Sent</span></span>  
- <span data-ttu-id="24501-1325">Paquetes de socket UDP recibidos</span><span class="sxs-lookup"><span data-stu-id="24501-1325">UDP Socket Packets Received</span></span>   
- <span data-ttu-id="24501-1326">Bytes de socket UDP recibidos</span><span class="sxs-lookup"><span data-stu-id="24501-1326">UDP Socket Bytes Received</span></span>  
- <span data-ttu-id="24501-1327">Paquetes de socket UDP puestos en cola</span><span class="sxs-lookup"><span data-stu-id="24501-1327">UDP Socket Packets Queued</span></span>  
- <span data-ttu-id="24501-1328">Paquetes de recepción de socket UDP eliminados</span><span class="sxs-lookup"><span data-stu-id="24501-1328">UDP Socket Receive Packets Dropped</span></span>  
- <span data-ttu-id="24501-1329">Errores de suma de comprobación de socket UDP</span><span class="sxs-lookup"><span data-stu-id="24501-1329">UDP Socket Checksum Errors</span></span>  

<span data-ttu-id="24501-1330">Todos estos informes de errores y estadísticas están disponibles para la aplicación con el servicio ***nx_udp_info_get** _ para las estadísticas acumuladas de UDP en todos los sockets UDP y el servicio _ *_nx_udp_socket_info_get_** para las estadísticas de UDP en el socket UDP especificado.</span><span class="sxs-lookup"><span data-stu-id="24501-1330">All these statistics and error reports are available to the application with the ***nx_udp_info_get** _ service for UDP statistics amassed over all UDP sockets, and the _ *_nx_udp_socket_info_get_** service for UDP statistics on the specified UDP socket.</span></span>

### <a name="udp-socket-control-block-nx_udp_socket"></a><span data-ttu-id="24501-1331">Bloque de control de socket UDP NX_UDP_SOCKET</span><span class="sxs-lookup"><span data-stu-id="24501-1331">UDP Socket Control Block NX_UDP_SOCKET</span></span>
<span data-ttu-id="24501-1332">Las características de cada socket UDP se encuentran en el bloque de control NX_UDP_SOCKET asociado.</span><span class="sxs-lookup"><span data-stu-id="24501-1332">The characteristics of each UDP socket are found in the associated NX_UDP_SOCKET control block.</span></span> <span data-ttu-id="24501-1333">Contiene información útil, como el vínculo a la estructura de datos IP, la interfaz de red para las rutas de acceso de envío y recepción, el puerto enlazado y la cola de paquetes de recepción.</span><span class="sxs-lookup"><span data-stu-id="24501-1333">It contains useful information such as the link to the IP data structure, the network interface for the sending and receiving paths, the bound port, and the receive packet queue.</span></span> <span data-ttu-id="24501-1334">Esta estructura se define en el archivo ***tx_api.h***.</span><span class="sxs-lookup"><span data-stu-id="24501-1334">This structure is defined in the ***nx_api.h*** file.</span></span>

## <a name="transmission-control-protocol-tcp"></a><span data-ttu-id="24501-1335">Protocolo de control de transmisión (TCP)</span><span class="sxs-lookup"><span data-stu-id="24501-1335">Transmission Control Protocol (TCP)</span></span>

<span data-ttu-id="24501-1336">El Protocolo de control de transmisión (TCP) proporciona transferencia de datos de secuencia confiable entre dos miembros de la red (RFC 793).</span><span class="sxs-lookup"><span data-stu-id="24501-1336">The Transmission Control Protocol (TCP) provides reliable stream data transfer between two network members (RFC 793).</span></span> <span data-ttu-id="24501-1337">El miembro receptor comprueba y confirma todos los datos enviados desde un miembro de la red.</span><span class="sxs-lookup"><span data-stu-id="24501-1337">All data sent from one network member are verified and acknowledged by the receiving member.</span></span> <span data-ttu-id="24501-1338">Además, los dos miembros deben haber establecido una conexión antes de cualquier transferencia de datos.</span><span class="sxs-lookup"><span data-stu-id="24501-1338">In addition, the two members must have established a connection prior to any data transfer.</span></span> <span data-ttu-id="24501-1339">Todo esto produce una transferencia de datos confiable; sin embargo, requiere bastante más sobrecarga que la transferencia de datos UDP descrita previamente.</span><span class="sxs-lookup"><span data-stu-id="24501-1339">All this results in reliable data transfer; however, it does require substantially more overhead than the previously described UDP data transfer.</span></span>

<span data-ttu-id="24501-1340">Excepto en los casos en los que se indique, no hay ningún cambio en los servicios de API del protocolo TCP entre NetX y NetX Duo, ya que IPv6 se preocupa principalmente del nivel de IP subyacente.</span><span class="sxs-lookup"><span data-stu-id="24501-1340">Except where noted, there are no changes in TCP protocol API services between NetX and NetX Duo because IPv6 is primarily concerned with the underlying IP layer.</span></span> <span data-ttu-id="24501-1341">Todos los servicios de TCP de NetX Duo se pueden usar para conexiones IPv4 o IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1341">All NetX Duo TCP services can be used for either IPv4 or IPv6 connections.</span></span>

### <a name="tcp-header"></a><span data-ttu-id="24501-1342">Encabezado TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1342">TCP Header</span></span>   
<span data-ttu-id="24501-1343">En la transmisión, el encabezado TCP se coloca delante de los datos del usuario.</span><span class="sxs-lookup"><span data-stu-id="24501-1343">On transmission, TCP header is placed in front of the data from the user.</span></span> <span data-ttu-id="24501-1344">En la recepción, el encabezado TCP se quita del paquete entrante y solo están disponibles para la aplicación los datos del usuario.</span><span class="sxs-lookup"><span data-stu-id="24501-1344">On reception, TCP header is removed from the incoming packet, leaving only the user data available to the application.</span></span> <span data-ttu-id="24501-1345">TCP emplea el protocolo IP para enviar y recibir paquetes, lo que significa que hay un encabezado IP delante del encabezado TCP cuando el paquete está en la red.</span><span class="sxs-lookup"><span data-stu-id="24501-1345">TCP utilizes the IP protocol to send and receive packets, which means there is an IP header in front of the TCP header when the packet is on the network.</span></span> <span data-ttu-id="24501-1346">En la figura 13 se muestra el formato del encabezado TCP.</span><span class="sxs-lookup"><span data-stu-id="24501-1346">Figure 13 shows the format of the TCP header.</span></span>

![Diagrama del formato de encabezado TCP.](./media/user-guide/image22.png)

### <a name="figure-13-tcp-header"></a><span data-ttu-id="24501-1348">FIGURA 13.</span><span class="sxs-lookup"><span data-stu-id="24501-1348">FIGURE 13.</span></span> <span data-ttu-id="24501-1349">Encabezado TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1349">TCP Header</span></span>

<span data-ttu-id="24501-1350">A continuación se describe el formato de encabezado TCP:</span><span class="sxs-lookup"><span data-stu-id="24501-1350">The following describes the TCP header format:</span></span>

|<span data-ttu-id="24501-1351">Campo de&nbsp;encabezado</span><span class="sxs-lookup"><span data-stu-id="24501-1351">Header&nbsp;Field</span></span> |<span data-ttu-id="24501-1352">Fin</span><span class="sxs-lookup"><span data-stu-id="24501-1352">Purpose</span></span> |
|------|------|
| <span data-ttu-id="24501-1353">**Número de puerto de origen de 16 bits**</span><span class="sxs-lookup"><span data-stu-id="24501-1353">**16-bit source port number**</span></span> | <span data-ttu-id="24501-1354">Este campo contiene el puerto por el que se envía el paquete TCP.</span><span class="sxs-lookup"><span data-stu-id="24501-1354">This field contains the port the TCP packet is being sent out on.</span></span> <span data-ttu-id="24501-1355">El intervalo de puertos TCP válidos va del 1 al 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="24501-1355">Valid TCP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="24501-1356">**Puerto de destino de 16 bits**</span><span class="sxs-lookup"><span data-stu-id="24501-1356">**16-bit destination port**</span></span> | <span data-ttu-id="24501-1357">Este campo contiene el puerto al que se envía el paquete TCP.</span><span class="sxs-lookup"><span data-stu-id="24501-1357">This field contains the TCP port the packet is being sent to.</span></span> <span data-ttu-id="24501-1358">El intervalo de puertos TCP válidos va del 1 al 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="24501-1358">Valid TCP ports range from 1 through 0xFFFF.</span></span> |
| <span data-ttu-id="24501-1359">**Número de secuencia de 32 bits**</span><span class="sxs-lookup"><span data-stu-id="24501-1359">**32-bit sequence number**</span></span> | <span data-ttu-id="24501-1360">Este campo contiene el número de secuencia de los datos enviados desde este extremo de la conexión.</span><span class="sxs-lookup"><span data-stu-id="24501-1360">This field contains the sequence number for data sent from this end of the connection.</span></span> <span data-ttu-id="24501-1361">La secuencia original se establece durante la secuencia de conexión inicial entre dos nodos TCP.</span><span class="sxs-lookup"><span data-stu-id="24501-1361">The original sequence is established during the initial connection sequence between two TCP nodes.</span></span> <span data-ttu-id="24501-1362">Cada transferencia de datos desde ese punto da lugar a un incremento del número de secuencia en la cantidad de bytes enviados.</span><span class="sxs-lookup"><span data-stu-id="24501-1362">Every data transfer from that point results in an increment of the sequence number by the amount bytes sent.</span></span> |
| <span data-ttu-id="24501-1363">**Número de confirmación de 32 bits**</span><span class="sxs-lookup"><span data-stu-id="24501-1363">**32-bit acknowledgement number**</span></span> | <span data-ttu-id="24501-1364">Este campo contiene el número de secuencia correspondiente al último byte recibido por este lado de la conexión.</span><span class="sxs-lookup"><span data-stu-id="24501-1364">This field contains the sequence number corresponding to the last byte received by this side of the connection.</span></span> <span data-ttu-id="24501-1365">Se utiliza para determinar si el otro extremo de la conexión ha recibido correctamente o no los datos que se han enviado anteriormente.</span><span class="sxs-lookup"><span data-stu-id="24501-1365">This is used to determine whether or not data previously sent has successfully been received by the other end of the connection.</span></span> |
| <span data-ttu-id="24501-1366">**Longitud del encabezado de 4 bits**</span><span class="sxs-lookup"><span data-stu-id="24501-1366">**4-bit header length**</span></span> | <span data-ttu-id="24501-1367">Este campo contiene el número de palabras de 32 bits que hay en el encabezado TCP.</span><span class="sxs-lookup"><span data-stu-id="24501-1367">This field contains the number of 32-bit words in the TCP header.</span></span> <span data-ttu-id="24501-1368">Si no hay opciones en el encabezado TCP, el valor de este campo es 5.</span><span class="sxs-lookup"><span data-stu-id="24501-1368">If no options are present in the TCP header, this field is 5.</span></span> |
| <span data-ttu-id="24501-1369">**Bits de código de 6 bits**</span><span class="sxs-lookup"><span data-stu-id="24501-1369">**6-bit code bits**</span></span> |<span data-ttu-id="24501-1370">Este campo contiene los seis bits de código diferentes que se usan para indicar diversa información de control asociada a la conexión.</span><span class="sxs-lookup"><span data-stu-id="24501-1370">This field contains the six different code bits used to indicate various control information associated with the connection.</span></span> <span data-ttu-id="24501-1371">Los bits de control se definen de la siguiente manera: <br \> - URG (21): datos de urgencia<br \> - ACK (20): el número de confirmación es válido<br \> - PSH (19): controlar estos datos inmediatamente<br \> - RST (18): restablecer la conexión<br \> - SYN (17): sincronizar los números de secuencia (se usa para establecer la conexión) <br \> - FIN (16): el remitente ha finalizado con la transmisión (se usa para la conexión)</span><span class="sxs-lookup"><span data-stu-id="24501-1371">The control bits are defined as follows:<br \> - URG (21): Urgent data presen<br \> - ACK (20): Acknowledgement number is valid<br \> - PSH (19): Handle this data immediately<br \> - RST (18): Reset the connection<br \> - SYN (17): Synchronize sequence numbers (used to establish connection)<br \> - FIN (16): Sender is finished with transmit (used to close connection)</span></span> |
|<span data-ttu-id="24501-1372">**Ventana de 16 bits**</span><span class="sxs-lookup"><span data-stu-id="24501-1372">**16-bit window**</span></span> |<span data-ttu-id="24501-1373">Este campo se usa para el control de flujo.</span><span class="sxs-lookup"><span data-stu-id="24501-1373">This field is used for flow control.</span></span> <span data-ttu-id="24501-1374">Contiene la cantidad de bytes que el socket puede recibir actualmente.</span><span class="sxs-lookup"><span data-stu-id="24501-1374">It contains the amount of bytes the socket can currently receive.</span></span> <span data-ttu-id="24501-1375">Básicamente se usa para el control de flujo.</span><span class="sxs-lookup"><span data-stu-id="24501-1375">This basically is used for flow control.</span></span> <span data-ttu-id="24501-1376">El remitente es responsable de asegurarse de que los datos que se van a enviar se ajustan a la ventana anunciada del receptor.</span><span class="sxs-lookup"><span data-stu-id="24501-1376">The sender is responsible for making sure the data to send will fit into the receiver's advertised window.</span></span> |
|<span data-ttu-id="24501-1377">**Suma de comprobación de TCP de 16 bits**</span><span class="sxs-lookup"><span data-stu-id="24501-1377">**16-bit TCP checksum**</span></span> |<span data-ttu-id="24501-1378">Este campo contiene la suma de comprobación de 16 bits del paquete, incluidos el encabezado TCP, el área de datos del paquete y el pseudoencabezado IP.</span><span class="sxs-lookup"><span data-stu-id="24501-1378">This field contains the 16-bit checksum for the packet including the TCP header, the packet data area, and the pseudo IP header.</span></span> |
|<span data-ttu-id="24501-1379">**Puntero urgente de 16 bits**</span><span class="sxs-lookup"><span data-stu-id="24501-1379">**16-bit urgent pointer**</span></span> |<span data-ttu-id="24501-1380">Este campo contiene el desplazamiento positivo del último byte de los datos urgentes.</span><span class="sxs-lookup"><span data-stu-id="24501-1380">This field contains the positive offset of the last byte of the urgent data.</span></span> <span data-ttu-id="24501-1381">Este campo solo es válido si se establece en el encabezado el bit de código URG.</span><span class="sxs-lookup"><span data-stu-id="24501-1381">This field is only valid if the URG code bit is set in the header.</span></span> |

> [!NOTE]  
> <span data-ttu-id="24501-1382">*Se espera que todos los encabezados de la implementación de TCP/IP estén en formato **big endian**. En este formato, el byte más significativo de la palabra reside en la dirección de bytes más baja.*</span><span class="sxs-lookup"><span data-stu-id="24501-1382">*All headers in the TCP/IP implementation are expected to be in **big endian** format. In this format, the most significant byte of the word resides at the lowest byte address*.</span></span>

### <a name="tcp-enable"></a><span data-ttu-id="24501-1383">Habilitación de TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1383">TCP Enable</span></span>       
<span data-ttu-id="24501-1384">Antes de que las conexiones TCP y las transmisiones de paquetes sean posibles, la aplicación debe habilitar primero TCP mediante una llamada al servicio ***nx_tcp_enable***.</span><span class="sxs-lookup"><span data-stu-id="24501-1384">Before TCP connections and packet transmissions are possible, the application must first enable TCP by calling the ***nx_tcp_enable*** service.</span></span> <span data-ttu-id="24501-1385">Una vez habilitada, la aplicación puede acceder a todos los servicios de TCP.</span><span class="sxs-lookup"><span data-stu-id="24501-1385">After enabled, the application is free to access all TCP services.</span></span>  

### <a name="tcp-socket-create"></a><span data-ttu-id="24501-1386">Creación de sockets TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1386">TCP Socket Create</span></span>    
<span data-ttu-id="24501-1387">Los sockets TCP se crean durante la inicialización o en tiempo de ejecución mediante subprocesos de la aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-1387">TCP sockets are created either during initialization or during runtime by application threads.</span></span> <span data-ttu-id="24501-1388">En el servicio ***nx_tcp_socket_create*** se definen el tipo inicial de servicio, el período de vida y el tamaño de la ventana.</span><span class="sxs-lookup"><span data-stu-id="24501-1388">The initial type of service, time to live, and window size are defined by the ***nx_tcp_socket_create*** service.</span></span> <span data-ttu-id="24501-1389">No hay ningún límite en el número de sockets TCP de una aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-1389">There are no limits on the number of TCP sockets in an application.</span></span>  

### <a name="tcp-checksum"></a><span data-ttu-id="24501-1390">Suma de comprobación de TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1390">TCP Checksum</span></span>     
<span data-ttu-id="24501-1391">TCP especifica una suma de comprobación de 16 bits del complemento a uno que incluye el pseudoencabezado IP (que consta de la dirección IP de origen, la dirección IP de destino, el protocolo y la longitud de palabra de IP), el encabezado TCP y los datos del paquete TCP.</span><span class="sxs-lookup"><span data-stu-id="24501-1391">TCP specifies a one's complement 16-bit checksum that covers the IP pseudo header, (consisting of the source IP address, destination IP address, and the protocol/length IP word), the TCP header, and the TCP packet data.</span></span> <span data-ttu-id="24501-1392">La única diferencia entre las sumas de comprobación de encabezado de paquete TCP IPv4 e IPv6 es que las direcciones IP de origen y destino son de 32 bits en IPv4 y 128 bits en IPv6.</span><span class="sxs-lookup"><span data-stu-id="24501-1392">The only difference between IPv4 and IPv6 TCP packet header checksums is that the source and destination IP addresses are 32 bit in IPv4 and 128 bit in IPv6.</span></span> 

<span data-ttu-id="24501-1393">Algunos controladores de red pueden realizar el cálculo y la validación de la suma de comprobación de TCP por hardware.</span><span class="sxs-lookup"><span data-stu-id="24501-1393">Certain network controllers are able to perform TCP checksum computation and validation in hardware.</span></span> <span data-ttu-id="24501-1394">En estos sistemas, es posible que las aplicaciones deseen usar la lógica de la suma de comprobación por hardware tanto como sea posible para reducir la sobrecarga en tiempo de ejecución.</span><span class="sxs-lookup"><span data-stu-id="24501-1394">For such systems, applications may want to use hardware checksum logic as much as possible to reduce runtime overhead.</span></span> <span data-ttu-id="24501-1395">Las aplicaciones pueden deshabilitar por completo la lógica del cálculo de la suma de comprobación de TCP de la biblioteca de NetX en tiempo de compilación mediante la definición de ***NX_DISABLE_TCP_TX_CHECKSUM** _ y _*_NX_DISABLE_TCP_RX_CHECKSUM_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-1395">Applications may disable TCP checksum computation logic from the NetX Duo library altogether at build time by defining ***NX_DISABLE_TCP_TX_CHECKSUM** _ and _*_NX_DISABLE_TCP_RX_CHECKSUM_\*\*.</span></span> <span data-ttu-id="24501-1396">De esta manera, el código de la suma de comprobación de TCP no se compila.</span><span class="sxs-lookup"><span data-stu-id="24501-1396">This way, the TCP checksum code is not compiled in.</span></span> <span data-ttu-id="24501-1397">Sin embargo, hay que tener cuidado si se instala el paquete IPsec de NetX Duo opcional y la conexión TCP puede necesitar atravesar un canal seguro.</span><span class="sxs-lookup"><span data-stu-id="24501-1397">However one should exercise caution if the optional NetX Duo IPsec package is installed, and the TCP connection may need to traverse through a secure channel.</span></span> <span data-ttu-id="24501-1398">En este caso, los datos de los paquetes que pertenecen a la conexión TCP ya están cifrados y la mayoría de los módulos de suma de comprobación de TCP de hardware presentes en el controlador de red no pueden generar un valor de suma de comprobación correcto a partir de la carga de TCP cifrada.</span><span class="sxs-lookup"><span data-stu-id="24501-1398">In this case, data in packets belonging to the TCP connection is already encrypted, and most hardware TCP checksum modules present in the network driver are unable to generate correct checksum value from the encrypted TCP payload.</span></span>

<span data-ttu-id="24501-1399">Para solucionar este problema, la aplicación debe mantener la lógica de la suma de comprobación de TCP disponible en la biblioteca y usar la característica de funcionalidad de interfaz.</span><span class="sxs-lookup"><span data-stu-id="24501-1399">To address this issue, application shall keep the TCP checksum logic available in the library and use the interface capability feature.</span></span> <span data-ttu-id="24501-1400">Con la característica de funcionalidad de interfaz habilitada, el módulo de TCP sabe cómo administrar correctamente la suma de comprobación de TCP si el controlador también puede calcular el valor de la suma de comprobación:</span><span class="sxs-lookup"><span data-stu-id="24501-1400">With interface capability feature enabled, the TCP module knows how to properly handle the TCP checksum if the driver is also able to compute the checksum value:</span></span>

1) <span data-ttu-id="24501-1401">Si el paquete TCP no está sujeto a un proceso IPsec, el hardware de la interfaz de red puede calcular la suma de comprobación.</span><span class="sxs-lookup"><span data-stu-id="24501-1401">If the TCP packet is not subject to IPsec process, the network interface hardware is able to compute the checksum.</span></span> <span data-ttu-id="24501-1402">Por lo tanto, el módulo de TCP no intenta calcular la suma de comprobación.</span><span class="sxs-lookup"><span data-stu-id="24501-1402">Therefore the TCP module does not attempt to compute the checksum;</span></span>

2) <span data-ttu-id="24501-1403">Si se instala el paquete IPsec y el paquete TCP está sujeto a un proceso IPsec, el módulo de TCP calcula la suma de comprobación en el software antes de enviar el paquete a la capa IPsec.</span><span class="sxs-lookup"><span data-stu-id="24501-1403">If IPsec package is installed, and the TCP packet is subject to IPsec process, the TCP module computes checksum in software before sending the packet to IPsec layer.</span></span>

### <a name="tcp-port"></a><span data-ttu-id="24501-1404">Puerto TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1404">TCP Port</span></span>     
<span data-ttu-id="24501-1405">Un puerto TCP es un punto de conexión lógico en el protocolo TCP.</span><span class="sxs-lookup"><span data-stu-id="24501-1405">A TCP port is a logical connection point in the TCP protocol.</span></span> <span data-ttu-id="24501-1406">Hay 65 535 puertos válidos en el componente de TCP de NetX Duo, que van del 1 al 0xFFFF.</span><span class="sxs-lookup"><span data-stu-id="24501-1406">There are 65,535 valid ports in the TCP component of NetX Duo, ranging from 1 through 0xFFFF.</span></span> <span data-ttu-id="24501-1407">A diferencia de UDP, en que los datos de un puerto se pueden enviar a cualquier otro puerto de destino, un puerto TCP se conecta a otro puerto TCP específico, y solo cuando se establece esta conexión se puede realizar cualquier transferencia de datos (solo entre los dos puertos que conforman la conexión).</span><span class="sxs-lookup"><span data-stu-id="24501-1407">Unlike UDP in which data from one port can be sent to any other destination port, a TCP port is connected to another specific TCP port, and only when this connection is established can any data transfer take place—and only between the two ports making up the connection.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="24501-1408">*Los puertos TCP son completamente independientes de los puertos UDP; es decir, el puerto UDP número 1 no tiene relación con el puerto TCP número 1*.</span><span class="sxs-lookup"><span data-stu-id="24501-1408">*TCP ports are completely separate from UDP ports; e.g., UDP port number 1 has no relation to TCP port number 1*.</span></span>

### <a name="client-server-model"></a><span data-ttu-id="24501-1409">Modelo cliente-servidor</span><span class="sxs-lookup"><span data-stu-id="24501-1409">Client-Server Model</span></span>     
<span data-ttu-id="24501-1410">Para usar TCP para la transferencia de datos, primero se debe establecer una conexión entre los dos sockets TCP.</span><span class="sxs-lookup"><span data-stu-id="24501-1410">To use TCP for data transfer, a connection must first be established between the two TCP sockets.</span></span> <span data-ttu-id="24501-1411">El establecimiento de la conexión se realiza en modo cliente-servidor.</span><span class="sxs-lookup"><span data-stu-id="24501-1411">The establishment of the connection is done in a client-server fashion.</span></span> <span data-ttu-id="24501-1412">El lado cliente de la conexión es el lado que inicia la conexión, mientras que el lado servidor simplemente espera las solicitudes de conexión de cliente antes de ejecutar cualquier procesamiento.</span><span class="sxs-lookup"><span data-stu-id="24501-1412">The client side of the connection is the side that initiates the connection, while the server side simply waits for client connection requests before any processing is done.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="24501-1413">*En el caso de los dispositivos de host múltiple, NetX Duo determina automáticamente la dirección de origen que se usará para la conexión y la dirección del próximo salto en función de la dirección IP de destino de la conexión. Dado que TCP está limitado a enviar paquetes a direcciones de destino de unidifusión (por ejemplo, sin difusión), NetX Duo no requiere una "sugerencia" para elegir la dirección IPv6 de origen*.</span><span class="sxs-lookup"><span data-stu-id="24501-1413">*For multihome devices, NetX Duo automatically determines the source address to use for the connection, and the next hop address based on the destination IP address of the connection. Because TCP is limited to sending packets to unicast (e.g.nonbroadcast) destination addresses, NetX Duo does not require a "hint" for choosing the source IPv6 address*.</span></span>

### <a name="tcp-socket-state-machine"></a><span data-ttu-id="24501-1414">Máquina de estados del socket TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1414">TCP Socket State Machine</span></span>      
<span data-ttu-id="24501-1415">La conexión entre dos sockets TCP (un cliente y un servidor) es compleja y se administra en modo de máquina de estados.</span><span class="sxs-lookup"><span data-stu-id="24501-1415">The connection between two TCP sockets (one client and one server) is complex and is managed in a state machine manner.</span></span> <span data-ttu-id="24501-1416">Cada socket TCP se inicia en estado CLOSED.</span><span class="sxs-lookup"><span data-stu-id="24501-1416">Each TCP socket starts in a CLOSED state.</span></span> <span data-ttu-id="24501-1417">Mediante los eventos de conexión, la máquina de estados de cada socket cambia al estado ESTABLISHED, que es donde tiene lugar la mayor parte de la transferencia de datos en TCP.</span><span class="sxs-lookup"><span data-stu-id="24501-1417">Through connection events each socket's state machine migrates into the ESTABLISHED state, which is where the bulk of the data transfer in TCP takes place.</span></span> <span data-ttu-id="24501-1418">Cuando un lado de la conexión ya no quiere enviar más datos, se desconecta.</span><span class="sxs-lookup"><span data-stu-id="24501-1418">When one side of the connection no longer wishes to send data, it disconnects.</span></span> <span data-ttu-id="24501-1419">Una vez que el otro lado se desconecta, el socket TCP vuelve al estado CLOSED.</span><span class="sxs-lookup"><span data-stu-id="24501-1419">After the other side disconnects, eventually the TCP socket returns to the CLOSED state.</span></span> <span data-ttu-id="24501-1420">Este proceso se repite cada vez que un cliente y un servidor TCP establecen y cierran una conexión.</span><span class="sxs-lookup"><span data-stu-id="24501-1420">This process repeats each time a TCP client and server establish and close a connection.</span></span> <span data-ttu-id="24501-1421">En la figura 14 se muestran los distintos estados de la máquina de estados de TCP.</span><span class="sxs-lookup"><span data-stu-id="24501-1421">Figure 14 shows the various states of the TCP state machine.</span></span>

### <a name="tcp-client-connection"></a><span data-ttu-id="24501-1422">Conexión del cliente TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1422">TCP Client Connection</span></span>       
<span data-ttu-id="24501-1423">Como se mencionó anteriormente, el lado cliente de la conexión TCP inicia una solicitud de conexión a un servidor TCP.</span><span class="sxs-lookup"><span data-stu-id="24501-1423">As mentioned previously, the client side of the TCP connection initiates a connection request to a TCP server.</span></span> <span data-ttu-id="24501-1424">Para poder realizar una solicitud de conexión, TCP debe estar habilitado en la instancia de IP del cliente.</span><span class="sxs-lookup"><span data-stu-id="24501-1424">Before a connection request can be made, TCP must be enabled on the client IP instance.</span></span> <span data-ttu-id="24501-1425">Además, el socket TCP del cliente debe crearse con el servicio \***nx_tcp_socket_create** _ y enlazarse a un puerto mediante el servicio _ \*_nx_tcp_client_socket_bind_\*\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-1425">In addition, the client TCP socket must next be created with the ***nx_tcp_socket_create** _ service and bound to a port via the _ *_nx_tcp_client_socket_bind_** service.</span></span>

<span data-ttu-id="24501-1426">Una vez enlazado el socket de cliente, se utiliza el servicio ***nxd_tcp_client_socket_connect*** se usa para establecer una conexión con un servidor TCP.</span><span class="sxs-lookup"><span data-stu-id="24501-1426">After the client socket is bound, the ***nxd_tcp_client_socket_connect*** service is used to establish a connection with a TCP server.</span></span> <span data-ttu-id="24501-1427">Tenga en cuenta que el socket debe estar en estado CLOSED para iniciar un intento de conexión.</span><span class="sxs-lookup"><span data-stu-id="24501-1427">Note the socket must be in a CLOSED state to initiate a connection attempt.</span></span> <span data-ttu-id="24501-1428">Para establecer la conexión, primero se emite un paquete SYN y, a continuación, se espera a que el servidor devuelva un paquete SYN ACK, lo que significa que se acepta la solicitud de conexión.</span><span class="sxs-lookup"><span data-stu-id="24501-1428">Establishing the connection starts with NetX Duo issuing a SYN packet and then waiting for a SYN ACK packet back from the server, which signifies acceptance of the connection request.</span></span> <span data-ttu-id="24501-1429">Una vez recibido el paquete SYN ACK, NetX Duo responde con un paquete ACK y promueve el socket de cliente al estado ESTABLISHED.</span><span class="sxs-lookup"><span data-stu-id="24501-1429">After the SYN ACK is received, NetX Duo responds with an ACK packet and promotes the client socket to the ESTABLISHED state.</span></span>

![Diagrama de los estados de la máquina de estados de TCP.](./media/user-guide/image24.png)   

<span data-ttu-id="24501-1431">**FIGURA 14. Estados de la máquina de estados de TCP**</span><span class="sxs-lookup"><span data-stu-id="24501-1431">**FIGURE 14. States of the TCP State Machine**</span></span>


> [!WARNING]
> <span data-ttu-id="24501-1432">*Las aplicaciones deben usar **nxd_tcp_client_socket_connect** para las conexiones TCP IPv4 e IPv6. Las aplicaciones pueden seguir usando **nx_tcp_client_socket_connect** para las conexiones TCP IPv4, pero se recomienda a los desarrolladores que utilicen **nxd_tcp_client_socket_connect**, ya que **nx_tcp_client_socket_connect** se dejará de usar*.</span><span class="sxs-lookup"><span data-stu-id="24501-1432">*Applications should use **nxd_tcp_client_socket_connect** for either IPv4 and IPv6 TCP connections. Applications can still use **nx_tcp_client_socket_connect** for IPv4 TCP connections, but developers are encouraged to use **nxd_tcp_client_socket_connect** since **nx_tcp_client_socket_connect** will eventually be deprecated*.</span></span>

<span data-ttu-id="24501-1433">*De modo parecido, **nxd_tcp_socket_peer_info_get** funciona con conexiones TCP IPv4 o IPv6. Sin embargo, **nx_tcp_socket_peer_info_get** sigue estando disponible para las aplicaciones heredadas. Se recomienda a los desarrolladores que utilicen **nxd_tcp_socket_peer_info_get** en adelante*.</span><span class="sxs-lookup"><span data-stu-id="24501-1433">*Similarly, **nxd_tcp_socket_peer_info_get** works with either IPv4 or IPv6 TCP connections. However, **nx_tcp_socket_peer_info_get** is still available for legacy applications. Developers are encouraged to use **nxd_tcp_socket_peer_info_get** going forward*.</span></span>

### <a name="tcp-client-disconnection"></a><span data-ttu-id="24501-1434">Desconexión del cliente TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1434">TCP Client Disconnection</span></span>    
<span data-ttu-id="24501-1435">El cierre de la conexión se realiza mediante una llamada a ***nx_tcp_socket_disconnect***.</span><span class="sxs-lookup"><span data-stu-id="24501-1435">Closing the connection is accomplished by calling ***nx_tcp_socket_disconnect***.</span></span> <span data-ttu-id="24501-1436">Si no se especifica ninguna suspensión, el socket de cliente envía un paquete RST al socket de servidor y coloca el socket en estado CLOSED.</span><span class="sxs-lookup"><span data-stu-id="24501-1436">If no suspension is specified, the client socket sends a RST packet to the server socket and places the socket in the CLOSED state.</span></span> <span data-ttu-id="24501-1437">De lo contrario, si se solicita una suspensión, se realiza el protocolo de desconexión TCP completo, como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="24501-1437">Otherwise, if a suspension is requested, the full TCP disconnect protocol is performed, as follows:</span></span> 

- <span data-ttu-id="24501-1438">Si el servidor inició previamente una solicitud de desconexión (el socket de cliente ya recibió un paquete FIN, respondió con un paquete ACK y está en estado CLOSE WAIT), NetX Duo promueve el estado del socket TCP de cliente al estado LAST ACK y envía un paquete FIN.</span><span class="sxs-lookup"><span data-stu-id="24501-1438">If the server previously initiated a disconnect request (the client socket has already received a FIN packet, responded with an ACK, and is in the CLOSE WAIT state), NetX Duo promotes the client TCP socket state to the LAST ACK state and sends a FIN packet.</span></span> <span data-ttu-id="24501-1439">Después, espera un paquete ACK del servidor antes de completar la desconexión y de entrar en estado CLOSED.</span><span class="sxs-lookup"><span data-stu-id="24501-1439">It then waits for an ACK from the server before completing the disconnect and entering the CLOSED state.</span></span>

- <span data-ttu-id="24501-1440">Por otro lado, si el cliente es el primero en iniciar una solicitud de desconexión (el servidor no se desconectó y el socket todavía está en estado ESTABLISHED), NetX Duo envía un paquete FIN para iniciar la desconexión y espera a recibir un paquete FIN y un paquete ACK del servidor antes de completar la desconexión y colocar el socket en estado CLOSED.</span><span class="sxs-lookup"><span data-stu-id="24501-1440">If on the other hand, the client is the first to initiate a disconnect request (the server has not disconnected and the socket is still in the ESTABLISHED state), NetX Duo sends a FIN packet to initiate the disconnect and waits to receive a FIN and an ACK from the server before completing the disconnect and placing the socket in a CLOSED state.</span></span>

<span data-ttu-id="24501-1441">Si todavía hay paquetes en la cola de transmisión del socket, NetX Duo realiza una suspensión durante el tiempo de espera especificado para permitir que se confirmen los paquetes.</span><span class="sxs-lookup"><span data-stu-id="24501-1441">If there are still packets on the socket transmit queue, NetX Duo suspends for the specified timeout to allow the packets to be acknowledged.</span></span> <span data-ttu-id="24501-1442">Si se agota el tiempo de espera, NetX Duo vacía la cola de transmisión del socket de cliente.</span><span class="sxs-lookup"><span data-stu-id="24501-1442">If the timeout expires, NetX Duo empties the transmit queue of the client socket.</span></span> 

<span data-ttu-id="24501-1443">Para desenlazar el puerto del socket de cliente, la aplicación llama a ***nx_tcp_client_socket_unbind***.</span><span class="sxs-lookup"><span data-stu-id="24501-1443">To unbind the port from the client socket, the application calls ***nx_tcp_client_socket_unbind***.</span></span> <span data-ttu-id="24501-1444">El socket se debe encontrar en estado CLOSED o en proceso de desconexión (por ejemplo, TIMED WAIT) antes de que se libere el puerto; de lo contrario, se devuelve un error.</span><span class="sxs-lookup"><span data-stu-id="24501-1444">The socket must be in a CLOSED state or in the process of disconnecting (i.e., TIMED WAIT state) before the port is released; otherwise, an error is returned.</span></span>

<span data-ttu-id="24501-1445">Por último, si la aplicación ya no necesita el socket de cliente, llama a ***nx_tcp_socket_delete*** para eliminar el socket.</span><span class="sxs-lookup"><span data-stu-id="24501-1445">Finally, if the application no longer needs the client socket, it calls ***nx_tcp_socket_delete*** to delete the socket.</span></span>

### <a name="tcp-server-connection"></a><span data-ttu-id="24501-1446">Conexión del servidor TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1446">TCP Server Connection</span></span>      
<span data-ttu-id="24501-1447">El lado servidor de una conexión TCP es pasivo; es decir, el servidor espera a que un cliente inicie la solicitud de conexión.</span><span class="sxs-lookup"><span data-stu-id="24501-1447">The server side of a TCP connection is passive; i.e., the server waits for a client to initiate connection request.</span></span> <span data-ttu-id="24501-1448">Para aceptar una conexión de cliente, primero se debe habilitar TCP en la instancia de IP mediante una llamada al servicio \***nx_tcp_enable** _.</span><span class="sxs-lookup"><span data-stu-id="24501-1448">To accept a client connection, TCP must first be enabled on the IP instance by calling the service \***nx_tcp_enable** _.</span></span> <span data-ttu-id="24501-1449">A continuación, la aplicación debe crear un socket TCP mediante el servicio _ \*_nx_tcp_socket_create_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-1449">Next, the application must create a TCP socket using the _ *_nx_tcp_socket_create_*\* service.</span></span>  

<span data-ttu-id="24501-1450">También se debe configurar el socket de servidor para la escucha de solicitudes de conexión.</span><span class="sxs-lookup"><span data-stu-id="24501-1450">The server socket must also be set up for listening for connection requests.</span></span> <span data-ttu-id="24501-1451">Esto se realiza mediante el servicio ***nx_tcp_server_socket_listen***.</span><span class="sxs-lookup"><span data-stu-id="24501-1451">This is achieved by using the ***nx_tcp_server_socket_listen*** service.</span></span> <span data-ttu-id="24501-1452">Este servicio coloca el socket de servidor en estado LISTEN y enlaza el puerto especificado del servidor al socket.</span><span class="sxs-lookup"><span data-stu-id="24501-1452">This service places the server socket in the LISTEN state and binds the specified server port to the socket.</span></span>

> [!NOTE] 
> <span data-ttu-id="24501-1453">*Para establecer una rutina de devolución de llamada de escucha de sockets, la aplicación especifica la función de devolución de llamada adecuada para el argumento tcp_listen_callback del servicio **nx_tcp_server_socket_listen**. En este momento, NetX Duo ejecutará la función de devolución de llamada de la aplicación siempre que se solicite una nueva conexión en este puerto del servidor. El procesamiento de la devolución de llamada está bajo el control de la aplicación.*</span><span class="sxs-lookup"><span data-stu-id="24501-1453">*To set a socket listen callback routine the application specifies the appropriate callback function for the tcp_listen_callback argument of the **nx_tcp_server_socket_listen** service. This application callback function is then executed by NetX Duo whenever a new connection is requested on this server port. The processing in the callback is under application control.*</span></span>

<span data-ttu-id="24501-1454">Para aceptar solicitudes de conexión de cliente, la aplicación llama al servicio \***nx_tcp_server_socket_accept** _.</span><span class="sxs-lookup"><span data-stu-id="24501-1454">To accept client connection requests, the application calls the \***nx_tcp_server_socket_accept** _ service.</span></span> <span data-ttu-id="24501-1455">El socket de servidor debe estar en estado LISTEN o en estado SYN RECEIVED (es decir, el servidor está en estado LISTEN y ha recibido un paquete SYN de un cliente que solicita una conexión) para llamar al servicio de aceptación.</span><span class="sxs-lookup"><span data-stu-id="24501-1455">The server socket must either be in a LISTEN state or a SYN RECEIVED state (i.e., the server is in the LISTEN state and has received a SYN packet from a client requesting a connection) to call the accept service.</span></span> <span data-ttu-id="24501-1456">Un estado de devolución correcto desde _ *_nx_tcp_server_socket_accept_*\* indica que se ha configurado la conexión y el socket de servidor está en estado ESTABLISHED.</span><span class="sxs-lookup"><span data-stu-id="24501-1456">A successful return status from _ *_nx_tcp_server_socket_accept_*\* indicates the connection has been set up and the server socket is in the ESTABLISHED state.</span></span>

<span data-ttu-id="24501-1457">Una vez que el socket de servidor tenga una conexión válida, las solicitudes de conexión de cliente adicionales se ponen en cola hasta la profundidad especificada por el parámetro *listen_queue_size, que se pasa al servicio* \***nx_tcp_server_socket_listen** _.</span><span class="sxs-lookup"><span data-stu-id="24501-1457">After the server socket has a valid connection, additional client connection requests are queued up to the depth specified by the *listen_queue_size, passed into the* \***nx_tcp_server_socket_listen** _ service.</span></span> <span data-ttu-id="24501-1458">Para procesar las conexiones posteriores en un puerto del servidor, la aplicación debe llamar a _ *_nx_tcp_server_socket_relisten_*\* con un socket disponible (es decir, un socket en estado CLOSED).</span><span class="sxs-lookup"><span data-stu-id="24501-1458">In order to process subsequent connections on a server port, the application must call _ *_nx_tcp_server_socket_relisten_*\* with an available socket (i.e., a socket in a CLOSED state).</span></span> <span data-ttu-id="24501-1459">Tenga en cuenta que se puede usar el mismo socket de servidor si ya ha finalizado la conexión anterior asociada con el socket y el socket está en estado CLOSED.</span><span class="sxs-lookup"><span data-stu-id="24501-1459">Note that the same server socket could be used if the previous connection associated with the socket is now finished and the socket is in the CLOSED state.</span></span>

### <a name="tcp-server-disconnection"></a><span data-ttu-id="24501-1460">Desconexión del servidor TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1460">TCP Server Disconnection</span></span>     
<span data-ttu-id="24501-1461">El cierre de la conexión se realiza mediante una llamada a ***nx_tcp_socket_disconnect***.</span><span class="sxs-lookup"><span data-stu-id="24501-1461">Closing the connection is accomplished by calling ***nx_tcp_socket_disconnect***.</span></span> <span data-ttu-id="24501-1462">Si no se especifica ninguna suspensión, el socket de servidor envía un paquete RST al socket de cliente y coloca el socket en estado CLOSED.</span><span class="sxs-lookup"><span data-stu-id="24501-1462">If no suspension is specified, the server socket sends a RST packet to the client socket and places the socket in the CLOSED state.</span></span> <span data-ttu-id="24501-1463">De lo contrario, si se solicita una suspensión, se realiza el protocolo de desconexión TCP completo, como se indica a continuación:</span><span class="sxs-lookup"><span data-stu-id="24501-1463">Otherwise, if a suspension is requested, the full TCP disconnect protocol is performed, as follows:</span></span>

- <span data-ttu-id="24501-1464">Si el cliente inició previamente una solicitud de desconexión (el socket de servidor ya recibió un paquete FIN, respondió con un paquete ACK y está en estado CLOSE WAIT), NetX Duo promueve el estado del socket TCP al estado LAST ACK y envía un paquete FIN.</span><span class="sxs-lookup"><span data-stu-id="24501-1464">If the client previously initiated a disconnect request (the server socket has already received a FIN packet, responded with an ACK, and is in the CLOSE WAIT state), NetX Duo promotes the TCP socket state to the LAST ACK state and sends a FIN packet.</span></span> <span data-ttu-id="24501-1465">Después, espera un paquete ACK del cliente antes de completar la desconexión y de entrar en estado CLOSED.</span><span class="sxs-lookup"><span data-stu-id="24501-1465">It then waits for an ACK from the client before  completing the disconnect and entering the CLOSED state.</span></span>

- <span data-ttu-id="24501-1466">Por otro lado, si el servidor es el primero en iniciar una solicitud de desconexión (el cliente no se desconectó y el socket todavía está en estado ESTABLISHED), NetX Duo envía un paquete FIN para iniciar la desconexión y espera a recibir un paquete FIN y un paquete ACK del cliente antes de completar la desconexión y colocar el socket en estado CLOSED.</span><span class="sxs-lookup"><span data-stu-id="24501-1466">If on the other hand, the server is the first to initiate a disconnect request (the client has not disconnected and the socket is still in the ESTABLISHED state), NetX Duo sends a FIN packet to initiate the disconnect and waits to receive a FIN and an ACK from the client before completing the disconnect and placing the socket in a CLOSED state.</span></span>

<span data-ttu-id="24501-1467">Si todavía hay paquetes en la cola de transmisión del socket, NetX Duo realiza una suspensión durante el tiempo de espera especificado para permitir que se confirmen esos paquetes.</span><span class="sxs-lookup"><span data-stu-id="24501-1467">If there are still packets on the socket transmit queue, NetX Duo suspends for the specified timeout to allow those packets to be acknowledged.</span></span> <span data-ttu-id="24501-1468">Si se agota el tiempo de espera, NetX Duo vacía la cola de transmisión del socket de servidor.</span><span class="sxs-lookup"><span data-stu-id="24501-1468">If the timeout expires, NetX Duo flushes the transmit queue of the server socket.</span></span>

<span data-ttu-id="24501-1469">Cuando el procesamiento de la desconexión se completa y el socket de servidor se encuentra en estado CLOSED, la aplicación debe llamar al servicio \***nx_tcp_server_socket_unaccept** _ para finalizar la asociación de este socket con el puerto del servidor.</span><span class="sxs-lookup"><span data-stu-id="24501-1469">After the disconnect processing is complete and the server socket is in the CLOSED state, the application must call the \***nx_tcp_server_socket_unaccept** _ service to end the association of this socket with the server port.</span></span> <span data-ttu-id="24501-1470">Tenga en cuenta que la aplicación debe llamar a este servicio aunque _*_nx_tcp_socket_disconnect_*_ o _*_nx_tcp_server_socket_accept_*_ devuelvan un estado de error.</span><span class="sxs-lookup"><span data-stu-id="24501-1470">Note this service must be called by the application even if _*_nx_tcp_socket_disconnect_*_ or _*_nx_tcp_server_socket_accept_*_ return an error status.</span></span> <span data-ttu-id="24501-1471">Después de la devolución de _*_nx_tcp_server_socket_unaccept_*_, el socket se puede usar como un socket de cliente o de servidor, o incluso eliminarse si ya no se necesita.</span><span class="sxs-lookup"><span data-stu-id="24501-1471">After the _*_nx_tcp_server_socket_unaccept_*_ returns, the socket can be used as a client or server socket, or even deleted if it is no longer needed.</span></span> <span data-ttu-id="24501-1472">Si se desea aceptar otra conexión de cliente en el mismo puerto de servidor, se debe llamar al servicio _ *_nx_tcp_server_socket_relisten_*\* en este socket.</span><span class="sxs-lookup"><span data-stu-id="24501-1472">If accepting another client connection on the same server port is desired, the _ *_nx_tcp_server_socket_relisten_*\* service should be called on this socket.</span></span>

<span data-ttu-id="24501-1473">En el segmento de código siguiente se muestra la secuencia de llamadas que usa un servidor TCP típico:</span><span class="sxs-lookup"><span data-stu-id="24501-1473">The following code segment illustrates the sequence of calls a typical TCP server uses:</span></span>

```c
/* Set up a previously created TCP socket to
   listen on port 12 */
nx_tcp_server_socket_listen()

/* Loop to make a (another) connection. */
while(1)
{
    /* Wait for a client socket connection request
       for 100 ticks. */
    nx_tcp_server_socket_accept();

    /* (Send and receive TCP messages with the TCP
       client) */

    /* Disconnect the server socket. */
    nx_tcp_socket_disconnect();

    /* Remove this server socket from listening on
       the port. */
    nx_tcp_server_socket_unaccept(&server_socket);
    /* Set up server socket to relisten on the
       same port for the next client. */
    nx_tcp_server_socket_relisten();
}
```

### <a name="mss-validation"></a><span data-ttu-id="24501-1474">Validación de MSS</span><span class="sxs-lookup"><span data-stu-id="24501-1474">MSS Validation</span></span>      
<span data-ttu-id="24501-1475">El tamaño máximo de segmento (MSS) es la cantidad máxima de bytes que puede recibir un host TCP sin que el nivel de IP subyacente los fragmente.</span><span class="sxs-lookup"><span data-stu-id="24501-1475">The Maximum Segment Size (MSS) is the maximum amount of bytes a TCP host can receive without being fragmented by the underlying IP layer.</span></span> <span data-ttu-id="24501-1476">Durante la fase de establecimiento de la conexión TCP, ambos extremos intercambian su propio valor de MSS de TCP, por lo que el remitente no envía un segmento de datos TCP mayor que el valor de MSS del receptor.</span><span class="sxs-lookup"><span data-stu-id="24501-1476">During TCP connection establishment phase, both ends exchanges its own TCP MSS value, so that the sender does not send a TCP data segment that is larger than the receiver's MSS.</span></span> <span data-ttu-id="24501-1477">El módulo TCP de NetX Duo validará opcionalmente el valor de MSS anunciado de su nodo del mismo nivel antes de establecer una conexión.</span><span class="sxs-lookup"><span data-stu-id="24501-1477">NetX Duo TCP module will optionally validate its peer's advertised MSS value before establishing a connection.</span></span> <span data-ttu-id="24501-1478">De forma predeterminada, NetX Duo no habilita este tipo de comprobación.</span><span class="sxs-lookup"><span data-stu-id="24501-1478">By default NetX Duo does not enable such a check.</span></span> <span data-ttu-id="24501-1479">Las aplicaciones que deseen realizar la validación de MSS definirán ***NX_ENABLE_TCP_MSS_CHECK** _ al compilar la biblioteca de NetX Duo y el valor mínimo se definirá en _*_NX_TCP_MSS_MINIMUM_\*_.</span><span class="sxs-lookup"><span data-stu-id="24501-1479">Applications wishing to perform MSS validation shall define ***NX_ENABLE_TCP_MSS_CHECK** _ when building the NetX Duo library, and the minimum value shall be defined in _*_NX_TCP_MSS_MINIMUM_\*_.</span></span> <span data-ttu-id="24501-1480">Las conexiones TCP entrantes con valores de MSS inferiores a _ *_NX_TCP_MSS_MINIMUM_*\* se anulan.</span><span class="sxs-lookup"><span data-stu-id="24501-1480">Incoming TCP connections with MSS values below _ *_NX_TCP_MSS_MINIMUM_*\* are dropped.</span></span>

### <a name="stop-listening-on-a-server-port"></a><span data-ttu-id="24501-1481">Detención de la escucha en un puerto del servidor</span><span class="sxs-lookup"><span data-stu-id="24501-1481">Stop Listening on a Server Port</span></span>    
<span data-ttu-id="24501-1482">Si la aplicación ya no desea escuchar las solicitudes de conexión de cliente en un puerto del servidor que se especificó anteriormente mediante una llamada al servicio \***nx_tcp_server_socket_listen** _, la aplicación simplemente llama al servicio _ \*_nx_tcp_server_socket_unlisten_\*\*.</span><span class="sxs-lookup"><span data-stu-id="24501-1482">If the application no longer wishes to listen for client connection requests on a server port that was previously specified by a call to the ***nx_tcp_server_socket_listen** _ service, the application simply calls the _ *_nx_tcp_server_socket_unlisten_** service.</span></span> <span data-ttu-id="24501-1483">Este servicio coloca cualquier socket en espera de una conexión en estado CLOSED y libera los paquetes de solicitud de conexión de cliente en cola.</span><span class="sxs-lookup"><span data-stu-id="24501-1483">This service places any socket waiting for a connection back in the CLOSED state and releases any queued client connection request packets.</span></span> 

### <a name="tcp-window-size"></a><span data-ttu-id="24501-1484">Tamaño de la ventana de TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1484">TCP Window Size</span></span>   
<span data-ttu-id="24501-1485">Durante las fases de configuración y transferencia de datos de la conexión, cada puerto informa de la cantidad de datos que puede controlar, que se conoce como el tamaño de la ventana.</span><span class="sxs-lookup"><span data-stu-id="24501-1485">During both the setup and data transfer phases of the connection, each port reports the amount of data it can handle, which is called its window size.</span></span> <span data-ttu-id="24501-1486">A medida que se reciben y procesan los datos, el tamaño de esta ventana se ajusta de forma dinámica.</span><span class="sxs-lookup"><span data-stu-id="24501-1486">As data are received and processed, this window size is adjusted dynamically.</span></span> <span data-ttu-id="24501-1487">En TCP, un remitente solo puede enviar la cantidad de datos que quepa en la ventana del receptor.</span><span class="sxs-lookup"><span data-stu-id="24501-1487">In TCP, a sender can only send an amount of data that fits into the receiver's window.</span></span> <span data-ttu-id="24501-1488">En esencia, el tamaño de la ventana proporciona el control de flujo para la transferencia de datos en cada dirección de la conexión.</span><span class="sxs-lookup"><span data-stu-id="24501-1488">In essence, the window size provides flow control for data transfer in each direction of the connection.</span></span>   

### <a name="tcp-packet-send"></a><span data-ttu-id="24501-1489">Envío de paquetes TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1489">TCP Packet Send</span></span>     
<span data-ttu-id="24501-1490">El envío de datos TCP se realiza fácilmente mediante una llamada a la función ***nx_tcp_socket_send***.</span><span class="sxs-lookup"><span data-stu-id="24501-1490">Sending TCP data is easily accomplished by calling the ***nx_tcp_socket_send*** function.</span></span> <span data-ttu-id="24501-1491">Si el tamaño de los datos que se transmiten es mayor que el valor de MSS del socket o que el tamaño actual de la ventana de recepción del nodo del mismo nivel, lo que sea menor, la lógica interna de TCP divide los datos que caben en min (MSS, ventana de recepción del nodo del mismo nivel) para la transmisión.</span><span class="sxs-lookup"><span data-stu-id="24501-1491">If the size of the data being transmitted is larger than the MSS value of the socket or the current peer receive window size, whichever is smaller, TCP internal logic carves off the data that fits into min (MSS, peer receive Window) for transmission.</span></span> <span data-ttu-id="24501-1492">A continuación, este servicio crea un encabezado TCP delante del paquete (incluido el cálculo de la suma de comprobación).</span><span class="sxs-lookup"><span data-stu-id="24501-1492">This service then builds a TCP header in front of the packet (including the checksum calculation).</span></span> <span data-ttu-id="24501-1493">Si el tamaño de la ventana del receptor no es cero, el autor de llamada enviará tantos datos como pueda para llenar el tamaño de la ventana del receptor.</span><span class="sxs-lookup"><span data-stu-id="24501-1493">If the receiver's window size is not zero, the caller will send as much data as it can to fill up the receiver window size.</span></span> <span data-ttu-id="24501-1494">Si el tamaño de la ventana de recepción llega a ser cero, el autor de llamada puede suspender y esperar a que el tamaño de la ventana del receptor aumente lo suficiente para que se envíe este paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-1494">If the receive window becomes zero, the caller may suspend and wait for the receiver's window size to increase enough for this packet to be sent.</span></span> <span data-ttu-id="24501-1495">En un momento dado, se pueden suspender varios subprocesos mientras intentan enviar datos mediante el mismo socket.</span><span class="sxs-lookup"><span data-stu-id="24501-1495">At any given time, multiple threads may suspend while trying to send data through the same socket.</span></span> 

> [!WARNING]  
> <span data-ttu-id="24501-1496">*Los datos de TCP que residen en la estructura NX_PACKET deben residir en un límite de palabra larga. Además, debe haber espacio suficiente entre el puntero antepuesto y el puntero de inicio de datos para colocar los encabezados del soporte físico, IP y TCP.*</span><span class="sxs-lookup"><span data-stu-id="24501-1496">*The TCP data residing in the NX_PACKET structure should reside on a long-word boundary. In addition, there needs to be sufficient space between the prepend pointer and the data start pointer to place the TCP, IP, and physical media headers*.</span></span>

### <a name="tcp-packet-retransmit"></a><span data-ttu-id="24501-1497">Retransmisión de paquetes TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1497">TCP Packet Retransmit</span></span>      
<span data-ttu-id="24501-1498">Los paquetes TCP transmitidos que se han enviado previamente en realidad se almacenan de forma interna hasta que se devuelve un mensaje ACK desde el otro lado de la conexión.</span><span class="sxs-lookup"><span data-stu-id="24501-1498">Previously transmitted TCP packets sent actually stored internally until an ACK is returned from the other side of the connection.</span></span> <span data-ttu-id="24501-1499">Si los datos transmitidos no se confirman dentro del período de tiempo de espera, el paquete almacenado se vuelve a enviar y se establece el período de tiempo de espera siguiente.</span><span class="sxs-lookup"><span data-stu-id="24501-1499">If transmitted data is not acknowledged within the timeout period, the stored packet is re-sent and the next timeout period is set.</span></span> <span data-ttu-id="24501-1500">Cuando se recibe un mensaje ACK, finalmente se liberan todos los paquetes que están incluidos en el número de confirmación de la cola de transmisión interna.</span><span class="sxs-lookup"><span data-stu-id="24501-1500">When an ACK is received, all packets covered by the acknowledgement number in the internal transmit queue are finally released.</span></span>  

> [!WARNING]   
> <span data-ttu-id="24501-1501">*La aplicación no reutilizará el paquete ni modificará su contenido después de que nx_tcp_socket_send() vuelva con NX_SUCCESS. Finalmente, el procesamiento interno de NetX Duo libera el paquete transmitido después de que el otro extremo confirme los datos*.</span><span class="sxs-lookup"><span data-stu-id="24501-1501">*Application shall not reuse the packet or alter the contents of the packet after nx_tcp_socket_send() returns with NX_SUCCESS. The transmitted packet is eventually released by NetX Duo internal processing after the data is acknowledged by the other end*.</span></span>

### <a name="tcp-keepalive"></a><span data-ttu-id="24501-1502">TCP Keepalive</span><span class="sxs-lookup"><span data-stu-id="24501-1502">TCP Keepalive</span></span>     
<span data-ttu-id="24501-1503">La característica TCP Keepalive permite a un socket detectar si su elemento del mismo nivel se desconecta o no sin la terminación adecuada (por ejemplo, el elemento del mismo nivel bloqueado), o bien impedir que determinadas funciones de supervisión de red finalicen una conexión durante períodos prolongados de inactividad.</span><span class="sxs-lookup"><span data-stu-id="24501-1503">TCP Keepalive feature allows a socket to detect whether or not its peer disconnects without proper termination (for example, the peer crashed), or to prevent certain network monitoring facilities to terminate a connection for long periods of idle.</span></span> <span data-ttu-id="24501-1504">TCP Keepalive funciona enviando periódicamente un marco TCP sin datos y el número de secuencia establecido en uno menos que el número de secuencia actual.</span><span class="sxs-lookup"><span data-stu-id="24501-1504">TCP Keepalive works by periodically sending a TCP frame with no data, and the sequence number set to one less than the current sequence number.</span></span> <span data-ttu-id="24501-1505">Al recibir este marco de TCP Keepalive, el destinatario, si sigue activo, responde con un mensaje ACK para su número de secuencia actual.</span><span class="sxs-lookup"><span data-stu-id="24501-1505">On receiving such TCP Keepalive frame, the recipient, if still alive, responses with an ACK for its current sequence number.</span></span> <span data-ttu-id="24501-1506">De este modo, se completa la transacción de Keepalive.</span><span class="sxs-lookup"><span data-stu-id="24501-1506">This completes the keepalive transaction.</span></span>  

<span data-ttu-id="24501-1507">De forma predeterminada, la característica Keepalive no está habilitada.</span><span class="sxs-lookup"><span data-stu-id="24501-1507">By default the keepalive feature is not enabled.</span></span> <span data-ttu-id="24501-1508">Para usar esta característica, la biblioteca de NetX Duo debe compilarse con \***NX_ENABLE_TCP_KEEPALIVE** _ definido.</span><span class="sxs-lookup"><span data-stu-id="24501-1508">To use this feature, NetX Duo library must be built with \***NX_ENABLE_TCP_KEEPALIVE** _ defined.</span></span> <span data-ttu-id="24501-1509">El símbolo _ *_NX_TCP_KEEPALIVE_INITIAL_*\* especifica el número de segundos de inactividad antes de que se inicie el marco Keepalive.</span><span class="sxs-lookup"><span data-stu-id="24501-1509">The symbol _ *_NX_TCP_KEEPALIVE_INITIAL_*\* specifies the number of seconds of inactivity before the keepalive frame is initiated.</span></span>  

### <a name="tcp-packet-receive"></a><span data-ttu-id="24501-1510">Recepción de paquetes TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1510">TCP Packet Receive</span></span>   
<span data-ttu-id="24501-1511">El procesamiento de paquetes de recepción TCP (llamado desde el subproceso auxiliar de IP) es responsable de controlar las distintas acciones de conexión y desconexión, así como de transmitir el procesamiento de confirmación.</span><span class="sxs-lookup"><span data-stu-id="24501-1511">The TCP receive packet processing (called from the IP helper thread) is responsible for handling various connection and disconnection actions as well as transmit acknowledge processing.</span></span> <span data-ttu-id="24501-1512">Además, el procesamiento de paquetes de recepción TCP es responsable de colocar los paquetes con los datos de recepción en la cola de recepción del socket TCP correspondiente o de entregar el paquete al primer subproceso suspendido que espera un paquete.</span><span class="sxs-lookup"><span data-stu-id="24501-1512">In addition, the TCP receive packet processing is responsible for placing packets with receive data on the appropriate TCP socket's receive queue or delivering the packet to the first suspended thread waiting for a packet.</span></span>

### <a name="tcp-receive-notify"></a><span data-ttu-id="24501-1513">Notificación de recepción de TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1513">TCP Receive Notify</span></span>     
<span data-ttu-id="24501-1514">Si el subproceso de la aplicación debe procesar los datos recibidos desde más de un socket, se debe usar la función ***nx_udp_socket_receive_notify***.</span><span class="sxs-lookup"><span data-stu-id="24501-1514">If the application thread needs to process received data from more than one socket, the ***nx_tcp_socket_receive_notify*** function should be used.</span></span> <span data-ttu-id="24501-1515">Esta función registra una función de devolución de llamada de paquetes de recepción para el socket.</span><span class="sxs-lookup"><span data-stu-id="24501-1515">This function registers a receive packet callback function for the socket.</span></span> <span data-ttu-id="24501-1516">Cada vez que se recibe un paquete en el socket, se ejecuta la función de devolución de llamada.</span><span class="sxs-lookup"><span data-stu-id="24501-1516">Whenever a packet is received on the socket, the callback function is executed.</span></span>  

<span data-ttu-id="24501-1517">El contenido de la función de devolución de llamada es específico de la aplicación; sin embargo, la función probablemente contendría lógica para informar al subproceso de procesamiento de que está disponible un paquete en el socket correspondiente.</span><span class="sxs-lookup"><span data-stu-id="24501-1517">The contents of the callback function are applicationspecific; however, the function would most likely contain logic to inform the processing thread that a packet is available on the corresponding socket.</span></span> 

### <a name="thread-suspension"></a><span data-ttu-id="24501-1518">Suspensión de subprocesos</span><span class="sxs-lookup"><span data-stu-id="24501-1518">Thread Suspension</span></span>      
<span data-ttu-id="24501-1519">Como se ha mencionado anteriormente, los subprocesos de la aplicación se pueden suspender al intentar recibir datos desde un puerto TCP determinado.</span><span class="sxs-lookup"><span data-stu-id="24501-1519">As mentioned previously, application threads can suspend while attempting to receive data from a particular TCP port.</span></span> <span data-ttu-id="24501-1520">Una vez que se recibe un paquete en ese puerto, se asigna al primer subproceso suspendido y, a continuación, se reanuda el subproceso.</span><span class="sxs-lookup"><span data-stu-id="24501-1520">After a packet is received on that port, it is given to the first thread suspended and that thread is then resumed.</span></span> <span data-ttu-id="24501-1521">Existe un tiempo de espera opcional disponible cuando hay una suspensión en la recepción de un paquete TCP, una característica disponible para la mayoría de los servicios de NetX Duo.</span><span class="sxs-lookup"><span data-stu-id="24501-1521">An optional timeout is available when suspending on a TCP receive packet, a feature available for most NetX Duo services.</span></span>  

<span data-ttu-id="24501-1522">La suspensión de subprocesos también está disponible para los servicios de conexión (cliente y servidor), enlace de cliente y desconexión.</span><span class="sxs-lookup"><span data-stu-id="24501-1522">Thread suspension is also available for connection (both client and server), client binding, and disconnection services.</span></span>  

### <a name="tcp-socket-statistics-and-errors"></a><span data-ttu-id="24501-1523">Estadísticas y errores del socket TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1523">TCP Socket Statistics and Errors</span></span>     
<span data-ttu-id="24501-1524">Si se habilita, el software de socket TCP de NetX Duo realiza un seguimiento de varios errores y estadísticas que pueden ser útiles para la aplicación.</span><span class="sxs-lookup"><span data-stu-id="24501-1524">If enabled, the NetX Duo TCP socket software keeps track of several statistics and errors that may be useful to the application.</span></span> <span data-ttu-id="24501-1525">Se mantienen las estadísticas y los informes de errores siguientes para cada instancia de IP/TCP:</span><span class="sxs-lookup"><span data-stu-id="24501-1525">The following statistics and error reports are maintained for each IP/TCP instance:</span></span>   

- <span data-ttu-id="24501-1526">Número total de paquetes TCP enviados</span><span class="sxs-lookup"><span data-stu-id="24501-1526">Total TCP Packets Sent</span></span>  
- <span data-ttu-id="24501-1527">Número total de bytes TCP enviados</span><span class="sxs-lookup"><span data-stu-id="24501-1527">Total TCP Bytes Sent</span></span>  
- <span data-ttu-id="24501-1528">Número total de paquetes TCP recibidos</span><span class="sxs-lookup"><span data-stu-id="24501-1528">Total TCP Packets Received</span></span>   
- <span data-ttu-id="24501-1529">Número total de bytes TCP recibidos</span><span class="sxs-lookup"><span data-stu-id="24501-1529">Total TCP Bytes Received</span></span>   
- <span data-ttu-id="24501-1530">Número total de paquetes TCP no válidos</span><span class="sxs-lookup"><span data-stu-id="24501-1530">Total TCP Invalid Packets</span></span>   
- <span data-ttu-id="24501-1531">Número total de paquetes de recepción de TCP eliminados</span><span class="sxs-lookup"><span data-stu-id="24501-1531">Total TCP Receive Packets Dropped</span></span>    
- <span data-ttu-id="24501-1532">Número total de errores de suma de comprobación de recepción de TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1532">Total TCP Receive Checksum Errors</span></span>   
- <span data-ttu-id="24501-1533">Número total de conexiones TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1533">Total TCP Connections</span></span>   
- <span data-ttu-id="24501-1534">Número total de desconexiones TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1534">Total TCP Disconnections</span></span>   
- <span data-ttu-id="24501-1535">Número total de conexiones TCP eliminadas</span><span class="sxs-lookup"><span data-stu-id="24501-1535">Total TCP Connections Dropped</span></span>    
- <span data-ttu-id="24501-1536">Número total de retransmisiones de paquetes TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1536">Total TCP Packet Retransmits</span></span>   
- <span data-ttu-id="24501-1537">Paquetes de socket TCP enviados</span><span class="sxs-lookup"><span data-stu-id="24501-1537">TCP Socket Packets Sent</span></span>   
- <span data-ttu-id="24501-1538">Bytes de socket TCP enviados</span><span class="sxs-lookup"><span data-stu-id="24501-1538">TCP Socket Bytes Sent</span></span>   
- <span data-ttu-id="24501-1539">Paquetes de socket TCP recibidos</span><span class="sxs-lookup"><span data-stu-id="24501-1539">TCP Socket Packets Received</span></span>   
- <span data-ttu-id="24501-1540">Bytes de socket TCP recibidos</span><span class="sxs-lookup"><span data-stu-id="24501-1540">TCP Socket Bytes Received</span></span>   
- <span data-ttu-id="24501-1541">Retransmisiones de paquetes de socket TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1541">TCP Socket Packet Retransmits</span></span>    
- <span data-ttu-id="24501-1542">Paquetes de socket TCP puestos en cola</span><span class="sxs-lookup"><span data-stu-id="24501-1542">TCP Socket Packets Queued</span></span>    
- <span data-ttu-id="24501-1543">Errores de suma de comprobación de socket TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1543">TCP Socket Checksum Errors</span></span>    
- <span data-ttu-id="24501-1544">Estado de socket TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1544">TCP Socket State</span></span>    
- <span data-ttu-id="24501-1545">Profundidad de la cola de transmisión de socket TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1545">TCP Socket Transmit Queue Depth</span></span>    
- <span data-ttu-id="24501-1546">Tamaño de la ventana de transmisión del socket TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1546">TCP Socket Transmit Window Size</span></span>    
- <span data-ttu-id="24501-1547">Tamaño de la ventana de recepción de socket TCP</span><span class="sxs-lookup"><span data-stu-id="24501-1547">TCP Socket Receive Window Size</span></span>    

<span data-ttu-id="24501-1548">Todos estos informes de errores y estadísticas están disponibles para la aplicación con el servicio ***nx_tcp_info_get** _ para las estadísticas totales de TCP y el servicio _ *_nx_tcp_socket_info_get_** para las estadísticas TCP por socket.</span><span class="sxs-lookup"><span data-stu-id="24501-1548">All these statistics and error reports are available to the application with the ***nx_tcp_info_get** _ service for total TCP statistics and the _ *_nx_tcp_socket_info_get_** service for TCP statistics per socket.</span></span>

### <a name="tcp-socket-control-block-nx_tcp_socket"></a><span data-ttu-id="24501-1549">Bloque de control de socket TCP NX_TCP_SOCKET</span><span class="sxs-lookup"><span data-stu-id="24501-1549">TCP Socket Control Block NX_TCP_SOCKET</span></span>      
<span data-ttu-id="24501-1550">Las características de cada socket TCP se encuentran en el bloque de control *NX_TCP_SOCKET* asociado, que contiene información útil, como el vínculo a la estructura de datos IP, la interfaz de conexión de red, el puerto enlazado y la cola de paquetes de recepción.</span><span class="sxs-lookup"><span data-stu-id="24501-1550">The characteristics of each TCP socket are found in the associated *NX_TCP_SOCKET* control block, which contains useful information such as the link to the IP data structure, the network connection interface, the bound port, and the receive packet queue.</span></span> <span data-ttu-id="24501-1551">Esta estructura se define en el archivo ***tx_api.h***.</span><span class="sxs-lookup"><span data-stu-id="24501-1551">This structure is defined in the ***nx_api.h*** file.</span></span>