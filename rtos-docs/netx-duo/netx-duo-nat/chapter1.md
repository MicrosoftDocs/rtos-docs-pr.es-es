---
title: 'Capítulo 1: Introducción a la traducción de direcciones de red'
description: La traducción de direcciones de red (NAT) IP se desarrolló originalmente para solucionar el problema de un número limitado de direcciones IPv4 de Internet.
author: philmea
ms.author: philmea
ms.date: 07/14/2020
ms.topic: article
ms.service: rtos
ms.openlocfilehash: 3d01aa6f68e21ea82f65a59a19c4f5c7958a6b92
ms.sourcegitcommit: e3d42e1f2920ec9cb002634b542bc20754f9544e
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 03/22/2021
ms.locfileid: "104814633"
---
# <a name="chapter-1---an-introduction-to-network-address-translation"></a><span data-ttu-id="86689-103">Capítulo 1: Introducción a la traducción de direcciones de red</span><span class="sxs-lookup"><span data-stu-id="86689-103">Chapter 1 - An introduction to Network Address Translation</span></span>

## <a name="the-need-for-network-address-translation"></a><span data-ttu-id="86689-104">Necesidad de la traducción de direcciones de red</span><span class="sxs-lookup"><span data-stu-id="86689-104">The Need for Network Address Translation</span></span>

<span data-ttu-id="86689-105">La traducción de direcciones de red (NAT) IP se desarrolló originalmente para solucionar el problema de un número limitado de direcciones IPv4 de Internet.</span><span class="sxs-lookup"><span data-stu-id="86689-105">IP Network Address Translation (NAT) was originally developed to solve the problem of a limited number of Internet IPv4 addresses.</span></span> <span data-ttu-id="86689-106">La necesidad de NAT se produce cuando varios dispositivos necesitan tener acceso a Internet, pero el proveedor de servicios Internet (ISP) solo asigna una dirección de Internet IPv4.</span><span class="sxs-lookup"><span data-stu-id="86689-106">The need for NAT arises when multiple devices need to access the Internet but only one IPv4 Internet address is assigned by the Internet Service Provider (ISP).</span></span>

<span data-ttu-id="86689-107">También hay otras ventajas en el uso de NAT.</span><span class="sxs-lookup"><span data-stu-id="86689-107">There are other benefits of using NAT as well.</span></span> <span data-ttu-id="86689-108">La topología de red fuera del dominio local puede cambiar de muchas maneras.</span><span class="sxs-lookup"><span data-stu-id="86689-108">Network topology outside the local domain can change in many ways.</span></span> <span data-ttu-id="86689-109">Los clientes pueden cambiar los proveedores, las redes troncales de la empresa se pueden reorganizar o los proveedores pueden combinarlos o dividirlos.</span><span class="sxs-lookup"><span data-stu-id="86689-109">Customers may change providers, company backbones may be reorganized, or providers may merge or split.</span></span> <span data-ttu-id="86689-110">Siempre que cambie la topología externa, las asignaciones de direcciones para los hosts dentro del dominio local también deben cambiar para reflejar estos cambios externos.</span><span class="sxs-lookup"><span data-stu-id="86689-110">Whenever the external topology changes, address assignments for hosts within the local domain must also change to reflect these external changes.</span></span> <span data-ttu-id="86689-111">Los cambios de este tipo se pueden ocultar a los usuarios dentro del dominio centralizando los cambios en un único enrutador de traducción de direcciones.</span><span class="sxs-lookup"><span data-stu-id="86689-111">Changes of this type can be hidden from users within the domain by centralizing changes to a single address translation router.</span></span> <span data-ttu-id="86689-112">NAT permite el acceso de los hosts locales a la red pública de Internet y los protege del acceso directo desde el exterior.</span><span class="sxs-lookup"><span data-stu-id="86689-112">NAT enables access for local hosts to the public Internet and protects them from direct access from the outside.</span></span> <span data-ttu-id="86689-113">Las organizaciones con una configuración de red principalmente para uso interno, con una necesidad de acceso externo ocasional, son buenos candidatos para este esquema.</span><span class="sxs-lookup"><span data-stu-id="86689-113">Organizations with a network setup predominantly for internal use, with a need for occasional external access are good candidates for this scheme.</span></span>

## <a name="basic-nat-and-network-address-port-translation"></a><span data-ttu-id="86689-114">Traducción básica de puertos de direcciones de red y NAT</span><span class="sxs-lookup"><span data-stu-id="86689-114">Basic NAT and Network Address Port Translation</span></span>

<span data-ttu-id="86689-115">Un enrutador habilitado para NAT se instala entre la red pública y la red privada.</span><span class="sxs-lookup"><span data-stu-id="86689-115">A NAT-enabled router is installed between the public network and the private network.</span></span> <span data-ttu-id="86689-116">La función del enrutador habilitado para NAT consiste en traducir entre las direcciones IPv4 privadas internas y la dirección IPv4 pública asignada, por lo que todos los dispositivos de la red privada pueden compartir la misma dirección IPv4 pública.</span><span class="sxs-lookup"><span data-stu-id="86689-116">The role of the NAT-enabled router is to translate between the internal private IPv4 addresses and the assigned public IPv4 address, so all the devices on the private network are able to share the same public IPv4 address.</span></span>

<span data-ttu-id="86689-117">En la implementación básica de NAT, el enrutador NAT "posee" una o más direcciones IP registradas globalmente diferentes de su propia dirección IP.</span><span class="sxs-lookup"><span data-stu-id="86689-117">In the basic implementation of NAT, the NAT router ‘owns’ one or more globally registered IP addresses different from its own IP address.</span></span> <span data-ttu-id="86689-118">Estas direcciones globales están disponibles para asignarlas a los hosts de su red privada de forma estática o dinámica.</span><span class="sxs-lookup"><span data-stu-id="86689-118">These global addresses are available to assign to hosts on its private network either statically or dynamically.</span></span> <span data-ttu-id="86689-119">NAPT, o traducción de puertos de dirección de red, es una variación de NAT básico, donde la traducción de direcciones de red se amplía para incluir un identificador de "transporte".</span><span class="sxs-lookup"><span data-stu-id="86689-119">NAPT, or Network Address Port Translation, is a variation of basic NAT, where network address translation is extended to include a ‘transport’ identifier.</span></span> <span data-ttu-id="86689-120">Normalmente, es el número de puerto de los paquetes TCP y UDP, y el identificador de consulta de los paquetes ICMP.</span><span class="sxs-lookup"><span data-stu-id="86689-120">Most typically this is the port number for TCP and UDP packets, and the Query ID for ICMP packets.</span></span>

<span data-ttu-id="86689-121">Normalmente, las conexiones a través del límite de NAT se inician mediante los hosts de la red privada que envían paquetes salientes a un host externo.</span><span class="sxs-lookup"><span data-stu-id="86689-121">Connections across the NAT boundary are typically initiated by hosts on the private network sending outbound packets to an external host.</span></span> <span data-ttu-id="86689-122">Con este fin, a estos hosts se les asignan habitualmente direcciones IP *dinámicas* (temporales).</span><span class="sxs-lookup"><span data-stu-id="86689-122">These hosts are usually assigned *dynamic* (temporary) IP addresses for this purpose.</span></span> <span data-ttu-id="86689-123">Sin embargo, también es posible que las conexiones se inicien en la dirección opuesta si la red privada tiene "servidores", por ejemplo, servidores HTTP o FTP que aceptarán solicitudes de cliente de la red externa.</span><span class="sxs-lookup"><span data-stu-id="86689-123">However, it is also possible to have connections initiated in the opposite direction if the private network has ‘servers’ e.g. HTTP or FTP servers that will accept Client requests from the external network.</span></span> <span data-ttu-id="86689-124">Normalmente, NAT asignará a estos hosts locales una dirección IP *estática* (permanente): puerto.</span><span class="sxs-lookup"><span data-stu-id="86689-124">NAT will typically assign these local hosts a *static* (permanent) IP address:port.</span></span>

## <a name="how-network-address-translation-works"></a><span data-ttu-id="86689-125">Funcionamiento de la traducción de direcciones de red</span><span class="sxs-lookup"><span data-stu-id="86689-125">How Network Address Translation Works</span></span>

<span data-ttu-id="86689-126">En la figura 1 se muestra una configuración de red típica con un enrutador habilitado para NAT.</span><span class="sxs-lookup"><span data-stu-id="86689-126">A typical network setup with a NAT-enabled router is illustrated in Figure 1.</span></span>

![Configuración de red típica con un enrutador habilitado para NAT](media/image2.png)

<span data-ttu-id="86689-128">**Figura 1: Configuración de red típica con un enrutador habilitado para NAT**</span><span class="sxs-lookup"><span data-stu-id="86689-128">**Figure 1 - A typical network setup with a NAT-enabled router**</span></span>

<span data-ttu-id="86689-129">Un enrutador habilitado para NAT normalmente tiene dos interfaces de red.</span><span class="sxs-lookup"><span data-stu-id="86689-129">A NAT-enabled router typically has two network interfaces.</span></span> <span data-ttu-id="86689-130">Una interfaz está conectada a la red pública de Internet y la otra está conectada a la red privada.</span><span class="sxs-lookup"><span data-stu-id="86689-130">One interface is connected to the public Internet; the other is connected to the private network.</span></span> <span data-ttu-id="86689-131">Un enrutador típico en esta configuración es responsable de enrutar los datagramas IP entre la red privada y la red pública en función de la dirección IP de destino.</span><span class="sxs-lookup"><span data-stu-id="86689-131">A typical router in this setup is responsible for routing IP datagrams between the private network and the public network based on destination IP address.</span></span> <span data-ttu-id="86689-132">Un enrutador habilitado para NAT realiza la traducción de direcciones antes de enrutar un datagrama IPv4 entre la interfaz pública y la privada.</span><span class="sxs-lookup"><span data-stu-id="86689-132">A NAT-enabled router performs address translation before routing an IPv4 datagram between the public and the private interface.</span></span> <span data-ttu-id="86689-133">Se establece una traducción para cada sesión TCP o UDP, en función de la dirección de origen interna, el número de puerto de origen, la dirección de destino externa y el número de puerto de destino.</span><span class="sxs-lookup"><span data-stu-id="86689-133">A translation is established for each TCP or UDP session, based the internal source address, source port number, and external destination address and destination port number.</span></span> <span data-ttu-id="86689-134">En el caso de la solicitud de eco ICMP y el datagrama de respuesta, se usa el identificador de consulta ICMP en lugar del número de puerto.</span><span class="sxs-lookup"><span data-stu-id="86689-134">For ICMP echo request and response datagram, the ICMP query ID is used instead of the port number.</span></span>

<span data-ttu-id="86689-135">Para ilustrar una implementación típica de la traducción de direcciones de red, supongamos que tenemos en cuenta una configuración de red en la figura 2.</span><span class="sxs-lookup"><span data-stu-id="86689-135">To illustrate a typical implementation of Network Address Translation, let us consider a network setup in Figure 2.</span></span>

![Implementación típica de la traducción de direcciones de red](media/image3.png)

<span data-ttu-id="86689-137">**Figura 2: Implementación típica de la traducción de direcciones de red**</span><span class="sxs-lookup"><span data-stu-id="86689-137">**Figure 2 - A typical implementation of Network Address Translation**</span></span>

<span data-ttu-id="86689-138">En este escenario, el enrutador NAT conecta la red privada a la izquierda y la red pública a la derecha.</span><span class="sxs-lookup"><span data-stu-id="86689-138">In this scenario, the NAT router connects the private network to the left, and the public network to the right.</span></span> <span data-ttu-id="86689-139">Supongamos que en el lado de la red pública, la dirección IP de la interfaz del enrutador NAT es 202.151.25.14 y que en la interfaz de red privada, el enrutador NAT usa la dirección IP 192.168.1.254.</span><span class="sxs-lookup"><span data-stu-id="86689-139">Let’s assume on the public network side, the NAT router interface IP address is 202.151.25.14; on the private network interface, the NAT router uses the IP address 192.168.1.254.</span></span> <span data-ttu-id="86689-140">Un nodo de la red privada inicia una conexión TCP con un servidor web en Internet.</span><span class="sxs-lookup"><span data-stu-id="86689-140">A node on the private network initiates a TCP connection with a web server on the Internet.</span></span>

<span data-ttu-id="86689-141">En la figura 3 se muestra una vista general del proceso de traducción de direcciones de red.</span><span class="sxs-lookup"><span data-stu-id="86689-141">Figure 3 shows a high-level view of the Network Address Translation process.</span></span>

![Vista general del proceso de traducción de direcciones de red](media/image4.png)

<span data-ttu-id="86689-143">**Figura 3: Vista general del proceso de traducción de direcciones de red**</span><span class="sxs-lookup"><span data-stu-id="86689-143">**Figure 3 - A high-level view of the Network Address Translation process**</span></span>

1. <span data-ttu-id="86689-144">El cliente transmite un mensaje SYN de TCP al servidor web.</span><span class="sxs-lookup"><span data-stu-id="86689-144">Client transmits a TCP SYN message to the web server.</span></span> <span data-ttu-id="86689-145">La dirección del remitente es 192.168.1.15 y el número de puerto 6732; la dirección de destino es 128.15.54.3 y el número de puerto 80.</span><span class="sxs-lookup"><span data-stu-id="86689-145">The sender address is 192.168.1.15, port number 6732; the destination address is 128.15.54.3, port number 80.</span></span>
1. <span data-ttu-id="86689-146">El enrutador NAT recibe el paquete del cliente en la interfaz de red privada.</span><span class="sxs-lookup"><span data-stu-id="86689-146">The packet from the Client is received on the private network interface by the NAT router.</span></span> <span data-ttu-id="86689-147">La regla de tráfico saliente se aplica al paquete: la dirección del remitente (cliente) se traduce a la dirección IP pública del enrutador NAT 202.15.25.14 y el número de puerto de origen del remitente (cliente) se traduce al número de puerto TCP 2015 en la interfaz pública.</span><span class="sxs-lookup"><span data-stu-id="86689-147">The outbound traffic rule applies to the packet: the sender’s (Client’s) address is translated to the NAT router’s public IP address 202.15.25.14, and sender (Client) source port number is translated to the TCP port number 2015 on the public interface.</span></span>
1. <span data-ttu-id="86689-148">A continuación, el paquete se transmite a través de Internet y, finalmente, llega a su host de destino 128.15.54.3.</span><span class="sxs-lookup"><span data-stu-id="86689-148">The packet is then transmitted over the Internet and ultimately reaches its destination host 128.15.54.3.</span></span> <span data-ttu-id="86689-149">Observe que en el lado de recepción, en función de la dirección de origen y el número de puerto de la capa TCP, el paquete parece haberse originado en 202.151.24.14, número de puerto 2015.</span><span class="sxs-lookup"><span data-stu-id="86689-149">Notice that on the receiving side, based on the IP layer source address and TCP layer port number, the packet appears to have originated from 202.151.24.14, port number 2015.</span></span>
   <span data-ttu-id="86689-150">La figura 4 muestra el proceso NAT en la ruta de acceso de devolución.</span><span class="sxs-lookup"><span data-stu-id="86689-150">Figure 4 shows the NAT process on the return path.</span></span>

   ![Proceso NAT en la ruta de acceso de devolución](media/image5.png)

   <span data-ttu-id="86689-152">**Figura 4: Proceso NAT en la ruta de acceso de devolución**</span><span class="sxs-lookup"><span data-stu-id="86689-152">**Figure 4 - NAT process on the return path**</span></span>
1. <span data-ttu-id="86689-153">En este escenario, el host de Internet 128.15.54.3 envía un paquete de respuesta con la dirección de Internet del enrutador NAT como destino.</span><span class="sxs-lookup"><span data-stu-id="86689-153">In this scenario, the Internet host 128.15.54.3 sends a response packet with the NAT router’s Internet address as its destination.</span></span>
1. <span data-ttu-id="86689-154">El paquete alcanza el enrutador NAT.</span><span class="sxs-lookup"><span data-stu-id="86689-154">The packet reaches the NAT router.</span></span> <span data-ttu-id="86689-155">Dado que se trata de un paquete entrante, se aplican las reglas de traducción de entrada: la dirección de destino se vuelve a cambiar a la dirección IP del remitente (cliente) original: 192.168.1.15, número de puerto de destino 6732.</span><span class="sxs-lookup"><span data-stu-id="86689-155">Since this is an in-bound packet, the in-bound translation rules apply: the destination address is changed back to the original sender’s (Client’s) IP address: 192.168.1.15, destination port number 6732.</span></span>
1. <span data-ttu-id="86689-156">A continuación, el paquete se reenvía al cliente mediante la interfaz que está conectada a la red interna.</span><span class="sxs-lookup"><span data-stu-id="86689-156">The packet is then forwarded to the Client through the interface that is connected to the internal network.</span></span>

<span data-ttu-id="86689-157">De esta manera, la dirección de red de Internet y el número de puerto del remitente no se exponen a otros hosts de la red pública de Internet.</span><span class="sxs-lookup"><span data-stu-id="86689-157">In this manner the internet network address and port number of the sender is not exposed to other hosts on the public Internet.</span></span>

## <a name="netx-duo-nat-features"></a><span data-ttu-id="86689-158">Características de NAT en NetX Duo</span><span class="sxs-lookup"><span data-stu-id="86689-158">NetX Duo NAT Features</span></span>

<span data-ttu-id="86689-159">Cuando se crea la instancia de NAT mediante la llamada a *nx_nat_create*, se crea la tabla de traducción NAT.</span><span class="sxs-lookup"><span data-stu-id="86689-159">When the NAT instance is created using *nx_nat_create* call, the NAT translation table is created.</span></span>

```C
UINT nx_nat_create(NX_NAT_DEVICE *nat_ptr, NX_IP *ip_ptr,
    UINT global_interface_index,
    VOID *dynamic_cache_memory,
    UINT dynamic_cache_size);
```

<span data-ttu-id="86689-160">Para realizar un seguimiento de las traducciones de direcciones de red de todas las conexiones activas entre las redes locales y externas, el enrutador habilitado para NAT de Net Duo mantiene una tabla de traducción con información sobre cada conexión de host privado que incluye la dirección IP de origen y de destino y el número de puerto.</span><span class="sxs-lookup"><span data-stu-id="86689-160">To keep track of the network address translations for all active connections between local and external networks, the NetX Duo NAT-enabled router maintains a translation table with information about each private host connection which includes source and destination IP address and port number.</span></span>

<span data-ttu-id="86689-161">La ubicación de esta tabla de traducción ("caché") se establece con el puntero dynamic_cache_memory.</span><span class="sxs-lookup"><span data-stu-id="86689-161">The location of this translation table (“cache”) is set with the dynamic_cache_memory pointer.</span></span> <span data-ttu-id="86689-162">Esta área debe ser un espacio de búfer alineado de 4 bytes.</span><span class="sxs-lookup"><span data-stu-id="86689-162">This area must be a 4 byte aligned buffer space.</span></span> <span data-ttu-id="86689-163">El tamaño de la tabla (o el número de entradas) se determina dividiendo el tamaño de caché dynamic_cache_size por el tamaño de una entrada de la tabla NAT.</span><span class="sxs-lookup"><span data-stu-id="86689-163">The size of the table (or number of entries) is determined by dividing the cache size dynamic_cache_size by the size of a NAT table entry.</span></span> <span data-ttu-id="86689-164">La tabla debe ser lo suficientemente grande para el número mínimo de entradas especificado por **NX_NAT_MIN_ENTRY_COUNT que se define en *nx_nat.h*. El valor predeterminado es 3.**</span><span class="sxs-lookup"><span data-stu-id="86689-164">The table must be large enough for the minimal number of entries specified by **NX_NAT_MIN_ENTRY_COUNT which is defined in *nx_nat.h*. The default value is 3.**</span></span>

<span data-ttu-id="86689-165">El tiempo de espera de todas las entradas dinámicas de la tabla de traducción NAT de NetX Duo se inicializa en NX_NAT_ENTRY_RESPONSE_TIMEOUT, que se define en *nx_nat. h*.</span><span class="sxs-lookup"><span data-stu-id="86689-165">The timeout for all dynamic entries in the NetX Duo NAT translation table are initialized to NX_NAT_ENTRY_RESPONSE_TIMEOUT which is defined in *nx_nat.h*.</span></span> <span data-ttu-id="86689-166">El valor predeterminado es 4 minutos (240 tics del sistema en el caso de un procesador de 100 mHz), según se recomienda en el documento RFC 2663.</span><span class="sxs-lookup"><span data-stu-id="86689-166">The default value is 4 minutes (or 240 system ticks for a 100 mHz processor) as recommended by RFC 2663.</span></span> <span data-ttu-id="86689-167">Cada vez que NAT de NetX Duo recibe o envía un paquete que coincide con una entrada dinámica de la tabla, restablece el tiempo de espera de la entrada en NX_NAT_ENTRY_RESPONSE_TIMEOUT.</span><span class="sxs-lookup"><span data-stu-id="86689-167">Each time NetX Duo NAT receives or sends a packet matching a dynamic entry in the table it resets that entry’s time out to NX_NAT_ENTRY_RESPONSE_TIMEOUT.</span></span> <span data-ttu-id="86689-168">Al buscar en la tabla, NAT de NetX Duo también buscará en la tabla las entradas expiradas y las eliminará.</span><span class="sxs-lookup"><span data-stu-id="86689-168">When searching the table, NetX Duo NAT will also check the table for expired entries and delete them.</span></span>

<span data-ttu-id="86689-169">Para crear entradas entrantes como estáticas en la tabla, por ejemplo, para los servidores de la red local, NAT de NetX Duo proporciona el servicio *nx_nat_inbound_entry_create*.</span><span class="sxs-lookup"><span data-stu-id="86689-169">To create inbound entries as static in the table e.g. for servers on the local network, NetX Duo NAT provides the *nx_nat_inbound_entry_create* service.</span></span> <span data-ttu-id="86689-170">Si una entrada de la tabla define la conexión del host local como estática, nunca expira.</span><span class="sxs-lookup"><span data-stu-id="86689-170">If a table entry defines the local host connection as static, it never expires.</span></span>

```C
UINT nx_nat_inbound_entry_create(NX_NAT_DEVICE *nat_ptr,
    NX_NAT_TRANSLATION_ENTRY *entry_ptr,
    ULONG local_ip_address, USHORT external_port,
    USHORT local_port, UCHAR protocol);
```

<span data-ttu-id="86689-171">Este servicio se describe con más detalle en [Capítulo 4: Descripción de los servicios](chapter4.md).</span><span class="sxs-lookup"><span data-stu-id="86689-171">This service is described in more detail in [Chapter 4 - Description of Services](chapter4.md)</span></span>

<span data-ttu-id="86689-172">Durante el tiempo de ejecución, si la tabla de traducción está llena y no se pueden agregar más entradas, NAT de NetX Duo lo notificará a la aplicación NAT con una devolución de llamada de caché completa si se registra una con la instancia de NAT.</span><span class="sxs-lookup"><span data-stu-id="86689-172">During runtime, if the translation table is full and no more entries can be added, NetX Duo NAT will notify the NAT application with a cache full callback if one is registered with the NAT instance.</span></span> <span data-ttu-id="86689-173">Para ello se usa el servicio *nx_nat_cache_notify_set*.</span><span class="sxs-lookup"><span data-stu-id="86689-173">This is done using the *nx_nat_cache_notify_set* service:</span></span>

```C
UINT nx_nat_cache_notify_set(NX_NAT_DEVICE *nat_ptr,
    VOID (*cache_full_notify_cb)(NX_NAT_DEVICE *nat_ptr));
```

<span data-ttu-id="86689-174">Consulte [Capítulo 4: Descripción de los servicios](chapter4.md) para más información sobre este servicio.</span><span class="sxs-lookup"><span data-stu-id="86689-174">See [Chapter 4 - Description of Services](chapter4.md) for more details about this service.</span></span>

## <a name="nat-packet-processing-in-netx-duo"></a><span data-ttu-id="86689-175">Procesamiento de paquetes NAT en NetX Duo</span><span class="sxs-lookup"><span data-stu-id="86689-175">NAT Packet Processing in NetX Duo</span></span>

<span data-ttu-id="86689-176">El uso de NAT de NetX Duo va dirigido a los enrutadores IPv4.</span><span class="sxs-lookup"><span data-stu-id="86689-176">NetX Duo NAT is intended for use on an IPv4 router.</span></span> <span data-ttu-id="86689-177">Para que NAT funcione, NetX Duo debe estar configurado para reenviar paquetes al servidor NAT.</span><span class="sxs-lookup"><span data-stu-id="86689-177">For NAT to work, NetX Duo must be configured for forwarding packets to the NAT server.</span></span> <span data-ttu-id="86689-178">Consulte el capítulo 2 sobre la instalación de NAT de NetX Duo para saber cómo hacerlo.</span><span class="sxs-lookup"><span data-stu-id="86689-178">See Chapter 2 on NetX Duo NAT installation for how to do so.</span></span> <span data-ttu-id="86689-179">El servidor NAT indica entonces si "consume" (intenta reenviar) el paquete a un host de cualquiera de sus redes.</span><span class="sxs-lookup"><span data-stu-id="86689-179">The NAT server then indicates if it will ‘consume’ (attempt to forward) the packet to a host on either of its networks.</span></span> <span data-ttu-id="86689-180">Si no se consume el paquete, este se "devuelve" a NetX Duo para procesarlo de la manera habitual.</span><span class="sxs-lookup"><span data-stu-id="86689-180">If it will not consume the packet, the packet is ‘returned’ to NetX Duo to process the packet as it normally would.</span></span>

<span data-ttu-id="86689-181">Cuando el servidor NAT recibe un paquete para reenviar desde NetX Duo, determina si el paquete es entrante o saliente.</span><span class="sxs-lookup"><span data-stu-id="86689-181">When the NAT server receives a packet to forward from NetX Duo, it determines if the packet is inbound or outbound.</span></span>

<span data-ttu-id="86689-182">En el caso de los paquetes salientes, el servidor NAT comprueba la dirección de origen y el puerto del encabezado IP del paquete.</span><span class="sxs-lookup"><span data-stu-id="86689-182">For outbound packets, the NAT server checks the packet IP header source address and port.</span></span> <span data-ttu-id="86689-183">Si la tabla de traducción no contiene una entrada para un paquete enviado previamente por este host para el mismo destino, NAT creará una nueva entrada que contendrá una dirección IP de origen global única para la conexión-puerto y modificará los encabezados de paquete con esta nueva dirección IP-puerto antes de enviarlo a la red externa.</span><span class="sxs-lookup"><span data-stu-id="86689-183">If the translation table does not contain an entry for a packet previously sent by this host for the same destination, NAT will create a new entry which will contain a unique global source IP address:port for the connection, and modify the packet headers with this new IP address:port before sending it onto the external network.</span></span>

<span data-ttu-id="86689-184">En el caso de los paquetes entrantes, el servidor NAT busca una entrada anterior en su tabla de traducción con una dirección IP externa-puerto que coincida con la dirección IP de destino del paquete-puerto.</span><span class="sxs-lookup"><span data-stu-id="86689-184">For inbound packets, the NAT server looks for a previous entry in its translation table with an external IP address: port matching the packet destination IP address: port.</span></span> <span data-ttu-id="86689-185">Si no se encuentra ninguna coincidencia, descartará el paquete a menos que la dirección de destino-puerto sea la dirección externa del servidor en la red local.</span><span class="sxs-lookup"><span data-stu-id="86689-185">If no match is found, it will discard the packet unless the destination address: port is the external address for server on the local network.</span></span> <span data-ttu-id="86689-186">Si encuentra una coincidencia, reemplazará la dirección IP de destino externa del encabezado del paquete-puerto por la dirección IP privada-puerto y enviará el paquete en la red local al host privado previsto.</span><span class="sxs-lookup"><span data-stu-id="86689-186">If it does find a match, it will replace the packet header’s external destination IP address: port with the private IP address: port and send the packet onto the local network to the intended private host.</span></span>

<span data-ttu-id="86689-187">NAT de NetX Duo emplea una serie de puertos de traducción TCP, UDP e ICMP para crear conexiones únicas de dirección local-puerto para los hosts locales que se conectan a hosts externos.</span><span class="sxs-lookup"><span data-stu-id="86689-187">NetX Duo NAT uses a range of TCP, UDP and ICMP translation ports for creating unique local address: port connections for local hosts connecting with outside hosts.</span></span> <span data-ttu-id="86689-188">Las siguientes opciones configurables por el usuario, definidas en *nx_nat.h* definen el intervalo de cada protocolo:</span><span class="sxs-lookup"><span data-stu-id="86689-188">The following user configurable options, defined in *nx_nat.h,* define the range for each protocol:</span></span>

```C
NX_NAT_START_TCP_PORT

NX_NAT_END_TCP_PORT

NX_NAT_START_UDP_PORT

NX_NAT_END_UDP_PORT

NX_NAT_START_ICMP_QUERY_ID

NX_NAT_END_ICMP_QUERY_ID
```

## <a name="nat-requirements-and-constraints"></a><span data-ttu-id="86689-189">Requisitos y restricciones de NAT</span><span class="sxs-lookup"><span data-stu-id="86689-189">NAT Requirements and Constraints</span></span>

<span data-ttu-id="86689-190">NAT de NetX Duo requiere NetX Duo 5.8 o posterior.</span><span class="sxs-lookup"><span data-stu-id="86689-190">NetX Duo NAT requires NetX Duo 5.8 or later.</span></span> <span data-ttu-id="86689-191">La aplicación NAT requiere la creación de una única instancia IP y una interfaz a la red física interna y externa.</span><span class="sxs-lookup"><span data-stu-id="86689-191">The NAT application requires creation of a single IP instance and an interface to the internal and external physical network.</span></span>

<span data-ttu-id="86689-192">Restricciones:</span><span class="sxs-lookup"><span data-stu-id="86689-192">Constraints:</span></span>

- <span data-ttu-id="86689-193">NAT de NetX Duo es compatible con TCP, UDP e ICMP.</span><span class="sxs-lookup"><span data-stu-id="86689-193">NetX Duo NAT supports TCP, UDP and ICMP.</span></span> <span data-ttu-id="86689-194">IGMP no es compatible.</span><span class="sxs-lookup"><span data-stu-id="86689-194">IGMP is not supported.</span></span>
- <span data-ttu-id="86689-195">NAT de NetX Duo no admite direccionamiento IPv6.</span><span class="sxs-lookup"><span data-stu-id="86689-195">NetX Duo NAT does not support IPv6 addressing.</span></span>
- <span data-ttu-id="86689-196">NAT de NetX Duo no incluye los servicios DNS o DHCP, aunque puede integrar esos servicios con sus operaciones NAT.</span><span class="sxs-lookup"><span data-stu-id="86689-196">NetX Duo NAT does not include DNS or DHCP services, although NetX Duo NAT can integrate those services with its NAT operations.</span></span>

## <a name="rfcs-supported-by-netx-duo-nat"></a><span data-ttu-id="86689-197">Documentos RFC que cumple NAT de NetX Duo</span><span class="sxs-lookup"><span data-stu-id="86689-197">RFCs Supported by NetX Duo NAT</span></span>

<span data-ttu-id="86689-198">La implementación de NAT de NetX Duo se basa en la información que se presenta en los siguientes documentos RFC:</span><span class="sxs-lookup"><span data-stu-id="86689-198">NetX Duo NAT implementation is based on information presented in the following RFCs:</span></span>

- <span data-ttu-id="86689-199">RFC 2663: Terminología y consideraciones del traductor de direcciones IP de red (NAT)</span><span class="sxs-lookup"><span data-stu-id="86689-199">RFC 2663: IP Network Address Translator (NAT) Terminology and Considerations</span></span>
- <span data-ttu-id="86689-200">RFC 3022: Traductor de direcciones de red IP tradicionales (NAT tradicional)</span><span class="sxs-lookup"><span data-stu-id="86689-200">RFC 3022: Traditional IP Netowrk Address Translator (Traditional NAT)</span></span>
- <span data-ttu-id="86689-201">RFC 4787: Requisitos de comportamiento de la traducción de direcciones de red (NAT) para UDP de unidifusión</span><span class="sxs-lookup"><span data-stu-id="86689-201">RFC 4787: Network Address Translation (NAT) Behavioral Requirements for Unicast UDP</span></span>
